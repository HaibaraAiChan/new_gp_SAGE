[05:26:00] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27741370 edges into 32 parts and get 8911194 edge cuts
main start at this time 1651555536.5796936
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026287078857421875
global_2_local spend time (sec) 0.03759503364562988
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004907369613647461
A = g.adjacency_matrix() spent  0.007829427719116211
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08196282386779785
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2887773513793945
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2049503326416016

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18687042, 2.0: 3216437, 3.0: 806435, 4.0: 243588, 5.0: 87963, 6.0: 38056, 7.0: 17712, 8.0: 9211, 9.0: 5018, 10.0: 2773, 11.0: 1603, 12.0: 931, 13.0: 552, 14.0: 368, 15.0: 239, 16.0: 157, 17.0: 127, 18.0: 78, 19.0: 42, 20.0: 15, 21.0: 7})
Convert a graph into a bidirected graph: 1.114 seconds
Metis partitioning: 5.440 seconds
Split the graph: 0.606 seconds
Construct subgraphs: 0.111 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.284312963485718
2909
2890
2927
2887
2892
2916
2897
2895
2758
2874
2919
2889
2782
2911
2858
2902
2760
2798
2795
2785
2927
2762
2758
2759
2888
2768
2802
2875
2795
2810
2794
2759
total k batches seeds list generation spend  19.802788972854614
after graph partition
graph partition algorithm spend time 19.895970344543457
2909
2890
2927
2887
2892
2916
2897
2895
2758
2874
2919
2889
2782
2911
2858
2902
2760
2798
2795
2785
2927
2762
2758
2759
2888
2768
2802
2875
2795
2810
2794
2759
partition_len_list
[7575, 6325, 7369, 6708, 5700, 7152, 5102, 5245, 9148, 7352, 6667, 7264, 6169, 6208, 6482, 5459, 17587, 18534, 14211, 15621, 17813, 16222, 16711, 18325, 7713, 8854, 6944, 6755, 9421, 11404, 12387, 14943]
shared_neighbor_graph_partition_s0 selection method  spend 19.995882272720337
time for parepare:  0.019246339797973633
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0010120868682861328
mini_batch_src_global generation:  0.0012366771697998047
r_  generation:  0.006926298141479492
local_output_nid generation:  0.0008695125579833984
local_in_edges_tensor generation:  0.000812530517578125
mini_batch_src_global generation:  0.0009686946868896484
r_  generation:  0.006179332733154297
local_output_nid generation:  0.0009484291076660156
local_in_edges_tensor generation:  0.0009706020355224609
mini_batch_src_global generation:  0.0011489391326904297
r_  generation:  0.008119583129882812
local_output_nid generation:  0.0009579658508300781
local_in_edges_tensor generation:  0.0007700920104980469
mini_batch_src_global generation:  0.0008349418640136719
r_  generation:  0.006308078765869141
local_output_nid generation:  0.0009348392486572266
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0007815361022949219
r_  generation:  0.006553173065185547
local_output_nid generation:  0.0009343624114990234
local_in_edges_tensor generation:  0.0007772445678710938
mini_batch_src_global generation:  0.0009148120880126953
r_  generation:  0.007437229156494141
local_output_nid generation:  0.0009024143218994141
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0007023811340332031
r_  generation:  0.005773782730102539
local_output_nid generation:  0.0026030540466308594
local_in_edges_tensor generation:  0.0010614395141601562
mini_batch_src_global generation:  0.0006892681121826172
r_  generation:  0.006337642669677734
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.000705718994140625
mini_batch_src_global generation:  0.0008411407470703125
r_  generation:  0.006267547607421875
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.0009975433349609375
r_  generation:  0.008064985275268555
local_output_nid generation:  0.0009417533874511719
local_in_edges_tensor generation:  0.0007495880126953125
mini_batch_src_global generation:  0.0008885860443115234
r_  generation:  0.007541656494140625
local_output_nid generation:  0.0009150505065917969
local_in_edges_tensor generation:  0.0007216930389404297
mini_batch_src_global generation:  0.0008046627044677734
r_  generation:  0.006853818893432617
local_output_nid generation:  0.0008747577667236328
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0008716583251953125
r_  generation:  0.0077915191650390625
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0008752346038818359
r_  generation:  0.007674217224121094
local_output_nid generation:  0.0008995532989501953
local_in_edges_tensor generation:  0.0007293224334716797
mini_batch_src_global generation:  0.0008633136749267578
r_  generation:  0.007451057434082031
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0007131099700927734
r_  generation:  0.005866050720214844
local_output_nid generation:  0.0008337497711181641
local_in_edges_tensor generation:  0.0007338523864746094
mini_batch_src_global generation:  0.00116729736328125
r_  generation:  0.008605241775512695
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0008294582366943359
mini_batch_src_global generation:  0.0015647411346435547
r_  generation:  0.009272098541259766
local_output_nid generation:  0.0009396076202392578
local_in_edges_tensor generation:  0.0007431507110595703
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.00798654556274414
local_output_nid generation:  0.0009427070617675781
local_in_edges_tensor generation:  0.000728607177734375
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.007917404174804688
local_output_nid generation:  0.0009756088256835938
local_in_edges_tensor generation:  0.0008668899536132812
mini_batch_src_global generation:  0.0012402534484863281
r_  generation:  0.012798547744750977
local_output_nid generation:  0.0009701251983642578
local_in_edges_tensor generation:  0.0007913112640380859
mini_batch_src_global generation:  0.0012519359588623047
r_  generation:  0.009187459945678711
local_output_nid generation:  0.0009789466857910156
local_in_edges_tensor generation:  0.0007994174957275391
mini_batch_src_global generation:  0.0010769367218017578
r_  generation:  0.01102304458618164
local_output_nid generation:  0.0009720325469970703
local_in_edges_tensor generation:  0.0007855892181396484
mini_batch_src_global generation:  0.0012969970703125
r_  generation:  0.009667158126831055
local_output_nid generation:  0.00103759765625
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0008389949798583984
r_  generation:  0.0065517425537109375
local_output_nid generation:  0.001033782958984375
local_in_edges_tensor generation:  0.006157636642456055
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.006178617477416992
local_output_nid generation:  0.0007908344268798828
local_in_edges_tensor generation:  0.0007164478302001953
mini_batch_src_global generation:  0.0007381439208984375
r_  generation:  0.0050432682037353516
local_output_nid generation:  0.0008027553558349609
local_in_edges_tensor generation:  0.0006968975067138672
mini_batch_src_global generation:  0.0007703304290771484
r_  generation:  0.005547523498535156
local_output_nid generation:  0.0007832050323486328
local_in_edges_tensor generation:  0.0006806850433349609
mini_batch_src_global generation:  0.0007522106170654297
r_  generation:  0.0055315494537353516
local_output_nid generation:  0.0008013248443603516
local_in_edges_tensor generation:  0.0007054805755615234
mini_batch_src_global generation:  0.0009212493896484375
r_  generation:  0.006653785705566406
local_output_nid generation:  0.0008108615875244141
local_in_edges_tensor generation:  0.0006849765777587891
mini_batch_src_global generation:  0.0008726119995117188
r_  generation:  0.007231473922729492
local_output_nid generation:  0.0008347034454345703
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.0012311935424804688
r_  generation:  0.009883642196655273
----------------------check_connections_block total spend ----------------------------- 0.42347121238708496
generate_one_block  0.017352819442749023
generate_one_block  0.009284496307373047
generate_one_block  0.011542320251464844
generate_one_block  0.008346796035766602
generate_one_block  0.00893712043762207
generate_one_block  0.010208606719970703
generate_one_block  0.007482767105102539
generate_one_block  0.007685422897338867
generate_one_block  0.011837005615234375
generate_one_block  0.01902914047241211
generate_one_block  0.011515378952026367
generate_one_block  0.011001825332641602
generate_one_block  0.010846853256225586
generate_one_block  0.010554313659667969
generate_one_block  0.010277271270751953
generate_one_block  0.007858514785766602
generate_one_block  0.013947010040283203
generate_one_block  0.01484823226928711
generate_one_block  0.012004852294921875
generate_one_block  0.012835025787353516
generate_one_block  0.018721580505371094
generate_one_block  0.014377832412719727
generate_one_block  0.016162633895874023
generate_one_block  0.01745748519897461
generate_one_block  0.010918378829956055
generate_one_block  0.009906530380249023
generate_one_block  0.007310628890991211
generate_one_block  0.007895946502685547
generate_one_block  0.008906364440917969
generate_one_block  0.01054525375366211
generate_one_block  0.01080012321472168
generate_one_block  0.015065670013427734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03705930709838867
gen group dst list time:  0.009420156478881836
time for parepare:  0.023382186889648438
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.010898828506469727
mini_batch_src_global generation:  0.0019452571868896484
r_  generation:  0.017293930053710938
local_output_nid generation:  0.0019218921661376953
local_in_edges_tensor generation:  0.0015645027160644531
mini_batch_src_global generation:  0.01782846450805664
r_  generation:  0.013210058212280273
local_output_nid generation:  0.002279520034790039
local_in_edges_tensor generation:  0.0017971992492675781
mini_batch_src_global generation:  0.0013704299926757812
r_  generation:  0.017522335052490234
local_output_nid generation:  0.0019309520721435547
local_in_edges_tensor generation:  0.0015270709991455078
mini_batch_src_global generation:  0.0012388229370117188
r_  generation:  0.01430821418762207
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0013256072998046875
mini_batch_src_global generation:  0.0010523796081542969
r_  generation:  0.011993646621704102
local_output_nid generation:  0.0018091201782226562
local_in_edges_tensor generation:  0.0015692710876464844
mini_batch_src_global generation:  0.0013320446014404297
r_  generation:  0.0159146785736084
local_output_nid generation:  0.0013325214385986328
local_in_edges_tensor generation:  0.0010936260223388672
mini_batch_src_global generation:  0.0010967254638671875
r_  generation:  0.008682489395141602
local_output_nid generation:  0.0014309883117675781
local_in_edges_tensor generation:  0.0011467933654785156
mini_batch_src_global generation:  0.00099945068359375
r_  generation:  0.008951425552368164
local_output_nid generation:  0.002554178237915039
local_in_edges_tensor generation:  0.002039194107055664
mini_batch_src_global generation:  0.0016248226165771484
r_  generation:  0.022741079330444336
local_output_nid generation:  0.002010345458984375
local_in_edges_tensor generation:  0.0019252300262451172
mini_batch_src_global generation:  0.0018606185913085938
r_  generation:  0.01882791519165039
local_output_nid generation:  0.0027768611907958984
local_in_edges_tensor generation:  0.0020072460174560547
mini_batch_src_global generation:  0.0019168853759765625
r_  generation:  0.015780925750732422
local_output_nid generation:  0.0020151138305664062
local_in_edges_tensor generation:  0.0015871524810791016
mini_batch_src_global generation:  0.00131988525390625
r_  generation:  0.016370773315429688
local_output_nid generation:  0.001607656478881836
local_in_edges_tensor generation:  0.001373291015625
mini_batch_src_global generation:  0.0012423992156982422
r_  generation:  0.014424800872802734
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0013377666473388672
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.014907598495483398
local_output_nid generation:  0.0016858577728271484
local_in_edges_tensor generation:  0.004031658172607422
mini_batch_src_global generation:  0.001224517822265625
r_  generation:  0.015112161636352539
local_output_nid generation:  0.0014548301696777344
local_in_edges_tensor generation:  0.0015552043914794922
mini_batch_src_global generation:  0.0012249946594238281
r_  generation:  0.010098457336425781
local_output_nid generation:  0.004403114318847656
local_in_edges_tensor generation:  0.005350828170776367
mini_batch_src_global generation:  0.004834175109863281
r_  generation:  0.05311250686645508
local_output_nid generation:  0.00515294075012207
local_in_edges_tensor generation:  0.005991220474243164
mini_batch_src_global generation:  0.007016897201538086
r_  generation:  0.05400538444519043
local_output_nid generation:  0.004276275634765625
local_in_edges_tensor generation:  0.0039234161376953125
mini_batch_src_global generation:  0.004576206207275391
r_  generation:  0.04037761688232422
local_output_nid generation:  0.004526376724243164
local_in_edges_tensor generation:  0.004025936126708984
mini_batch_src_global generation:  0.004511356353759766
r_  generation:  0.044995784759521484
local_output_nid generation:  0.004989147186279297
local_in_edges_tensor generation:  0.0062711238861083984
mini_batch_src_global generation:  0.006216526031494141
r_  generation:  0.05252647399902344
local_output_nid generation:  0.004607439041137695
local_in_edges_tensor generation:  0.004400491714477539
mini_batch_src_global generation:  0.004944801330566406
r_  generation:  0.04968571662902832
local_output_nid generation:  0.006777286529541016
local_in_edges_tensor generation:  0.00426173210144043
mini_batch_src_global generation:  0.005586862564086914
r_  generation:  0.04805946350097656
local_output_nid generation:  0.005249738693237305
local_in_edges_tensor generation:  0.006376028060913086
mini_batch_src_global generation:  0.006192207336425781
r_  generation:  0.056432247161865234
local_output_nid generation:  0.0024747848510742188
local_in_edges_tensor generation:  0.002504587173461914
mini_batch_src_global generation:  0.0025997161865234375
r_  generation:  0.018267154693603516
local_output_nid generation:  0.0028204917907714844
local_in_edges_tensor generation:  0.0023813247680664062
mini_batch_src_global generation:  0.0017328262329101562
r_  generation:  0.0218203067779541
local_output_nid generation:  0.0021402835845947266
local_in_edges_tensor generation:  0.001729726791381836
mini_batch_src_global generation:  0.001453399658203125
r_  generation:  0.014962434768676758
local_output_nid generation:  0.002039194107055664
local_in_edges_tensor generation:  0.0016126632690429688
mini_batch_src_global generation:  0.001237630844116211
r_  generation:  0.014436960220336914
local_output_nid generation:  0.0026311874389648438
local_in_edges_tensor generation:  0.002057790756225586
mini_batch_src_global generation:  0.0017278194427490234
r_  generation:  0.02280402183532715
local_output_nid generation:  0.0031099319458007812
local_in_edges_tensor generation:  0.0025892257690429688
mini_batch_src_global generation:  0.0026018619537353516
r_  generation:  0.0299375057220459
local_output_nid generation:  0.0034627914428710938
local_in_edges_tensor generation:  0.0029382705688476562
mini_batch_src_global generation:  0.0029790401458740234
r_  generation:  0.03229212760925293
local_output_nid generation:  0.004069089889526367
local_in_edges_tensor generation:  0.003607034683227539
mini_batch_src_global generation:  0.004370212554931641
r_  generation:  0.04268836975097656
----------------------check_connections_block total spend ----------------------------- 1.3535659313201904
generate_one_block  0.02340412139892578
generate_one_block  0.01856255531311035
generate_one_block  0.02934861183166504
generate_one_block  0.0195620059967041
generate_one_block  0.015575885772705078
generate_one_block  0.021209239959716797
generate_one_block  0.012482881546020508
generate_one_block  0.012067556381225586
generate_one_block  0.027316808700561523
generate_one_block  0.024326324462890625
generate_one_block  0.02050948143005371
generate_one_block  0.046320199966430664
generate_one_block  0.02017998695373535
generate_one_block  0.02003788948059082
generate_one_block  0.03117680549621582
generate_one_block  0.014872074127197266
generate_one_block  0.07308387756347656
generate_one_block  0.08684253692626953
generate_one_block  0.05893421173095703
generate_one_block  0.07090640068054199
generate_one_block  0.07701325416564941
generate_one_block  0.0641634464263916
generate_one_block  0.07442808151245117
generate_one_block  0.07530975341796875
generate_one_block  0.024636507034301758
generate_one_block  0.028916358947753906
generate_one_block  0.03563356399536133
generate_one_block  0.02008962631225586
generate_one_block  0.04422569274902344
generate_one_block  0.05245161056518555
generate_one_block  0.045935869216918945
generate_one_block  0.06162905693054199
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.3535659313201904
block generation total time  1.2511522769927979
average batch blocks generation time:  0.03909850865602493
pseudo mini batch 0 input nodes size: 18482
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.01159048080444336  GigaBytes
Max Memory Allocated: 0.01159048080444336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.011612415313720703  GigaBytes
Max Memory Allocated: 0.011612415313720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.011612415313720703  GigaBytes
Max Memory Allocated: 0.011612415313720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01215982437133789  GigaBytes
Max Memory Allocated: 0.01215982437133789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01215982437133789  GigaBytes
Max Memory Allocated: 0.01215982437133789  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01215982437133789  GigaBytes
Max Memory Allocated: 0.01215982437133789  GigaBytes

torch.Size([18482, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01215982437133789  GigaBytes
Max Memory Allocated: 0.01215982437133789  GigaBytes

m.shape torch.Size([561, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.037034034729003906  GigaBytes
Max Memory Allocated: 0.03749847412109375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.037034034729003906  GigaBytes
Max Memory Allocated: 0.03749847412109375  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03756904602050781  GigaBytes
Max Memory Allocated: 0.03756904602050781  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.04222726821899414  GigaBytes
Max Memory Allocated: 0.042494773864746094  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([702, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.042629241943359375  GigaBytes
Max Memory Allocated: 0.04264497756958008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.042629241943359375  GigaBytes
Max Memory Allocated: 0.04264497756958008  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.04329872131347656  GigaBytes
Max Memory Allocated: 0.04329872131347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.053885459899902344  GigaBytes
Max Memory Allocated: 0.05455493927001953  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([617, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.054433345794677734  GigaBytes
Max Memory Allocated: 0.05455493927001953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.054433345794677734  GigaBytes
Max Memory Allocated: 0.05455493927001953  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.05502176284790039  GigaBytes
Max Memory Allocated: 0.05502176284790039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.06796693801879883  GigaBytes
Max Memory Allocated: 0.06884956359863281  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([629, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.06887245178222656  GigaBytes
Max Memory Allocated: 0.06890106201171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.06887245178222656  GigaBytes
Max Memory Allocated: 0.06890106201171875  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0694723129272461  GigaBytes
Max Memory Allocated: 0.0694723129272461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08740997314453125  GigaBytes
Max Memory Allocated: 0.08860969543457031  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([516, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08834028244018555  GigaBytes
Max Memory Allocated: 0.08860969543457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08834028244018555  GigaBytes
Max Memory Allocated: 0.08860969543457031  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08883237838745117  GigaBytes
Max Memory Allocated: 0.08883237838745117  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10682439804077148  GigaBytes
Max Memory Allocated: 0.10805463790893555  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([446, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10785436630249023  GigaBytes
Max Memory Allocated: 0.10805463790893555  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10785436630249023  GigaBytes
Max Memory Allocated: 0.10805463790893555  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10827970504760742  GigaBytes
Max Memory Allocated: 0.10827970504760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.12656927108764648  GigaBytes
Max Memory Allocated: 0.12784528732299805  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([415, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.12774181365966797  GigaBytes
Max Memory Allocated: 0.12784528732299805  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.12774181365966797  GigaBytes
Max Memory Allocated: 0.12784528732299805  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.12813758850097656  GigaBytes
Max Memory Allocated: 0.12813758850097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.14792633056640625  GigaBytes
Max Memory Allocated: 0.14931154251098633  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([415, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.14931154251098633  GigaBytes
Max Memory Allocated: 0.14934873580932617  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.14931154251098633  GigaBytes
Max Memory Allocated: 0.14934873580932617  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 1.3475341796875 GB
    Memory Allocated: 0.14970731735229492  GigaBytes
Max Memory Allocated: 0.14970731735229492  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.17226648330688477  GigaBytes
Max Memory Allocated: 0.17384958267211914  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([342, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.1735363006591797  GigaBytes
Max Memory Allocated: 0.17384958267211914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.1735363006591797  GigaBytes
Max Memory Allocated: 0.17384958267211914  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.17386245727539062  GigaBytes
Max Memory Allocated: 0.17386245727539062  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.19473648071289062  GigaBytes
Max Memory Allocated: 0.19620418548583984  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([2932, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.20855426788330078  GigaBytes
Max Memory Allocated: 0.20888280868530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.20855426788330078  GigaBytes
Max Memory Allocated: 0.20888280868530273  GigaBytes

 h.shape torch.Size([1, 2932, 128]), torch.Size([1, 2932, 128])
----------------------------------------3
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.21159648895263672  GigaBytes
Max Memory Allocated: 0.21159648895263672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.41046667098999023  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

rst.shape  torch.Size([1, 2932, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.38834476470947266  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.39556884765625  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.40279293060302734  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.39551210403442383  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

torch.Size([7575, 256])
first layer input nodes number: 18482
first layer output nodes number: 7575
edges number: 50211
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.40293264389038086  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.4101567268371582  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.41196298599243164  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.41196298599243164  GigaBytes
Max Memory Allocated: 0.42444753646850586  GigaBytes

m.shape torch.Size([373, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4346199035644531  GigaBytes
Max Memory Allocated: 0.43462133407592773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4346199035644531  GigaBytes
Max Memory Allocated: 0.43462133407592773  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4353313446044922  GigaBytes
Max Memory Allocated: 0.4353313446044922  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.44170570373535156  GigaBytes
Max Memory Allocated: 0.4420614242553711  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.44206714630126953  GigaBytes
Max Memory Allocated: 0.44207000732421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.44206714630126953  GigaBytes
Max Memory Allocated: 0.44207000732421875  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4427785873413086  GigaBytes
Max Memory Allocated: 0.4427785873413086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.45345020294189453  GigaBytes
Max Memory Allocated: 0.4541616439819336  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4539194107055664  GigaBytes
Max Memory Allocated: 0.4541616439819336  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4539194107055664  GigaBytes
Max Memory Allocated: 0.4541616439819336  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4544649124145508  GigaBytes
Max Memory Allocated: 0.4544649124145508  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4687824249267578  GigaBytes
Max Memory Allocated: 0.4696006774902344  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.46987390518188477  GigaBytes
Max Memory Allocated: 0.4698781967163086  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.46987390518188477  GigaBytes
Max Memory Allocated: 0.4698781967163086  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4703679084777832  GigaBytes
Max Memory Allocated: 0.4703679084777832  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4856395721435547  GigaBytes
Max Memory Allocated: 0.48662757873535156  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4864354133605957  GigaBytes
Max Memory Allocated: 0.48662757873535156  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4864354133605957  GigaBytes
Max Memory Allocated: 0.48662757873535156  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.486849308013916  GigaBytes
Max Memory Allocated: 0.486849308013916  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5017495155334473  GigaBytes
Max Memory Allocated: 0.502784252166748  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5024595260620117  GigaBytes
Max Memory Allocated: 0.502784252166748  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5024595260620117  GigaBytes
Max Memory Allocated: 0.502784252166748  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.5027627944946289  GigaBytes
Max Memory Allocated: 0.502784252166748  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.515803337097168  GigaBytes
Max Memory Allocated: 0.5167131423950195  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5165266990661621  GigaBytes
Max Memory Allocated: 0.5167131423950195  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5165266990661621  GigaBytes
Max Memory Allocated: 0.5167131423950195  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5167746543884277  GigaBytes
Max Memory Allocated: 0.5167746543884277  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.529172420501709  GigaBytes
Max Memory Allocated: 0.5300402641296387  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([160, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5302786827087402  GigaBytes
Max Memory Allocated: 0.5302834510803223  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5302786827087402  GigaBytes
Max Memory Allocated: 0.5302834510803223  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5305838584899902  GigaBytes
Max Memory Allocated: 0.5305838584899902  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5479788780212402  GigaBytes
Max Memory Allocated: 0.5491995811462402  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5486569404602051  GigaBytes
Max Memory Allocated: 0.5491995811462402  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5486569404602051  GigaBytes
Max Memory Allocated: 0.5491995811462402  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5488400459289551  GigaBytes
Max Memory Allocated: 0.5491995811462402  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.5605587959289551  GigaBytes
Max Memory Allocated: 0.5613827705383301  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.5612268447875977  GigaBytes
Max Memory Allocated: 0.5613827705383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.5612268447875977  GigaBytes
Max Memory Allocated: 0.5613827705383301  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.5613775253295898  GigaBytes
Max Memory Allocated: 0.5613827705383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.5720758438110352  GigaBytes
Max Memory Allocated: 0.5728292465209961  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.572899341583252  GigaBytes
Max Memory Allocated: 0.5729031562805176  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.572899341583252  GigaBytes
Max Memory Allocated: 0.5729031562805176  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.573061466217041  GigaBytes
Max Memory Allocated: 0.573061466217041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.5857071876525879  GigaBytes
Max Memory Allocated: 0.5865988731384277  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.586479663848877  GigaBytes
Max Memory Allocated: 0.5865988731384277  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.586479663848877  GigaBytes
Max Memory Allocated: 0.5865988731384277  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.5866208076477051  GigaBytes
Max Memory Allocated: 0.5866208076477051  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.5986180305480957  GigaBytes
Max Memory Allocated: 0.5994648933410645  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.5992221832275391  GigaBytes
Max Memory Allocated: 0.5994648933410645  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.5992221832275391  GigaBytes
Max Memory Allocated: 0.5994648933410645  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 1.8006591796875 GB
    Memory Allocated: 0.5993251800537109  GigaBytes
Max Memory Allocated: 0.5994648933410645  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.6088008880615234  GigaBytes
Max Memory Allocated: 0.6094703674316406  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.609489917755127  GigaBytes
Max Memory Allocated: 0.6094932556152344  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.609489917755127  GigaBytes
Max Memory Allocated: 0.6094932556152344  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.6095948219299316  GigaBytes
Max Memory Allocated: 0.6095948219299316  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.6199803352355957  GigaBytes
Max Memory Allocated: 0.6207146644592285  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.6205334663391113  GigaBytes
Max Memory Allocated: 0.6207146644592285  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.6205334663391113  GigaBytes
Max Memory Allocated: 0.6207146644592285  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.6206135749816895  GigaBytes
Max Memory Allocated: 0.6207146644592285  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.6291050910949707  GigaBytes
Max Memory Allocated: 0.6297059059143066  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.6297574043273926  GigaBytes
Max Memory Allocated: 0.6297602653503418  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.6297574043273926  GigaBytes
Max Memory Allocated: 0.6297602653503418  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.6298432350158691  GigaBytes
Max Memory Allocated: 0.6298432350158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6395421028137207  GigaBytes
Max Memory Allocated: 0.6402287483215332  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6400876045227051  GigaBytes
Max Memory Allocated: 0.6402287483215332  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6400876045227051  GigaBytes
Max Memory Allocated: 0.6402287483215332  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6401562690734863  GigaBytes
Max Memory Allocated: 0.6402287483215332  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6483960151672363  GigaBytes
Max Memory Allocated: 0.648979663848877  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6488981246948242  GigaBytes
Max Memory Allocated: 0.648979663848877  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6488981246948242  GigaBytes
Max Memory Allocated: 0.648979663848877  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.6489572525024414  GigaBytes
Max Memory Allocated: 0.648979663848877  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.6564664840698242  GigaBytes
Max Memory Allocated: 0.6569986343383789  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.656984806060791  GigaBytes
Max Memory Allocated: 0.6569986343383789  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.656984806060791  GigaBytes
Max Memory Allocated: 0.6569986343383789  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.6570420265197754  GigaBytes
Max Memory Allocated: 0.6570420265197754  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.6647095680236816  GigaBytes
Max Memory Allocated: 0.6652531623840332  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.665046215057373  GigaBytes
Max Memory Allocated: 0.6652531623840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.665046215057373  GigaBytes
Max Memory Allocated: 0.6652531623840332  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.6650824546813965  GigaBytes
Max Memory Allocated: 0.6652531623840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.6701922416687012  GigaBytes
Max Memory Allocated: 0.6705546379089355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.6706991195678711  GigaBytes
Max Memory Allocated: 0.6707015037536621  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.6706991195678711  GigaBytes
Max Memory Allocated: 0.6707015037536621  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.6707487106323242  GigaBytes
Max Memory Allocated: 0.6707487106323242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.6780881881713867  GigaBytes
Max Memory Allocated: 0.6786088943481445  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.6785922050476074  GigaBytes
Max Memory Allocated: 0.6786088943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.6785922050476074  GigaBytes
Max Memory Allocated: 0.6786088943481445  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.6786398887634277  GigaBytes
Max Memory Allocated: 0.6786398887634277  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8846435546875 GB
    Memory Allocated: 0.6860308647155762  GigaBytes
Max Memory Allocated: 0.6865553855895996  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.8846435546875 GB
    Memory Allocated: 0.6865596771240234  GigaBytes
Max Memory Allocated: 0.6865620613098145  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8846435546875 GB
    Memory Allocated: 0.6865596771240234  GigaBytes
Max Memory Allocated: 0.6865620613098145  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 1.8846435546875 GB
    Memory Allocated: 0.6866073608398438  GigaBytes
Max Memory Allocated: 0.6866073608398438  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6943321228027344  GigaBytes
Max Memory Allocated: 0.694880485534668  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6947007179260254  GigaBytes
Max Memory Allocated: 0.694880485534668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6947007179260254  GigaBytes
Max Memory Allocated: 0.694880485534668  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6947331428527832  GigaBytes
Max Memory Allocated: 0.694880485534668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.7002129554748535  GigaBytes
Max Memory Allocated: 0.7006020545959473  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([213, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.705315113067627  GigaBytes
Max Memory Allocated: 0.7053351402282715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.705315113067627  GigaBytes
Max Memory Allocated: 0.7053351402282715  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.705721378326416  GigaBytes
Max Memory Allocated: 0.705721378326416  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.777224063873291  GigaBytes
Max Memory Allocated: 0.7823023796081543  GigaBytes

rst.shape  torch.Size([1, 213, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7577242851257324  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7581582069396973  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7585921287536621  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7581362724304199  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

torch.Size([2909, 40])
input nodes number: 7575
output nodes number: 2909
edges number: 23065
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7586488723754883  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7586498260498047  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.016431331634521484  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

pseudo mini batch 1 input nodes size: 14307
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.01482248306274414  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.01482248306274414  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.02164459228515625  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.021666526794433594  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.012831687927246094  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.013245582580566406  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.013245582580566406  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.013245582580566406  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

torch.Size([14307, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.013245582580566406  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

m.shape torch.Size([784, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.03160524368286133  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.03160524368286133  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.03235292434692383  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.039807796478271484  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([789, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.040186405181884766  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.040186405181884766  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.0409388542175293  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.052225589752197266  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([666, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.052802085876464844  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.052802085876464844  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.053437232971191406  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.0674285888671875  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([512, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.06808757781982422  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.06808757781982422  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.06857585906982422  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.08273601531982422  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([431, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.08351945877075195  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.08351945877075195  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.08393049240112305  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.09872770309448242  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([387, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.09962940216064453  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.09962940216064453  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 387, 128]), torch.Size([1, 387, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.09999847412109375  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.11586856842041016  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 387, 128])
m.shape torch.Size([347, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1175069808959961  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1175069808959961  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.11783790588378906  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1343841552734375  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([265, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.13522958755493164  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.13522958755493164  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1354823112487793  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1498875617980957  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([241, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.15079545974731445  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.15079545974731445  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 241, 128]), torch.Size([1, 241, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.15102529525756836  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.16573476791381836  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 241, 128])
m.shape torch.Size([1903, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.17469406127929688  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.17469406127929688  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 1903, 128]), torch.Size([1, 1903, 128])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.17650890350341797  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.30623865127563477  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 1903, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.2907533645629883  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.2967853546142578  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.30281734466552734  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.2967381477355957  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

torch.Size([6325, 256])
first layer input nodes number: 14307
first layer output nodes number: 6325
edges number: 36633
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.30292606353759766  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3089580535888672  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.31095457077026367  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.31095457077026367  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

m.shape torch.Size([547, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3296022415161133  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3296022415161133  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3306455612182617  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3399214744567871  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([432, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.34023046493530273  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.34023046493530273  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.34105443954467773  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.35344552993774414  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([338, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.35400819778442383  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.35400819778442383  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.35465288162231445  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3694491386413574  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3700380325317383  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3700380325317383  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.37049007415771484  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.38359928131103516  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3843393325805664  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3843393325805664  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3847227096557617  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.39852428436279297  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3994288444519043  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3994288444519043  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.39977216720581055  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4145350456237793  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4152650833129883  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4152650833129883  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.41552066802978516  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4282999038696289  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.42901039123535156  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.42901039123535156  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4292182922363281  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4410686492919922  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.44171762466430664  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.44171762466430664  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.44188356399536133  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.45250368118286133  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4532184600830078  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4532184600830078  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.45337677001953125  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4646167755126953  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.46520376205444336  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.46520376205444336  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.46532392501831055  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.47469663619995117  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.47521352767944336  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.47521352767944336  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.475308895111084  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4834151268005371  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.48381757736206055  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.48381757736206055  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4838862419128418  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4902033805847168  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4906806945800781  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4906806945800781  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.490753173828125  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.4979286193847656  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.49846935272216797  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.49846935272216797  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.49854564666748047  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5066328048706055  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5069179534912109  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5069179534912109  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5069580078125  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5114841461181641  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5119543075561523  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5119543075561523  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5120115280151367  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5188779830932617  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5192646980285645  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5192646980285645  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.519310474395752  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5251240730285645  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5254483222961426  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5254483222961426  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.525484561920166  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5303406715393066  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5305342674255371  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5305342674255371  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.530555248260498  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5335135459899902  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5338058471679688  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5338058471679688  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5338344573974609  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5380687713623047  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5384140014648438  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5384140014648438  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5384464263916016  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5434722900390625  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5438761711120605  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5438761711120605  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.543912410736084  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5497832298278809  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5501112937927246  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5501112937927246  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5501399040222168  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5549750328063965  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([144, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5584211349487305  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5584211349487305  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5586957931518555  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.6070356369018555  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 144, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5923933982849121  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5928244590759277  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5932555198669434  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5928025245666504  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

torch.Size([2890, 40])
input nodes number: 6325
output nodes number: 2890
edges number: 18719
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5928688049316406  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5928692817687988  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.014078617095947266  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

pseudo mini batch 2 input nodes size: 18607
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.012828826904296875  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.012828826904296875  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.021701335906982422  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.021723270416259766  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.014879226684570312  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.015465736389160156  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.015465736389160156  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.015465736389160156  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

torch.Size([18607, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.015465736389160156  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

m.shape torch.Size([482, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.041759490966796875  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.041759490966796875  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.04221916198730469  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.04589653015136719  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([550, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.04619121551513672  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.04619121551513672  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.046715736389160156  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.05504179000854492  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([545, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.05555915832519531  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.05555915832519531  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.05607891082763672  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.06751346588134766  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([480, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.06816911697387695  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.06816911697387695  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.06862688064575195  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.08190202713012695  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([454, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.08275556564331055  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.08275556564331055  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.08318853378295898  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.09877538681030273  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([378, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.0996403694152832  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.0996403694152832  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.10000085830688477  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.11550188064575195  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([358, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1165165901184082  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1165165901184082  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.11685800552368164  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13392877578735352  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([338, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13504743576049805  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13504743576049805  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13536977767944336  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.15374326705932617  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([288, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.15520334243774414  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.15520334243774414  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.15547800064086914  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.17305612564086914  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([3496, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1895890235900879  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1895890235900879  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 3496, 128]), torch.Size([1, 3496, 128])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.19292306900024414  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.4296402931213379  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 3496, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.40595245361328125  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.4129800796508789  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.42000770568847656  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.41292476654052734  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

torch.Size([7369, 256])
first layer input nodes number: 18607
first layer output nodes number: 7369
edges number: 52437
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.4201483726501465  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.42717599868774414  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.42953062057495117  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.42953062057495117  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

m.shape torch.Size([324, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.45555639266967773  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.45555639266967773  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.456174373626709  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.46132755279541016  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([332, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.4616570472717285  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.4616570472717285  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.46229028701782227  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.4719676971435547  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.47241830825805664  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.47241830825805664  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.47292566299438477  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.48563623428344727  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.48627471923828125  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.48627471923828125  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.48671722412109375  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.49954986572265625  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.500241756439209  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.500241756439209  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5006041526794434  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5136504173278809  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5144038200378418  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5144038200378418  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5147128105163574  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5279994010925293  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.528834342956543  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.528834342956543  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5291147232055664  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5431337356567383  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([128, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5439777374267578  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5439777374267578  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5442218780517578  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5581378936767578  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([112, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5589847564697266  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5589847564697266  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5591983795166016  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5728702545166016  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([111, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5738306045532227  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5738306045532227  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5740423202514648  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5890741348266602  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5898141860961914  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5898141860961914  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5899667739868164  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6018686294555664  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6026692390441895  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6026692390441895  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6028141975402832  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.615135669708252  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([67, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6159005165100098  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6159005165100098  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6160283088684082  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6277852058410645  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.628542423248291  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.628542423248291  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6286587715148926  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6401772499084473  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6409697532653809  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6409697532653809  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6410822868347168  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6530108451843262  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6535391807556152  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6535391807556152  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6536116600036621  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.661801815032959  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6624355316162109  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6624355316162109  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6625137329101562  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6718978881835938  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6723952293395996  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6723952293395996  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6724543571472168  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6799635887145996  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.680445671081543  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.680445671081543  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6804990768432617  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6876554489135742  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6882247924804688  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6882247924804688  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6882839202880859  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6966209411621094  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.697136402130127  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.697136402130127  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.6971879005432129  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7048096656799316  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7055454254150391  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7055454254150391  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7056140899658203  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7162570953369141  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7165102958679199  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7165102958679199  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7165350914001465  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7205519676208496  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7210240364074707  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7210240364074707  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7210640907287598  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7278332710266113  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([314, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7353582382202148  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7353582382202148  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.735957145690918  GigaBytes
Max Memory Allocated: 0.7853503227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8442659378051758  GigaBytes
Max Memory Allocated: 0.8517522811889648  GigaBytes

rst.shape  torch.Size([1, 314, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8212943077087402  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8217306137084961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.822166919708252  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8217086791992188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2927, 40])
input nodes number: 7369
output nodes number: 2927
edges number: 26236
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8217911720275879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.8217916488647461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.016590595245361328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 3 input nodes size: 16101
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.014884471893310547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.014884471893310547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.022562026977539062  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.022583961486816406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.013689517974853516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.01412343978881836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.01412343978881836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.01412343978881836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([16101, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.01412343978881836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([733, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0345611572265625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0345611572265625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.03526020050048828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04085254669189453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([748, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.041216373443603516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.041216373443603516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04192972183227539  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.05352973937988281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([687, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.054155826568603516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.054155826568603516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.05481100082397461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.06922483444213867  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([592, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.07002639770507812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.07002639770507812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.07059097290039062  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.08788490295410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([530, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0888662338256836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0888662338256836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0893716812133789  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10763025283813477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([406, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10853910446166992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10853910446166992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10892629623413086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12557554244995117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([335, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12650012969970703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12650012969970703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12681961059570312  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1427936553955078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([333, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1444692611694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1444692611694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14478683471679688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1628885269165039  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 333, 128])
m.shape torch.Size([269, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.16388416290283203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.16388416290283203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1641407012939453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1805591583251953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([2075, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.19032526016235352  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.19032526016235352  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 2075, 128]), torch.Size([1, 2075, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.19230413436889648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.33776283264160156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 2075, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.32030677795410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3267040252685547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.33344078063964844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.326993465423584  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([6708, 256])
first layer input nodes number: 16101
first layer output nodes number: 6708
edges number: 39924
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.33356285095214844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.33996009826660156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.34155941009521484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.34155941009521484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([496, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.35970401763916016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.35970401763916016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.36065006256103516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3684530258178711  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([419, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3687858581542969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3687858581542969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3695850372314453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3826723098754883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([336, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3832416534423828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3832416534423828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3838825225830078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3986186981201172  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([277, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.39936351776123047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.39936351776123047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.39989185333251953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.41521358489990234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4160933494567871  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4160933494567871  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4165472984313965  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.432889461517334  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([188, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4337468147277832  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4337468147277832  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.43410539627075195  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4495244026184082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.45015954971313477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.45015954971313477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4503903388977051  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4619297981262207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.46265268325805664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.46265268325805664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4628605842590332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.47471094131469727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.47548961639404297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.47548961639404297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.47568416595458984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.48813533782958984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4888458251953125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4888458251953125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.48900604248046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5003814697265625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5008406639099121  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5008406639099121  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5009379386901855  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5085253715515137  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5090537071228027  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5090537071228027  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5091490745544434  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5172553062438965  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5179576873779297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5179576873779297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5180721282958984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5286006927490234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5290818214416504  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5290818214416504  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5291581153869629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5367112159729004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5373797416687012  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5373797416687012  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.537473201751709  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5473799705505371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5476408004760742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5476408004760742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5476789474487305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5519895553588867  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5524120330810547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5524120330810547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5524635314941406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5586433410644531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5589985847473145  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5589985847473145  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5590405464172363  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5643696784973145  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5647139549255371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5647139549255371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5647521018981934  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5698637962341309  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5703063011169434  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5703063011169434  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5703520774841309  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5768065452575684  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5770864486694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5770864486694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5771150588989258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5813493728637695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5815677642822266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5815677642822266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5815887451171875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5848407745361328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.584963321685791  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.584963321685791  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5849747657775879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5868287086486816  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5870771408081055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5870771408081055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5870981216430664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5906438827514648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([111, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5933008193969727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5933008193969727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5935125350952148  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6307744979858398  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 111, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6159453392028809  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6163759231567383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6168065071105957  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6163539886474609  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2887, 40])
input nodes number: 6708
output nodes number: 2887
edges number: 18250
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6164202690124512  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6164207458496094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.01499176025390625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 4 input nodes size: 11262
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.013683795928955078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.013683795928955078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.019053936004638672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.019075870513916016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.011376380920410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.011768341064453125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.011768341064453125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.011768341064453125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([11262, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.011768341064453125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([620, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.02822113037109375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.02822113037109375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.028812408447265625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.033754825592041016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([656, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.03408479690551758  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.03408479690551758  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.03471040725708008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04424858093261719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([601, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04479551315307617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04479551315307617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04536867141723633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.058358192443847656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([579, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.059175968170166016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.059175968170166016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.059728145599365234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.07671594619750977  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([445, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.07750082015991211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.07750082015991211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.07792520523071289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.09320306777954102  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([376, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.09406661987304688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.09406661987304688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.09442520141601562  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10984420776367188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([333, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.11077642440795898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.11077642440795898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.11109399795532227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12697267532348633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 333, 128])
m.shape torch.Size([300, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1279582977294922  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1279582977294922  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12824440002441406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14455223083496094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 300, 128])
m.shape torch.Size([254, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14549922943115234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14549922943115234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14574146270751953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.16124439239501953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([1536, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.16844749450683594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.16844749450683594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 1536, 128]), torch.Size([1, 1536, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.16991233825683594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.27486324310302734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 1536, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.261044979095459  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.2664809226989746  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.27191686630249023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.26643800735473633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([5700, 256])
first layer input nodes number: 11262
first layer output nodes number: 5700
edges number: 32909
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.2720026969909668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.2774386405944824  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.27989721298217773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.27989721298217773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([402, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3000931739807129  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3000931739807129  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3008599281311035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.30825281143188477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([389, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.30861759185791016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.30861759185791016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3093595504760742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.32085752487182617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([330, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3214383125305176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3214383125305176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3220677375793457  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.33591508865356445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.33681774139404297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.33681774139404297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.33731937408447266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.35252857208251953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.35329198837280273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.35329198837280273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.35369443893432617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3681826591491699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.36904287338256836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.36904287338256836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.36939382553100586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.38448476791381836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([167, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3854331970214844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3854331970214844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.38575172424316406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.40167808532714844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.40258026123046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.40258026123046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4028434753417969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4178466796875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([129, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.41883134841918945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.41883134841918945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.41907739639282227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.43482446670532227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.43561458587646484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.43561458587646484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.43579578399658203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.44866085052490234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.44942665100097656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.44942665100097656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4495811462402344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.46163177490234375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4623274803161621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4623274803161621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.46245527267456055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.47331762313842773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4740161895751953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4740161895751953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4741325378417969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4848365783691406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4853839874267578  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4853839874267578  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4854698181152344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.49396705627441406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4946022033691406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4946022033691406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4946918487548828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5041942596435547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5047030448913574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5047030448913574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5047717094421387  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5125308036804199  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5129051208496094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5129051208496094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5129528045654297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5186748504638672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.519066333770752  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.519066333770752  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5191121101379395  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.524925708770752  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5254325866699219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5254325866699219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5254878997802734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5328998565673828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5332951545715332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5332951545715332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5333371162414551  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5392537117004395  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.539515495300293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.539515495300293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5395421981811523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5434942245483398  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5438404083251953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5438404083251953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5438728332519531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5488986968994141  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5491256713867188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5491256713867188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5491466522216797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5525455474853516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5527658462524414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5527658462524414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5527849197387695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5560083389282227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([95, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5582818984985352  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5582818984985352  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5584630966186523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5903539657592773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 95, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5734128952026367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5738439559936523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.574275016784668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.573822021484375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2892, 40])
input nodes number: 5700
output nodes number: 2892
edges number: 19548
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5738873481750488  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.573887825012207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.012552261352539062  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 5 input nodes size: 15981
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.01137685775756836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.01137685775756836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.019054412841796875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.01907634735107422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.013684272766113281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.014202117919921875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.014202117919921875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.014202117919921875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([15981, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.014202117919921875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([617, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.03716135025024414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.03716135025024414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0377497673034668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04267120361328125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([654, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04300069808959961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.04300069808959961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0436244010925293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.05358409881591797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([598, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.05412769317626953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.05412769317626953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.05469799041748047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.0672445297241211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([557, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.06802177429199219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.06802177429199219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.06855297088623047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.08469772338867188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([557, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.08576011657714844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.08576011657714844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.08629131317138672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10555696487426758  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([469, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10663318634033203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10663318634033203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.10708045959472656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1263132095336914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([421, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12749481201171875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12749481201171875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 421, 128]), torch.Size([1, 421, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.12789630889892578  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14797115325927734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 421, 128])
m.shape torch.Size([368, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14917421340942383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14917421340942383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.14952516555786133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.16952943801879883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([312, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.17069292068481445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.17069292068481445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1709904670715332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.1900334358215332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([2599, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.20227766036987305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.20227766036987305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 2599, 128]), torch.Size([1, 2599, 128])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.2047562599182129  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3880910873413086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 2599, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3680758476257324  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3748965263366699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3817172050476074  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.37484312057495117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([7152, 256])
first layer input nodes number: 15981
first layer output nodes number: 7152
edges number: 46235
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.381838321685791  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3886590003967285  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3903641700744629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3903641700744629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.41312360763549805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.41312360763549805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4139418601989746  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4204878807067871  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([346, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4207439422607422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4207439422607422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4214038848876953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4319801330566406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.43248653411865234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.43248653411865234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.43303966522216797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4457082748413086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4463663101196289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4463663101196289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.44682979583740234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.46027088165283203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([214, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.46106767654418945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.46106767654418945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.46147584915161133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.47617006301879883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4768829345703125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4768829345703125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4771862030029297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.49022674560546875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4909968376159668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4909968376159668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.4912581443786621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5043234825134277  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5051541328430176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5051541328430176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5053925514221191  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5189824104309082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5196681022644043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5196681022644043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5198454856872559  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5311980247497559  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.532984733581543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.532984733581543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5331811904907227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5471296310424805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([93, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5480146408081055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5480146408081055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.548192024230957  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5620279312133789  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5627350807189941  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5627350807189941  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5628666877746582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5740532875061035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5746250152587891  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5746250152587891  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5747222900390625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5836715698242188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5842556953430176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5842556953430176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5843453407287598  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5932202339172363  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5938534736633301  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5938534736633301  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5939431190490723  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6034455299377441  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6041083335876465  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6041083335876465  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6041960716247559  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6141104698181152  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6145567893981934  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6145567893981934  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6146140098571777  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6214804649353027  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6219882965087891  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6219882965087891  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6220474243164062  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6295566558837891  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6301484107971191  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6301484107971191  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6302132606506348  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6389031410217285  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6394476890563965  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6394476890563965  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6395049095153809  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6475729942321777  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6479077339172363  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6479077339172363  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.647942066192627  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6530232429504395  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6533446311950684  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6533446311950684  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6533751487731934  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6581053733825684  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6584439277648926  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6584439277648926  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6584744453430176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6634182929992676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6637721061706543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6637721061706543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6638026237487793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6689600944519043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([233, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6745438575744629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6745438575744629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6749882698059082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.7532048225402832  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 233, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.7336440086364746  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.7340788841247559  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.7345137596130371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.7340569496154785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2916, 40])
input nodes number: 7152
output nodes number: 2916
edges number: 23047
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.7341361045837402  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.7341365814208984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.015208721160888672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 6 input nodes size: 9130
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.013688087463378906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.013688087463378906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.018041610717773438  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01806354522705078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.010364055633544922  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.010678768157958984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.010678768157958984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.010678768157958984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([9130, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.010678768157958984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([678, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.023661136627197266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.023661136627197266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.024307727813720703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.03024911880493164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([762, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.030652523040771484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.030652523040771484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.03137922286987305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.04353761672973633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([639, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.04408836364746094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.04408836364746094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.04469776153564453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.058104515075683594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([545, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.05883932113647461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.05883932113647461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.059359073638916016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.07467794418334961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([471, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.07554101943969727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.07554101943969727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.07599020004272461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.09216070175170898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([363, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.09297466278076172  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.09297466278076172  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.09332084655761719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.10820674896240234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([288, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.10899496078491211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.10899496078491211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.10926961898803711  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.12300252914428711  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([238, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.12377309799194336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.12377309799194336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.12400007247924805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.13693761825561523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([200, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.13768243789672852  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.13768243789672852  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 200, 128]), torch.Size([1, 200, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.13787317276000977  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.15008020401000977  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 200, 128])
m.shape torch.Size([918, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.15436220169067383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.15436220169067383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.15523767471313477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.21872901916503906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 918, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.20835304260253906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.21358203887939453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.21844768524169922  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2131805419921875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([5102, 256])
first layer input nodes number: 9130
first layer output nodes number: 5102
edges number: 25732
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2181544303894043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.22338342666625977  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.22423648834228516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.22423648834228516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([485, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.24055004119873047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.24055004119873047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.24147510528564453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2498016357421875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([453, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2502102851867676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2502102851867676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.25107431411743164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.26407957077026367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([355, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.26487207412719727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.26487207412719727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2655491828918457  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.28044748306274414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([280, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2811856269836426  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2811856269836426  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2817196846008301  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2972073554992676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([267, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.29822349548339844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.29822349548339844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2987327575683594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.31771183013916016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([194, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3185763359069824  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3185763359069824  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.31894636154174805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3348574638366699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([153, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.33570194244384766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.33570194244384766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.33599376678466797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3505849838256836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.35138511657714844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.35138511657714844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3516197204589844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3649921417236328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.36573123931884766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.36573123931884766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3659200668334961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3780050277709961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.37862205505371094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.37862205505371094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.37876319885253906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.38878440856933594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.38948583602905273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.38948583602905273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.38962507247924805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4004855155944824  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.40106201171875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.40106201171875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4011688232421875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.410247802734375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4107818603515625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4107818603515625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4108715057373047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.41911888122558594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.41962575912475586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.41962575912475586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.41970396041870117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4274458885192871  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4278397560119629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4278397560119629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.42789697647094727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.433962345123291  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.43439531326293945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.43439531326293945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.43445253372192383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4409184455871582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44123315811157227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44123315811157227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44127321243286133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44607973098754883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44623279571533203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44623279571533203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44625186920166016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44867420196533203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44881105422973633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44881105422973633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44882631301879883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45087099075317383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4510364532470703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4510364532470703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4510536193847656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4534740447998047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4536876678466797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4536876678466797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4537086486816406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4568138122558594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45699405670166016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45699405670166016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45701122283935547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4596719741821289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4598402976989746  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4598402976989746  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4598555564880371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4623274803161621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4624814987182617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4624814987182617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4624948501586914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4647512435913086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([54, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.46604251861572266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.46604251861572266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.46614551544189453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.48427295684814453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 54, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4713139533996582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.47174596786499023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.47217798233032227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4717240333557129  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2897, 40])
input nodes number: 5102
output nodes number: 2897
edges number: 16351
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.47178125381469727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.47178173065185547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01132822036743164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 7 input nodes size: 9911
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.010361194610595703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.010361194610595703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.015087127685546875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.015109062194824219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.010733604431152344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.011060714721679688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.011060714721679688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.011060714721679688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([9911, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.011060714721679688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([744, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.024559974670410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.024559974670410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.025269508361816406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.030991554260253906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([780, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.031380653381347656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.031380653381347656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.03212451934814453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.043836116790771484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([652, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.04439687728881836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.04439687728881836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.045018672943115234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.058698177337646484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([540, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.0594172477722168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.0594172477722168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.05993223190307617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.0749659538269043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([437, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.07575035095214844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.07575035095214844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.07616710662841797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.0911703109741211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([326, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.09189462661743164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.09189462661743164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.09220552444458008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.10557413101196289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([281, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.10635662078857422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.10635662078857422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.10662460327148438  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.12002372741699219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 281, 128])
m.shape torch.Size([228, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.12075948715209961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.12075948715209961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.12097692489624023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.13337087631225586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([202, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.13412904739379883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.13412904739379883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 202, 128]), torch.Size([1, 202, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.1343216896057129  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.1466507911682129  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 202, 128])
m.shape torch.Size([1055, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.15158510208129883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.15158510208129883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.15259122848510742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.22428607940673828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2143688201904297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.21937084197998047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.22437286376953125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2193317413330078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([5245, 256])
first layer input nodes number: 9911
first layer output nodes number: 5245
edges number: 26720
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.22444868087768555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.22945070266723633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.23087167739868164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.23087167739868164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([506, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2478933334350586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2478933334350586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.24885845184326172  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.25795698165893555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([460, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2583589553833008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2583589553833008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.25923633575439453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2723970413208008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([355, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.272982120513916  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.272982120513916  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.27365922927856445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2887606620788574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([295, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.28975391387939453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.28975391387939453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.2903165817260742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.30754947662353516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([232, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3083834648132324  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3083834648132324  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3088259696960449  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3247561454772949  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3254866600036621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3254866600036621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.32580137252807617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.33933401107788086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([145, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3401522636413574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3401522636413574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.34042882919311523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.35425710678100586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3549342155456543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3549342155456543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3551363945007324  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.36666059494018555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.36744213104248047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.36744213104248047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.36763668060302734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.38008785247802734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3806633949279785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3806633949279785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3807969093322754  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3902764320373535  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3907594680786133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3907594680786133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.39085865020751953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.39859485626220703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.39914512634277344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.39914512634277344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.3992443084716797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.40767478942871094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4081878662109375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4081878662109375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.40827369689941406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4161701202392578  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.41678667068481445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.41678667068481445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.41688013076782227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4261326789855957  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4265909194946289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4265909194946289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.42665767669677734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4337339401245117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4341006278991699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4341006278991699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.43415021896362305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.43975400924682617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44007253646850586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44007253646850586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4401125907897949  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4449191093444824  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44538354873657227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.44538354873657227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.445436954498291  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45221948623657227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45253992080688477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45253992080688477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4525761604309082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45743227005004883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45760679244995117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.45760679244995117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4576258659362793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4603152275085449  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4605684280395508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4605684280395508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.46059322357177734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4642629623413086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4645047187805176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4645047187805176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.46452760696411133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4680752754211426  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.46824073791503906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.46824073791503906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.46825599670410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.47072792053222656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4709281921386719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4709281921386719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4709453582763672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.473846435546875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([80, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.47576045989990234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.47576045989990234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.47591304779052734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.5027685165405273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 80, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4894580841064453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.48988962173461914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.49032115936279297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4898676872253418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2895, 40])
input nodes number: 5245
output nodes number: 2895
edges number: 17069
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4899282455444336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.4899287223815918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.011739253997802734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 8 input nodes size: 23100
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01073312759399414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01073312759399414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.021748065948486328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.021769046783447266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01702117919921875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01762866973876953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01762866973876953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01762866973876953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([23100, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1307373046875 GB
    Memory Allocated: 0.01762866973876953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([725, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.04861164093017578  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.04861164093017578  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 725, 128]), torch.Size([1, 725, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.04930305480957031  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.05487775802612305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 725, 128])
m.shape torch.Size([751, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.055248260498046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.055248260498046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.05596446990966797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.06711959838867188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([734, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.06781148910522461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.06781148910522461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0685114860534668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.08432435989379883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([616, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.08514928817749023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.08514928817749023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.08573675155639648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.10277318954467773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([622, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.10396242141723633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.10396242141723633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.10455560684204102  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.12618589401245117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([512, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.12735414505004883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.12735414505004883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.12784242630004883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.14883852005004883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([404, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.14994287490844727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.14994287490844727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1503281593322754  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.16959238052368164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([418, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.17099428176879883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.17099428176879883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.17139291763305664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.19411516189575195  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([362, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.19546937942504883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.19546937942504883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1958146095275879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.2179093360900879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([4004, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.23726797103881836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.23726797103881836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 4004, 128]), torch.Size([1, 4004, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.24108648300170898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.517026424407959  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 4004, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4890403747558594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.49776458740234375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5064888000488281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4976963996887207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([9148, 256])
first layer input nodes number: 23100
first layer output nodes number: 9148
edges number: 62545
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5066628456115723  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5153870582580566  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5184035301208496  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5184035301208496  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([481, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5371303558349609  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5371303558349609  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5380477905273438  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5459747314453125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([389, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5462641716003418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5462641716003418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5470061302185059  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5592169761657715  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5597457885742188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5597457885742188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5603408813476562  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.57366943359375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5743064880371094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5743064880371094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5747699737548828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5882110595703125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.589012622833252  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.589012622833252  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5894227027893066  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6041855812072754  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.604863166809082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.604863166809082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6051549911499023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6177034378051758  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6183381080627441  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6183381080627441  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6185593605041504  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6296219825744629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6302881240844727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6302881240844727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6304807662963867  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6414613723754883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6422910690307617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6422910690307617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6424951553344727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6555566787719727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6561470031738281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6561470031738281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6562843322753906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6660346984863281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6665902137756348  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6665902137756348  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6667027473449707  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6754803657531738  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6761050224304199  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6761050224304199  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6762175559997559  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6857829093933105  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6862139701843262  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6862139701843262  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6862883567810059  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6931319236755371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6935253143310547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6935253143310547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6935863494873047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6996288299560547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.700218677520752  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.700218677520752  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7003006935119629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7089943885803223  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7094149589538574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7094149589538574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7094721794128418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7159380912780762  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.716334342956543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.716334342956543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7163839340209961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7223348617553711  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7226910591125488  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7226910591125488  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7227330207824707  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7280621528625488  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7284250259399414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7284250259399414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7284650802612305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7338323593139648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.734062671661377  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.734062671661377  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7340874671936035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7375836372375488  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7380356788635254  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7380356788635254  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7380795478820801  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7445721626281738  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7447195053100586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7447195053100586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7447347640991211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7470998764038086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7473134994506836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7473134994506836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7473325729370117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.750422477722168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7506899833679199  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7506899833679199  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7507128715515137  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7545809745788574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([172, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7587027549743652  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7587027549743652  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.759030818939209  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.816770076751709  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 172, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8011655807495117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8015766143798828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8019876480102539  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8015556335449219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2758, 40])
input nodes number: 9148
output nodes number: 2758
edges number: 18874
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8016242980957031  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8016247749328613  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.01876544952392578  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 9 input nodes size: 14862
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.017000675201416016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.017000675201416016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.02408742904663086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.02410888671875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013072967529296875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013659477233886719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013659477233886719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013659477233886719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([14862, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013659477233886719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([451, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.03994321823120117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.03994321823120117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.04037332534790039  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.04381418228149414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([507, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0440826416015625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0440826416015625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.04456615447998047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.05181884765625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([510, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0523066520690918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0523066520690918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.052793025970458984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.06349325180053711  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([459, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.06412553787231445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.06412553787231445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.06456327438354492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.07725763320922852  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([449, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0781092643737793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0781092643737793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0785374641418457  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.09395265579223633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([385, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.09484004974365234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.09484004974365234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.09520721435546875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.11099529266357422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([370, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.11204671859741211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.11204671859741211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.11239957809448242  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.13004255294799805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([353, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.13121271133422852  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.13121271133422852  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 353, 128]), torch.Size([1, 353, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.13154935836791992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.15073823928833008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 353, 128])
m.shape torch.Size([289, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1518101692199707  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1518101692199707  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1520857810974121  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1697249412536621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([3579, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.18665313720703125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.18665313720703125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 3579, 128]), torch.Size([1, 3579, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.19166278839111328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4395761489868164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 3579, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4150819778442383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.42209339141845703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4291048049926758  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.42203855514526367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([7352, 256])
first layer input nodes number: 14862
first layer output nodes number: 7352
edges number: 53191
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4292178153991699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.43622922897338867  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4386019706726074  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4386019706726074  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([348, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4634432792663574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4634432792663574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.46410703659057617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.46941709518432617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([317, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4696946144104004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4696946144104004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.47029924392700195  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4803476333618164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4808354377746582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4808354377746582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.48135805130004883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.493131160736084  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([216, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4937005043029785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4937005043029785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.494112491607666  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5060601234436035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([178, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5067095756530762  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5067095756530762  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5070490837097168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5192713737487793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5199494361877441  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5199494361877441  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5202298164367676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5322861671447754  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5331487655639648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5331487655639648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5334329605102539  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.547642707824707  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([134, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5492568016052246  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5492568016052246  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5495123863220215  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5640807151794434  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5647664070129395  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5647664070129395  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5649456977844238  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5764203071594238  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5771961212158203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5771961212158203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5773677825927734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5895557403564453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([95, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5904746055603027  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5904746055603027  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5906558036804199  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6047892570495605  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6055293083190918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6055293083190918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6056666374206543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6173396110534668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6181206703186035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6181206703186035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6182503700256348  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6301827430725098  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([77, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6311540603637695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6311540603637695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6313009262084961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6458406448364258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6466178894042969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6466178894042969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6467304229736328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6586589813232422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6593255996704102  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6593255996704102  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6594152450561523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6695451736450195  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6702194213867188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6702194213867188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6703033447265625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6803741455078125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6809377670288086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6809377670288086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.681004524230957  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6894826889038086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6899242401123047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6899242401123047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6899738311767578  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6966190338134766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6972866058349609  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6972866058349609  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6973552703857422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7070369720458984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7075681686401367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7075681686401367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7076215744018555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7155256271362305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7158584594726562  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7158584594726562  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7158908843994141  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.720916748046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7214531898498535  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7214531898498535  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7215008735656738  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7292256355285645  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7297787666320801  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7297787666320801  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7298264503479004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7378849983215332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([273, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7449235916137695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7449235916137695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7454442977905273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8411445617675781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 273, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8193621635437012  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8197908401489258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8202195167541504  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8197693824768066  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2874, 40])
input nodes number: 7352
output nodes number: 2874
edges number: 25363
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8198633193969727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8198637962341309  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.014761924743652344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 10 input nodes size: 14471
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.01309061050415039  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.01309061050415039  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.019990921020507812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.020012855529785156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.012904644012451172  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013412952423095703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013412952423095703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013412952423095703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([14471, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.013412952423095703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([609, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.03557157516479492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.03557157516479492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.03615236282348633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0412750244140625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([552, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.04151105880737305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.04151105880737305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0420374870300293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.05059480667114258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([535, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.05109691619873047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.05109691619873047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.05160713195800781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.06283187866210938  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([480, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0634922981262207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0634922981262207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0639500617980957  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.0772252082824707  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([438, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.07804059982299805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.07804059982299805  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 438, 128]), torch.Size([1, 438, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.07845830917358398  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.09349584579467773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 438, 128])
m.shape torch.Size([358, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.09431123733520508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.09431123733520508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.09465265274047852  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.10933351516723633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([335, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.11028099060058594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.11028099060058594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.11060047149658203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.12657451629638672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([327, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1286163330078125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1286163330078125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.12892818450927734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.14670372009277344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([242, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.14758634567260742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.14758634567260742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.14781713485717773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.16258764266967773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([2791, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1757807731628418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1757807731628418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 2791, 128]), torch.Size([1, 2791, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.17844247817993164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.3764166831970215  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 2791, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.3559556007385254  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.36231374740600586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.36867189407348633  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.36226367950439453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([6667, 256])
first layer input nodes number: 14471
first layer output nodes number: 6667
edges number: 44625
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.36878204345703125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.3755970001220703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.37685298919677734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.37685298919677734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([459, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.40003108978271484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.40003108978271484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4009065628051758  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.40856170654296875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([327, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4087529182434082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4087529182434082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4093766212463379  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4194908142089844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.42002105712890625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.42002105712890625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4205780029296875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4329085350036621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.43350696563720703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.43350696563720703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4339418411254883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.44655323028564453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4472827911376953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4472827911376953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4476585388183594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4611854553222656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4619145393371582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4619145393371582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4622178077697754  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.47525835037231445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4759950637817383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4759950637817383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.47624683380126953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.48883533477783203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4896402359008789  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4896402359008789  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.4898710250854492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.503026008605957  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5036978721618652  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5036978721618652  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5038714408874512  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5149798393249512  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5158352851867676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5158352851867676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5160222053527832  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5292935371398926  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5301198959350586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5301198959350586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5302858352661133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5432291030883789  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5439190864562988  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5439190864562988  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5440468788146973  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5549092292785645  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5556325912475586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5556325912475586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5557527542114258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.566807746887207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5673937797546387  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5673937797546387  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5674853324890137  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5765490531921387  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5772242546081543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5772242546081543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5773196220397949  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5874285697937012  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5879654884338379  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5879654884338379  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5880379676818848  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5962281227111816  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5969929695129395  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5969929695129395  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.5970864295959473  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6083016395568848  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6088433265686035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6088433265686035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6089081764221191  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6171441078186035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6176414489746094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6176414489746094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6176967620849609  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6251087188720703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6256580352783203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6256580352783203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6257152557373047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6337833404541016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6343603134155273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6343603134155273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6344175338745117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6428861618041992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6432170867919922  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6432170867919922  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.64324951171875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6482753753662109  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6485466957092285  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6485466957092285  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6485714912414551  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6525883674621582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6529912948608398  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6529912948608398  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6530256271362305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6588277816772461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([242, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6646256446838379  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6646256446838379  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6650872230529785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7463250160217285  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 242, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7263717651367188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7268071174621582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7272424697875977  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7267851829528809  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2919, 40])
input nodes number: 6667
output nodes number: 2919
edges number: 23522
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7268638610839844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7268643379211426  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.01439523696899414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 11 input nodes size: 15797
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012911319732666016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012911319732666016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.02044391632080078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.020465850830078125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.01354360580444336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.014050960540771484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.014050960540771484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.014050960540771484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([15797, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.014050960540771484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([677, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.037232398986816406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.037232398986816406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03787803649902344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.04304313659667969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([708, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.0433955192565918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.0433955192565918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.04407072067260742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.054366111755371094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 708, 128])
m.shape torch.Size([650, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.054958343505859375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.054958343505859375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.05557823181152344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.06963157653808594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([552, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.0705265998840332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.0705265998840332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.07105302810668945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.0863194465637207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([510, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08727216720581055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08727216720581055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08775854110717773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10526800155639648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([446, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10630083084106445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10630083084106445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10672616958618164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1250157356262207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([376, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12605810165405273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12605810165405273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12641668319702148  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.14434576034545898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([335, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.14544439315795898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.14544439315795898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.14576387405395508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.16397428512573242  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.16568660736083984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.16568660736083984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1659383773803711  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1820516586303711  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([2746, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.19501972198486328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.19501972198486328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 2746, 128]), torch.Size([1, 2746, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.19763851165771484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3835725784301758  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 2746, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.36335229873657227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.37027978897094727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.37720727920532227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3702254295349121  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([7264, 256])
first layer input nodes number: 15797
first layer output nodes number: 7264
edges number: 46625
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.37732696533203125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.38425445556640625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.38646697998046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.38646697998046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([459, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4075651168823242  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4075651168823242  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.40844058990478516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.415555477142334  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.41586780548095703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.41586780548095703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4166116714477539  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4285745620727539  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4291195869445801  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4291195869445801  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42972612380981445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.44365739822387695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.44430017471313477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.44430017471313477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.44476938247680664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.458376407623291  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4593496322631836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4593496322631836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.45975399017333984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.47431087493896484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.47531652450561523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.47531652450561523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4756503105163574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4900031089782715  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.490664005279541  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.490664005279541  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.49089860916137695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5026288032531738  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5033807754516602  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5033807754516602  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.503596305847168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5158815383911133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5165524482727051  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5165524482727051  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5167241096496582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5277104377746582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5284419059753418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5284419059753418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5286040306091309  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5401148796081543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5406789779663086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5406789779663086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5407953262329102  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.549870491027832  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5505390167236328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5505390167236328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5506591796875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5608730316162109  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5614628791809082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5614628791809082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5615620613098145  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5706868171691895  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5713505744934082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5713505744934082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5714516639709473  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5814595222473145  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5819282531738281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5819282531738281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5819969177246094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5892753601074219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5895795822143555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5895795822143555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5896215438842773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5943632125854492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5948162078857422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5948162078857422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5948715209960938  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6015090942382812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6018967628479004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6018967628479004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6019425392150879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6077561378479004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6080803871154785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6080803871154785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.608116626739502  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6129727363586426  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6136274337768555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6136274337768555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6136941909790039  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6231069564819336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6235380172729492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6235380172729492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6235818862915039  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6300745010375977  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6303277015686035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6303277015686035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6303524971008301  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6341958045959473  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6346035003662109  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6346035003662109  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6346397399902344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6405105590820312  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6406311988830566  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6406311988830566  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6406426429748535  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6425766944885254  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([223, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6479296684265137  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6479296684265137  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6483550071716309  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7232146263122559  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 223, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7053146362304688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7057452201843262  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7061758041381836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7057232856750488  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2889, 40])
input nodes number: 7264
output nodes number: 2889
edges number: 21360
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7057948112487793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7057952880859375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.015026569366455078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 12 input nodes size: 14041
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.013538837432861328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.013538837432861328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.020234107971191406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.020255088806152344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012700557708740234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.013199329376220703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.013199329376220703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.013199329376220703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([14041, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.013199329376220703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([481, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.033765316009521484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.033765316009521484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03422403335571289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03789377212524414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([549, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03818798065185547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03818798065185547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.0387115478515625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.04742240905761719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([492, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.047864437103271484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.047864437103271484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.04833364486694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.05865621566772461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([484, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.05934476852416992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.05934476852416992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.05980634689331055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.07319211959838867  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([390, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.07389116287231445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.07389116287231445  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.07426309585571289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08765268325805664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([369, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08852243423461914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08852243423461914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08887434005737305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10400629043579102  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([300, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10483169555664062  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10483169555664062  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1051177978515625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.11942291259765625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 300, 128])
m.shape torch.Size([272, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12031745910644531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12031745910644531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12057685852050781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1353626251220703  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 272, 128])
m.shape torch.Size([251, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.13631010055541992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.13631010055541992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 251, 128]), torch.Size([1, 251, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1365494728088379  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1518692970275879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 251, 128])
m.shape torch.Size([2581, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.16405677795410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.16405677795410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 2581, 128]), torch.Size([1, 2581, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.16655397415161133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.34217214584350586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 2581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.323972225189209  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.32985544204711914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3357386589050293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.32980918884277344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([6169, 256])
first layer input nodes number: 14041
first layer output nodes number: 6169
edges number: 41500
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3358454704284668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.34172868728637695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3435497283935547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3435497283935547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([352, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3682518005371094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3682518005371094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3689231872558594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.37531137466430664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([332, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3756141662597656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3756141662597656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3762474060058594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.38770532608032227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([269, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3881645202636719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3881645202636719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.38867759704589844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.40023136138916016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.40079402923583984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.40079402923583984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4012002944946289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4129819869995117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([163, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4135622978210449  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4135622978210449  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.41387319564819336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4250655174255371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4257349967956543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4257349967956543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4260077476501465  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.43773603439331055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4384474754333496  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4384474754333496  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.438687801361084  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.45070409774780273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4513683319091797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4513683319091797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.45156288146972656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.46265220642089844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4634547233581543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4634547233581543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4636530876159668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4763484001159668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.47705698013305664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.47705698013305664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4772171974182129  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.48859262466430664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4892420768737793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4892420768737793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.48937368392944336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.49963903427124023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5004615783691406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5004615783691406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5006084442138672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.513092041015625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.513643741607666  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.513643741607666  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5137391090393066  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5225129127502441  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5229902267456055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5229902267456055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5230646133422852  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5304288864135742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5309252738952637  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5309252738952637  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5309958457946777  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5384764671325684  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5389490127563477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5389490127563477  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5390119552612305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5461244583129883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5468940734863281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5468940734863281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5469875335693359  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5582027435302734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5588135719299316  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5588135719299316  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5588860511779785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5680909156799316  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5687851905822754  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5687851905822754  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5688614845275879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5790848731994629  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5794892311096191  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5794892311096191  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5795331001281738  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5857186317443848  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5863428115844727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5863428115844727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5864038467407227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5954370498657227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.595850944519043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.595850944519043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.595890998840332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6020994186401367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.602808952331543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.602808952331543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6028718948364258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6130685806274414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6134986877441406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6134986877441406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6135368347167969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6199836730957031  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([333, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6279664039611816  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6279664039611816  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6286015510559082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7431902885437012  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 333, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7214035987854004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7218184471130371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7222332954406738  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7217974662780762  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2782, 40])
input nodes number: 6169
output nodes number: 2782
edges number: 25219
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7218489646911621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.7218494415283203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.014146804809570312  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 13 input nodes size: 13479
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012684822082519531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012684822082519531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.019112110137939453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.019134044647216797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012417793273925781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012926101684570312  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012926101684570312  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012926101684570312  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([13479, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.012926101684570312  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([364, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03432655334472656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03432655334472656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03467369079589844  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03745079040527344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([457, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.037713050842285156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.037713050842285156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.03814888000488281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.044686317443847656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([445, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.04510498046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.04510498046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.04552936553955078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.05486583709716797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([451, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.055513858795166016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.055513858795166016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.055943965911865234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.06841707229614258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([439, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.06924867630004883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.06924867630004883  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.06966733932495117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08473920822143555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([441, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08625459671020508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08625459671020508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.08667516708374023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10475969314575195  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([369, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10578107833862305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10578107833862305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10613298416137695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12372827529907227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([339, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12484550476074219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.12484550476074219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1251688003540039  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.14359664916992188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([243, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.14447784423828125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.14447784423828125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.14470958709716797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.15954113006591797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([2660, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.17210912704467773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.17210912704467773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 2660, 128]), torch.Size([1, 2660, 128])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.1750502586364746  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3592557907104492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 2660, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3397364616394043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3461604118347168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3520808219909668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3456106185913086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([6208, 256])
first layer input nodes number: 13479
first layer output nodes number: 6208
edges number: 43340
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.35167980194091797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.35810375213623047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.35937023162841797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.35937023162841797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([270, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.38354921340942383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.38354921340942383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3840641975402832  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3899216651916504  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3902297019958496  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3902297019958496  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.3907904624938965  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4001479148864746  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([258, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.40061187744140625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.40061187744140625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4011039733886719  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4120368957519531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.41266775131225586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.41266775131225586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4131026268005371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42571401596069336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42656850814819336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42656850814819336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42699384689331055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4423060417175293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([221, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.44336795806884766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.44336795806884766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4437894821166992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4619150161743164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([180, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.46291542053222656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.46291542053222656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4632587432861328  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4804248809814453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([151, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4814143180847168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4814143180847168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4817023277282715  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.49811887741088867  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4989180564880371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4989180564880371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.49912595748901367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5124316215515137  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5135388374328613  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5135388374328613  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5137791633605957  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5308423042297363  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([114, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5319275856018066  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5319275856018066  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5321450233459473  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.549105167388916  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.549769401550293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.549769401550293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5498971939086914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5607595443725586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([76, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5616455078125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5616455078125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5617904663085938  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5751266479492188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5760231018066406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5760231018066406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5761604309082031  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5897560119628906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5902500152587891  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5902500152587891  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5903244018554688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5982093811035156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5988950729370117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5988950729370117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.5989847183227539  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6091146469116211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.609919548034668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.609919548034668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6100187301635742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6219205856323242  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6224594116210938  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6224594116210938  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6225242614746094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6307601928710938  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6311845779418945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6311845779418945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6312322616577148  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6376218795776367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6383285522460938  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6383285522460938  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6384010314941406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.64862060546875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.649169921875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.649169921875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6492252349853516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6574115753173828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6578702926635742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6578702926635742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6579141616821289  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6647138595581055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6650238037109375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6650238037109375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6650524139404297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6696872711181641  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6702265739440918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6702265739440918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6702723503112793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6780085563659668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([196, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6826953887939453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6826953887939453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.6830692291259766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7488651275634766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 196, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7277750968933105  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7282090187072754  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7286429405212402  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.728187084197998  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2911, 40])
input nodes number: 6208
output nodes number: 2911
edges number: 24752
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7282743453979492  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7282748222351074  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.013911247253417969  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 14 input nodes size: 14303
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012436866760253906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012436866760253906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.019257068634033203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.019278526306152344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012829303741455078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.013335704803466797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.013335704803466797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.013335704803466797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([14303, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.013335704803466797  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([474, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0350642204284668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0350642204284668  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03551626205444336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03913259506225586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([525, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03940725326538086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03940725326538086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03990793228149414  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.048302650451660156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([538, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.04882192611694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.04882192611694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.04933500289916992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.060942649841308594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([500, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.06163978576660156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.06163978576660156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.06211662292480469  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.07594490051269531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([420, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.07670783996582031  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.07670783996582031  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.07710838317871094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.09152793884277344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([390, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.09244346618652344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.09244346618652344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.09281539916992188  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.10880851745605469  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([356, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.10981082916259766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.10981082916259766  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.11015033721923828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.12712574005126953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([333, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.12822628021240234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.12822628021240234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.12854385375976562  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.14664554595947266  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 333, 128])
m.shape torch.Size([311, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.14782142639160156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.14782142639160156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 311, 128]), torch.Size([1, 311, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.1481180191040039  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.1670999526977539  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 311, 128])
m.shape torch.Size([2635, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.17951631546020508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.17951631546020508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 2635, 128]), torch.Size([1, 2635, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.18202924728393555  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.36605167388916016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 2635, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.346832275390625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.35322093963623047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3594026565551758  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3529653549194336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([6482, 256])
first layer input nodes number: 14303
first layer output nodes number: 6482
edges number: 43883
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.35930442810058594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3656930923461914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3670315742492676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3670315742492676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([348, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3911094665527344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3911094665527344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3917732238769531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.397371768951416  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([306, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3976283073425293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3976283073425293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3982119560241699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.40791845321655273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.408416748046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.408416748046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4089393615722656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4212331771850586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4218330383300781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4218330383300781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4222602844238281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4346504211425781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4353165626525879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4353165626525879  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4356656074523926  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.44823122024536133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.44902563095092773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.44902563095092773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.44934606552124023  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.46312475204467773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.463900089263916  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.463900089263916  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.46416521072387695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.47742128372192383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4782886505126953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4782886505126953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.47853660583496094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.49267005920410156  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([123, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4936103820800781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4936103820800781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.49384498596191406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5088596343994141  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([100, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5097036361694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5097036361694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5098943710327148  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5234365463256836  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([115, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5245571136474609  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5245571136474609  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5247764587402344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5418853759765625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.542686939239502  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.542686939239502  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5428376197814941  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5556454658508301  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.556495189666748  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.556495189666748  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5566363334655762  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5696215629577637  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5703315734863281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5703315734863281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5704421997070312  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5813941955566406  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5821175575256348  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5821175575256348  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5822205543518066  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5931382179260254  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5938558578491211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5938558578491211  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5939512252807617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6047277450561523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6053013801574707  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6053013801574707  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6053738594055176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6140713691711426  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6146926879882812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6146926879882812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6147651672363281  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6239700317382812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6243906021118164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6243906021118164  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6244382858276367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6308279037475586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.631554126739502  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.631554126739502  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6316285133361816  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6421170234680176  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6425642967224121  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6425642967224121  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6426100730895996  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6493849754333496  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6499333381652832  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6499333381652832  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6499848365783691  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6579670906066895  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.658383846282959  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.658383846282959  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6584219932556152  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6646018028259277  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6649980545043945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6649980545043945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6650323867797852  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6708345413208008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([204, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6757192611694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6757192611694336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.6761083602905273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7445898056030273  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 204, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7236108779907227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7240371704101562  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7244634628295898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7240157127380371  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2858, 40])
input nodes number: 6482
output nodes number: 2858
edges number: 23993
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7240781784057617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.7240786552429199  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.01429891586303711  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 15 input nodes size: 11887
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012821674346923828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012821674346923828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.01924896240234375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.019270896911621094  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012429237365722656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012789726257324219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012789726257324219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012789726257324219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([11887, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012789726257324219  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([651, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.02813434600830078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.02813434600830078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.02875518798828125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.033721923828125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([687, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03406667709350586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03406667709350586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03472185134887695  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.044780731201171875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([658, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0453944206237793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0453944206237793  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.04602193832397461  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.059827327728271484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([516, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.060545921325683594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.060545921325683594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.06103801727294922  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0760030746459961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([385, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0766749382019043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0766749382019043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 385, 128]), torch.Size([1, 385, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0770421028137207  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.09026002883911133  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 385, 128])
m.shape torch.Size([354, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.09108924865722656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.09108924865722656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 354, 128]), torch.Size([1, 354, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.09142684936523438  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.10594367980957031  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 354, 128])
m.shape torch.Size([305, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.10679292678833008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.10679292678833008  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.10708379745483398  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.1216273307800293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([228, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.12235164642333984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.12235164642333984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 228, 128]), torch.Size([1, 228, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.12256908416748047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.1349630355834961  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 228, 128])
m.shape torch.Size([218, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.1357898712158203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.1357898712158203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 218, 128]), torch.Size([1, 218, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.13599777221679688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.14930343627929688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 218, 128])
m.shape torch.Size([1457, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.15614700317382812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.15614700317382812  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 1457, 128]), torch.Size([1, 1457, 128])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.15753650665283203  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.2573885917663574  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 1457, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.24459409713745117  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.2498002052307129  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.2550063133239746  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.24975919723510742  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([5459, 256])
first layer input nodes number: 11887
first layer output nodes number: 5459
edges number: 30603
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.2550969123840332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.2603030204772949  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.26160478591918945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.26160478591918945  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([462, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.2791152000427246  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.2791152000427246  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.279996395111084  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.288665771484375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([441, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.28907299041748047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.28907299041748047  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.2899141311645508  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.30306291580200195  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([395, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.303952693939209  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.303952693939209  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3047060966491699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3218693733215332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([312, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3226923942565918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3226923942565918  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3232874870300293  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3405451774597168  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.34123802185058594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.34123802185058594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3416309356689453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3557758331298828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.35653114318847656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.35653114318847656  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3568458557128906  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3703784942626953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3711361885070801  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3711361885070801  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3713955879211426  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3843655586242676  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.38506650924682617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.38506650924682617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3852725028991699  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.39701414108276367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3978886604309082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.3978886604309082  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.398104190826416  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.411898136138916  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4124441146850586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4124441146850586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.41257381439208984  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4217824935913086  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4223628044128418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4223628044128418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.42247915267944336  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.43155431747436523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.43221139907836914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.43221139907836914  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4323296546936035  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4423813819885254  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4429597854614258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4429597854614258  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4430570602416992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.45200634002685547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.452455997467041  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.452455997467041  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4525265693664551  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.45951318740844727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4598383903503418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4598383903503418  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4598860740661621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.46494054794311523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4655475616455078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4655475616455078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4656257629394531  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.47446250915527344  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4748973846435547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4748973846435547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.47495269775390625  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.48159027099609375  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4820127487182617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4820127487182617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.48206233978271484  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4883604049682617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.48881053924560547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.48881053924560547  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4888601303100586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.49550533294677734  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4958076477050781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.4958076477050781  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.49584007263183594  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5004119873046875  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5007796287536621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5007796287536621  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5008158683776855  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5061793327331543  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5064153671264648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5064153671264648  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5064382553100586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5099859237670898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5101513862609863  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5101513862609863  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5101666450500488  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5126385688781738  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5128154754638672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5128154754638672  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5128307342529297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5154094696044922  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([74, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5171799659729004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5171799659729004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5173211097717285  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5421624183654785  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 74, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.527979850769043  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5284123420715332  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5288448333740234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5283904075622559  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([2902, 40])
input nodes number: 5459
output nodes number: 2902
edges number: 17621
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5284595489501953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.5284600257873535  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.013532638549804688  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

pseudo mini batch 16 input nodes size: 50203
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012435436248779297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.012435436248779297  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03637409210205078  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.03639507293701172  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.029945850372314453  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0312504768371582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0312504768371582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0312504768371582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

torch.Size([50203, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.0312504768371582  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

m.shape torch.Size([642, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.10362720489501953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.10362720489501953  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.10423946380615234  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.10936498641967773  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([713, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.10973882675170898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.10973882675170898  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 713, 128]), torch.Size([1, 713, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.11041879653930664  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.12061834335327148  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 713, 128])
m.shape torch.Size([672, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.12123966217041016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.12123966217041016  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.12188053131103516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.13597965240478516  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([637, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.13687419891357422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.13687419891357422  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.137481689453125  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.15574359893798828  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([618, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.15691328048706055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.15691328048706055  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.1575026512145996  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.17884302139282227  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([610, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.18029356002807617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.18029356002807617  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.18087530136108398  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.20612478256225586  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([582, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.20777654647827148  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.20777654647827148  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.20833158493041992  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.2365403175354004  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([570, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.23914289474487305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.23914289474487305  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.2396864891052246  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.27067136764526367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([574, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.27286291122436523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.27286291122436523  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.2734103202819824  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 0.31006288528442383  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([11969, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.36686182022094727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.36686182022094727  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

 h.shape torch.Size([1, 11969, 128]), torch.Size([1, 11969, 128])
----------------------------------------3
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.37827634811401367  GigaBytes
Max Memory Allocated: 0.8523483276367188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2053556442260742  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

rst.shape  torch.Size([1, 11969, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.1373867988586426  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.1541590690612793  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.170931339263916  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.1540279388427734  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

torch.Size([17587, 256])
first layer input nodes number: 50203
first layer output nodes number: 17587
edges number: 146872
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.1713075637817383  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.188079833984375  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.1922731399536133  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.1922731399536133  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

m.shape torch.Size([368, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2197265625  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2197265625  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.220428466796875  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.226161003112793  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([313, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2264118194580078  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2264118194580078  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2270088195800781  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2360281944274902  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([231, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2363958358764648  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2363958358764648  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2368364334106445  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2465295791625977  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([177, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2469902038574219  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2469902038574219  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2473278045654297  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2571182250976562  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([171, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2577714920043945  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2577714920043945  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2580976486206055  GigaBytes
Max Memory Allocated: 1.2624282836914062  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2698392868041992  GigaBytes
Max Memory Allocated: 1.2706546783447266  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2703971862792969  GigaBytes
Max Memory Allocated: 1.2706546783447266  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2703971862792969  GigaBytes
Max Memory Allocated: 1.2706546783447266  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2706356048583984  GigaBytes
Max Memory Allocated: 1.2706546783447266  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2808876037597656  GigaBytes
Max Memory Allocated: 1.2816028594970703  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2814884185791016  GigaBytes
Max Memory Allocated: 1.2816028594970703  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2814884185791016  GigaBytes
Max Memory Allocated: 1.2816028594970703  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2816925048828125  GigaBytes
Max Memory Allocated: 1.2816925048828125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2918968200683594  GigaBytes
Max Memory Allocated: 1.2926111221313477  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.292463779449463  GigaBytes
Max Memory Allocated: 1.2926111221313477  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.292463779449463  GigaBytes
Max Memory Allocated: 1.2926111221313477  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.2926297187805176  GigaBytes
Max Memory Allocated: 1.2926297187805176  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3020882606506348  GigaBytes
Max Memory Allocated: 1.3027520179748535  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3026456832885742  GigaBytes
Max Memory Allocated: 1.3027520179748535  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3026456832885742  GigaBytes
Max Memory Allocated: 1.3027520179748535  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3027868270874023  GigaBytes
Max Memory Allocated: 1.3027868270874023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3118200302124023  GigaBytes
Max Memory Allocated: 1.312455177307129  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3124608993530273  GigaBytes
Max Memory Allocated: 1.3124637603759766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3124608993530273  GigaBytes
Max Memory Allocated: 1.3124637603759766  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3126020431518555  GigaBytes
Max Memory Allocated: 1.3126020431518555  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3226232528686523  GigaBytes
Max Memory Allocated: 1.323328971862793  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.323218822479248  GigaBytes
Max Memory Allocated: 1.323328971862793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.323218822479248  GigaBytes
Max Memory Allocated: 1.323328971862793  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3233389854431152  GigaBytes
Max Memory Allocated: 1.3233389854431152  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3327116966247559  GigaBytes
Max Memory Allocated: 1.3333725929260254  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3332748413085938  GigaBytes
Max Memory Allocated: 1.3333725929260254  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3332748413085938  GigaBytes
Max Memory Allocated: 1.3333725929260254  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3333778381347656  GigaBytes
Max Memory Allocated: 1.3333778381347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.342132568359375  GigaBytes
Max Memory Allocated: 1.3427505493164062  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3427062034606934  GigaBytes
Max Memory Allocated: 1.3427505493164062  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3427062034606934  GigaBytes
Max Memory Allocated: 1.3427505493164062  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.342801570892334  GigaBytes
Max Memory Allocated: 1.342801570892334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3515753746032715  GigaBytes
Max Memory Allocated: 1.3521952629089355  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.352147102355957  GigaBytes
Max Memory Allocated: 1.3521952629089355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.352147102355957  GigaBytes
Max Memory Allocated: 1.3521952629089355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3522348403930664  GigaBytes
Max Memory Allocated: 1.3522348403930664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3609209060668945  GigaBytes
Max Memory Allocated: 1.3615350723266602  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3615260124206543  GigaBytes
Max Memory Allocated: 1.3615350723266602  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3615260124206543  GigaBytes
Max Memory Allocated: 1.3615350723266602  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3616118431091309  GigaBytes
Max Memory Allocated: 1.3616118431091309  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3707098960876465  GigaBytes
Max Memory Allocated: 1.3713536262512207  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3712821006774902  GigaBytes
Max Memory Allocated: 1.3713536262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3712821006774902  GigaBytes
Max Memory Allocated: 1.3713536262512207  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3713583946228027  GigaBytes
Max Memory Allocated: 1.3713583946228027  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3799796104431152  GigaBytes
Max Memory Allocated: 1.3805899620056152  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3804316520690918  GigaBytes
Max Memory Allocated: 1.3805899620056152  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3804316520690918  GigaBytes
Max Memory Allocated: 1.3805899620056152  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3804888725280762  GigaBytes
Max Memory Allocated: 1.3805899620056152  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3873553276062012  GigaBytes
Max Memory Allocated: 1.3878417015075684  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3879499435424805  GigaBytes
Max Memory Allocated: 1.3879528045654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3879499435424805  GigaBytes
Max Memory Allocated: 1.3879528045654297  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3880186080932617  GigaBytes
Max Memory Allocated: 1.3880186080932617  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3967390060424805  GigaBytes
Max Memory Allocated: 1.3973569869995117  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3974170684814453  GigaBytes
Max Memory Allocated: 1.3974199295043945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.3974170684814453  GigaBytes
Max Memory Allocated: 1.3974199295043945  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.397491455078125  GigaBytes
Max Memory Allocated: 1.397491455078125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4074592590332031  GigaBytes
Max Memory Allocated: 1.4081659317016602  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.407883644104004  GigaBytes
Max Memory Allocated: 1.4081659317016602  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.407883644104004  GigaBytes
Max Memory Allocated: 1.4081659317016602  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4079294204711914  GigaBytes
Max Memory Allocated: 1.4081659317016602  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.414383888244629  GigaBytes
Max Memory Allocated: 1.414841651916504  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4152493476867676  GigaBytes
Max Memory Allocated: 1.4152531623840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4152493476867676  GigaBytes
Max Memory Allocated: 1.4152531623840332  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4153332710266113  GigaBytes
Max Memory Allocated: 1.4153332710266113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4277539253234863  GigaBytes
Max Memory Allocated: 1.4286351203918457  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4278812408447266  GigaBytes
Max Memory Allocated: 1.4286351203918457  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4278812408447266  GigaBytes
Max Memory Allocated: 1.4286351203918457  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.427896499633789  GigaBytes
Max Memory Allocated: 1.4286351203918457  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4302616119384766  GigaBytes
Max Memory Allocated: 1.430429458618164  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4306964874267578  GigaBytes
Max Memory Allocated: 1.4306983947753906  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4306964874267578  GigaBytes
Max Memory Allocated: 1.4306983947753906  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.430734634399414  GigaBytes
Max Memory Allocated: 1.430734634399414  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4369144439697266  GigaBytes
Max Memory Allocated: 1.4373531341552734  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4373798370361328  GigaBytes
Max Memory Allocated: 1.4373817443847656  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4373798370361328  GigaBytes
Max Memory Allocated: 1.4373817443847656  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4374198913574219  GigaBytes
Max Memory Allocated: 1.4374198913574219  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4441890716552734  GigaBytes
Max Memory Allocated: 1.4446697235107422  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([513, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.456495761871338  GigaBytes
Max Memory Allocated: 1.4565439224243164  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.456495761871338  GigaBytes
Max Memory Allocated: 1.4565439224243164  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 2.9608154296875 GB
    Memory Allocated: 1.4574742317199707  GigaBytes
Max Memory Allocated: 1.4574742317199707  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.6333966255187988  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 513, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.6087021827697754  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.6091136932373047  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.609525203704834  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.6090927124023438  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

torch.Size([2760, 40])
input nodes number: 17587
output nodes number: 2760
edges number: 28069
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.6092238426208496  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 1.6092243194580078  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.03354358673095703  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

pseudo mini batch 17 input nodes size: 50809
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.029924869537353516  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.029924869537353516  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.054152488708496094  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.05417346954345703  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.03021383285522461  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.03160905838012695  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.03160905838012695  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.03160905838012695  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

torch.Size([50809, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.03160905838012695  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

m.shape torch.Size([596, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.10874366760253906  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.10874366760253906  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.10931205749511719  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.11393928527832031  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([646, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.11427116394042969  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.11427116394042969  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.11488723754882812  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.12412834167480469  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([659, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.12476301193237305  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.12476301193237305  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.12539148330688477  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.13933229446411133  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([625, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.14021015167236328  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.14021015167236328  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.1408061981201172  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.15809154510498047  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([629, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.15929317474365234  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.15929317474365234  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.15989303588867188  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.18246221542358398  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([624, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.18394756317138672  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.18394756317138672  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.18454265594482422  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.21013164520263672  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([592, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.21270275115966797  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.21270275115966797  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.21326732635498047  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.24183177947998047  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([608, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.24386882781982422  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.24386882781982422  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.24444866180419922  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.2774991989135742  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([565, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.2805051803588867  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.2805051803588867  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.28104400634765625  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.31568336486816406  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([12990, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.37735509872436523  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.37735509872436523  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 12990, 128]), torch.Size([1, 12990, 128])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 0.3897433280944824  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2906346321105957  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 12990, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.216996669769287  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2346720695495605  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.252347469329834  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2345337867736816  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

torch.Size([18534, 256])
first layer input nodes number: 50809
first layer output nodes number: 18534
edges number: 157247
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.25272798538208  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2704033851623535  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2749028205871582  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2749028205871582  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

m.shape torch.Size([360, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3041234016418457  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3041234016418457  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3048100471496582  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.311750888824463  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([295, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3119750022888184  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3119750022888184  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.312537670135498  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3229002952575684  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([223, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3232622146606445  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3232622146606445  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3236875534057617  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3330450057983398  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([177, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3335132598876953  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3335132598876953  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3338508605957031  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3436412811279297  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([146, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3441743850708008  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3441743850708008  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3444528579711914  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.354477882385254  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([123, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3550481796264648  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3550481796264648  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3552827835083008  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.365370750427246  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3659734725952148  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3659734725952148  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3661775588989258  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3763818740844727  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3769183158874512  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3769183158874512  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3770766258239746  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3861002922058105  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3866701126098633  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3866701126098633  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3868131637573242  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3959684371948242  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3965797424316406  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3965797424316406  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3967151641845703  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4063301086425781  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4070448875427246  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4070448875427246  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4071860313415527  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4181952476501465  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4188055992126465  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4188055992126465  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4189181327819824  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.428483486175537  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4291396141052246  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4291396141052246  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.429248332977295  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4392504692077637  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4397344589233398  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4397344589233398  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4398107528686523  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4473638534545898  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4480609893798828  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4480609893798828  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4481582641601562  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4584693908691406  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.459035873413086  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.459035873413086  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4591121673583984  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.467733383178711  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.46836519241333  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.46836519241333  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4684433937072754  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.477827548980713  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4786882400512695  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4786882400512695  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4787874221801758  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4913835525512695  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.491790771484375  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.491790771484375  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4918384552001953  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4982280731201172  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4989347457885742  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4989347457885742  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.499007225036621  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5092267990112305  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5099577903747559  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5099577903747559  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5100302696228027  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5207571983337402  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.521165370941162  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.521165370941162  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5212054252624512  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5274138450622559  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5280132293701172  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5280132293701172  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.528066635131836  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5367183685302734  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5373377799987793  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5373377799987793  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.537391185760498  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5464167594909668  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([546, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5595097541809082  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5595097541809082  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.5605511665344238  GigaBytes
Max Memory Allocated: 1.645627498626709  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.7492070198059082  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 546, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.7227559089660645  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.7231731414794922  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.72359037399292  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.7231521606445312  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([2798, 40])
input nodes number: 18534
output nodes number: 2798
edges number: 29915
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.7233171463012695  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.7233176231384277  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.0340580940246582  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

pseudo mini batch 18 input nodes size: 42938
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.030219554901123047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.030219554901123047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.05069398880004883  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.050714969635009766  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02646636962890625  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02750396728515625  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02750396728515625  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02750396728515625  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([42938, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02750396728515625  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

m.shape torch.Size([639, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.08381986618041992  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.08381986618041992  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.08442926406860352  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.08982992172241211  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([732, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.09022331237792969  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.09022331237792969  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.09092140197753906  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10139274597167969  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([659, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10198640823364258  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10198640823364258  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1026148796081543  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.11694812774658203  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([572, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.11772489547729492  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.11772489547729492  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1182703971862793  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.13503408432006836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([587, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.13616085052490234  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.13616085052490234  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1367206573486328  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15774965286254883  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([508, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15892314910888672  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15892314910888672  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1594076156616211  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.18023967742919922  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([507, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.18168973922729492  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.18168973922729492  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1821732521057129  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.20634889602661133  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([479, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.20793437957763672  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.20793437957763672  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2083911895751953  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.23442935943603516  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([463, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.23618793487548828  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.23618793487548828  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.23662948608398438  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2648887634277344  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([9065, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.3078932762145996  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.3078932762145996  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 9065, 128]), torch.Size([1, 9065, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.31653833389282227  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9303374290466309  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 9065, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.8778996467590332  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.8914523124694824  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9050049781799316  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.8913459777832031  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([14211, 256])
first layer input nodes number: 42938
first layer output nodes number: 14211
edges number: 114549
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9053268432617188  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.918879508972168  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9222679138183594  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9222679138183594  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9464211463928223  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9464211463928223  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9471859931945801  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9538965225219727  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([395, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9542737007141113  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9542737007141113  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9550271034240723  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9682364463806152  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([270, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9686384201049805  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9686384201049805  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9691534042358398  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9821100234985352  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([195, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.982602596282959  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.982602596282959  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9829745292663574  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9937605857849121  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9944496154785156  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9944496154785156  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9947967529296875  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.007293701171875  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0078816413879395  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0078816413879395  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0081334114074707  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0189595222473145  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.019681453704834  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.019681453704834  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0199217796325684  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.031938076019287  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.032486915588379  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.032486915588379  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0326528549194336  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0421113967895508  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0428071022033691  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0428071022033691  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0429787635803223  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0539650917053223  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0544848442077637  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0544848442077637  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0546050071716309  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0631365776062012  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.063817024230957  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.063817024230957  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.063950538635254  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0743646621704102  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0749902725219727  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0749902725219727  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0751047134399414  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0848321914672852  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0852375030517578  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0852375030517578  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0853080749511719  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0918006896972656  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.09230375289917  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.09230375289917  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0923800468444824  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.09993314743042  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1004576683044434  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1004576683044434  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.100532054901123  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.10841703414917  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.108795166015625  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.108795166015625  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.108846664428711  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1146659851074219  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1149835586547852  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1149835586547852  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1150236129760742  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1198301315307617  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1204156875610352  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1204156875610352  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1204824447631836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1289606094360352  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1294937133789062  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1294937133789062  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1295528411865234  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1374759674072266  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1381769180297852  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1381769180297852  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.138249397277832  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1484689712524414  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1488165855407715  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1488165855407715  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.148852825164795  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1542162895202637  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1546211242675781  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1546211242675781  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1546592712402344  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1605720520019531  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1609292030334473  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1609292030334473  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.160961627960205  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1662144660949707  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.166590690612793  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.166590690612793  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1666231155395508  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.172102928161621  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([383, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1820430755615234  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1820430755615234  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1827735900878906  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3266949653625488  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 383, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.305464267730713  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3058810234069824  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.306297779083252  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3058600425720215  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([2795, 40])
input nodes number: 14211
output nodes number: 2795
edges number: 24598
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3059868812561035  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3059873580932617  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02939605712890625  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

pseudo mini batch 19 input nodes size: 47641
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.026465892791748047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.026465892791748047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.04990339279174805  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.049924373626708984  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.029428958892822266  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.03054189682006836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.03054189682006836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.03054189682006836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([47641, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.03054189682006836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

m.shape torch.Size([734, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.09174013137817383  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.09174013137817383  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.09244012832641602  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.09841108322143555  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([792, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.0988163948059082  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.0988163948059082  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.09957170486450195  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1109013557434082  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([819, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1116952896118164  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1116952896118164  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.11247634887695312  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.13013410568237305  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([697, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.131072998046875  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.131072998046875  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.13173770904541016  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15148353576660156  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([660, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1527247428894043  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1527247428894043  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15335416793823242  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1763472557067871  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([605, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1777634620666504  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1777634620666504  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.17834043502807617  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2035365104675293  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([544, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2050638198852539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2050638198852539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2055826187133789  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.23217105865478516  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([553, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.23402118682861328  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.23402118682861328  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.23454856872558594  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.26530933380126953  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([473, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2670755386352539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2670755386352539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.26752662658691406  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.29639625549316406  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([9744, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.3426337242126465  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.3426337242126465  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 9744, 128]), torch.Size([1, 9744, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.351926326751709  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.027829647064209  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 9744, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9705920219421387  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9854893684387207  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0003867149353027  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.9853725433349609  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([15621, 256])
first layer input nodes number: 47641
first layer output nodes number: 15621
edges number: 124422
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0007438659667969  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.015641212463379  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0193657875061035  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0193657875061035  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

m.shape torch.Size([403, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0436511039733887  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0436511039733887  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.044419765472412  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0508952140808105  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.051187515258789  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.051187515258789  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.051858901977539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0636305809020996  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([308, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.064183235168457  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.064183235168457  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0647706985473633  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0779733657836914  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0785369873046875  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0785369873046875  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0789623260498047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0912971496582031  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.091944694519043  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.091944694519043  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.0922861099243164  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1045770645141602  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1051273345947266  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1051273345947266  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1053657531738281  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1156177520751953  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1162524223327637  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1162524223327637  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1164660453796387  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1271471977233887  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([89, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1277251243591309  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1277251243591309  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1278948783874512  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.137570858001709  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1381349563598633  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1381349563598633  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1382780075073242  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1474332809448242  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([55, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.147890567779541  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.147890567779541  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1479954719543457  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1554436683654785  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1559834480285645  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1559834480285645  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.156090259552002  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.164421558380127  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1650490760803223  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1650490760803223  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1651616096496582  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.174726963043213  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1752958297729492  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1752958297729492  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1753911972045898  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1841650009155273  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.184736728668213  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.184736728668213  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1848244667053223  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1935105323791504  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1940436363220215  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.1940436363220215  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.194119930267334  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.202207088470459  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2025842666625977  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2025842666625977  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2026357650756836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2084550857543945  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2088871002197266  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2088871002197266  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2089405059814453  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2153491973876953  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2157726287841797  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2157726287841797  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2158222198486328  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2221202850341797  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2224793434143066  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2224793434143066  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2225193977355957  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.22788667678833  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2282705307006836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2282705307006836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2283105850219727  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2339582443237305  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2345037460327148  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2345037460327148  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2345571517944336  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2424612045288086  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2427306175231934  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2427306175231934  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2427573204040527  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2468962669372559  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2474136352539062  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2474136352539062  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2474594116210938  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2548751831054688  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2551755905151367  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2551755905151367  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.255202293395996  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2597150802612305  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([410, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2695536613464355  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2695536613464355  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.2703356742858887  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.4117884635925293  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 410, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3903932571411133  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3908085823059082  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3912239074707031  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3907876014709473  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([2785, 40])
input nodes number: 15621
output nodes number: 2785
edges number: 24736
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3909239768981934  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 1.3909244537353516  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.03257608413696289  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

pseudo mini batch 20 input nodes size: 41163
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.029427528381347656  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.029427528381347656  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.04905557632446289  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.049077510833740234  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.025619029998779297  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02709817886352539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02709817886352539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02709817886352539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([41163, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.02709817886352539  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

m.shape torch.Size([427, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10532617568969727  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10532617568969727  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10573339462280273  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10899114608764648  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([427, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10919475555419922  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10919475555419922  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.10960197448730469  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.11571025848388672  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([435, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.11612892150878906  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.11612892150878906  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.11654376983642578  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1256704330444336  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([456, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.12633275985717773  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.12633275985717773  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.12676763534545898  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.13937902450561523  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([453, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1402416229248047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.1402416229248047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.14067363739013672  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15622615814208984  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([440, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15726900100708008  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15726900100708008  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.15768861770629883  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.17573213577270508  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([456, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.17704439163208008  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.17704439163208008  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.17747926712036133  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.19922304153442383  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([454, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.20073747634887695  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.20073747634887695  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.2011704444885254  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.22584962844848633  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([470, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.22765016555786133  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.22765016555786133  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.22809839248657227  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.25678491592407227  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([13795, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.3223404884338379  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.3223404884338379  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 13795, 128]), torch.Size([1, 13795, 128])
----------------------------------------3
 Nvidia-smi: 3.7576904296875 GB
    Memory Allocated: 0.3354964256286621  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2695679664611816  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 13795, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.194972038269043  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2119598388671875  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.228947639465332  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2118268013000488  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

torch.Size([17813, 256])
first layer input nodes number: 41163
first layer output nodes number: 17813
edges number: 158319
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2292566299438477  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2462444305419922  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.250777244567871  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.250777244567871  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

m.shape torch.Size([261, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2897286415100098  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2897286415100098  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2902264595031738  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2943177223205566  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([168, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2943921089172363  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2943921089172363  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2947125434875488  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2995190620422363  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([145, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2997770309448242  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.2997770309448242  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.300053596496582  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.306138038635254  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([151, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3065805435180664  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3065805435180664  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.306868553161621  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.315220832824707  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([134, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.315721035003662  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.315721035003662  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.315976619720459  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3251776695251465  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([103, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3256440162658691  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3256440162658691  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3258404731750488  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3342881202697754  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3348021507263184  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3348021507263184  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3349757194519043  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3436541557312012  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3442211151123047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3442211151123047  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3443832397460938  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3536243438720703  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3542180061340332  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3542180061340332  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3543667793273926  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3638882637023926  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.364640712738037  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.364640712738037  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.364804744720459  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.376451015472412  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.377077579498291  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.377077579498291  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3772053718566895  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3871731758117676  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3880090713500977  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.3880090713500977  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.388157844543457  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.400803565979004  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4017038345336914  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4017038345336914  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4018526077270508  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4155397415161133  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4163131713867188  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4163131713867188  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.416433334350586  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4283294677734375  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4290194511413574  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4290194511413574  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4291186332702637  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4396319389343262  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4404897689819336  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4404897689819336  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4406023025512695  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4533185958862305  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4540796279907227  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4540796279907227  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4541749954223633  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4656190872192383  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.466611385345459  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.466611385345459  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4667201042175293  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.480527400970459  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.481222152709961  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.481222152709961  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4813003540039062  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4917793273925781  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4926824569702148  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4926824569702148  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.4927759170532227  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5059537887573242  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5067548751831055  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5067548751831055  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5068349838256836  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.518691062927246  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5194125175476074  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5194125175476074  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5194811820983887  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5301241874694824  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5308194160461426  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5308194160461426  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5308823585510254  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.541079044342041  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.541785717010498  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.541785717010498  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.541846752166748  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.552161693572998  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([888, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5734682083129883  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5734682083129883  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

 h.shape torch.Size([1, 888, 256]), torch.Size([1, 888, 256])
----------------------------------------3
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.5751619338989258  GigaBytes
Max Memory Allocated: 1.7622246742248535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.8750076293945312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 888, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.8389992713928223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.8394355773925781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.839871883392334  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.8394136428833008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2927, 40])
input nodes number: 17813
output nodes number: 2927
edges number: 40132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.8395895957946777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4530029296875 GB
    Memory Allocated: 1.839590072631836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02963733673095703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 21 input nodes size: 43313
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025640010833740234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025640010833740234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04629325866699219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.046314239501953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.026664257049560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027881145477294922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027881145477294922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027881145477294922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([43313, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027881145477294922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([635, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09433174133300781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09433174133300781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09493732452392578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10081148147583008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([683, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10116004943847656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10116004943847656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 683, 128]), torch.Size([1, 683, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10181140899658203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11158180236816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 683, 128])
m.shape torch.Size([614, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11213445663452148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11213445663452148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11272001266479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12560224533081055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([569, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12639474868774414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12639474868774414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1269373893737793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1427617073059082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([579, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14387083053588867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14387083053588867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1444230079650879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16430139541625977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([532, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16554737091064453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16554737091064453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16605472564697266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1881270408630371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([516, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18959569931030273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18959569931030273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19008779525756836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21558713912963867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([473, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21714544296264648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21714544296264648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21759653091430664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24330854415893555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([488, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2451772689819336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2451772689819336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24564266204833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27542781829833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([11133, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3282814025878906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3282814025878906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11133, 128]), torch.Size([1, 11133, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33957958221435547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0936036109924316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11133, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0309953689575195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0464658737182617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.061936378479004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0463447570800781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([16222, 256])
first layer input nodes number: 43313
first layer output nodes number: 16222
edges number: 135324
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0622611045837402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0777316093444824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0817923545837402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0817923545837402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([367, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1098175048828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1098175048828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1105175018310547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1185264587402344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([320, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1187915802001953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1187915802001953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1194019317626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1285572052001953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([225, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1289010047912598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1289010047912598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1293301582336426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1387715339660645  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([165, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1391916275024414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1391916275024414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1395063400268555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1486330032348633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.149369716644287  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.149369716644287  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1497244834899902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1624960899353027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([124, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1630339622497559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1630339622497559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1632704734802246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1734404563903809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1740694046020508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1740694046020508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.174281120300293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1848669052124023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([82, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.185391902923584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.185391902923584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1855483055114746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1944632530212402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1950860023498535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1950860023498535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1952404975891113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2051281929016113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.205723762512207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.205723762512207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.205857276916504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.215336799621582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2159361839294434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2159361839294434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2160563468933105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2254290580749512  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2261419296264648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2261419296264648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2262697219848633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2371320724487305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2377805709838867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2377805709838867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.237889289855957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2478914260864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2483487129211426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2483487129211426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2484211921691895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.25559663772583  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2561659812927246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2561659812927246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2562460899353027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.264737606048584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.265282154083252  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.265282154083252  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2653546333312988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2735447883605957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2742605209350586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2742605209350586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.274348258972168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.284876823425293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2853522300720215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2853522300720215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2854094505310059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2926764488220215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2933235168457031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2933235168457031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2933940887451172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3028507232666016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.303257942199707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.303257942199707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3033018112182617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3094873428344727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3100709915161133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3100709915161133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3101282119750977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3185968399047852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3190546035766602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3190546035766602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3190984725952148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3258981704711914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3262743949890137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3262743949890137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3263087272644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3318705558776855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.332292079925537  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.332292079925537  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3323283195495605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3384528160095215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([500, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3504490852355957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3504490852355957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.351402759552002  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.52775239944458  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 500, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.502497673034668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5029096603393555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.503321647644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5028886795043945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2762, 40])
input nodes number: 16222
output nodes number: 2762
edges number: 27877
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5030064582824707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.503006935119629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029999256134033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 22 input nodes size: 39489
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.026639938354492188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.026639938354492188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04617118835449219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.046192169189453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025517940521240234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02683401107788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02683401107788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02683401107788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([39489, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02683401107788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([549, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09733819961547852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09733819961547852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09786176681518555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10277462005615234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([559, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10304594039916992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10304594039916992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10357904434204102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11157560348510742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([555, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11210298538208008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11210298538208008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11263227462768555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12522268295288086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([488, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12588882446289062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12588882446289062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12635421752929688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13985061645507812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([504, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14081954956054688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14081954956054688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14130020141601562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15860366821289062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([476, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15972518920898438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15972518920898438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16017913818359375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17969894409179688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([479, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18107080459594727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18107080459594727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18152761459350586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20436811447143555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([409, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20569992065429688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20569992065429688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20608997344970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22832298278808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([464, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2301192283630371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2301192283630371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2305617332458496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2588820457458496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([12228, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31725454330444336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31725454330444336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12228, 128]), torch.Size([1, 12228, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.328916072845459  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1599745750427246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12228, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0932531356811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1091899871826172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.125126838684082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.109065055847168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([16711, 256])
first layer input nodes number: 39489
first layer output nodes number: 16711
edges number: 143741
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1254234313964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1413602828979492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1453447341918945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1453447341918945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([320, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1773200035095215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1773200035095215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1779303550720215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.184976577758789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([247, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1851463317871094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1851463317871094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.185617446899414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1926841735839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([217, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1930747032165527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1930747032165527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.193488597869873  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.20259428024292  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([169, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2030372619628906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2030372619628906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.203359603881836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.21270751953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([145, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2132434844970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2132434844970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2135200500488281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2234764099121094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([120, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2240304946899414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2240304946899414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.224259376525879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2341012954711914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([87, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.234572410583496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.234572410583496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2347383499145508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2430353164672852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.243452548980713  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.243452548980713  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2435765266418457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.250643253326416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2512736320495605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2512736320495605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2514262199401855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2611918449401855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.261807918548584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.261807918548584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2619452476501465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.271695613861084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([50, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.27215576171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.27215576171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2722511291503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2796897888183594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2802996635437012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2802996635437012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2804083824157715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.289649486541748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.290144920349121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.290144920349121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2902288436889648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2979497909545898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2984733581542969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2984733581542969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.298553466796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3064842224121094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3069777488708496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3069777488708496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3070483207702637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3145289421081543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3150629997253418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3150629997253418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3151335716247559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.323108196258545  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3236451148986816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3236451148986816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.32371187210083  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3317227363586426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3323125839233398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3323125839233398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.332381248474121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3411016464233398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.341597080230713  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.341597080230713  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3416523933410645  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3490643501281738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3495559692382812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3495559692382812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3496074676513672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3568687438964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3574485778808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3574485778808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3575057983398438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3659744262695312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3664956092834473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3664956092834473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3665452003479004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3742318153381348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.374560832977295  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.374560832977295  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.37459135055542  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.37953519821167  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3801889419555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3801889419555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.380244255065918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.389592170715332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([741, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.407369613647461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.407369613647461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 741, 256]), torch.Size([1, 741, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.408782958984375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6607799530029297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 741, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6314802169799805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6318912506103516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6323022842407227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6318702697753906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2758, 40])
input nodes number: 16711
output nodes number: 2758
edges number: 32821
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6320152282714844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6320157051086426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029095172882080078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 23 input nodes size: 50103
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.049407958984375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04942893981933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029876708984375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031256675720214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031256675720214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031256675720214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([50103, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031256675720214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([628, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10788774490356445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10788774490356445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10848665237426758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11407613754272461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([648, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1143946647644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1143946647644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11501264572143555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1242823600769043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([630, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12487459182739258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12487459182739258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12547540664672852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1389451026916504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([604, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13979673385620117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13979673385620117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14037275314331055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15747785568237305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([559, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1585226058959961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1585226058959961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1590557098388672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17824983596801758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([570, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17961406707763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17961406707763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18015766143798828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20418453216552734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([505, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2055983543395996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2055983543395996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20607995986938477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23016023635864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([547, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23200607299804688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23200607299804688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2325277328491211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.26377153396606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([505, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.26567792892456055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.26567792892456055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2661595344543457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2969822883605957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([13129, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3593454360961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3593454360961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13129, 128]), torch.Size([1, 13129, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37186622619628906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2748188972473145  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13129, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2017216682434082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2191977500915527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2366738319396973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2190608978271484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([18325, 256])
first layer input nodes number: 50103
first layer output nodes number: 18325
edges number: 156191
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2370491027832031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2545251846313477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.258894443511963  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.258894443511963  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([383, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2871031761169434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2871031761169434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2878336906433105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2954602241516113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([300, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2956719398498535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2956719398498535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2962441444396973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3048672676086426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([252, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3053078651428223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3053078651428223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.305788516998291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3163628578186035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([183, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.316826343536377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.316826343536377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3171753883361816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3272976875305176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([143, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3278107643127441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3278107643127441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3280835151672363  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.337902545928955  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([117, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3384408950805664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3384408950805664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3386640548706055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3482599258422852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([87, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.348733901977539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.348733901977539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3488998413085938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3571968078613281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([78, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3577136993408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3577136993408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3578624725341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.366342544555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3669171333312988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3669171333312988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3670601844787598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3762154579162598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3768649101257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3768649101257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3770079612731934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.38716459274292  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3877487182617188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3877487182617188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3878669738769531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3970909118652344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3976550102233887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3976550102233887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3977580070495605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.40651273727417  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4070487022399902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4070487022399902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4071383476257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4153857231140137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.415785312652588  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.415785312652588  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4158482551574707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4220795631408691  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4226970672607422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4226970672607422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4227828979492188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4318809509277344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4324226379394531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4324226379394531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4324951171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4406852722167969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4411559104919434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4411559104919434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4412150382995605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.448310375213623  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4488344192504883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4488344192504883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4488954544067383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4566469192504883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.457219123840332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.457219123840332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4572820663452148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4657163619995117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4663000106811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4663000106811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4663610458374023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4749670028686523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4754209518432617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4754209518432617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4754667282104492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4822416305541992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4826416969299316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4826416969299316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.482679843902588  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4885926246643066  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4891929626464844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4891929626464844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4892463684082031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4978981018066406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.498448371887207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.498448371887207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4984960556030273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5065546035766602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([562, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5200347900390625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5200347900390625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5211067199707031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7116742134094238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 562, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6861968040466309  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6866083145141602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6870198249816895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6865873336791992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2759, 40])
input nodes number: 18325
output nodes number: 2759
edges number: 28840
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6867456436157227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6867461204528809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03366851806640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 24 input nodes size: 19462
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029877185821533203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029877185821533203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03915739059448242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.039179325103759766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015267372131347656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015740394592285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015740394592285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015740394592285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([19462, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015740394592285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([833, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03880167007446289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03880167007446289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0395960807800293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04595136642456055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([836, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04635143280029297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04635143280029297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.047148704528808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05910778045654297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([812, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05992317199707031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05992317199707031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06069755554199219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07773399353027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([637, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07871818542480469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07871818542480469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07932567596435547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09714031219482422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([597, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09825992584228516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09825992584228516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09882926940917969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11974287033081055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([499, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12088584899902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12088584899902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12136173248291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14182472229003906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([416, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1429753303527832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1429753303527832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1433720588684082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1632084846496582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([356, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1643681526184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1643681526184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 356, 128]), torch.Size([1, 356, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16470766067504883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18405961990356445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 356, 128])
m.shape torch.Size([308, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1852116584777832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1852116584777832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18550539016723633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20430421829223633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([2419, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21569204330444336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21569204330444336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 2419, 128]), torch.Size([1, 2419, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21799898147583008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38208866119384766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 2419, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36293888092041016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37029457092285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37765026092529297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.370236873626709  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7713, 256])
first layer input nodes number: 19462
first layer output nodes number: 7713
edges number: 46190
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37779760360717773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38515329360961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38738250732421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38738250732421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([557, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40463829040527344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40463829040527344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40570068359375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4151430130004883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([438, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4154539108276367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4154539108276367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4162893295288086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4288206100463867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([351, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4294867515563965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4294867515563965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43015623092651367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4453773498535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44597721099853516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44597721099853516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4464406967163086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4598817825317383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([242, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46091699600219727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46091699600219727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4613785743713379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4779953956604004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4788484573364258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4788484573364258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47919178009033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4939546585083008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4947185516357422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4947185516357422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4949836730957031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.50823974609375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5090298652648926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5090298652648926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5092587471008301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5223050117492676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.523012638092041  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.523012638092041  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5231938362121582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5347905158996582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5353250503540039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5353250503540039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5354490280151367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5442514419555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([45, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5446653366088867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5446653366088867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5447511672973633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5514459609985352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5519800186157227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5519800186157227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5520753860473633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5601816177368164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5607337951660156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5607337951660156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5608253479003906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5692481994628906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5697274208068848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5697274208068848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5698018074035645  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5771660804748535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5775041580200195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5775041580200195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5775537490844727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5828104019165039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5831546783447266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5831546783447266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5832004547119141  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5883731842041016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5887265205383301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5887265205383301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5887703895568848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5940346717834473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5943937301635742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5943937301635742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5944356918334961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5997648239135742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5999813079833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5999813079833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.600006103515625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6033287048339844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6037392616271973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6037392616271973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6037812232971191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6096978187561035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6097979545593262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6097979545593262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.609809398651123  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6115031242370605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6117091178894043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6117091178894043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6117281913757324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6146845817565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6149406433105469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6149406433105469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6149635314941406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6186714172363281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6188445091247559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6188445091247559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6188597679138184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6214385032653809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([110, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6240739822387695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6240739822387695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6242837905883789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6612100601196289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 110, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6473226547241211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6477532386779785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6481838226318359  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6477313041687012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2888, 40])
input nodes number: 7713
output nodes number: 2888
edges number: 17263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6478300094604492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6478304862976074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01671314239501953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 25 input nodes size: 24158
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015286445617675781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015286445617675781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.026805877685546875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.026826858520507812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01752471923828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018126487731933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018126487731933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018126487731933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([24158, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018126487731933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([695, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.048161983489990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.048161983489990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04882478713989258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05412721633911133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([728, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.054490089416503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.054490089416503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 728, 128]), torch.Size([1, 728, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.055184364318847656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06566429138183594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 728, 128])
m.shape torch.Size([671, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06627702713012695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06627702713012695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06691694259643555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08132505416870117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([617, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08218193054199219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08218193054199219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08277034759521484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09983444213867188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([562, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10088014602661133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10088014602661133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10141611099243164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1212458610534668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([520, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12246561050415039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12246561050415039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12296152114868164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1452479362487793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([449, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1464986801147461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1464986801147461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1469268798828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1683368682861328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([420, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1697249412536621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1697249412536621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17012548446655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19295644760131836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([351, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19426250457763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19426250457763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1945972442626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2160205841064453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([3841, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23416852951049805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23416852951049805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 3841, 128]), torch.Size([1, 3841, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23783159255981445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.498868465423584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 3841, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47348690032958984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4819307327270508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4903745651245117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48186445236206055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([8854, 256])
first layer input nodes number: 24158
first layer output nodes number: 8854
edges number: 60634
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4905567169189453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49900054931640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5016441345214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5016441345214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([448, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5214529037475586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5214529037475586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5223073959350586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5300569534301758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([378, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5303564071655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5303564071655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5310773849487305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5427312850952148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([304, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5432476997375488  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5432476997375488  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5438275337219238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5570902824401855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5577154159545898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5577154159545898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5581693649291992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5713338851928711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5720586776733398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5720586776733398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5724363327026367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5860319137573242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5866966247558594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5866966247558594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5869789123535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5991172790527344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5998444557189941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5998444557189941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.600090503692627  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6123929023742676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6132159233093262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6132159233093262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6134505271911621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6268229484558105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6275277137756348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6275277137756348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.627708911895752  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.639305591583252  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6400704383850098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6400704383850098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6402401924133301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6522927284240723  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.652705192565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.652705192565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6527948379516602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6597871780395508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6604347229003906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6604347229003906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6605491638183594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6702766418457031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6707820892333984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6707820892333984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.670867919921875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6787643432617188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6793136596679688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6793136596679688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6793975830078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6877059936523438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6882410049438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6882410049438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6883172988891602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6964044570922852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6969509124755859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6969509124755859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6970233917236328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7052135467529297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7056350708007812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7056350708007812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7056884765625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.71209716796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7125897407531738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7125897407531738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7126469612121582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7199139595031738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7202873229980469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7202873229980469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7203292846679688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7259521484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.726315975189209  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.726315975189209  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7263541221618652  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7317328453063965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7319560050964355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7319560050964355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7319788932800293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7353663444519043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7355875968933105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7355875968933105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7356085777282715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7388606071472168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7391600608825684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7391600608825684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7391867637634277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7435126304626465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7438454627990723  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7438454627990723  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7438740730285645  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7487092018127441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([192, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7533082962036133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7533082962036133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7536745071411133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8181276321411133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 192, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8014082908630371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8018207550048828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8022332191467285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8017997741699219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2768, 40])
input nodes number: 8854
output nodes number: 2768
edges number: 20034
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8018689155578613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8018693923950195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019270896911621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 26 input nodes size: 17698
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01750659942626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01750659942626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025945663452148438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025966644287109375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014426231384277344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014836311340332031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014836311340332031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014836311340332031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([17698, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014836311340332031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([819, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03532123565673828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03532123565673828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.036102294921875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04289722442626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([893, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04335832595825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04335832595825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.044209957122802734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05698442459106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([747, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.057627201080322266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.057627201080322266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.058339595794677734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07407474517822266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([607, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07487630844116211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07487630844116211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0754551887512207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09237241744995117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([517, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09331560134887695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09331560134887695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09380865097045898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1118917465209961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([410, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11281824111938477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11281824111938477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11320924758911133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13002252578735352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([377, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13108539581298828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13108539581298828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13144493103027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14942169189453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([332, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15050840377807617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15050840377807617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 332, 128]), torch.Size([1, 332, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15082502365112305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16887235641479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 332, 128])
m.shape torch.Size([271, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1698770523071289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1698770523071289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.170135498046875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.186676025390625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([1971, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19628667831420898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19628667831420898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 1971, 128]), torch.Size([1, 1971, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1981663703918457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3360304832458496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 1971, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31873416900634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32535648345947266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33197879791259766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3253045082092285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([6944, 256])
first layer input nodes number: 17698
first layer output nodes number: 6944
edges number: 39763
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33211278915405273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33873510360717773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.340390682220459  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.340390682220459  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([561, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3556962013244629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3556962013244629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3567662239074707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36605215072631836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([497, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3664727210998535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3664727210998535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36742067337036133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38317346572875977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([344, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3838787078857422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3838787078857422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3845348358154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39897727966308594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([299, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3997988700866699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3997988700866699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40036916732788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4170374870300293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4176368713378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4176368713378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4179878234863281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4306221008300781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4313235282897949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4313235282897949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4316134452819824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4440798759460449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4448366165161133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4448366165161133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44509220123291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4578714370727539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45847415924072266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45847415924072266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45865535736083984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46898365020751953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4696197509765625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4696197509765625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46977996826171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48003387451171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4806942939758301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4806942939758301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48084115982055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4912686347961426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49176645278930664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49176645278930664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4918694496154785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49990320205688477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([27, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5001635551452637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5001635551452637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5002150535583496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5045924186706543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.505129337310791  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.505129337310791  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5052151679992676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5131115913391113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5135531425476074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5135531425476074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5136218070983887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5204195976257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5207605361938477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5207605361938477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5208101272583008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.526066780090332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5263495445251465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5263495445251465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5263876914978027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.530698299407959  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5309243202209473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5309243202209473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5309529304504395  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.534386157989502  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.534700870513916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.534700870513916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5347371101379395  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.539339542388916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.539522647857666  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.539522647857666  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.539543628692627  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5423550605773926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5425949096679688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5425949096679688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5426197052001953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5461158752441406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5464062690734863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5464062690734863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5464348793029785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5506691932678223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5508456230163574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5508456230163574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5508627891540527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5535235404968262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5537581443786621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5537581443786621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.553779125213623  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5571780204772949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5573291778564453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5573291778564453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.557342529296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5595989227294922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([67, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5612025260925293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5612025260925293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5613303184509277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5838217735290527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5718297958374023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5722475051879883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5726652145385742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5722265243530273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2802, 40])
input nodes number: 6944
output nodes number: 2802
edges number: 15231
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5723047256469727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5723052024841309  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015685081481933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 27 input nodes size: 16719
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014431476593017578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014431476593017578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022403717041015625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022425174713134766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.013965129852294922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014388561248779297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014388561248779297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014388561248779297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([16719, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.014388561248779297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([724, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03481769561767578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03481769561767578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.035508155822753906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.041031837463378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([828, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04147624969482422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04147624969482422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.042265892028808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05446195602416992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([691, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05505561828613281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05505561828613281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05571460723876953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07021236419677734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([619, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07106351852416992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07106351852416992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07165384292602539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08954381942749023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([554, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09056949615478516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09056949615478516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09109783172607422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11071538925170898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([422, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11165857315063477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11165857315063477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1120610237121582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12936639785766602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([366, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1303868293762207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1303868293762207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 366, 128]), torch.Size([1, 366, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1307358741760254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14818811416625977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 366, 128])
m.shape torch.Size([335, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1492915153503418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1492915153503418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1496109962463379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16782140731811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([265, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16879892349243164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16879892349243164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1690516471862793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1852259635925293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([1951, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19440269470214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19440269470214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 1951, 128]), torch.Size([1, 1951, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19626331329345703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33391761779785156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 1951, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3165445327758789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3229866027832031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32942867279052734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3229360580444336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([6755, 256])
first layer input nodes number: 16719
first layer output nodes number: 6755
edges number: 39368
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3295555114746094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33620262145996094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33760833740234375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33760833740234375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([506, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3548879623413086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3548879623413086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3558530807495117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3635740280151367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([458, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36397218704223633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36397218704223633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36484575271606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37794923782348633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([346, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3785867691040039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3785867691040039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37924671173095703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39423179626464844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3950672149658203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3950672149658203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39556884765625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4106292724609375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([240, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.411531925201416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.411531925201416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.411989688873291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.428469181060791  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4291343688964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4291343688964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4294300079345703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4421424865722656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44290971755981445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44290971755981445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44316911697387695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45613908767700195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45691680908203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45691680908203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4571418762207031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.469970703125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4707322120666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4707322120666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47092485427856445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48325395584106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4840230941772461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4840230941772461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4841947555541992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4963827133178711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4969210624694824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4969210624694824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49703359603881836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5058112144470215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.506378173828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.506378173828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5064811706542969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5152359008789062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5157217979431152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5157217979431152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5158038139343262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5233492851257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5236988067626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5236988067626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5237541198730469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5292301177978516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5296640396118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5296640396118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5297250747680664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5361948013305664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5366721153259277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5366721153259277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5367350578308105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5438475608825684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5441756248474121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5441756248474121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.544217586517334  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.549252986907959  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5496301651000977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5496301651000977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5496740341186523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5552453994750977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5554609298706055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5554609298706055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.555485725402832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5588083267211914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5591034889221191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5591034889221191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5591340065002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5634369850158691  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.563563346862793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.563563346862793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5635766983032227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5655527114868164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5657787322998047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5657787322998047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5657997131347656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5690517425537109  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5691742897033691  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5691742897033691  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.569185733795166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5710396766662598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5712881088256836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5712881088256836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5713090896606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.574854850769043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([103, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5773196220397949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5773196220397949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5775160789489746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6120924949645996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 103, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5981264114379883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5985550880432129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5989837646484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5985336303710938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2875, 40])
input nodes number: 6755
output nodes number: 2875
edges number: 17338
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5986166000366211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5986170768737793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015261650085449219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 28 input nodes size: 26790
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.013976097106933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.013976097106933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027647972106933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02766895294189453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019675254821777344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020277976989746094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020277976989746094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020277976989746094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([26790, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020277976989746094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([853, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.051629066467285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.051629066467285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05244255065917969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05895042419433594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([822, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05932760238647461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05932760238647461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06011152267456055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07187032699584961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([777, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07261419296264648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07261419296264648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07335519790649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08965730667114258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([648, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09062385559082031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09062385559082031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09124183654785156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10916328430175781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([618, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11032772064208984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11032772064208984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1109170913696289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13306045532226562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([471, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13411331176757812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13411331176757812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13456249237060547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15387725830078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([431, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1550912857055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1550912857055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1555023193359375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1760540008544922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([427, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17844867706298828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17844867706298828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17885589599609375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20206737518310547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([355, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20338726043701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20338726043701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20372581481933594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22539329528808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([4019, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24475526809692383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24475526809692383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 4019, 128]), torch.Size([1, 4019, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24858808517456055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.524756908416748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 4019, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49666881561279297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5056533813476562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5146379470825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5055828094482422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([9421, 256])
first layer input nodes number: 26790
first layer output nodes number: 9421
edges number: 63154
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5148396492004395  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5238242149353027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.526705265045166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.526705265045166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([552, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5442957878112793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5442957878112793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5453486442565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5537714958190918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([444, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5540986061096191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5540986061096191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5549454689025879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5699858665466309  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5705199241638184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5705199241638184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5711531639099121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5863685607910156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.587005615234375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.587005615234375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5874786376953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6011962890625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6025362014770508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6025362014770508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6029653549194336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6184148788452148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([121, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6188983917236328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6188983917236328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6191291809082031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6290531158447266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6297454833984375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6297454833984375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.629974365234375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.64141845703125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6422114372253418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6422114372253418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6424365043640137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6552653312683105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([68, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6557412147521973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6557412147521973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6558709144592285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6641716957092285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6647319793701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6647319793701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.66485595703125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6736583709716797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6741461753845215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6741461753845215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6742453575134277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6819815635681152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6825318336486816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6825318336486816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6826310157775879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6910614967346191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6914119720458984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6914119720458984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6914730072021484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6970882415771484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6975560188293457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6975560188293457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6976265907287598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.704613208770752  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7049098014831543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7049098014831543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.704953670501709  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7096037864685059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7099356651306152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7099356651306152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7099795341491699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7149367332458496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7152090072631836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7152090072631836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7152433395385742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7193632125854492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7196578979492188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7196578979492188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7196922302246094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7240524291992188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.724419116973877  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.724419116973877  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.724459171295166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7298264503479004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7303256988525391  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7303256988525391  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.730377197265625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7376384735107422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7378349304199219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7378349304199219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7378559112548828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7409610748291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7411832809448242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7411832809448242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7412042617797852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7444562911987305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7445125579833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7445125579833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7445182800292969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7454452514648438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7456502914428711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7456502914428711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7456674575805664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7485685348510742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([165, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7525248527526855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7525248527526855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7528395652770996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8082289695739746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 165, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7938613891601562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7942781448364258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7946949005126953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7942571640014648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2795, 40])
input nodes number: 9421
output nodes number: 2795
edges number: 17620
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7943367958068848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.794337272644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02144336700439453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 29 input nodes size: 29849
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019663333892822266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019663333892822266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033896446228027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03391742706298828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020224571228027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02103710174560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02103710174560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02103710174560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([29849, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02103710174560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([694, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06381750106811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06381750106811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06447935104370117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06984233856201172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([734, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07021141052246094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07021141052246094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07091140747070312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08141136169433594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([575, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08188390731811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08188390731811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08243227005004883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09492731094360352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([572, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09574413299560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09574413299560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09628963470458984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11242008209228516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([551, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11346101760864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11346101760864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11398649215698242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13385963439941406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([518, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13507890701293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13507890701293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1355729103088379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15762758255004883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([491, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15901947021484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15901947021484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15948772430419922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18290042877197266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([480, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18449735641479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18449735641479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18495512008666992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21104764938354492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([445, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21272850036621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21272850036621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21315288543701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24031352996826172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([6344, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2703518867492676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2703518867492676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 6344, 128]), torch.Size([1, 6344, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2765994071960449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7061572074890137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 6344, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6669807434082031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6783180236816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6896553039550781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6782326698303223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([11404, 256])
first layer input nodes number: 29849
first layer output nodes number: 11404
edges number: 86760
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6898798942565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7012171745300293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7039361000061035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7039361000061035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7258377075195312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7258377075195312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7266902923583984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7346382141113281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([396, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7349734306335449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7349734306335449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7357287406921387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7472386360168457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([253, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7475905418395996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7475905418395996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7480731010437012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7586894035339355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([200, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7592172622680664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7592172622680664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7595987319946289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7706613540649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7713503837585449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7713503837585449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7716994285583496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7842650413513184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7850422859191895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7850422859191895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7853569984436035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7988896369934082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7996745109558105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7996745109558105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7999415397644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8132929801940918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8140592575073242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8140592575073242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8142824172973633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8270025253295898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.827756404876709  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.827756404876709  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8279471397399902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8401541709899902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8408470153808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8408470153808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.84100341796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8521080017089844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8528971672058105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8528971672058105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8530535697937012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8652529716491699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8658671379089355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8658671379089355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8659815788269043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.875709056854248  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.876164436340332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.876164436340332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8762426376342773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8834371566772461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8838691711425781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8838691711425781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8839359283447266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8905448913574219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8910164833068848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8910164833068848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8910832405090332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8981595039367676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8986492156982422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8986492156982422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8987140655517578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9060420989990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9064998626708984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9064998626708984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9065570831298828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9134235382080078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9138102531433105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9138102531433105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.913856029510498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9196696281433105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9201035499572754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9201035499572754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9201512336730957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9265408515930176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9269976615905762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9269976615905762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9270453453063965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9337687492370605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9341287612915039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9341287612915039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9341650009155273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9395284652709961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9397854804992676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9397854804992676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9398102760314941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9436535835266113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9439511299133301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9439511299133301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9439778327941895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9483036994934082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9486827850341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9486827850341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9487152099609375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9541950225830078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([273, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9616608619689941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9616608619689941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.962181568145752  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0613713264465332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 273, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0425372123718262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0429563522338867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0433754920959473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0429353713989258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2810, 40])
input nodes number: 11404
output nodes number: 2810
edges number: 22210
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.043044090270996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0430445671081543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022528648376464844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 30 input nodes size: 35196
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02022695541381836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02022695541381836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03700971603393555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.037030696868896484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02277660369873047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02362537384033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02362537384033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02362537384033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([35196, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02362537384033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([749, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0687861442565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0687861442565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06950044631958008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07521486282348633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([870, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07568740844726562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07568740844726562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07651710510253906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08982086181640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([807, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09072589874267578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09072589874267578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09149551391601562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10842704772949219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([736, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10944604873657227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10944604873657227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11014795303344727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13068628311157227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([653, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13189220428466797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13189220428466797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13251495361328125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1549849510192871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([570, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15630435943603516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15630435943603516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15684795379638672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18086671829223633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([533, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1823740005493164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1823740005493164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18288230895996094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20921945571899414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([492, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21084213256835938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21084213256835938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21131134033203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23805618286132812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([431, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2396712303161621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2396712303161621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2400822639465332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2663884162902832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([6546, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29743289947509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29743289947509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 6546, 128]), torch.Size([1, 6546, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30367565155029297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7565469741821289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 6546, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7146396636962891  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7264528274536133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7382659912109375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7263603210449219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([12387, 256])
first layer input nodes number: 35196
first layer output nodes number: 12387
edges number: 91545
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.738530158996582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7503433227539062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7532968521118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7532968521118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7751507759094238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7751507759094238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7759804725646973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7841806411743164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([406, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7845463752746582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7845463752746582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7853207588195801  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7986712455749512  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([314, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.799189567565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.799189567565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7997884750366211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8136701583862305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8143281936645508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8143281936645508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8148031234741211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8285760879516602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8292088508605957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8292088508605957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8295540809631348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.841982364654541  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8426346778869629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8426346778869629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8429074287414551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8546357154846191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8551387786865234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8551387786865234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8553199768066406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8643798828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8650431632995605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8650431632995605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8652300834655762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8758845329284668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8764486312866211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8764486312866211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8765935897827148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8858709335327148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8865194320678711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8865194320678711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.886662483215332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8968191146850586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8972868919372559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8972868919372559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8973841667175293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9049715995788574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9054765701293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9054765701293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9055681228637695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9133501052856445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9139041900634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9139041900634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9139957427978516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9224185943603516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9227633476257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9227633476257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.922818660736084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9282946586608887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9288005828857422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9288005828857422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9288711547851562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9363517761230469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9367780685424805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9367780685424805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9368352890014648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9433012008666992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.943730354309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.943730354309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9437837600708008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9501924514770508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.950563907623291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.950563907623291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9506077766418457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.956179141998291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9568147659301758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9568147659301758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.956883430480957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9660844802856445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9663386344909668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9663386344909668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.966367244720459  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9704012870788574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9708313941955566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9708313941955566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9708733558654785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.977083683013916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9773802757263184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9773802757263184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9774088859558105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9818434715270996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9820060729980469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9820060729980469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9820213317871094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9844932556152344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9847397804260254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9847397804260254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9847607612609863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9883065223693848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([321, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.996009349822998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.996009349822998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9966216087341309  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1052289009094238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 321, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0863699913024902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0867867469787598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0872035026550293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0867657661437988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2794, 40])
input nodes number: 12387
output nodes number: 2794
edges number: 22172
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0868768692016602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0868773460388184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02520895004272461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 31 input nodes size: 37559
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022774219512939453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022774219512939453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.040683746337890625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04070472717285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.023900985717773438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02508831024169922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02508831024169922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02508831024169922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([37559, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02508831024169922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([487, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08731269836425781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08731269836425781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08777713775634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0914926528930664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([595, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0918278694152832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0918278694152832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09239530563354492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10227632522583008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([519, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10273504257202148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10273504257202148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10322999954223633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11434221267700195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([469, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1149892807006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1149892807006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11543655395507812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12840747833251953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([475, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1293163299560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1293163299560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12976932525634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14607715606689453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([456, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1471552848815918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1471552848815918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14759016036987305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1662898063659668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([487, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16769790649414062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16769790649414062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16816234588623047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19138431549072266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([440, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19283056259155273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19283056259155273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19325017929077148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21716833114624023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([459, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21892833709716797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21892833709716797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21936607360839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24738121032714844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([10556, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2974972724914551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2974972724914551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 10556, 128]), torch.Size([1, 10556, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30756425857543945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0235142707824707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 10556, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9646148681640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9788656234741211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9931163787841797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9787540435791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([14943, 256])
first layer input nodes number: 37559
first layer output nodes number: 14943
edges number: 126841
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9933981895446777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0076489448547363  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0120797157287598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0120797157287598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([318, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0440020561218262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0440020561218262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0446085929870605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0499153137207031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([299, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.050187110900879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.050187110900879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0507574081420898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0601835250854492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([214, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0605158805847168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0605158805847168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0609240531921387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.06990385055542  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([144, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0702533721923828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0702533721923828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0705280303955078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0784931182861328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([136, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0790095329284668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0790095329284668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0792689323425293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0886073112487793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0891294479370117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0891294479370117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0893449783325195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0986127853393555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([89, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0991039276123047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0991039276123047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.099273681640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1077613830566406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([69, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1082072257995605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1082072257995605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1083388328552246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1158404350280762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1164493560791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1164493560791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.116598129272461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.126119613647461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1266989707946777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1266989707946777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.126828670501709  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1360373497009277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.136702060699463  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.136702060699463  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.136833667755127  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1470990180969238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1477022171020508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1477022171020508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.147812843322754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1572160720825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.157660961151123  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.157660961151123  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1577372550964355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1647562980651855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1653237342834473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1653237342834473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1654095649719238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1739068031311035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1742534637451172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1742534637451172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1743049621582031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1797637939453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1802458763122559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1802458763122559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1803088188171387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1874213218688965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1879944801330566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1879944801330566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1880650520324707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1965336799621582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1970696449279785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1970696449279785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1971325874328613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2051262855529785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2058439254760742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2058439254760742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2059221267700195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2164011001586914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2169389724731445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2169389724731445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.216996192932129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2250642776489258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2255001068115234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2255001068115234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2255439758300781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2320365905761719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2325859069824219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2325859069824219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2326374053955078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2406196594238281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2409920692443848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2409920692443848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2410264015197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2465882301330566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.247148036956787  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.247148036956787  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2471957206726074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2552542686462402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([725, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.272651195526123  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.272651195526123  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.274034023284912  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5311789512634277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 725, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5017967224121094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5022082328796387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.502619743347168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5021872520446777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2759, 40])
input nodes number: 14943
output nodes number: 2759
edges number: 32405
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.502314567565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5023150444030762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027158737182617188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03270912170410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03270912170410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009147852659225464 |0.011924490332603455 |0.13018933683633804 |8.589774370193481e-05 |0.07622463256120682 |0.005892038345336914 |
----------------------------------------------------------pseudo_mini_loss sum 5.336206436157227
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1128181
Number of first layer input nodes during this epoch:  808811
Number of first layer output nodes during this epoch:  319370
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03270864486694336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018732547760009766
global_2_local spend time (sec) 0.04813575744628906
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004352569580078125
A = g.adjacency_matrix() spent  0.0076024532318115234
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0845801830291748[05:26:31] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27802158 edges into 32 parts and get 8817985 edge cuts

remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.2939224243164062
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1749629974365234

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18720996, 2.0: 3229533, 3.0: 807748, 4.0: 243722, 5.0: 89337, 6.0: 38108, 7.0: 18016, 8.0: 9112, 9.0: 4890, 10.0: 2746, 11.0: 1644, 12.0: 893, 13.0: 552, 14.0: 337, 15.0: 196, 16.0: 180, 17.0: 140, 18.0: 67, 19.0: 54, 20.0: 11, 21.0: 10})
Convert a graph into a bidirected graph: 1.133 seconds
Metis partitioning: 5.584 seconds
Split the graph: 0.526 seconds
Construct subgraphs: 0.077 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.333848237991333
2836
2913
2894
2883
2789
2779
2808
2917
2889
2901
2927
2858
2917
2880
2922
2903
2816
2798
2790
2766
2759
2758
2758
2927
2794
2877
2872
2801
2759
2778
2874
2798
total k batches seeds list generation spend  19.392069816589355
after graph partition
graph partition algorithm spend time 19.485772848129272
2836
2913
2894
2883
2789
2779
2808
2917
2889
2901
2927
2858
2917
2880
2922
2903
2816
2798
2790
2766
2759
2758
2758
2927
2794
2877
2872
2801
2759
2778
2874
2798
partition_len_list
[6377, 5942, 5575, 5733, 7382, 7553, 7066, 7861, 6090, 7775, 7421, 7637, 5746, 6410, 5056, 5755, 17099, 18344, 14870, 12043, 15987, 17062, 18074, 18269, 8589, 7142, 6825, 8300, 16042, 11163, 8202, 11806]
shared_neighbor_graph_partition_s0 selection method  spend 19.593223810195923
time for parepare:  0.022698640823364258
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0018124580383300781
mini_batch_src_global generation:  0.0011019706726074219
r_  generation:  0.006705760955810547
local_output_nid generation:  0.000835418701171875
local_in_edges_tensor generation:  0.0009851455688476562
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.00742650032043457
local_output_nid generation:  0.0008537769317626953
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.0007750988006591797
r_  generation:  0.006534576416015625
local_output_nid generation:  0.0008299350738525391
local_in_edges_tensor generation:  0.0007474422454833984
mini_batch_src_global generation:  0.0008099079132080078
r_  generation:  0.006715297698974609
local_output_nid generation:  0.0007987022399902344
local_in_edges_tensor generation:  0.0007441043853759766
mini_batch_src_global generation:  0.0008533000946044922
r_  generation:  0.007346153259277344
local_output_nid generation:  0.0008115768432617188
local_in_edges_tensor generation:  0.0006928443908691406
mini_batch_src_global generation:  0.0007658004760742188
r_  generation:  0.006544351577758789
local_output_nid generation:  0.0008299350738525391
local_in_edges_tensor generation:  0.0007092952728271484
mini_batch_src_global generation:  0.0007042884826660156
r_  generation:  0.006143331527709961
local_output_nid generation:  0.0008680820465087891
local_in_edges_tensor generation:  0.0007169246673583984
mini_batch_src_global generation:  0.0007910728454589844
r_  generation:  0.007513761520385742
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0007023811340332031
mini_batch_src_global generation:  0.0007395744323730469
r_  generation:  0.006498813629150391
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0007185935974121094
mini_batch_src_global generation:  0.0008168220520019531
r_  generation:  0.006219387054443359
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0007102489471435547
mini_batch_src_global generation:  0.0008108615875244141
r_  generation:  0.007175445556640625
local_output_nid generation:  0.0008609294891357422
local_in_edges_tensor generation:  0.0006773471832275391
mini_batch_src_global generation:  0.0007109642028808594
r_  generation:  0.006220817565917969
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.0006990432739257812
mini_batch_src_global generation:  0.0006673336029052734
r_  generation:  0.0060956478118896484
local_output_nid generation:  0.0008473396301269531
local_in_edges_tensor generation:  0.0007188320159912109
mini_batch_src_global generation:  0.0007359981536865234
r_  generation:  0.006798505783081055
local_output_nid generation:  0.0008366107940673828
local_in_edges_tensor generation:  0.0006625652313232422
mini_batch_src_global generation:  0.0005970001220703125
r_  generation:  0.005198240280151367
local_output_nid generation:  0.0008349418640136719
local_in_edges_tensor generation:  0.0006661415100097656
mini_batch_src_global generation:  0.0005397796630859375
r_  generation:  0.005096435546875
local_output_nid generation:  0.0008237361907958984
local_in_edges_tensor generation:  0.0007255077362060547
mini_batch_src_global generation:  0.0010213851928710938
r_  generation:  0.008942127227783203
local_output_nid generation:  0.000843048095703125
local_in_edges_tensor generation:  0.0007321834564208984
mini_batch_src_global generation:  0.0013222694396972656
r_  generation:  0.008729934692382812
local_output_nid generation:  0.0008852481842041016
local_in_edges_tensor generation:  0.0007047653198242188
mini_batch_src_global generation:  0.0009286403656005859
r_  generation:  0.007723808288574219
local_output_nid generation:  0.0008835792541503906
local_in_edges_tensor generation:  0.0006778240203857422
mini_batch_src_global generation:  0.0007495880126953125
r_  generation:  0.006263256072998047
local_output_nid generation:  0.0008759498596191406
local_in_edges_tensor generation:  0.0006957054138183594
mini_batch_src_global generation:  0.0008816719055175781
r_  generation:  0.00780034065246582
local_output_nid generation:  0.0008826255798339844
local_in_edges_tensor generation:  0.0007257461547851562
mini_batch_src_global generation:  0.0012063980102539062
r_  generation:  0.009181976318359375
local_output_nid generation:  0.0008885860443115234
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.011198282241821289
local_output_nid generation:  0.0009675025939941406
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.012595891952514648
local_output_nid generation:  0.0009522438049316406
local_in_edges_tensor generation:  0.0007390975952148438
mini_batch_src_global generation:  0.0009217262268066406
r_  generation:  0.006300926208496094
local_output_nid generation:  0.0010406970977783203
local_in_edges_tensor generation:  0.0007245540618896484
mini_batch_src_global generation:  0.0006318092346191406
r_  generation:  0.00552821159362793
local_output_nid generation:  0.0009555816650390625
local_in_edges_tensor generation:  0.000720977783203125
mini_batch_src_global generation:  0.0006766319274902344
r_  generation:  0.005644559860229492
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.0006761550903320312
mini_batch_src_global generation:  0.0006718635559082031
r_  generation:  0.005854606628417969
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0009865760803222656
r_  generation:  0.010680675506591797
local_output_nid generation:  0.0009560585021972656
local_in_edges_tensor generation:  0.0008537769317626953
mini_batch_src_global generation:  0.0008554458618164062
r_  generation:  0.006330966949462891
local_output_nid generation:  0.0010411739349365234
local_in_edges_tensor generation:  0.0007674694061279297
mini_batch_src_global generation:  0.0006830692291259766
r_  generation:  0.00576472282409668
local_output_nid generation:  0.0008881092071533203
local_in_edges_tensor generation:  0.0007033348083496094
mini_batch_src_global generation:  0.0008120536804199219
r_  generation:  0.007165193557739258
----------------------check_connections_block total spend ----------------------------- 0.4011359214782715
generate_one_block  0.0160524845123291
generate_one_block  0.011623620986938477
generate_one_block  0.010133504867553711
generate_one_block  0.010359525680541992
generate_one_block  0.01139211654663086
generate_one_block  0.010094881057739258
generate_one_block  0.009132146835327148
generate_one_block  0.01137995719909668
generate_one_block  0.00955510139465332
generate_one_block  0.009545087814331055
generate_one_block  0.010897397994995117
generate_one_block  0.009272098541259766
generate_one_block  0.00865316390991211
generate_one_block  0.00998544692993164
generate_one_block  0.00738835334777832
generate_one_block  0.007273435592651367
generate_one_block  0.021040678024291992
generate_one_block  0.015475273132324219
generate_one_block  0.012385368347167969
generate_one_block  0.009833574295043945
generate_one_block  0.012924432754516602
generate_one_block  0.014812946319580078
generate_one_block  0.01676177978515625
generate_one_block  0.019878864288330078
generate_one_block  0.009961605072021484
generate_one_block  0.008552312850952148
generate_one_block  0.008028030395507812
generate_one_block  0.008837223052978516
generate_one_block  0.0154876708984375
generate_one_block  0.009735822677612305
generate_one_block  0.009249210357666016
generate_one_block  0.011178731918334961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03632783889770508
gen group dst list time:  0.009533405303955078
time for parepare:  0.023364543914794922
local_output_nid generation:  0.0016903877258300781
local_in_edges_tensor generation:  0.011384963989257812
mini_batch_src_global generation:  0.0015304088592529297
r_  generation:  0.014772653579711914
local_output_nid generation:  0.00176239013671875
local_in_edges_tensor generation:  0.0018842220306396484
mini_batch_src_global generation:  0.0016276836395263672
r_  generation:  0.014143228530883789
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0013573169708251953
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.012639522552490234
local_output_nid generation:  0.0015823841094970703
local_in_edges_tensor generation:  0.001529693603515625
mini_batch_src_global generation:  0.0009889602661132812
r_  generation:  0.01199793815612793
local_output_nid generation:  0.0020673274993896484
local_in_edges_tensor generation:  0.0017731189727783203
mini_batch_src_global generation:  0.001485586166381836
r_  generation:  0.017940521240234375
local_output_nid generation:  0.001965045928955078
local_in_edges_tensor generation:  0.002152681350708008
mini_batch_src_global generation:  0.0016026496887207031
r_  generation:  0.01875448226928711
local_output_nid generation:  0.00417780876159668
local_in_edges_tensor generation:  0.001705169677734375
mini_batch_src_global generation:  0.0013437271118164062
r_  generation:  0.016024351119995117
local_output_nid generation:  0.002118349075317383
local_in_edges_tensor generation:  0.0020079612731933594
mini_batch_src_global generation:  0.0015954971313476562
r_  generation:  0.018358707427978516
local_output_nid generation:  0.0017626285552978516
local_in_edges_tensor generation:  0.0014879703521728516
mini_batch_src_global generation:  0.001180887222290039
r_  generation:  0.01349020004272461
local_output_nid generation:  0.0022444725036621094
local_in_edges_tensor generation:  0.0020203590393066406
mini_batch_src_global generation:  0.0012173652648925781
r_  generation:  0.017149925231933594
local_output_nid generation:  0.0021162033081054688
local_in_edges_tensor generation:  0.0018727779388427734
mini_batch_src_global generation:  0.0014867782592773438
r_  generation:  0.017723560333251953
local_output_nid generation:  0.0021517276763916016
local_in_edges_tensor generation:  0.0018429756164550781
mini_batch_src_global generation:  0.001377105712890625
r_  generation:  0.01749897003173828
local_output_nid generation:  0.0016412734985351562
local_in_edges_tensor generation:  0.0013973712921142578
mini_batch_src_global generation:  0.0011267662048339844
r_  generation:  0.01222538948059082
local_output_nid generation:  0.0018339157104492188
local_in_edges_tensor generation:  0.0015807151794433594
mini_batch_src_global generation:  0.001115560531616211
r_  generation:  0.014304399490356445
local_output_nid generation:  0.0014429092407226562
local_in_edges_tensor generation:  0.0013663768768310547
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.008394718170166016
local_output_nid generation:  0.001598358154296875
local_in_edges_tensor generation:  0.0013768672943115234
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.009974956512451172
local_output_nid generation:  0.004433155059814453
local_in_edges_tensor generation:  0.005400180816650391
mini_batch_src_global generation:  0.0047910213470458984
r_  generation:  0.0485227108001709
local_output_nid generation:  0.0053081512451171875
local_in_edges_tensor generation:  0.00629425048828125
mini_batch_src_global generation:  0.006140470504760742
r_  generation:  0.054877519607543945
local_output_nid generation:  0.004609346389770508
local_in_edges_tensor generation:  0.003989458084106445
mini_batch_src_global generation:  0.004670619964599609
r_  generation:  0.042003631591796875
local_output_nid generation:  0.0038101673126220703
local_in_edges_tensor generation:  0.0034475326538085938
mini_batch_src_global generation:  0.0034651756286621094
r_  generation:  0.032257080078125
local_output_nid generation:  0.004847526550292969
local_in_edges_tensor generation:  0.0042667388916015625
mini_batch_src_global generation:  0.007540225982666016
r_  generation:  0.04582571983337402
local_output_nid generation:  0.005021810531616211
local_in_edges_tensor generation:  0.004597902297973633
mini_batch_src_global generation:  0.005438089370727539
r_  generation:  0.04880785942077637
local_output_nid generation:  0.005135059356689453
local_in_edges_tensor generation:  0.005347251892089844
mini_batch_src_global generation:  0.006129264831542969
r_  generation:  0.053282737731933594
local_output_nid generation:  0.005307912826538086
local_in_edges_tensor generation:  0.0047168731689453125
mini_batch_src_global generation:  0.006640434265136719
r_  generation:  0.054430246353149414
local_output_nid generation:  0.002874612808227539
local_in_edges_tensor generation:  0.002437591552734375
mini_batch_src_global generation:  0.002823352813720703
r_  generation:  0.0224149227142334
local_output_nid generation:  0.0023300647735595703
local_in_edges_tensor generation:  0.002014636993408203
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.015453338623046875
local_output_nid generation:  0.0022110939025878906
local_in_edges_tensor generation:  0.0017838478088378906
mini_batch_src_global generation:  0.0012676715850830078
r_  generation:  0.014809370040893555
local_output_nid generation:  0.002599477767944336
local_in_edges_tensor generation:  0.0020418167114257812
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.019905805587768555
local_output_nid generation:  0.00444483757019043
local_in_edges_tensor generation:  0.00400543212890625
mini_batch_src_global generation:  0.022311687469482422
r_  generation:  0.046985626220703125
local_output_nid generation:  0.0034744739532470703
local_in_edges_tensor generation:  0.0031325817108154297
mini_batch_src_global generation:  0.0032503604888916016
r_  generation:  0.028886079788208008
local_output_nid generation:  0.0025708675384521484
local_in_edges_tensor generation:  0.002185344696044922
mini_batch_src_global generation:  0.0019371509552001953
r_  generation:  0.019447803497314453
local_output_nid generation:  0.003439664840698242
local_in_edges_tensor generation:  0.0028734207153320312
mini_batch_src_global generation:  0.0025260448455810547
r_  generation:  0.0318608283996582
----------------------check_connections_block total spend ----------------------------- 1.332808017730713
generate_one_block  0.026993274688720703
generate_one_block  0.028311967849731445
generate_one_block  0.017932415008544922
generate_one_block  0.016768455505371094
generate_one_block  0.024774551391601562
generate_one_block  0.023724794387817383
generate_one_block  0.021140575408935547
generate_one_block  0.025044918060302734
generate_one_block  0.017781496047973633
generate_one_block  0.023561477661132812
generate_one_block  0.024616718292236328
generate_one_block  0.02364659309387207
generate_one_block  0.016222000122070312
generate_one_block  0.019073963165283203
generate_one_block  0.012178659439086914
generate_one_block  0.013619661331176758
generate_one_block  0.06776118278503418
generate_one_block  0.07496881484985352
generate_one_block  0.05723214149475098
generate_one_block  0.044637441635131836
generate_one_block  0.062256574630737305
generate_one_block  0.06846094131469727
generate_one_block  0.07326555252075195
generate_one_block  0.08107995986938477
generate_one_block  0.02920079231262207
generate_one_block  0.024533748626708984
generate_one_block  0.02222466468811035
generate_one_block  0.027241945266723633
generate_one_block  0.06435894966125488
generate_one_block  0.04008293151855469
generate_one_block  0.025719881057739258
generate_one_block  0.04154539108276367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03270864486694336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

connection checking time:  1.332808017730713
block generation total time  1.1399624347686768
average batch blocks generation time:  0.03562382608652115
block dataloader generation time/epoch 23.131426572799683
pseudo mini batch 0 input nodes size: 14899
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029445171356201172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029445171356201172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03654956817626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03657102584838867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018640518188476562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019127845764160156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019127845764160156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019127845764160156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([14899, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019127845764160156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([477, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.040284156799316406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.040284156799316406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04073905944824219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04437828063964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([549, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04467439651489258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04467439651489258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04519796371459961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05305147171020508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([540, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.053562164306640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.053562164306640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0540771484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06572580337524414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([490, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06640291213989258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06640291213989258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06687021255493164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08042192459106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([424, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08119916915893555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08119916915893555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 424, 128]), torch.Size([1, 424, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0816035270690918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0961604118347168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 424, 128])
m.shape torch.Size([383, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09705400466918945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09705400466918945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09741926193237305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11312532424926758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([361, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11414766311645508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11414766311645508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11449193954467773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13170576095581055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([322, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13276195526123047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13276195526123047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13306903839111328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1505727767944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([275, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15159940719604492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15159940719604492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15186166763305664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16864633560180664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 275, 128])
m.shape torch.Size([2556, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18070316314697266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18070316314697266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 2556, 128]), torch.Size([1, 2556, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18339824676513672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35671138763427734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 2556, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3380422592163086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34412384033203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3502054214477539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34407615661621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([6377, 256])
first layer input nodes number: 14899
first layer output nodes number: 6377
edges number: 42711
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35031843185424805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3564000129699707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3582649230957031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3582649230957031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([352, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38050174713134766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38050174713134766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38117313385009766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3870353698730469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([321, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3873171806335449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3873171806335449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38792943954467773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3975868225097656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39814329147338867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39814329147338867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3987135887145996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41188955307006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41253137588500977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41253137588500977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4129910469055176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42632150650024414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4270291328430176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4270291328430176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.427401065826416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44079065322875977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44158506393432617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44158506393432617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4419093132019043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45585203170776367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4566974639892578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4566974639892578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45697784423828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4709968566894531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4717564582824707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4717564582824707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47197961807250977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48469972610473633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48553991317749023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48553991317749023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4857497215270996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4991774559020996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([100, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5000338554382324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5000338554382324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5002245903015137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5137667655944824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([102, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5147747993469238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5147747993469238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5149693489074707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.530144214630127  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5308084487915039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5308084487915039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5309343338012695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5416345596313477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5424590110778809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5424590110778809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5425944328308105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5550532341003418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5557527542114258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5557527542114258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5558614730834961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.566624641418457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5670895576477051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5670895576477051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5671582221984863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5744366645812988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5751867294311523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5751867294311523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5752840042114258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5862760543823242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5868158340454102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5868158340454102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5868844985961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5951242446899414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.595799446105957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.595799446105957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5958776473999023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.605809211730957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.606299877166748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.606299877166748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6063551902770996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.613767147064209  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.614527702331543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.614527702331543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6146059036254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6256322860717773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6261587142944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6261587142944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6262121200561523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6341161727905273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6344914436340332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6344914436340332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6345276832580566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6401448249816895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6404142379760742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6404142379760742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6404390335083008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6444559097290039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6448822021484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6448822021484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6449184417724609  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6510429382324219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([175, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6552300453186035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6552300453186035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6555638313293457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7143101692199707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 175, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6951723098754883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6955952644348145  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6960182189941406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6955738067626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2836, 40])
input nodes number: 6377
output nodes number: 2836
edges number: 22653
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6956543922424316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.695655345916748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020082950592041016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 1 input nodes size: 12956
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018652915954589844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018652915954589844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025220394134521484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025242328643798828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018116474151611328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018610477447509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018610477447509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018610477447509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([12956, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018610477447509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([357, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03908729553222656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03908729553222656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.039427757263183594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.042151451110839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([426, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04238748550415039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04238748550415039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04279375076293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04888772964477539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([445, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04932117462158203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04932117462158203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04974555969238281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05908203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([434, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.059697628021240234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.059697628021240234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06011152267456055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07211446762084961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([418, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07290410995483398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07290410995483398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0733027458190918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08765363693237305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([405, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08861303329467773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08861303329467773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 405, 128]), torch.Size([1, 405, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08899927139282227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10560750961303711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 405, 128])
m.shape torch.Size([343, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10692739486694336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10692739486694336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1072545051574707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12361001968383789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([323, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1246786117553711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1246786117553711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12498664855957031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14254474639892578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([236, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1434035301208496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1434035301208496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14362859725952148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15803289413452148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([2555, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1701035499572754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1701035499572754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 2555, 128]), torch.Size([1, 2555, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17254018783569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3458085060119629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 2555, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32753705978393555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3332037925720215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3388705253601074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3331594467163086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([5942, 256])
first layer input nodes number: 12956
first layer output nodes number: 5942
edges number: 41459
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33896923065185547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3446359634399414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3460526466369629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3460526466369629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([286, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37027454376220703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37027454376220703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3708200454711914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37598752975463867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([304, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3762993812561035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3762993812561035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3768792152404785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3863048553466797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.386782169342041  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.386782169342041  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38728952407836914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39919042587280273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39983272552490234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39983272552490234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40027713775634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4131650924682617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4140148162841797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4140148162841797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4144401550292969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4297523498535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([215, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43077993392944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43077993392944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43119001388549805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4488234519958496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([161, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44970178604125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44970178604125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4500088691711426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4653630256652832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([141, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4662938117980957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4662938117980957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46656274795532227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48189210891723633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4826231002807617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4826231002807617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48281383514404297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49502086639404297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([123, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4961080551147461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4961080551147461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49634265899658203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5129995346069336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5140666961669922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5140666961669922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5142803192138672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5309429168701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5315976142883301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5315976142883301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5317234992980957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5424237251281738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5432982444763184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5432982444763184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5434412956237793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5566020011901855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5574321746826172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5574321746826172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5575599670410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5702114105224609  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5707530975341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5707530975341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5708332061767578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5793247222900391  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5799922943115234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5799922943115234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5800800323486328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5899944305419922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5908493995666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5908493995666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5909543037414551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6035428047180176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6040439605712891  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6040439605712891  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6041049957275391  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6118564605712891  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6123008728027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6123008728027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6123504638671875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6189956665039062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6197013854980469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6197013854980469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6197738647460938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6299934387207031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6305627822875977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6305627822875977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.630620002746582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6390886306762695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6395678520202637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6395678520202637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6396136283874512  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6467089653015137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6470842361450195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6470842361450195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6471185684204102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6526803970336914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6531939506530762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6531939506530762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6532378196716309  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.660651683807373  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([207, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6656036376953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6656036376953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6659984588623047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7354869842529297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 207, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7143607139587402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7147951126098633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7152295112609863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7147731781005859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2913, 40])
input nodes number: 5942
output nodes number: 2913
edges number: 24781
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.714850902557373  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7148513793945312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019564151763916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 2 input nodes size: 11653
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018127918243408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018127918243408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02368450164794922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.023706436157226562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017117023468017578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017548084259033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017548084259033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017548084259033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([11653, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017548084259033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([485, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.035289764404296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.035289764404296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.035752296447753906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.039452552795410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([522, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0397191047668457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0397191047668457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.040216922760009766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04819679260253906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([538, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.048717498779296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.048717498779296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04923057556152344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0605463981628418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([465, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06117677688598633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06117677688598633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.061620235443115234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07448053359985352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([372, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07514572143554688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07514572143554688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07550048828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0882720947265625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([341, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08907032012939453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08907032012939453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08939552307128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1033792495727539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([293, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10419464111328125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10419464111328125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 293, 128]), torch.Size([1, 293, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10447406768798828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11844539642333984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 293, 128])
m.shape torch.Size([288, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11940431594848633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11940431594848633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11967897415161133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13533449172973633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([265, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13633441925048828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13633441925048828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 265, 128]), torch.Size([1, 265, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13658714294433594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15276145935058594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 265, 128])
m.shape torch.Size([2006, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1622004508972168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1622004508972168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 2006, 128]), torch.Size([1, 2006, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16411352157592773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3019442558288574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 2006, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.28730249404907227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2926192283630371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29793596267700195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29257726669311523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([5575, 256])
first layer input nodes number: 11653
first layer output nodes number: 5575
edges number: 35709
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29802513122558594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3033418655395508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3055753707885742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3055753707885742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([357, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3272581100463867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3272581100463867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3279390335083008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3333864212036133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([344, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.333707332611084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.333707332611084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3343634605407715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34433507919311523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3448982238769531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3448982238769531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3454875946044922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35857152938842773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([270, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3593168258666992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3593168258666992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3598318099975586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3751959800720215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37590932846069336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37590932846069336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3762946128845215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.390164852142334  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3909468650817871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3909468650817871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3912692070007324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40512990951538086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40593767166137695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40593767166137695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40621232986450195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41994524002075195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([139, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42087697982788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42087697982788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4211421012878418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43625402450561523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([134, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43728065490722656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43728065490722656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43753623962402344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45389366149902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4546213150024414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4546213150024414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4547910690307617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4668436050415039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([93, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4677419662475586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4677419662475586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46791934967041016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48175525665283203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([88, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4826817512512207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4826817512512207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4828495979309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4971165657043457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.497957706451416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.497957706451416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49809885025024414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5110840797424316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5117268562316895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5117268562316895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5118279457092285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5218358039855957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.522376537322998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.522376537322998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5224547386169434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5307440757751465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5312743186950684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5312743186950684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5313448905944824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5393195152282715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5398235321044922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5398235321044922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.539886474609375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5474395751953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5479793548583984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5479793548583984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5480422973632812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5560359954833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5565524101257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5565524101257324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5566096305847168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.564277172088623  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5647292137145996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5647292137145996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5647768974304199  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.571500301361084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5719408988952637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5719408988952637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5719847679138184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5784773826599121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.578857421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.578857421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5788936614990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5845108032226562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5848026275634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5848026275634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5848293304443359  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5891551971435547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5894651412963867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5894651412963867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5894918441772461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5940046310424805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([160, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5978360176086426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5978360176086426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5981411933898926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6518521308898926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 160, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6333398818969727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6337714195251465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6342029571533203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6337494850158691  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2894, 40])
input nodes number: 5575
output nodes number: 2894
edges number: 22066
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6338105201721191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6338109970092773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018387317657470703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 3 input nodes size: 11043
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01711416244506836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01711416244506836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02237987518310547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022401809692382812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.016823291778564453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017253398895263672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017253398895263672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017253398895263672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([11043, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017253398895263672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([605, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.034397125244140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.034397125244140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.034974098205566406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.040131568908691406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([687, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04049825668334961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04049825668334961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0411534309387207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05198383331298828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([563, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05246162414550781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05246162414550781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05299854278564453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06481075286865234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([509, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06551313400268555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06551313400268555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06599855422973633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08007574081420898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([416, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0808248519897461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0808248519897461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0812215805053711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0955038070678711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([341, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09628105163574219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09628105163574219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09660625457763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11058998107910156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([287, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11138534545898438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11138534545898438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11165904998779297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12534427642822266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([253, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12617254257202148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12617254257202148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 253, 128]), torch.Size([1, 253, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12641382217407227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1401667594909668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 253, 128])
m.shape torch.Size([233, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14104604721069336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14104604721069336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 233, 128]), torch.Size([1, 233, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14126825332641602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15548944473266602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 233, 128])
m.shape torch.Size([1839, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16414737701416016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16414737701416016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 1839, 128]), torch.Size([1, 1839, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16590118408203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2904214859008789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 1839, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27643489837646484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2819023132324219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2873697280883789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2818593978881836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([5733, 256])
first layer input nodes number: 11043
first layer output nodes number: 5733
edges number: 34350
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.28745412826538086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2929215431213379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29491472244262695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29491472244262695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3177366256713867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3177366256713867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31850147247314453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32601070404052734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32640695571899414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32640695571899414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3271794319152832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3392148017883301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3396592140197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3396592140197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3402085304260254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3532681465148926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35393571853637695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35393571853637695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.354403018951416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36795473098754883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3687257766723633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3687257766723633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3691244125366211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38347530364990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38411808013916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38411808013916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3843965530395508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39637088775634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3970189094543457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3970189094543457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39724206924438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4084000587463379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4090576171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4090576171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40924835205078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4201202392578125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42093324661254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42093324661254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42113351821899414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43395090103149414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43459129333496094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43459129333496094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4347381591796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44516563415527344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44577980041503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44577980041503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4459037780761719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45557403564453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4563312530517578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4563312530517578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4564666748046875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46797752380371094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46854734420776367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46854734420776367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4686446189880371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47759389877319336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4782719612121582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4782719612121582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4783749580383301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4885716438293457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48908281326293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48908281326293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48915719985961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.497042179107666  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49755859375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49755859375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49762725830078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5053863525390625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5059733390808105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5059733390808105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5060458183288574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5147433280944824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5153303146362305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5153303146362305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5153989791870117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5241193771362305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5246515274047852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5246515274047852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5247106552124023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5326337814331055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5330080986022949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5330080986022949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.533048152923584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5386958122253418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5392208099365234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5392208099365234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5392723083496094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5468940734863281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5473546981811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5473546981811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.547398567199707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5541982650756836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5547513961791992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5547513961791992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5548009872436523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5628347396850586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5632944107055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5632944107055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5633344650268555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.570103645324707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([251, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5767502784729004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5767502784729004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5772290229797363  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6614880561828613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 251, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6417903900146484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6422200202941895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6426496505737305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6421980857849121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2883, 40])
input nodes number: 5733
output nodes number: 2883
edges number: 23210
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6422610282897949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6422615051269531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018099308013916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 4 input nodes size: 16591
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01682138442993164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01682138442993164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.024732589721679688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.024753570556640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019465923309326172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020062923431396484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020062923431396484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020062923431396484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([16591, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020062923431396484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([435, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04689598083496094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04689598083496094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.047310829162597656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.050629615783691406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([502, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.050900936126708984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.050900936126708984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05137968063354492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.058560848236083984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([478, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0590052604675293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0590052604675293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.059461116790771484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06948995590209961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([397, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07001924514770508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07001924514770508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07039785385131836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08137750625610352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([420, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08259439468383789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08259439468383789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08299493789672852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09741449356079102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([388, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09832429885864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09832429885864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0986943244934082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11460542678833008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([360, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11562204360961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11562204360961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11596536636352539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1331315040588379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([363, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13434457778930664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13434457778930664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1346907615661621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15442323684692383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([308, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15557193756103516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15557193756103516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15586566925048828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17466449737548828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([3731, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1923084259033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1923084259033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 3731, 128]), torch.Size([1, 3731, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19678306579589844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44941234588623047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 3731, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42507123947143555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4321112632751465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4391512870788574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4320559501647949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7382, 256])
first layer input nodes number: 16591
first layer output nodes number: 7382
edges number: 54395
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43927717208862305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.446317195892334  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44809579849243164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44809579849243164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([321, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47411155700683594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47411155700683594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47472381591796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4808216094970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([294, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4810810089111328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4810810089111328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4816417694091797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49324464797973633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([251, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49368810653686523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49368810653686523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49416685104370117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5046992301940918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([187, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5051789283752441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5051789283752441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5055356025695801  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5158791542053223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([170, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5165181159973145  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5165181159973145  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5168423652648926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5285153388977051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5291666984558105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5291666984558105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5294356346130371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5409998893737793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5417871475219727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5417871475219727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.542048454284668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5551137924194336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([138, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.556732177734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.556732177734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5569953918457031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5719985961914062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5727753639221191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5727753639221191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5729756355285645  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5857930183410645  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5865583419799805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5865583419799805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5867300033569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5989179611206055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([95, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6005806922912598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6005806922912598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.600761890411377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6148953437805176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6157736778259277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6157736778259277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.615933895111084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6295523643493652  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6302971839904785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6302971839904785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6304230690002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6420044898986816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6428971290588379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6428971290588379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6430325508117676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6564393043518066  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6572799682617188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6572799682617188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6574001312255859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6701374053955078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6707849502563477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6707849502563477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.670872688293457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6807870864868164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.681462287902832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.681462287902832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6815462112426758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6916170120239258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6921982765197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6921982765197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6922669410705566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7009873390197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7013916969299316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7013916969299316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7014374732971191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7075715065002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7081637382507324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7081637382507324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7082247734069824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7168307304382324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7173051834106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7173051834106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7173528671264648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7244100570678711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7249574661254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7249574661254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7250089645385742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7329912185668945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.733518123626709  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.733518123626709  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7335658073425293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7412905693054199  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7417511940002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7417511940002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7417912483215332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7485604286193848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([296, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.755652904510498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.755652904510498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7562174797058105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8609251976013184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 296, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8378400802612305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8382558822631836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8386716842651367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8382349014282227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2789, 40])
input nodes number: 7382
output nodes number: 2789
edges number: 25690
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8382973670959473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8382978439331055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02115917205810547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 5 input nodes size: 17323
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01945209503173828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01945209503173828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027712345123291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027733325958251953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01980113983154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02034473419189453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02034473419189453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02034473419189453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([17323, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02034473419189453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([631, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.045569419860839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.045569419860839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04617118835449219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05098533630371094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([619, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.051274776458740234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.051274776458740234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0518651008605957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06134033203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([591, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.061890602111816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.061890602111816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0624542236328125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07556581497192383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([564, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07635974884033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07635974884033203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07689762115478516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09249591827392578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([508, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09386730194091797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09386730194091797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09435176849365234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11179256439208984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([441, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11281204223632812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11281204223632812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11323261260986328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.131317138671875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([391, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13241195678710938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13241195678710938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 391, 128]), torch.Size([1, 391, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13278484344482422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1514291763305664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 391, 128])
m.shape torch.Size([371, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15265798568725586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15265798568725586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15301179885864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17317914962768555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([292, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17425537109375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17425537109375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17453384399414062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19235610961914062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([3145, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2072134017944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2072134017944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 3145, 128]), torch.Size([1, 3145, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21021270751953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42435598373413086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 3145, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4020557403564453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4092588424682617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4164619445800781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40920209884643555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7553, 256])
first layer input nodes number: 17323
first layer output nodes number: 7553
edges number: 50867
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.416593074798584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4237961769104004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4255971908569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4255971908569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.447235107421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.447235107421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44805335998535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4556264877319336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4558882713317871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4558882713317871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45655393600463867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4673647880554199  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46784257888793945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46784257888793945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46837854385375977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48035526275634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4810523986816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4810523986816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48153114318847656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49541473388671875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4960598945617676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4960598945617676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4964108467102051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5090451240539551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5097465515136719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5097465515136719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5100364685058594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5225028991699219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.523226261138916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.523226261138916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5234723091125488  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5357747077941895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5364360809326172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5364360809326172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5366306304931641  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5477199554443359  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5483927726745605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5483927726745605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5485625267028809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5594267845153809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5601205825805664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5601205825805664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5602750778198242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5712442398071289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5719180107116699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5719180107116699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5720534324645996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5826163291931152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5831832885742188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5831832885742188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5832881927490234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5922050476074219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5927400588989258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5927400588989258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.592829704284668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6010770797729492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6016111373901367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6016111373901367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6016931533813477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6098127365112305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6104927062988281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6104927062988281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6105880737304688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.620697021484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6211109161376953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6211109161376953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6211681365966797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6276340484619141  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6281938552856445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6281938552856445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6282625198364258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6365022659301758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6369180679321289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6369180679321289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.636967658996582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6432657241821289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.643770694732666  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.643770694732666  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6438260078430176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.651237964630127  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6517295837402344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6517295837402344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6517810821533203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6590423583984375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6594204902648926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6594204902648926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6594586372375488  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6651043891906738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.66546630859375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.66546630859375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6655006408691406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6708221435546875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6712031364440918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6712031364440918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6712374687194824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6767992973327637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6771512031555176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6771512031555176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6771817207336426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6823391914367676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([246, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6882667541503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6882667541503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6887359619140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7713165283203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 246, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.752723217010498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7531375885009766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7535519599914551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7531166076660156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2779, 40])
input nodes number: 7553
output nodes number: 2779
edges number: 21955
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7531929016113281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7531933784484863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02138233184814453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 6 input nodes size: 16731
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01979970932006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01979970932006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027777671813964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02779865264892578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01951742172241211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020001888275146484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020001888275146484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020001888275146484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([16731, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020001888275146484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([647, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.042346954345703125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.042346954345703125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04296398162841797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0486750602722168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([744, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.049076080322265625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.049076080322265625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.049785614013671875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.061350345611572266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([609, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06186676025390625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06186676025390625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.062447547912597656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0753469467163086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([592, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07618570327758789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07618570327758789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07675027847290039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09403657913208008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([460, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09485101699829102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09485101699829102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09528970718383789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11108255386352539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([458, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11217355728149414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11217355728149414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1126103401184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1313920021057129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([364, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13238859176635742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13238859176635742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1327357292175293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15009260177612305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([305, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15108251571655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15108251571655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15137338638305664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1679530143737793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([297, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1690821647644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1690821647644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16936540603637695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18749284744262695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([2590, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19970130920410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19970130920410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 2590, 128]), torch.Size([1, 2590, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20217132568359375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37754249572753906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 2590, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3581085205078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36484718322753906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3715858459472656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3647942543029785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7066, 256])
first layer input nodes number: 16731
first layer output nodes number: 7066
edges number: 44939
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37171268463134766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3784513473510742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38013601303100586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38013601303100586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([446, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40036773681640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40036773681640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4012184143066406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.408113956451416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([417, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4084906578063965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4084906578063965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4092860221862793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4212164878845215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42171573638916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42171573638916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42230892181396484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4367079734802246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4373650550842285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4373650550842285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.437838077545166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4515557289123535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([178, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45217466354370117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45217466354370117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4525141716003418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4647364616394043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([179, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46568870544433594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46568870544433594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4660301208496094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4807109832763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4814486503601074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4814486503601074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4817061424255371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4945807456970215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49521350860595703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49521350860595703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49540233612060547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5061655044555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5069971084594727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5069971084594727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5072011947631836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5202627182006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5209012031555176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5209012031555176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5210480690002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5314755439758301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5320262908935547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5320262908935547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5321388244628906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5409164428710938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5415983200073242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5415983200073242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5417203903198242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5520963668823242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5525979995727539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5525979995727539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5526838302612305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5605802536010742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5610084533691406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5610084533691406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5610752105712891  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5676841735839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5681266784667969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5681266784667969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5681896209716797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5748615264892578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5752763748168945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5752763748168945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5753316879272461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5815820693969727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5820775032043457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5820775032043457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5821385383605957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5894627571105957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5898303985595703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5898303985595703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.589874267578125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5954456329345703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5959534645080566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5959534645080566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5960087776184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6034207344055176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6037006378173828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6037006378173828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6037311553955078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6080341339111328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6083621978759766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6083621978759766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6083946228027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6131935119628906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6133890151977539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6133890151977539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.613408088684082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6163644790649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6167750358581543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6167750358581543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6168112754821777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6226820945739746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6229181289672852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6229181289672852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6229391098022461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6264848709106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([189, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6310157775878906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6310157775878906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6313762664794922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6948223114013672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 189, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6777181625366211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6781368255615234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6785554885864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6781158447265625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2808, 40])
input nodes number: 7066
output nodes number: 2808
edges number: 19922
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6781940460205078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.678194522857666  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02095508575439453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 7 input nodes size: 15969
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019521713256835938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019521713256835938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027168750762939453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027190685272216797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019191741943359375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0197906494140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0197906494140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0197906494140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([15969, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0197906494140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([534, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04673433303833008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04673433303833008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.047243595123291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.051661014556884766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([603, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.051981449127197266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.051981449127197266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.052556514739990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06137275695800781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([614, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.061963558197021484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.061963558197021484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06254911422729492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07543134689331055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([551, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07712030410766602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07712030410766602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07764577865600586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09288454055786133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([544, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0939188003540039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0939188003540039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0944375991821289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11379337310791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([471, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11488151550292969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11488151550292969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11533069610595703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1346454620361328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([414, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1358027458190918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1358027458190918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13619756698608398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15593862533569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([360, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15801668167114258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15801668167114258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15836000442504883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17792940139770508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([322, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1791396141052246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1791396141052246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17944669723510742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19910001754760742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([3448, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21538782119750977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21538782119750977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 3448, 128]), torch.Size([1, 3448, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21873998641967773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.452207088470459  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 3448, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4281754493713379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4356722831726074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44316911697387695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43561363220214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7861, 256])
first layer input nodes number: 15969
first layer output nodes number: 7861
edges number: 54488
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44329023361206055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4507870674133301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4534168243408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4534168243408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([339, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47945308685302734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47945308685302734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4800996780395508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4857301712036133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([311, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4860048294067383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4860048294067383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48659801483154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4969911575317383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49750232696533203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49750232696533203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49803638458251953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.510197639465332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([227, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5108036994934082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5108036994934082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5112366676330566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5237927436828613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5246291160583496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5246291160583496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5250468254089355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5400843620300293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5408329963684082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5408329963684082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5411496162414551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5547642707824707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5555615425109863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5555615425109863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5558323860168457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5693745613098145  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5701775550842285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5701775550842285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5704102516174316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5836739540100098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5845785140991211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5845785140991211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.584803581237793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.599207878112793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([105, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.600104808807373  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.600104808807373  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6003050804138184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6145243644714355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6151857376098633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6151857376098633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6153230667114258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6260347366333008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6267390251159668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6267390251159668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6268668174743652  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6377291679382324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6384401321411133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6384401321411133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6385583877563477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6494379043579102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6501865386962891  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6501865386962891  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6503009796142578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6616306304931641  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6622657775878906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6622657775878906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6623573303222656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6720619201660156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.672539234161377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.672539234161377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6726040840148926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6799321174621582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6807494163513184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6807494163513184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6808485984802246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6927504539489746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6933064460754395  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6933064460754395  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6933732032775879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7018513679504395  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7022566795349121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7022566795349121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7023024559020996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7084364891052246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7092981338500977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7092981338500977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.709385871887207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7217569351196289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7223186492919922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7223186492919922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7223758697509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7308444976806641  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7311968803405762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7311968803405762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7312312126159668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7365527153015137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7368893623352051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7368893623352051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7369198799133301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7418637275695801  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7422637939453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7422637939453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7422981262207031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7481002807617188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7556371688842773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7556371688842773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.756220817565918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8633766174316406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8412156105041504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8416504859924316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8420853614807129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8416285514831543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2917, 40])
input nodes number: 7861
output nodes number: 2917
edges number: 25754
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8417253494262695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8417258262634277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020926952362060547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 8 input nodes size: 13086
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01920795440673828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01920795440673828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.025447845458984375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02546977996826172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01780080795288086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018234729766845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018234729766845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018234729766845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([13086, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018234729766845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([610, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03663206100463867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03663206100463867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.037213802337646484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.042638301849365234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([688, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04300355911254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04300355911254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04365968704223633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.053998470306396484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([602, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05453157424926758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05453157424926758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05510568618774414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06773614883422852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([537, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06847333908081055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06847333908081055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0689854621887207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08383703231811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([439, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08462762832641602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08462762832641602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08504629135131836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10011816024780273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([381, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1009988784790039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1009988784790039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10136222839355469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11698627471923828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([315, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11800193786621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11800193786621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1183023452758789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13332271575927734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([323, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13440465927124023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13440465927124023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13471269607543945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15227079391479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1532154083251953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1532154083251953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1534595489501953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1690845489501953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([1939, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1782083511352539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1782083511352539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 1939, 128]), torch.Size([1, 1939, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18005752563476562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3119068145751953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 1939, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2961697578430176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30197763442993164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3077855110168457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30193185806274414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([6090, 256])
first layer input nodes number: 13086
first layer output nodes number: 6090
edges number: 36904
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30788516998291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31386661529541016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31514501571655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31514501571655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33601903915405273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33601903915405273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33684873580932617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34424781799316406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([397, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34459638595581055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34459638595581055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3453536033630371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35680532455444336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35729217529296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35729217529296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3578643798828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3716707229614258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37236499786376953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37236499786376953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3728513717651367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38695621490478516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38776063919067383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38776063919067383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3881669044494629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40279245376586914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40352964401245117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40352964401245117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4038405418395996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4172091484069824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4178614616394043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4178614616394043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4180903434753418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4295344352722168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4304966926574707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4304966926574707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43076372146606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4459843635559082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4466557502746582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4466557502746582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44683313369750977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45818567276000977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45901966094970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45901966094970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45920276641845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47220325469970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47289419174194336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47289419174194336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4730353355407715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48404455184936523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48468923568725586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48468923568725586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48480749130249023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4948592185974121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49539995193481445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49539995193481445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49549150466918945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5039143562316895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5045952796936035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5045952796936035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5046982765197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.514894962310791  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5154781341552734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5154781341552734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5155620574951172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5244579315185547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5249543190002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5249543190002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5250210762023926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.532564640045166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5330705642700195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5330705642700195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5331335067749023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5406866073608398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5411396026611328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5411396026611328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5411930084228516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5479755401611328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5484786033630371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5484786033630371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5485339164733887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.555945873260498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5563607215881348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5563607215881348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5564045906066895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5625901222229004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5630731582641602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5630731582641602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5631208419799805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5701780319213867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5705561637878418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5705561637878418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5705924034118652  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.576209545135498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5765895843505859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5765895843505859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5766239166259766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5821857452392578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.582514762878418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.582514762878418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5825433731079102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5873785018920898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([170, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5914492607116699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5914492607116699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.591773509979248  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.648841381072998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 170, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6311917304992676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.631622314453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6320528984069824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6316003799438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2889, 40])
input nodes number: 6090
output nodes number: 2889
edges number: 21150
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6316637992858887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6316642761230469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019090652465820312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 9 input nodes size: 19936
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01779651641845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01779651641845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02730274200439453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.027324676513671875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.021062850952148438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.021575927734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.021575927734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.021575927734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([19936, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.021575927734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04605293273925781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04605293273925781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.046817779541015625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.052936553955078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([808, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05332469940185547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05332469940185547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05409526824951172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06565380096435547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([724, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0663747787475586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0663747787475586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06706523895263672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0829610824584961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([616, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08379077911376953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08379077911376953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08437824249267578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10170459747314453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([560, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10274600982666016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10274600982666016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10328006744384766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1228647232055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([469, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12393951416015625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12393951416015625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12438678741455078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14361953735351562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([378, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14465761184692383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14465761184692383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1450181007385254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16304254531860352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([372, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16428136825561523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16428136825561523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16463613510131836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18485784530639648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([299, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18596363067626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18596363067626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.186248779296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.204498291015625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([2747, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2174544334411621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2174544334411621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 2747, 128]), torch.Size([1, 2747, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22007417678833008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40607595443725586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 2747, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3848857879638672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3923006057739258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3997154235839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.392242431640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7775, 256])
first layer input nodes number: 19936
first layer output nodes number: 7775
edges number: 48451
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39986610412597656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40728092193603516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40978384017944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40978384017944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([503, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43007707595825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43007707595825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43103647232055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4395756721496582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([406, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4398765563964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4398765563964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44065093994140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45259523391723633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4531078338623047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4531078338623047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4537029266357422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46682071685791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4674344062805176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4674344062805176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46788644790649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48099565505981445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48204517364501953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48204517364501953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4824514389038086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49707698822021484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49829721450805664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49829721450805664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49863481521606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5131516456604004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5138106346130371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5138106346130371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.514045238494873  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5257754325866699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.526634693145752  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.526634693145752  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5268769264221191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5406842231750488  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.541419506072998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.541419506072998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5416083335876465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5536932945251465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5543584823608398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5543584823608398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.554509162902832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5652074813842773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5658302307128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5658302307128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5659561157226562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.575775146484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5763354301452637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5763354301452637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5764384269714355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5851931571960449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5857915878295898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5857915878295898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5858907699584961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5950155258178711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5954504013061523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5954504013061523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5955190658569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6023168563842773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6029458045959473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6029458045959473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6030335426330566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6123337745666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6128592491149902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6128592491149902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6129298210144043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6209044456481934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6213107109069824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6213107109069824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6213622093200684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6275420188903809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6280007362365723  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6280007362365723  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.628054141998291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6348366737365723  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6350841522216797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6350841522216797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6351127624511719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.638946533203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.639336109161377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.639336109161377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.639376163482666  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6450238227844238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6452865600585938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6452865600585938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6453132629394531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6492652893066406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6496539115905762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6496539115905762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6496901512145996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6553072929382324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.655665397644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.655665397644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6556978225708008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6609506607055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6612114906311035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6612114906311035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6612343788146973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.665102481842041  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([181, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6694402694702148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6694402694702148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6697854995727539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7305459976196289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 181, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7135367393493652  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7139692306518555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7144017219543457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7139472961425781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2901, 40])
input nodes number: 7775
output nodes number: 2901
edges number: 20304
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7140293121337891  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7140297889709473  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022598743438720703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 10 input nodes size: 18953
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02106475830078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02106475830078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.030102252960205078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.030124187469482422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020596027374267578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02116250991821289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02116250991821289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02116250991821289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([18953, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02116250991821289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([535, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04747629165649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04747629165649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.047986507415771484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.052068233489990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([595, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05238056182861328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05238056182861328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 595, 128]), torch.Size([1, 595, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.052947998046875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06158113479614258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 595, 128])
m.shape torch.Size([569, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06211137771606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06211137771606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06265401840209961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07509183883666992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([529, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07582950592041016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07582950592041016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07633399963378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09096431732177734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([468, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0918278694152832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0918278694152832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09227418899536133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10834169387817383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([373, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10951089859008789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10951089859008789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10986661911010742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12516260147094727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([378, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12624645233154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12624645233154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 378, 128]), torch.Size([1, 378, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12660694122314453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14463138580322266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 378, 128])
m.shape torch.Size([339, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14574432373046875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14574432373046875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14606761932373047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16449546813964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([287, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16556549072265625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16556549072265625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16583919525146484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18335628509521484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([3348, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19918394088745117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19918394088745117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 3348, 128]), torch.Size([1, 3348, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20275068283081055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43355894088745117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 3348, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4095911979675293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4166684150695801  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42374563217163086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4166131019592285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7421, 256])
first layer input nodes number: 18953
first layer output nodes number: 7421
edges number: 51547
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42388916015625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4309663772583008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43280458450317383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43280458450317383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([352, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4568920135498047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4568920135498047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4575634002685547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4635958671569824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46393680572509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46393680572509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46460819244384766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4755377769470215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([306, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47608470916748047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47608470916748047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4766683578491211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48950862884521484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([247, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49016666412353516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49016666412353516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49063777923583984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5043001174926758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5051379203796387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5051379203796387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5055346488952637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5198168754577637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.520576000213623  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.520576000213623  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5208926200866699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5345072746276855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5353312492370605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5353312492370605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5356097221374512  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5495333671569824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5503940582275391  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5503940582275391  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5506420135498047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5647754669189453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.565464973449707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.565464973449707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5656442642211914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5771188735961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([108, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5780673027038574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5780673027038574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5782732963562012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5928988456726074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5936102867126465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5936102867126465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.593757152557373  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6052126884460449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6059584617614746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6059584617614746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6060938835144043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6176047325134277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6182117462158203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6182117462158203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6183147430419922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6277904510498047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6284794807434082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6284794807434082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6285843849182129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.638969898223877  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6397395133972168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6397395133972168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6398482322692871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6513724327087402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6517949104309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6517949104309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6518540382385254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6585354804992676  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6591272354125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6591272354125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6591997146606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6678972244262695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6683974266052246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6683974266052246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6684565544128418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6759657859802246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6762652397155762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6762652397155762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6762995719909668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6809000968933105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.681363582611084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.681363582611084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6814112663269043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6881346702575684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6887164115905762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6887164115905762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6887736320495605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.697242259979248  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6977634429931641  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6977634429931641  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6978130340576172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7054996490478516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.705784797668457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.705784797668457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7058115005493164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7101373672485352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7105855941772461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7105855941772461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7106237411499023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7170705795288086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([271, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7235631942749023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7235631942749023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7240800857543945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8189477920532227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 271, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.797968864440918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7984051704406738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7988414764404297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7983832359313965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2927, 40])
input nodes number: 7421
output nodes number: 2927
edges number: 24333
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.798464298248291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7984647750854492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022255420684814453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 11 input nodes size: 19280
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020599842071533203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020599842071533203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029793262481689453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.029814720153808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020755290985107422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02126932144165039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02126932144165039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02126932144165039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([19280, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02126932144165039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([657, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.045722007751464844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.045722007751464844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04634857177734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05202007293701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([700, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05237436294555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05237436294555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.053041934967041016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06369256973266602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([717, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06438446044921875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06438446044921875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06506824493408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08011150360107422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([606, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08092546463012695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08092546463012695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08150339126586914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09917116165161133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 606, 128])
m.shape torch.Size([572, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10024595260620117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10024595260620117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10079145431518555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12081670761108398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([455, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12184572219848633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12184572219848633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12227964401245117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14093828201293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([397, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14204645156860352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14204645156860352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1424250602722168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16135549545288086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([394, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16266918182373047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16266918182373047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16304492950439453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1844625473022461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([305, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18558359146118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18558359146118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18587446212768555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20449018478393555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([2834, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21785831451416016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21785831451416016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 2834, 128]), torch.Size([1, 2834, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22056102752685547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4185762405395508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 2834, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39723730087280273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40452051162719727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4118037223815918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4044632911682129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7637, 256])
first layer input nodes number: 19280
first layer output nodes number: 7637
edges number: 49238
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41194963455200195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4192328453063965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4210538864135742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4210538864135742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44126272201538086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44126272201538086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4420638084411621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4493722915649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([384, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4497098922729492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4497098922729492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4504423141479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46240854263305664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([354, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4631361961364746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4631361961364746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46381139755249023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47896814346313477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([277, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4799623489379883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4799623489379883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48049068450927734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4966745376586914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([226, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4974966049194336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4974966049194336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4979276657104492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5134458541870117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5141878128051758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5141878128051758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5145044326782227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5281190872192383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5288758277893066  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5288758277893066  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5291352272033691  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5421051979064941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5428981781005859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5428981781005859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5431270599365234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5561733245849609  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5569500923156738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5569500923156738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5571465492248535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5697197914123535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5704293251037598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5704293251037598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.570589542388916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5819649696350098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5824241638183594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5824241638183594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5825214385986328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5901088714599609  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5907063484191895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5907063484191895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.590813159942627  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5998921394348145  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6006135940551758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6006135940551758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6007318496704102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6116113662719727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6121578216552734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6121578216552734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.61224365234375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6207408905029297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6214189529418945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6214189529418945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6215143203735352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6316232681274414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6320834159851074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6320834159851074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6321463584899902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.639258861541748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6397833824157715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6397833824157715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6398482322692871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6476302146911621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6480307579040527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6480307579040527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.648078441619873  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6541342735290527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6544756889343262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6544756889343262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6545138359069824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6596255302429199  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6599717140197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6599717140197754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6600079536437988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6651177406311035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6653623580932617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6653623580932617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6653871536254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6690568923950195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6691718101501465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6691718101501465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6691832542419434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.670957088470459  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6711945533752441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6711945533752441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6712155342102051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.674614429473877  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6749038696289062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6749038696289062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6749286651611328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6791191101074219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([150, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.682711124420166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.682711124420166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6829972267150879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7333512306213379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 150, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7163295745849609  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7167558670043945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7171821594238281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7167344093322754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2858, 40])
input nodes number: 7637
output nodes number: 2858
edges number: 19618
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7168030738830566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7168035507202148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.022268295288085938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 12 input nodes size: 11339
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020745277404785156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.020745277404785156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02615213394165039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.026174068450927734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.016959190368652344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017350196838378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017350196838378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017350196838378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([11339, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017350196838378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([618, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033942222595214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033942222595214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.034531593322753906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0394139289855957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([662, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03975057601928711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03975057601928711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04038190841674805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04985189437866211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([607, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05040454864501953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05040454864501953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.050983428955078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06404542922973633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([570, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06484317779541016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06484317779541016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06538677215576172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0812826156616211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([465, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08211946487426758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08211946487426758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08256292343139648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09852743148803711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([390, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09942150115966797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09942150115966797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0997934341430664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11578655242919922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([337, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11672544479370117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11672544479370117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11704683303833008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1331162452697754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([295, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1340808868408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1340808868408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 295, 128]), torch.Size([1, 295, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13436222076416016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15039825439453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 295, 128])
m.shape torch.Size([254, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15134763717651367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15134763717651367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15158987045288086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16709280014038086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([1548, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17435312271118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17435312271118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 1548, 128]), torch.Size([1, 1548, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17582941055297852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.28098535537719727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 1548, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2670450210571289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2725248336791992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27800464630126953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27248191833496094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([5746, 256])
first layer input nodes number: 11339
first layer output nodes number: 5746
edges number: 33193
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2780914306640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2835712432861328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2853870391845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2853870391845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([431, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30426883697509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30426883697509766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30509090423583984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3121824264526367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([394, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3125290870666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3125290870666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3132805824279785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32545042037963867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([345, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32631969451904297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32631969451904297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3269777297973633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3418254852294922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([273, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3425464630126953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3425464630126953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3430671691894531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3583188056945801  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3590054512023926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3590054512023926  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35938119888305664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3729081153869629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([188, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37380456924438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37380456924438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3741631507873535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38958215713500977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([175, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3905806541442871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3905806541442871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3909144401550293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40760374069213867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40851354598999023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40851354598999023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.408780574798584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42400121688842773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([131, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4250011444091797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4250011444091797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4252510070800781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4412422180175781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4420018196105957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4420018196105957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44217729568481445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4546360969543457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45533084869384766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45533084869384766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4554719924926758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46648120880126953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46726417541503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46726417541503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4674053192138672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4794025421142578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4800567626953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4800567626953125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4801673889160156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4903450012207031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49088191986083984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49088191986083984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4909658432006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49927425384521484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49980926513671875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49980926513671875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49988555908203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5079727172851562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5084576606750488  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5084576606750488  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5085225105285645  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5158505439758301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5161290168762207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5161290168762207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5161652565002441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5205140113830566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5209112167358398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5209112167358398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5209569931030273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5267705917358398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5272226333618164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5272226333618164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5272722244262695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5339174270629883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5343155860900879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5343155860900879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5343575477600098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5402741432189941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5405764579772949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5405764579772949  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5406069755554199  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5451235771179199  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5453624725341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5453624725341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5453853607177734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5489330291748047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.549187183380127  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.549187183380127  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5492100715637207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5529179573059082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5530910491943359  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5530910491943359  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5531063079833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5556850433349609  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([88, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5577921867370605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5577921867370605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.557960033416748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.587501049041748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 88, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5719294548034668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.572364330291748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5727992057800293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5723423957824707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2917, 40])
input nodes number: 5746
output nodes number: 2917
edges number: 19076
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.572415828704834  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5724163055419922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018139362335205078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 13 input nodes size: 13911
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0169677734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0169677734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.023601055145263672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.023622512817382812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018193721771240234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018668651580810547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018668651580810547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018668651580810547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([13911, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018668651580810547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([589, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.039032936096191406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.039032936096191406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03959465026855469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.044302940368652344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([623, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0446162223815918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0446162223815918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04521036148071289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05477619171142578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([583, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0553131103515625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0553131103515625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.055869102478027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0681009292602539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([492, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06876134872436523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06876134872436523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06923055648803711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08283758163452148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([487, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08389043807983398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08389043807983398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08435487747192383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1010746955871582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([403, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10199546813964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10199546813964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10237979888916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11890602111816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([341, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11985206604003906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11985206604003906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1201772689819336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13643741607666016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([322, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13750314712524414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13750314712524414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13781023025512695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15531396865844727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([282, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1563706398010254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1563706398010254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 282, 128]), torch.Size([1, 282, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15663957595825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17385149002075195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 282, 128])
m.shape torch.Size([2288, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18462705612182617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18462705612182617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 2288, 128]), torch.Size([1, 2288, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18680906295776367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34173154830932617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 2288, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3240385055541992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3301515579223633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33626461029052734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33010339736938477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([6410, 256])
first layer input nodes number: 13911
first layer output nodes number: 6410
edges number: 40786
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33637046813964844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3424835205078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3441171646118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3441171646118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3665652275085449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3665652275085449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.367337703704834  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37418031692504883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37450170516967773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37450170516967773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37520360946655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38585329055786133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3863358497619629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3863358497619629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3868870735168457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39960145950317383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4001913070678711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4001913070678711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4006204605102539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41306591033935547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41393566131591797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41393566131591797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4143400192260742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4288969039916992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4295659065246582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4295659065246582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4298539161682129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44223833084106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4430093765258789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4430093765258789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4432687759399414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4562387466430664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45710134506225586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45710134506225586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45734739303588867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.471372127532959  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47211456298828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47211456298828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4723052978515625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4845123291015625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([104, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48541688919067383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48541688919067383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48561525344848633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49969911575317383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([93, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5005831718444824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5005831718444824  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.500760555267334  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5145964622497559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.515200138092041  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.515200138092041  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5153145790100098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5250420570373535  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5256848335266113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5256848335266113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5257916450500488  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5356183052062988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5361976623535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5361976623535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5362873077392578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5451622009277344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5457377433776855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5457377433776855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5458197593688965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5545134544372559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5551648139953613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5551648139953613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5552506446838379  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5649495124816895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5652990341186523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5652990341186523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5653448104858398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5708379745483398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5712823867797852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5712823867797852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5713338851928711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5778741836547852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5784697532653809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5784697532653809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5785346031188965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5872244834899902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5877304077148438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5877304077148438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5877838134765625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5953140258789062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5956106185913086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5956106185913086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5956411361694336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6001577377319336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6005868911743164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6005868911743164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6006269454956055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6068353652954102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6071691513061523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6071691513061523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6071996688842773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6121435165405273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6124973297119141  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6124973297119141  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6125278472900391  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6176853179931641  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([235, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.623316764831543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.623316764831543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6237649917602539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7026529312133789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 235, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6833415031433105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6837706565856934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6841998100280762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6837491989135742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2880, 40])
input nodes number: 6410
output nodes number: 2880
edges number: 22817
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6838130950927734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6838135719299316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.019589900970458984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 14 input nodes size: 7892
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018187999725341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018187999725341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02195119857788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.021973133087158203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01531839370727539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015620708465576172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015620708465576172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015620708465576172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([7892, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015620708465576172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([766, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02822589874267578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02822589874267578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 766, 128]), torch.Size([1, 766, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02895641326904297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03480052947998047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 766, 128])
m.shape torch.Size([798, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03519630432128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03519630432128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03595733642578125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04752922058105469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([655, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.048085689544677734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.048085689544677734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04871034622192383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06245279312133789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([511, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06311511993408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06311511993408203  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.06360244750976562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07773494720458984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([425, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07850456237792969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07850456237792969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07890987396240234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09350109100341797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([361, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09433126449584961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09433126449584961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09467554092407227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10947942733764648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([305, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11032533645629883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11032533645629883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11061620712280273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12515974044799805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([219, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12584972381591797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12584972381591797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 219, 128]), torch.Size([1, 219, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12605857849121094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13796329498291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 219, 128])
m.shape torch.Size([182, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1386399269104004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1386399269104004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 182, 128]), torch.Size([1, 182, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13881349563598633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14992189407348633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 182, 128])
m.shape torch.Size([834, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15381193161010742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15381193161010742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15460729598999023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21152067184448242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 834, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20157146453857422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20639324188232422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21121501922607422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20635557174682617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([5056, 256])
first layer input nodes number: 7892
first layer output nodes number: 5056
edges number: 24527
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21127605438232422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21609783172607422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21733570098876953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21733570098876953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([546, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23328685760498047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23328685760498047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2343282699584961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24356746673583984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 546, 256])
m.shape torch.Size([486, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24398136138916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24398136138916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24490833282470703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.25881290435791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([367, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2596750259399414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2596750259399414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2603750228881836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2763681411743164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2769947052001953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2769947052001953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2774791717529297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29152870178222656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([248, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2924785614013672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2924785614013672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2929515838623047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3099803924560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([191, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31084537506103516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31084537506103516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31120967864990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3268747329711914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([161, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3277759552001953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3277759552001953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3280830383300781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34343719482421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34421443939208984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34421443939208984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34444522857666016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35760021209716797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35819435119628906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35819435119628906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3583507537841797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3683605194091797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36904191970825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36904191970825195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36919260025024414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37989091873168945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3804183006286621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3804183006286621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3805270195007324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3890070915222168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3896217346191406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3896217346191406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38973236083984375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3991355895996094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39954280853271484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39954280853271484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3996133804321289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40610599517822266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40648794174194336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40648794174194336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40654706954956055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4124007225036621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4129047393798828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4129047393798828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4129753112792969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4204559326171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.420682430267334  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.420682430267334  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4207148551940918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4243788719177246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4248366355895996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4248366355895996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42489194869995117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43152952194213867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4317617416381836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4317617416381836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4317903518676758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4354238510131836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43562889099121094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43562889099121094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4356517791748047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4387187957763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43880367279052734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43880367279052734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4388132095336914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4401578903198242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4404158592224121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4404158592224121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44044065475463867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4441103935241699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44430971145629883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44430971145629883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44432878494262695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44728517532348633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44747495651245117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44747495651245117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4474921226501465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4502730369567871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.450472354888916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.450472354888916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45048952102661133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45339059829711914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([48, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45453548431396484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45453548431396484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45462703704833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47074031829833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45822906494140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4586648941040039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45910072326660156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45864295959472656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2922, 40])
input nodes number: 5056
output nodes number: 2922
edges number: 15916
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4587092399597168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.458709716796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.016254425048828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 15 input nodes size: 11988
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015325069427490234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.015325069427490234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.021041393280029297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.02106332778930664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017278194427490234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01761484146118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01761484146118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01761484146118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([11988, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.01761484146118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([869, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03253173828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03253173828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03336048126220703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04043865203857422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([824, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04081010818481445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.04081010818481445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0415959358215332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05338335037231445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([690, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05433511734008789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05433511734008789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0549931526184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07052326202392578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([577, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07129478454589844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07129478454589844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07184505462646484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08780288696289062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([453, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08880376815795898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08880376815795898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08923578262329102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10478830337524414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([352, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10557937622070312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10557937622070312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10591506958007812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12034988403320312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([315, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12123346328735352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12123346328735352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12153387069702148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13655424118041992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([264, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13741111755371094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13741111755371094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1376628875732422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15201377868652344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([212, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15279769897460938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15279769897460938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 212, 128]), torch.Size([1, 212, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1529998779296875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1659393310546875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 212, 128])
m.shape torch.Size([1199, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1715555191040039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1715555191040039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 1199, 128]), torch.Size([1, 1199, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.172698974609375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.25388431549072266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 1199, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2418818473815918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24737024307250977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.25285863876342773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24732732772827148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([5755, 256])
first layer input nodes number: 11988
first layer output nodes number: 5755
edges number: 29487
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.25295019149780273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2584385871887207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2600393295288086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2600393295288086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([602, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2756481170654297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2756481170654297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2767963409423828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2872171401977539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([471, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2875485420227051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2875485420227051  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.28844690322875977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30257749557495117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([358, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3033723831176758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3033723831176758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.30405521392822266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31996726989746094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([294, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32087087631225586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32087087631225586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.32143163681030273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33802127838134766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([239, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33888959884643555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33888959884643555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33934545516967773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3557562828063965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35643959045410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35643959045410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35674095153808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.36969947814941406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3705449104309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3705449104309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.37082719802856445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38494157791137695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3856234550476074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3856234550476074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.38582754135131836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3974604606628418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39809370040893555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.39809370040893555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3982558250427246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4086318016052246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4092235565185547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4092235565185547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.40935707092285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4188365936279297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41928815841674805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41928815841674805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.41938161849975586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.42667150497436523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4270634651184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4270634651184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4271359443664551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.43329668045043945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4337477684020996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4337477684020996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4338221549987793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44066572189331055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4410862922668457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4410862922668457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44115114212036133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4475712776184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4480724334716797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4480724334716797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.44814300537109375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4556236267089844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45586538314819336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.45586538314819336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.455899715423584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4597792625427246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46013832092285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46013832092285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46018218994140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.46544647216796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4657707214355469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4657707214355469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4658088684082031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4706535339355469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47083568572998047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47083568572998047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4708566665649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47366809844970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4738306999206543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4738306999206543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4738478660583496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47626829147338867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4764213562011719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4764213562011719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4764366149902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4786949157714844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47885656356811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47885656356811523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.47887182235717773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48123693466186523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48140621185302734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48140621185302734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48142147064208984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48389339447021484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48404741287231445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48404741287231445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48406076431274414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48631715774536133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([62, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48780059814453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.48780059814453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4879188537597656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.5087318420410156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4965825080871582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.49701547622680664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4974484443664551  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4969935417175293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2903, 40])
input nodes number: 5755
output nodes number: 2903
edges number: 15501
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4970555305480957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.4970560073852539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.018316268920898438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 16 input nodes size: 45595
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017275333404541016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.017275333404541016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0390167236328125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03903770446777344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03329944610595703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.034598350524902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.034598350524902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.034598350524902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([45595, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.034598350524902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([616, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1048426628112793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1048426628112793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10543012619018555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11154890060424805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([687, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11191034317016602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11191034317016602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 687, 128]), torch.Size([1, 687, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11256551742553711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12239313125610352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 687, 128])
m.shape torch.Size([645, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12298822402954102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12298822402954102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 645, 128]), torch.Size([1, 645, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12360334396362305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13808012008666992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 645, 128])
m.shape torch.Size([612, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13893985748291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13893985748291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13952350616455078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15652179718017578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([639, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15775346755981445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15775346755981445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15836286544799805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18030118942260742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([557, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18159008026123047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18159008026123047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18212127685546875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2054004669189453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([565, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20702075958251953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20702075958251953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20755958557128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23523569107055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([522, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23695755004882812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23695755004882812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2374553680419922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.26645326614379883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([492, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.26831579208374023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.26831579208374023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2687849998474121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2988142967224121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([11764, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3546748161315918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3546748161315918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11764, 128]), torch.Size([1, 11764, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3661208152770996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1626715660095215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11764, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0968103408813477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1131172180175781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1294240951538086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1129894256591797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([17099, 256])
first layer input nodes number: 45595
first layer output nodes number: 17099
edges number: 143109
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1297659873962402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1460728645324707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1501498222351074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1501498222351074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([332, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1804008483886719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1804008483886719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1810340881347656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.186507225036621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([298, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1867637634277344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1867637634277344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1873321533203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1971111297607422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([228, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1974844932556152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1974844932556152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1979193687438965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.207486629486084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([194, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2080154418945312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2080154418945312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2083854675292969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2191162109375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2196569442749023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2196569442749023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.219944953918457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2303133010864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([110, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2308039665222168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2308039665222168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2310137748718262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2400355339050293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([86, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2405095100402832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2405095100402832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.240673542022705  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2488751411437988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2494621276855469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2494621276855469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2496280670166016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2590866088867188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([63, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2595486640930176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2595486640930176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2596688270568848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2673592567443848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2681164741516113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2681164741516113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2682785987854004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2797894477844238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2804698944091797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2804698944091797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2806072235107422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2913188934326172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2919425964355469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2919425964355469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2920570373535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3017845153808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3024396896362305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3024396896362305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3025484085083008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3125505447387695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.313021183013916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.313021183013916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3130955696105957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3204598426818848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3210573196411133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3210573196411133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.321141242980957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3300371170043945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3305797576904297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3305797576904297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3306522369384766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3388423919677734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3396234512329102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3396234512329102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3397188186645508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3511629104614258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3518767356872559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3518767356872559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3519606590270996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3626189231872559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3632526397705078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3632526397705078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3633232116699219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3727798461914062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3734946250915527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3734946250915527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3735690116882324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3840575218200684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3846464157104492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3846464157104492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3847055435180664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3934564590454102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.393934726715088  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.393934726715088  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3939805030822754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.401075839996338  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4014511108398438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4014511108398438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4014854431152344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4070472717285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4073762893676758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4073762893676758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.407404899597168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4122400283813477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([614, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4269790649414062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4269790649414062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4281501770019531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6440911293029785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 614, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.616544246673584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6169638633728027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6173834800720215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6169428825378418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2816, 40])
input nodes number: 17099
output nodes number: 2816
edges number: 31013
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6170783042907715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6170787811279297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03687095642089844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 17 input nodes size: 49819
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033286094665527344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033286094665527344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05704164505004883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.057062625885009766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.035300254821777344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.036683082580566406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.036683082580566406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.036683082580566406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([49819, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.036683082580566406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([589, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11299371719360352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11299371719360352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1135554313659668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11943340301513672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([693, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11981344223022461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11981344223022461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12047433853149414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1303877830505371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([650, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13098716735839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13098716735839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1316070556640625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14614295959472656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([594, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14696598052978516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14696598052978516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14753246307373047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1642160415649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([642, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16546344757080078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16546344757080078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1660757064819336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18811702728271484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([579, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1894674301147461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1894674301147461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1900196075439453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21394062042236328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([579, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21559715270996094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21559715270996094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21614933013916016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24451541900634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([540, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24629926681518555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24629926681518555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24681425094604492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27708911895751953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([580, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27932071685791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27932071685791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2798738479614258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.31599903106689453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([12898, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3772249221801758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3772249221801758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12898, 128]), torch.Size([1, 12898, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3895254135131836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2826013565063477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12898, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2106704711914062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2281646728515625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2456588745117188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2280278205871582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([18344, 256])
first layer input nodes number: 49819
first layer output nodes number: 18344
edges number: 155558
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2460322380065918  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.263526439666748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.268160343170166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.268160343170166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([326, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.297375202178955  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.297375202178955  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.297996997833252  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.305351734161377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([311, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3056387901306152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3056387901306152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.30623197555542  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3166708946228027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([234, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3170490264892578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3170490264892578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.317495346069336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3273143768310547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([176, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3277678489685059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3277678489685059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3281035423278809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3378386497497559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([162, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.338449478149414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.338449478149414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3387584686279297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3498821258544922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([128, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3504657745361328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3504657745361328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3507099151611328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3612079620361328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([103, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3617792129516602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3617792129516602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3619756698608398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3717985153198242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3724231719970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3724231719970703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3726024627685547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.382822036743164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([68, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3833208084106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3833208084106445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3834505081176758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3917512893676758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.392282485961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.392282485961914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3924007415771484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.400796890258789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4015097618103027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4015097618103027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.401648998260498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4125094413757324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4131436347961426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4131436347961426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4132599830627441  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.423149585723877  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4237165451049805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4237165451049805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.423811912536621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4325857162475586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4331841468811035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4331841468811035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4332756996154785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4423394203186035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4429426193237305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4429426193237305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.443028450012207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4521265029907227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4528217315673828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4528217315673828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4529132843017578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4632587432861328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4638175964355469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4638175964355469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.463888168334961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4723567962646484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4729619026184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4729619026184082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4730324745178223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4819951057434082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4825263023376465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4825263023376465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4825854301452637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4905085563659668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4910941123962402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4910941123962402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4911551475524902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4997611045837402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5005784034729004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5005784034729004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5006585121154785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.512514591217041  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5129609107971191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5129609107971191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5130047798156738  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5198044776916504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.520357608795166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.520357608795166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5204071998596191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5284409523010254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.529062271118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.529062271118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5291156768798828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5381412506103516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([553, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5514025688171387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5514025688171387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.552457332611084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7427010536193848  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 553, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7162165641784668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7166337966918945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7170510292053223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7166128158569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2798, 40])
input nodes number: 18344
output nodes number: 2798
edges number: 29944
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7167682647705078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.716768741607666  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03910064697265625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 18 input nodes size: 43534
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03529787063598633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03529787063598633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05605649948120117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05607748031616211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03230094909667969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03337860107421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03337860107421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03337860107421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([43534, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03337860107421875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([730, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09221315383911133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09221315383911133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09290933609008789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0986475944519043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([770, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09903383255004883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09903383255004883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 770, 128]), torch.Size([1, 770, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09976816177368164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11078310012817383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 770, 128])
m.shape torch.Size([706, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11170244216918945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11170244216918945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 706, 128]), torch.Size([1, 706, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11237573623657227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12796258926391602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 706, 128])
m.shape torch.Size([571, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12871503829956055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12871503829956055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12925958633422852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14580488204956055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([573, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14689874649047852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.14689874649047852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1474452018737793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16719913482666016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([540, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1684708595275879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1684708595275879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.16898584365844727  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19200754165649414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([512, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19345903396606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19345903396606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19394731521606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21836137771606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([492, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21999406814575195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21999406814575195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22046327590942383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2472081184387207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([451, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24890899658203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24890899658203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24933910369873047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27686595916748047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([9525, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3220696449279785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3220696449279785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 9525, 128]), torch.Size([1, 9525, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33115339279174805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9848370552062988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 9525, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9286127090454102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9427938461303711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.956974983215332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9426827430725098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([14870, 256])
first layer input nodes number: 43534
first layer output nodes number: 14870
edges number: 119606
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9573016166687012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9714827537536621  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9755740165710449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9755740165710449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([445, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0000557899475098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0000557899475098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0009045600891113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0076947212219238  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([365, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.007972240447998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.007972240447998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0086684226989746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.020371437072754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.020848274230957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.020848274230957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0213937759399414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0358495712280273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([190, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0363073348999023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0363073348999023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0366697311401367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0471792221069336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([157, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.047752857208252  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.047752857208252  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0480523109436035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0588326454162598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([127, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.059415340423584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.059415340423584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0596575736999512  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0700736045837402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0706725120544434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0706725120544434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0708765983581543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0810809135437012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0817327499389648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0817327499389648  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0819196701049805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.092574119567871  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0932159423828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0932159423828125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0933780670166016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1037540435791016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.104355812072754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.104355812072754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1044912338256836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1141061782836914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1145567893981934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1145567893981934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1146502494812012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1219401359558105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.122528076171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.122528076171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1226329803466797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1315498352050781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.131972312927246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.131972312927246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.132044792175293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1387128829956055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1392555236816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1392555236816406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1393375396728516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1474571228027344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1480507850646973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1480507850646973  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.148134708404541  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1570305824279785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1574039459228516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1574039459228516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1574554443359375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1632747650146484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1637067794799805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1637067794799805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1637601852416992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1701688766479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.170661449432373  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.170661449432373  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1707186698913574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.177985668182373  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1784687042236328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1784687042236328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1785221099853516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.185678482055664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1861133575439453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1861133575439453  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1861591339111328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1926136016845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.193075180053711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.193075180053711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1931209564208984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1998958587646484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.200190544128418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.200190544128418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2002191543579102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2046537399291992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2050156593322754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2050156593322754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2050480842590332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2103009223937988  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2106080055236816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2106080055236816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.210634708404541  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2151474952697754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([423, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2252984046936035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2252984046936035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2261052131652832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3726067543029785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 423, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.351048469543457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3514642715454102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3518800735473633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3514432907104492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2790, 40])
input nodes number: 14870
output nodes number: 2790
edges number: 24899
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3515739440917969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.351574420928955  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.035330772399902344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 19 input nodes size: 39514
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03229951858520508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03229951858520508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05183076858520508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.051851749420166016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031072139739990234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03188371658325195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03188371658325195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03188371658325195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([39514, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03188371658325195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([796, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07587957382202148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07587957382202148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.07663869857788086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08271169662475586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([824, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08311796188354492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08311796188354492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.08390378952026367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09569120407104492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([766, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0965571403503418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0965571403503418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 766, 128]), torch.Size([1, 766, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09728765487670898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11426305770874023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 766, 128])
m.shape torch.Size([698, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11522912979125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11522912979125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11589479446411133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13519906997680664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([597, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1362895965576172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1362895965576172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13685894012451172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15798091888427734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([549, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15926694869995117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15926694869995117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1597905158996582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18305253982543945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([486, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18441295623779297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.18441295623779297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1848764419555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.20805072784423828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([481, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2096538543701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2096538543701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2101125717163086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23625946044921875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([404, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2377638816833496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2377638816833496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.23814916610717773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.26280736923217773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([6442, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29386472702026367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.29386472702026367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 6442, 128]), torch.Size([1, 6442, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.300875186920166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7370686531066895  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 6442, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.6970133781433105  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.708498477935791  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7199835777282715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7084083557128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([12043, 256])
first layer input nodes number: 39514
first layer output nodes number: 12043
edges number: 89119
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7207474708557129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7322325706481934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7355713844299316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7355713844299316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([476, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.75506591796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.75506591796875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7559738159179688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7639780044555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([398, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.764289379119873  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.764289379119873  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7650485038757324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.776435375213623  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7770133018493652  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7770133018493652  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.777646541595459  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.792778491973877  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7933540344238281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7933540344238281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.7937965393066406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8066291809082031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8073019981384277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8073019981384277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8076567649841309  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8204283714294434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8210468292236328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8210468292236328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8213100433349609  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8326282501220703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8333044052124023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8333044052124023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8335332870483398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8449773788452148  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8457322120666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8457322120666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8459477424621582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8582329750061035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8589210510253906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8589210510253906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8590965270996094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8703269958496094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8708353042602539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8708353042602539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8709535598754883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8793497085571289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8799147605895996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8799147605895996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8800272941589355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8888049125671387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8893485069274902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8893485069274902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8894476890563965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8978781700134277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8984284400939941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8984284400939941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.8985199928283691  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9069428443908691  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9073681831359863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9073681831359863  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9074349403381348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9140439033508301  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9145874977111816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9145874977111816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9146637916564941  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9227509498596191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9231743812561035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9231743812561035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9232316017150879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9296975135803223  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9300775527954102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9300775527954102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9301252365112305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.935847282409668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9362564086914062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9362564086914062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9363040924072266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9423599243164062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.942774772644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.942774772644043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9428205490112305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9489545822143555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9492778778076172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9492778778076172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9493122100830078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9541530609130859  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9545397758483887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9545397758483887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9545779228210449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9602236747741699  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9604372978210449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9604372978210449  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9604582786560059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9637103080749512  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9639873504638672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9639873504638672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9640121459960938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9680290222167969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9682936668395996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9682936668395996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9683165550231934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9721846580505371  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([205, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9770994186401367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9770994186401367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.9774904251098633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0463075637817383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 205, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0299124717712402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.030324935913086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0307374000549316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.030303955078125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2766, 40])
input nodes number: 12043
output nodes number: 2766
edges number: 19678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.030411720275879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.030412197113037  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033435821533203125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 20 input nodes size: 44464
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031068801879882812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031068801879882812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05227088928222656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0522918701171875  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03273963928222656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033919334411621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033919334411621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033919334411621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([44464, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.033919334411621094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([691, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0988469123840332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0988469123840332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.09950590133666992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10645437240600586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([705, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1067972183227539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1067972183227539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10746955871582031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1175546646118164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([689, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11820411682128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11820411682128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11886119842529297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13399267196655273  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([530, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1346750259399414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1346750259399414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13518047332763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15050220489501953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([606, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15169429779052734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15169429779052734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15227222442626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17310142517089844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 606, 128])
m.shape torch.Size([510, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1742715835571289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1742715835571289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1747579574584961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19567203521728516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([482, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1970376968383789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1970376968383789  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19749736785888672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22048091888427734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([445, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22194862365722656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22194862365722656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22237300872802734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24656295776367188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([458, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24831628799438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24831628799438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24875307083129883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27670717239379883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([10871, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3283257484436035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3283257484436035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 10871, 128]), torch.Size([1, 10871, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33869314193725586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0747780799865723  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 10871, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0139026641845703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.029149055480957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0443954467773438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0290298461914062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([15987, 256])
first layer input nodes number: 44464
first layer output nodes number: 15987
edges number: 132144
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0447287559509277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0599751472473145  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.063955307006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.063955307006836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0900583267211914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0900583267211914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0908422470092773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.097118854522705  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0974016189575195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0974016189575195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.0980710983276367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1081876754760742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([273, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.108640193939209  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.108640193939209  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1091609001159668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1226630210876465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([155, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1229987144470215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1229987144470215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1232943534851074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1318678855895996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1326189041137695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1326189041137695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1329755783081055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1458158493041992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([117, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1463122367858887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1463122367858887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1465353965759277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1561312675476074  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1567668914794922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1567668914794922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1569786071777344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1675643920898438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1680970191955566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1680970191955566  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.16825532913208  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.177278995513916  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.177840232849121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.177840232849121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1779813766479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1870145797729492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([50, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.187424659729004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.187424659729004  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1875200271606445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.194291114807129  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1948885917663574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1948885917663574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.195004940032959  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2040801048278809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.204714298248291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.204714298248291  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2048287391662598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2145562171936035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2151613235473633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2151613235473633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2152624130249023  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.224562644958496  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2250370979309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2250370979309082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.225111484527588  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.232475757598877  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2330012321472168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2330012321472168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2330756187438965  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2409605979919434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2414464950561523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2414464950561523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.241511344909668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2488393783569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2492809295654297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2492809295654297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2493362426757812  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2559738159179688  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2564826011657715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2564826011657715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2565417289733887  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2640509605407715  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2644782066345215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2644782066345215  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2645258903503418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2709155082702637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2715067863464355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2715067863464355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2715678215026855  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2801737785339355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2807087898254395  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2807087898254395  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2807621955871582  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2886662483215332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.289041519165039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.289041519165039  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2890777587890625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2946949005126953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2949867248535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2949867248535156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.295013427734375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2993392944335938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2996492385864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2996492385864258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2996759414672852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3041887283325195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([469, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3154449462890625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3154449462890625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3163394927978516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4950165748596191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 469, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4726428985595703  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4730544090270996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.473465919494629  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4730334281921387  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2759, 40])
input nodes number: 15987
output nodes number: 2759
edges number: 26106
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.473172664642334  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4731731414794922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.036013126373291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 21 input nodes size: 42784
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.032738685607910156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.032738685607910156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.053139686584472656  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.053160667419433594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031937599182128906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03325080871582031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03325080871582031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03325080871582031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([42784, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03325080871582031  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([605, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10444068908691406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10444068908691406  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.10501766204833984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11036205291748047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([629, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11067342758178711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11067342758178711  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11127328872680664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12027120590209961  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([607, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12083959579467773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12083959579467773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12141847610473633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1348423957824707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13568830490112305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13568830490112305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1362156867980957  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15185308456420898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([507, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15279817581176758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15279817581176758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15328168869018555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17068815231323242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([520, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1719341278076172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1719341278076172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17243003845214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19459199905395508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([491, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1959829330444336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1959829330444336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19645118713378906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2198638916015625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([473, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2214341163635254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2214341163635254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22188520431518555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24759721755981445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([467, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2493758201599121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.2493758201599121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24982118606567383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27832460403442383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([12210, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33669567108154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.33669567108154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 12210, 128]), torch.Size([1, 12210, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.3483400344848633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1789579391479492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 12210, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1117701530456543  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1280417442321777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1443133354187012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1279144287109375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([17062, 256])
first layer input nodes number: 42784
first layer output nodes number: 17062
edges number: 145075
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1446342468261719  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1609058380126953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1649737358093262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1649737358093262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([371, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1952528953552246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.1952528953552246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.195960521697998  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2031865119934082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([287, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2033843994140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2033843994140625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2039318084716797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2169923782348633  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([218, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2173476219177246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2173476219177246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2177634239196777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2269110679626465  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([176, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2273797988891602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2273797988891602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2277154922485352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2374505996704102  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([110, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.23781156539917  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.23781156539917  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2380213737487793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2455744743347168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2461214065551758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2461214065551758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2463369369506836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2556047439575195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([86, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2560758590698242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2560758590698242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.256239891052246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2644414901733398  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.264859676361084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.264859676361084  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2649836540222168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.272050380706787  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2726459503173828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2726459503173828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2727909088134766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2820682525634766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2827363014221191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2827363014221191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2828831672668457  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2933106422424316  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2938928604125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2938928604125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.294011116027832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3032350540161133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3039140701293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3039140701293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3040361404418945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3144121170043945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3149137496948242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3149137496948242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3149995803833008  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3228960037231445  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3234858512878418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3234858512878418  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.323575496673584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3324503898620605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3329825401306152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3329825401306152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3330588340759277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3411459922790527  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3417229652404785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3417229652404785  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.341799259185791  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3504204750061035  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.350938320159912  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.350938320159912  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3510031700134277  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3587851524353027  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3591856956481934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3591856956481934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3592333793640137  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3652892112731934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3658499717712402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3658499717712402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3659110069274902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3740897178649902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3747129440307617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3747129440307617  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3747777938842773  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3839216232299805  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3845152854919434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3845152854919434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3845744132995605  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3933253288269043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3937187194824219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3937187194824219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3937568664550781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3996696472167969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.400136947631836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.400136947631836  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4001789093017578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4069766998291016  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4074864387512207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4074864387512207  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4075303077697754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4149441719055176  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([660, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4307808876037598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4307808876037598  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 660, 256]), torch.Size([1, 660, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.432039737701416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6560368537902832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 660, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.62839937210083  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6288104057312012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6292214393615723  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6287894248962402  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2758, 40])
input nodes number: 17062
output nodes number: 2758
edges number: 31005
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6289372444152832  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.6289377212524414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03552818298339844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 22 input nodes size: 43634
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0319371223449707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0319371223449707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05274343490600586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.0527644157409668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03234243392944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03377485275268555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03377485275268555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03377485275268555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([43634, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03377485275268555  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([494, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11098337173461914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11098337173461914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11145448684692383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11522340774536133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([571, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11553239822387695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11553239822387695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.11607694625854492  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12469816207885742  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([512, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12515830993652344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12515830993652344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.12564659118652344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13638877868652344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([529, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13719844818115234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13719844818115234  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13770294189453125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15256786346435547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([523, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1535625457763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1535625457763672  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.15406131744384766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1723952293395996  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([493, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17355632781982422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.17355632781982422  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1740264892578125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1942434310913086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([477, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1956005096435547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1956005096435547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.19605541229248047  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.21880054473876953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([464, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22034311294555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22034311294555664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.22078561782836914  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24600839614868164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([488, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24788141250610352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24788141250610352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.24834680557250977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.27813196182250977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([13523, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34238195419311523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.34238195419311523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 13523, 128]), torch.Size([1, 13523, 128])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.35527849197387695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.273542881011963  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 13523, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.200251579284668  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2174882888793945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.234724998474121  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.217353343963623  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([18074, 256])
first layer input nodes number: 43634
first layer output nodes number: 18074
edges number: 157534
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2350521087646484  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.252288818359375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.257056713104248  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.257056713104248  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([287, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2907700538635254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2907700538635254  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2913174629211426  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2970643043518066  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([239, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2972502708435059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.2972502708435059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.297706127166748  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3045439720153809  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([181, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3048381805419922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3048381805419922  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3051834106445312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3127784729003906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([153, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3131942749023438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3131942749023438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.313486099243164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3219490051269531  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([133, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3224425315856934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3224425315856934  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3226962089538574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3318285942077637  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([106, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.332313060760498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.332313060760498  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3325152397155762  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3412089347839355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3417201042175293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3417201042175293  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3418936729431152  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.350572109222412  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([67, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3510007858276367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3510007858276367  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3511285781860352  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.358412742614746  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3591623306274414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3591623306274414  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3593416213989258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3708162307739258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3714380264282227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3714380264282227  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3715791702270508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3816003799438477  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.382164478302002  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.382164478302002  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3822789192199707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3912053108215332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3918170928955078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.3918170928955078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.391927719116211  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4013309478759766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4018630981445312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4018630981445312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4019527435302734  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4102001190185547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4107880592346191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4107880592346191  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4108777046203613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.419752597808838  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.420212745666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.420212745666504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4202795028686523  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4273557662963867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4279375076293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4279375076293945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.428013801574707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4366350173950195  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4371528625488281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4371528625488281  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4372177124023438  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4449996948242188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4457287788391113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4457287788391113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.445812702178955  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4564709663391113  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4571232795715332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4571232795715332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.45719575881958  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4669079780578613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4674296379089355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4674296379089355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.467484951019287  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4752840995788574  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4759025573730469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4759025573730469  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4759635925292969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4849967956542969  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4855375289916992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4855375289916992  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4855890274047852  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.4935712814331055  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.494253158569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.494253158569336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.494314193725586  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.504201889038086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5049095153808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5049095153808594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5049705505371094  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5152854919433594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([778, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5339488983154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5339488983154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 778, 256]), torch.Size([1, 778, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.5354328155517578  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7972850799560547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 778, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7664494514465332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7668604850769043  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7672715187072754  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7668395042419434  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([2758, 40])
input nodes number: 18074
output nodes number: 2758
edges number: 34662
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.7669954299926758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 1.766995906829834  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03622770309448242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

pseudo mini batch 23 input nodes size: 42699
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03234243392944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03234243392944336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.052702903747558594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.05272483825683594  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.031897544860839844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03339862823486328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03339862823486328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03339862823486328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([42699, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.03339862823486328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([445, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.11264657974243164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.11264657974243164  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.11307096481323242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.11646604537963867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([445, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.11667823791503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.11667823791503906  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.11710262298583984  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.12346839904785156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([435, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.12387847900390625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.12387847900390625  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.12429332733154297  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.13341999053955078  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([478, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.1341242790222168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.1341242790222168  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.13458013534545898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.14779996871948242  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([512, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.14879274368286133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.14879274368286133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.14928102493286133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.16685914993286133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([485, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.1684713363647461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.1684713363647461  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.16893386840820312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.18882274627685547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([498, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.19025373458862305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.19025373458862305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.19072866439819336  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.21447515487670898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([466, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.21601533889770508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.21601533889770508  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.2164597511291504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.2417912483215332  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([501, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.24371910095214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.24371910095214844  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.24419689178466797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.27477550506591797  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([14004, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.34131288528442383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.34131288528442383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 14004, 128]), torch.Size([1, 14004, 128])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 0.35466814041137695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.317455768585205  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 14004, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.2420001029968262  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.259422779083252  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.2768454551696777  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.2592864036560059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

torch.Size([18269, 256])
first layer input nodes number: 42699
first layer output nodes number: 18269
edges number: 161785
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.2771658897399902  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.294588565826416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.2991280555725098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.2991280555725098  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

m.shape torch.Size([253, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3375835418701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3375835418701172  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3380661010742188  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3419265747070312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([197, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.342064380645752  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.342064380645752  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.342440128326416  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.348076343536377  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([153, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.348330020904541  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.348330020904541  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3486218452453613  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3550419807434082  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([138, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3554267883300781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3554267883300781  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3556900024414062  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3633232116699219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([143, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3638792037963867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3638792037963867  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.364151954650879  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3739709854125977  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([101, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3744173049926758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3744173049926758  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3746099472045898  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3828935623168945  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3833894729614258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3833894729614258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3835573196411133  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3919496536254883  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([80, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3924808502197266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3924808502197266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.3926334381103516  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4013309478759766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.401947021484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.401947021484375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.402099609375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.411865234375  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4127216339111328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4127216339111328  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4129066467285156  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4260425567626953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4267749786376953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4267749786376953  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4269237518310547  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.438528060913086  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4392380714416504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4392380714416504  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4393677711486816  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.450392246246338  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.451202392578125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.451202392578125  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4513359069824219  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4636192321777344  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4643197059631348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4643197059631348  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.464428424835205  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.475191593170166  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4760026931762695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4760026931762695  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4761171340942383  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4882478713989258  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4890518188476562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4890518188476562  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.4891586303710938  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5012283325195312  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5018939971923828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5018939971923828  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5019779205322266  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5120487213134766  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5129237174987793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5129237174987793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5130248069763184  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5258631706237793  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.526780605316162  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.526780605316162  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5268816947937012  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5404276847839355  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.541299819946289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.541299819946289  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.541391372680664  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.554300308227539  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5551629066467285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5551629066467285  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.555248737335205  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5679516792297363  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5686278343200684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5686278343200684  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.568692684173584  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5787444114685059  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5794858932495117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5794858932495117  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5795526504516602  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.590367317199707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5917463302612305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.5917463302612305  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.591832160949707  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.606337547302246  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([851, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.6267428398132324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.6267428398132324  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 4.5701904296875 GB
    Memory Allocated: 1.6283659934997559  GigaBytes
Max Memory Allocated: 1.89617919921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 1.9165525436401367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 851, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 1.8809471130371094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 1.8813834190368652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 1.881819725036621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 1.881361484527588  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2927, 40])
input nodes number: 18269
output nodes number: 2927
edges number: 39625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 1.881545066833496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5936279296875 GB
    Memory Allocated: 1.8815455436706543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.035981178283691406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 24 input nodes size: 24135
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03192281723022461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03192281723022461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04343128204345703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04345226287841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.02306985855102539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023631572723388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023631572723388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023631572723388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([24135, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023631572723388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([758, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05208730697631836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05208730697631836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0528101921081543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0593109130859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([784, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05969715118408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05969715118408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06044483184814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07166004180908203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([723, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07232046127319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07232046127319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07300996780395508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08817911148071289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([607, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08918237686157227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08918237686157227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08976125717163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10654878616333008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([615, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10772562026977539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10772562026977539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10831212997436523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1300334930419922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([506, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13118791580200195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13118791580200195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13167047500610352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1524205207824707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([431, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15361785888671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15361785888671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15402889251708984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17458057403564453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([357, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1757369041442871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1757369041442871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17607736587524414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19548368453979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([337, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19675970077514648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19675970077514648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1970810890197754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2176499366760254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([3471, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2340402603149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2340402603149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 3471, 128]), torch.Size([1, 3471, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2373504638671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.47237491607666016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 3471, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.44730472564697266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.45549583435058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4636869430541992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4554314613342285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([8589, 256])
first layer input nodes number: 24135
first layer output nodes number: 8589
edges number: 56650
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4638690948486328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4720602035522461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4742550849914551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4742550849914551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([492, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.49271726608276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.49271726608276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4936556816101074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5014810562133789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([412, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5018038749694824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5018038749694824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5025897026062012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5146713256835938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5152130126953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5152130126953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5158309936523438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5300869941711426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([260, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5308895111083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5308895111083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5313854217529297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5471534729003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5479435920715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5479435920715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5483555793762207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5631871223449707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5639328956604004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5639328956604004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5642476081848145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5777802467346191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5783767700195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5783767700195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5785903930664062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5892715454101562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5899109840393066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5899109840393066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5900959968566895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6006417274475098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6013021469116211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6013021469116211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6014680862426758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6120882034301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6126303672790527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6126303672790527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6127543449401855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6215567588806152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6221294403076172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6221294403076172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6222438812255859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6311702728271484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.631782054901123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.631782054901123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6318926811218262  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6412959098815918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6419029235839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6419029235839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6420040130615234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6513042449951172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6517653465270996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6517653465270996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6518378257751465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6590132713317871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6593952178955078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6593952178955078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6594505310058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.665313720703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6657938957214355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6657938957214355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6658568382263184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6729693412780762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6732158660888672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6732158660888672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.673248291015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6771392822265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6774864196777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6774864196777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6775264739990234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6826133728027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6830320358276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6830320358276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6830778121948242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6892118453979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6894965171813965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6894965171813965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6895270347595215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6938300132751465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6942791938781738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6942791938781738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6943230628967285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7008156776428223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.701026439666748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.701026439666748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.701047420501709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7042994499206543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7045764923095703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7045764923095703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7046012878417969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7086181640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7089056968688965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7089056968688965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.708930492401123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7131209373474121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([155, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7168331146240234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7168331146240234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7171287536621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7691612243652344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 155, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.753880500793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7542972564697266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7547140121459961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7542762756347656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2794, 40])
input nodes number: 8589
output nodes number: 2794
edges number: 18585
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7543420791625977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7543425559997559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.024718284606933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 25 input nodes size: 17584
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023050308227539062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023050308227539062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03143501281738281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03145647048950195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.019927024841308594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.020354270935058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.020354270935058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.020354270935058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([17584, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.020354270935058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04085874557495117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04085874557495117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04164743423461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04795694351196289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([855, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04837799072265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04837799072265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.049193382263183594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0623016357421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([782, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06301259994506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06301259994506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06375837326049805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08016538619995117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([637, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08120870590209961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08120870590209961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08181619644165039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09975767135620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([618, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10092735290527344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10092735290527344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1015167236328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12282085418701172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([450, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12381362915039062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12381362915039062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12424278259277344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14269638061523438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([368, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14371013641357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14371013641357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14406108856201172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16160869598388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([340, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16273021697998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16273021697998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1630544662475586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18153667449951172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18250751495361328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18250751495361328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18275928497314453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19887256622314453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([2001, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20828819274902344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20828819274902344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2001, 128]), torch.Size([1, 2001, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21019649505615234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3479270935058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2001, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3307070732116699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.33751821517944336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3443293571472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3374648094177246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([7142, 256])
first layer input nodes number: 17584
first layer output nodes number: 7142
edges number: 40903
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.34446239471435547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3512735366821289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.35363006591796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.35363006591796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([561, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.36998701095581055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.36998701095581055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.37105703353881836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.37961721420288086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([456, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3799591064453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3799591064453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.380828857421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3949432373046875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([356, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3957819938659668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3957819938659668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.39646100997924805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4117436408996582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4127511978149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4127511978149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.41326427459716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4281435012817383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([266, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4291653633117676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4291653633117676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4296727180480957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.44879770278930664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4494900703430176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4494900703430176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.44980287551879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4632534980773926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.46397876739501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.46397876739501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.46422863006591797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.47672176361083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4774198532104492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4774198532104492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.47762393951416016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4892568588256836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.48990774154663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.48990774154663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.49007368087768555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5006937980651855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5012550354003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5012550354003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5013828277587891  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5104560852050781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5109105110168457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5109105110168457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5110039710998535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5182938575744629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5188241004943848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5188241004943848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5189194679260254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5270256996154785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5275278091430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5275278091430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5276117324829102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5353326797485352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5357890129089355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5357890129089355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5358595848083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5428462028503418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5431861877441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5431861877441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5432357788085938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.548492431640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5486831665039062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5486831665039062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5487098693847656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.551727294921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5520410537719727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5520410537719727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5520792007446289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5566568374633789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5569319725036621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5569319725036621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5569643974304199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5610823631286621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5613770484924316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5613770484924316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5614094734191895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5657544136047363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5659885406494141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5659885406494141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5660133361816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5695095062255859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5695781707763672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5695781707763672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5695858001708984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5707149505615234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5708804130554199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5708804130554199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5708956718444824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5732607841491699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5734081268310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5734081268310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5734214782714844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5755844116210938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5756931304931641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5756931304931641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5757026672363281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5773143768310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([102, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5797605514526367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5797605514526367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5799551010131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6141958236694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 102, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6013503074645996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6017794609069824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6022086143493652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6017580032348633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2877, 40])
input nodes number: 7142
output nodes number: 2877
edges number: 16320
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6018452644348145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6018457412719727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.021239757537841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 26 input nodes size: 17408
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.019939422607421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.019939422607421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.028240203857421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.028261661529541016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.019855499267578125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.020282745361328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.020282745361328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.020282745361328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([17408, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.020282745361328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([693, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04070711135864258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04070711135864258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04136800765991211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04665517807006836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([819, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04710578918457031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04710578918457031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04788684844970703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05960273742675781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([721, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.060617923736572266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.060617923736572266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06130552291870117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07718420028686523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([642, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0780649185180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0780649185180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07867717742919922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09661006927490234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([529, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0975651741027832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0975651741027832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09806966781616211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1170644760131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([426, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11803102493286133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11803102493286133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11843729019165039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13590669631958008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([382, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1369786262512207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1369786262512207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1373429298400879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15555810928344727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([340, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15667295455932617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15667295455932617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1569972038269043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17547941207885742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([284, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17653608322143555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17653608322143555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17680692672729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19414091110229492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([1989, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2034897804260254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2034897804260254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 1989, 128]), torch.Size([1, 1989, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20538663864135742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3428769111633301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 1989, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3255162239074707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.33202505111694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.33853864669799805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.33197879791259766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6825, 256])
first layer input nodes number: 17408
first layer output nodes number: 6825
edges number: 40103
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3386702537536621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.34517908096313477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.34706830978393555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.34706830978393555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([488, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3640322685241699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3640322685241699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3649630546569824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.37300729751586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([471, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3734474182128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3734474182128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3743457794189453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.38840532302856445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([343, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3890829086303711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3890829086303711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3897371292114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.40433835983276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([287, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.40511465072631836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.40511465072631836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.40566205978393555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4221158027648926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([244, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.42301511764526367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.42301511764526367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4234805107116699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4402346611022949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.44095373153686523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.44095373153686523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4412684440612793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.454801082611084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4555387496948242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4555387496948242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4557924270629883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4684762954711914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4691648483276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4691648483276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.46936702728271484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.48089122772216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4815516471862793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4815516471862793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4817194938659668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4924616813659668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.49321413040161133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.49321413040161133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.493380069732666  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5051617622375488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5057873725891113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5057873725891113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5059151649475098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5158829689025879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5164422988891602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5164422988891602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.516545295715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5253000259399414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.525848388671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.525848388671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.52593994140625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.53436279296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5348825454711914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5348825454711914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5349626541137695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5428934097290039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5431561470031738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5431561470031738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5431962013244629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5474419593811035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5478525161743164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5478525161743164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5479059219360352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5539407730102539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5542902946472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5542902946472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5543341636657715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.559598445892334  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5599398612976074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5599398612976074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5599799156188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5650668144226074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5653209686279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5653209686279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5653495788574219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.569183349609375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5695538520812988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5695538520812988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5695919990539551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5749707221984863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5751333236694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5751333236694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5751504898071289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5776910781860352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5778098106384277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5778098106384277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5778212547302246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5795950889587402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5796999931335449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5796999931335449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.579709529876709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5812544822692871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5814113616943359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5814113616943359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5814247131347656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5836811065673828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([94, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5859332084655762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5859332084655762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5861124992370605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6176676750183105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 94, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.60400390625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6044321060180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6048603057861328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6044106483459473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2872, 40])
input nodes number: 6825
output nodes number: 2872
edges number: 17026
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6044821739196777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6044826507568359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.021152496337890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 27 input nodes size: 22963
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.01985454559326172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.01985454559326172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.030804157257080078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.030825138092041016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.022502899169921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023042678833007812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023042678833007812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023042678833007812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([22963, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023042678833007812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([703, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04974174499511719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04974174499511719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05041217803955078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.056131839752197266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([822, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.056580543518066406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.056580543518066406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.057364463806152344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0695490837097168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([746, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07022428512573242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07022428512573242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 746, 128]), torch.Size([1, 746, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07093572616577148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08708429336547852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 746, 128])
m.shape torch.Size([664, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08799505233764648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08799505233764648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08862829208374023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10774755477905273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([583, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10882091522216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10882091522216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10937690734863281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12961816787719727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([455, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13064193725585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13064193725585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13107585906982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1497344970703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([422, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1509261131286621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1509261131286621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15132856369018555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17145109176635742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([380, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1726994514465332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1726994514465332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17306184768676758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19371843338012695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([345, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19501781463623047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19501781463623047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19534683227539062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21640396118164062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([3180, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23140287399291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23140287399291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 3180, 128]), torch.Size([1, 3180, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2344355583190918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.45020198822021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 3180, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4269123077392578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4348278045654297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.44274330139160156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4347658157348633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([8300, 256])
first layer input nodes number: 22963
first layer output nodes number: 8300
edges number: 53785
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4429163932800293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.45083189010620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.45281076431274414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.45281076431274414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([483, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.471189022064209  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.471189022064209  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4721102714538574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.47953367233276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.47984981536865234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.47984981536865234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4806203842163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.49323463439941406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([340, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.49382972717285156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.49382972717285156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4944782257080078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5090885162353516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5097408294677734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5097408294677734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5102252960205078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5242748260498047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([221, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5253763198852539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5253763198852539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5257978439331055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5409727096557617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5416040420532227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5416040420532227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5418825149536133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5538568496704102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([145, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5546932220458984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5546932220458984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5549697875976562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5687980651855469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5693979263305664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5693979263305664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5695810317993164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5800180435180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5807919502258301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5807919502258301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5809826850891113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5931897163391113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([61, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5936808586120605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5936808586120605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5937972068786621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.602057933807373  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6026129722595215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6026129722595215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6027235984802246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6113524436950684  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6120352745056152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6120352745056152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6121573448181152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6225333213806152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6229972839355469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6229972839355469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.623077392578125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6304473876953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6308379173278809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6308379173278809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6308989524841309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6369414329528809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6373291015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6373291015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6373844146728516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6432476043701172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6438198089599609  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6438198089599609  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6438941955566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6522998809814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6527204513549805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6527204513549805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6527738571166992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6591825485229492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6596059799194336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6596059799194336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6596555709838867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6659536361694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6663126945495605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6663126945495605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6663527488708496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.671720027923584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6718730926513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6718730926513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6718902587890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6743106842041016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6746859550476074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6746859550476074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6747221946716309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6800856590270996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6803426742553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6803426742553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6803674697875977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6842107772827148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.684485912322998  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.684485912322998  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6845107078552246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6885275840759277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.688723087310791  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.688723087310791  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6887402534484863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6916413307189941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([149, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6952133178710938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6952133178710938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6954975128173828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7455158233642578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 149, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7309427261352539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7313604354858398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7317781448364258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7313394546508789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2801, 40])
input nodes number: 8300
output nodes number: 2801
edges number: 18508
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7314119338989258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.731412410736084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.024098873138427734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 28 input nodes size: 40214
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.022492408752441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.022492408752441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.042023658752441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.042044639587402344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.031074047088623047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03234434127807617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03234434127807617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03234434127807617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([40214, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03234434127807617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([483, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09949922561645508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09949922561645508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0999598503112793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10364484786987305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([589, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10397624969482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10397624969482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1045379638671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11296367645263672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([546, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1134638786315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1134638786315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11398458480834961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1261882781982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([498, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1268777847290039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1268777847290039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12735271453857422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14112567901611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([523, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1421351432800293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1421351432800293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14263391494750977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16091442108154297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([490, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16206693649291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16206693649291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16253423690795898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18262815475463867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([496, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1840500831604004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1840500831604004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1845231056213379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2081742286682129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([506, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2098679542541504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2098679542541504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21035051345825195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23785638809204102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([533, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23990249633789062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23990249633789062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24041080474853516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.27343225479125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([11378, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.32743263244628906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.32743263244628906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11378, 128]), torch.Size([1, 11378, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3382835388183594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.108902931213379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11378, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0455222129821777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0608210563659668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0761198997497559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0607013702392578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([16042, 256])
first layer input nodes number: 40214
first layer output nodes number: 16042
edges number: 136943
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0764217376708984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0917205810546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0959529876708984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0959529876708984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([301, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1284937858581543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1284937858581543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1290678977966309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.135423183441162  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([267, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1356496810913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1356496810913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1361589431762695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1481008529663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([198, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1484174728393555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1484174728393555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1487951278686523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1571035385131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([157, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1575183868408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1575183868408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1578178405761719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1665019989013672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([126, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1669578552246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1669578552246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1671981811523438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1758499145507812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([110, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1763644218444824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1763644218444824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1765742301940918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.185595989227295  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([102, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1861777305603027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1861777305603027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1863722801208496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1960997581481934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([70, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1965408325195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1965408325195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1966743469238281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.20428466796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2049708366394043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2049708366394043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.205136775970459  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.215756893157959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([61, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2162604331970215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2162604331970215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.216376781463623  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.224637508392334  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2253303527832031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2253303527832031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2254657745361328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2360286712646484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2366762161254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2366762161254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2367944717407227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2468461990356445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2473244667053223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2473244667053223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2474064826965332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2549519538879395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.255462646484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.255462646484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2555408477783203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2632827758789062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2638349533081055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2638349533081055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2639131546020508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.272202491760254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2726097106933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2726097106933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.272665023803711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2789154052734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2793946266174316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2793946266174316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2794537544250488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2865490913391113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2872810363769531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2872810363769531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2873649597167969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2980232238769531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2987117767333984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2987117767333984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.298788070678711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.309011459350586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3094735145568848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3094735145568848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.309523105621338  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3165154457092285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3168339729309082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3168339729309082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.316866397857666  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3216652870178223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3222203254699707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3222203254699707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3222718238830566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.330254077911377  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.330759048461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.330759048461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3308048248291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3382205963134766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3387746810913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3387746810913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.338822364807129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3468809127807617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([759, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3650946617126465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3650946617126465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 759, 256]), torch.Size([1, 759, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3665423393249512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.626471996307373  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 759, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5964303016662598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.596841812133789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5972533226013184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5968208312988281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2759, 40])
input nodes number: 16042
output nodes number: 2759
edges number: 33428
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5969552993774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5969557762145996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03454923629760742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 29 input nodes size: 36927
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.031067848205566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.031067848205566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0486760139465332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04869699478149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.029144763946533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.029866695404052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.029866695404052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.029866695404052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([36927, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.029866695404052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([840, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06917858123779297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06917858123779297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06997966766357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07670927047729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([867, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07713556289672852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07713556289672852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07796239852905273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09091043472290039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([768, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09166526794433594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09166526794433594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09239768981933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10851097106933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([688, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10945701599121094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10945701599121094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11011314392089844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12914085388183594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([656, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13037681579589844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13037681579589844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13100242614746094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1539134979248047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([528, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15511131286621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15511131286621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15561485290527344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17798423767089844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([478, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17932796478271484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17932796478271484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17978382110595703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2025766372680664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([474, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20415687561035156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20415687561035156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20460891723632812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2303752899169922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([386, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23180580139160156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23180580139160156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 386, 128]), torch.Size([1, 386, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23217391967773438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2557334899902344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 386, 128])
m.shape torch.Size([5478, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.28167057037353516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.28167057037353516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 5478, 128]), torch.Size([1, 5478, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2868947982788086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6582183837890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 5478, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6228189468383789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6334648132324219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6441106796264648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6333813667297363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([11163, 256])
first layer input nodes number: 36927
first layer output nodes number: 11163
edges number: 79470
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6443877220153809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6550335884094238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6576952934265137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6576952934265137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([568, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6750693321228027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6750693321228027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6761527061462402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.685941219329834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([460, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.686284065246582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.686284065246582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6871614456176758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7039279937744141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7043747901916504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7043747901916504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7049603462219238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7192034721374512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7200169563293457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7200169563293457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7205071449279785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7354917526245117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7361745834350586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7361745834350586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7365427017211914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7497949600219727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7504301071166992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7504301071166992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7507009506225586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7623472213745117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7629923820495605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7629923820495605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7632136344909668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7742762565612793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7750191688537598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7750191688537598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.775230884552002  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7872986793518066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7878246307373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7878246307373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7879638671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7974109649658203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7974109649658203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7975311279296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8060626983642578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([35, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.806373119354248  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.806373119354248  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8064398765563965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8116469383239746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8120865821838379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8120865821838379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8121647834777832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8188118934631348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8192853927612305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8192853927612305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8193635940551758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8265581130981445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8269767761230469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8269767761230469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8270416259765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8334617614746094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8338332176208496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8338332176208496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8338866233825684  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8395476341247559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8399977684020996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8399977684020996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8400568962097168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.846738338470459  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8470196723937988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8470196723937988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8470559120178223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8514046669006348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8517498970031738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8517498970031738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8517899513244629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8568768501281738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8571677207946777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8571677207946777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8572001457214355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8615450859069824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8619327545166016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8619327545166016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8619728088378906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8676204681396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8679437637329102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8679437637329102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.867976188659668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8727750778198242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8729281425476074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8729281425476074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8729434013366699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8753085136413574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8754115104675293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8754115104675293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8754210472106934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8769659996032715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8771457672119141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8771457672119141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8771610260009766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8797397613525391  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([162, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8836250305175781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8836250305175781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8839340209960938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9383163452148438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 162, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9241652488708496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9245796203613281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9249939918518066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9245586395263672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2778, 40])
input nodes number: 11163
output nodes number: 2778
edges number: 17377
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9246659278869629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9246664047241211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03127861022949219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 30 input nodes size: 21862
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.029147624969482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.029147624969482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03957223892211914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03959369659423828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.021964550018310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.02248525619506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.02248525619506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.02248525619506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([21862, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.02248525619506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([848, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04898357391357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04898357391357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04979228973388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0562744140625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([821, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05665302276611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05665302276611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05743598937988281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06918048858642578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([700, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06979036331176758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.06979036331176758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07045793533325195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08608484268188477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([635, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08696222305297852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08696222305297852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08756780624389648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10535287857055664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([568, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10640430450439453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10640430450439453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10694599151611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1273508071899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([465, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12841033935546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12841033935546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12885379791259766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14792251586914062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([390, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1490025520324707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1490025520324707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14937448501586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16797113418579102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([346, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16910505294799805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16910505294799805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1694350242614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18824338912963867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([303, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1893787384033203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1893787384033203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 303, 128]), torch.Size([1, 303, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1896677017211914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2081613540649414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 303, 128])
m.shape torch.Size([3126, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.22292280197143555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.22292280197143555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 3126, 128]), torch.Size([1, 3126, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.22590398788452148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4392571449279785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 3126, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.41612768173217773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4239497184753418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.43177175521850586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4238882064819336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([8202, 256])
first layer input nodes number: 21862
first layer output nodes number: 8202
edges number: 52245
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.43193674087524414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4397587776184082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4417142868041992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4417142868041992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([582, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.45916223526000977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.45916223526000977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.46027231216430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4698367118835449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([436, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4701199531555176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4701199531555176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.47095155715942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4842672348022461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4847860336303711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4847860336303711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.48540401458740234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4991121292114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([275, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4999518394470215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.4999518394470215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5004763603210449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5156874656677246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([222, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5164923667907715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5164923667907715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5169157981872559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5321593284606934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5330038070678711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5330038070678711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5333337783813477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5475225448608398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5482187271118164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5482187271118164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5484628677368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5606698989868164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5613322257995605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5613322257995605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5615267753601074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5726161003112793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5731935501098633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5731935501098633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5733423233032227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5828638076782227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5835490226745605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5835490226745605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5836997032165527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.594398021697998  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5949358940124512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5949358940124512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.5950465202331543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.603675365447998  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6041045188903809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6041045188903809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.604184627532959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6109938621520996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6115288734436035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6115288734436035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6116166114807129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6196885108947754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6200618743896484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6200618743896484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6201210021972656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6259746551513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6262626647949219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6262626647949219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6263046264648438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6307525634765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6310853958129883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6310853958129883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.631129264831543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6360864639282227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6364731788635254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6364731788635254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6365208625793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6422429084777832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6425824165344238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6425824165344238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6426224708557129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6477093696594238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6480183601379395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6480183601379395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6480526924133301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6526532173156738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6530013084411621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6530013084411621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6530375480651855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6581473350524902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6583313941955566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6583313941955566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6583504676818848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6611733436584473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6613755226135254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6613755226135254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6613945960998535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6643509864807129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.664452075958252  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.664452075958252  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.664461612701416  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6660065650939941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6662325859069824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6662325859069824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6662516593933105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6694750785827637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([135, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6727094650268555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6727094650268555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.6729669570922852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7182855606079102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 135, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7041940689086914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.704622745513916  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7050514221191406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7046012878417969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2874, 40])
input nodes number: 8202
output nodes number: 2874
edges number: 17435
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7046985626220703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7046990394592285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.023531436920166016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 31 input nodes size: 30536
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.02197885513305664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.02197885513305664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.036539554595947266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0365605354309082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.026114463806152344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.026973724365234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.026973724365234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.026973724365234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([30536, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.026973724365234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([673, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07196283340454102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07196283340454102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07260465621948242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07773923873901367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([704, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07808971405029297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07808971405029297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.07876110076904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08883190155029297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([597, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08935022354125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08935022354125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0899195671081543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10307073593139648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([578, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10388851165771484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10388851165771484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10443973541259766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12085866928100586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([516, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12181329727172852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12181329727172852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12230539321899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14075517654418945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([498, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14193391799926758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14193391799926758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1424088478088379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16283082962036133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([490, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1642289161682129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1642289161682129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16469621658325195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18806123733520508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([474, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1896357536315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1896357536315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19008779525756836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21585416793823242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([427, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21746063232421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21746063232421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21786785125732422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24392986297607422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([6849, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2763848304748535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2763848304748535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 6849, 128]), torch.Size([1, 6849, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.28362321853637695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7473750114440918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 6849, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7059721946716309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.717231273651123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7284903526306152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7171430587768555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([11806, 256])
first layer input nodes number: 30536
first layer output nodes number: 11806
edges number: 91307
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7296395301818848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.740898609161377  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7449560165405273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7449560165405273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.769106388092041  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.769106388092041  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.769920825958252  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7764363288879395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7767038345336914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7767038345336914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7773733139038086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7886419296264648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([264, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7890686988830566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7890686988830566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.7895722389221191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8018674850463867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([183, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8023195266723633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8023195266723633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.802668571472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8127908706665039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([169, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8134288787841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8134288787841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.813751220703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8253555297851562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.826146125793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.826146125793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8264608383178711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8399934768676758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8407044410705566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8407044410705566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8409504890441895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8532528877258301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8540835380554199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8540835380554199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8543200492858887  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8678011894226074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8684530258178711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8684530258178711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8686227798461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8794870376586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8802099227905273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8802099227905273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8803701400756836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8917455673217773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.892521858215332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.892521858215332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8926763534545898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9047269821166992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9052729606628418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9052729606628418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9053759574890137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.914130687713623  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9145040512084961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9145040512084961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9145689010620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9205350875854492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9210143089294434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9210143089294434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9210867881774902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9282622337341309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9288029670715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9288029670715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9288792610168457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9369664192199707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9375743865966797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9375743865966797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9376544952392578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9467067718505859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9472060203552246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9472060203552246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9472689628601074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9548220634460449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9552750587463379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9552750587463379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9553284645080566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9621109962463379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9626140594482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9626140594482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9626693725585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9700813293457031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.970611572265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.970611572265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9706668853759766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9784660339355469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9790439605712891  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9790439605712891  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9791011810302734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9875698089599609  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9879856109619141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9879856109619141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9880256652832031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9942340850830078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.99456787109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.99456787109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.994598388671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.999542236328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0000348091125488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0000348091125488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0000767707824707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0071682929992676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([316, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0147404670715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0147404670715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.015343189239502  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1349968910217285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 316, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1138548851013184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.114272117614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1146893501281738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1142511367797852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2798, 40])
input nodes number: 11806
output nodes number: 2798
edges number: 23893
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1143488883972168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.114349365234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes
[05:27:01] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27803442 edges into 32 parts and get 8747074 edge cuts

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.028524398803710938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.028524398803710938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.028524398803710938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007266305387020111 |0.0020290017127990723 |0.1162484735250473 |8.618086576461792e-05 |0.07716374099254608 |0.004739046096801758 |
----------------------------------------------------------pseudo_mini_loss sum 4.842036724090576
Total (block generation + training)time/epoch 29.801512241363525
Training time/epoch 6.66977071762085
Training time without block to device /epoch 6.604842662811279
Training time without total dataloading part /epoch 6.196687698364258
load block tensor time/epoch 0.23252177238464355
block to device time/epoch 0.06492805480957031
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1112418
Number of first layer input nodes during this epoch:  797222
Number of first layer output nodes during this epoch:  315196
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.028523921966552734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02019190788269043
global_2_local spend time (sec) 0.05825185775756836
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004223346710205078
A = g.adjacency_matrix() spent  0.012445926666259766
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09096837043762207
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.349827766418457
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1552033424377441

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18726793, 2.0: 3227048, 3.0: 807585, 4.0: 243406, 5.0: 88339, 6.0: 38420, 7.0: 17657, 8.0: 9197, 9.0: 4921, 10.0: 2773, 11.0: 1643, 12.0: 917, 13.0: 542, 14.0: 332, 15.0: 191, 16.0: 175, 17.0: 133, 18.0: 67, 19.0: 35, 20.0: 12, 21.0: 6})
Convert a graph into a bidirected graph: 1.227 seconds
Metis partitioning: 5.766 seconds
Split the graph: 0.576 seconds
Construct subgraphs: 0.089 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.671184301376343
2759
2803
2773
2758
2758
2852
2758
2759
2894
2901
2873
2896
2758
2775
2758
2829
2887
2903
2925
2927
2906
2907
2895
2903
2832
2875
2843
2875
2809
2834
2789
2927
total k batches seeds list generation spend  19.66496443748474
after graph partition
graph partition algorithm spend time 19.74862313270569
2759
2803
2773
2758
2758
2852
2758
2759
2894
2901
2873
2896
2758
2775
2758
2829
2887
2903
2925
2927
2906
2907
2895
2903
2832
2875
2843
2875
2809
2834
2789
2927
partition_len_list
[15540, 18661, 14488, 19046, 15282, 16689, 19056, 16910, 6356, 7769, 6347, 8981, 9645, 13520, 11509, 12059, 5399, 6636, 7172, 9431, 6566, 6016, 5142, 6106, 5661, 7078, 5179, 6342, 6847, 6720, 7507, 7517]
shared_neighbor_graph_partition_s0 selection method  spend 19.86619734764099
time for parepare:  0.017517805099487305
local_output_nid generation:  0.0007784366607666016
local_in_edges_tensor generation:  0.0009808540344238281
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.009471416473388672
local_output_nid generation:  0.0009014606475830078
local_in_edges_tensor generation:  0.0011734962463378906
mini_batch_src_global generation:  0.0017523765563964844
r_  generation:  0.009001970291137695
local_output_nid generation:  0.0009207725524902344
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.0009014606475830078
r_  generation:  0.006571292877197266
local_output_nid generation:  0.0009355545043945312
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.001046895980834961
r_  generation:  0.009194374084472656
local_output_nid generation:  0.0009233951568603516
local_in_edges_tensor generation:  0.000797271728515625
mini_batch_src_global generation:  0.0010654926300048828
r_  generation:  0.007824420928955078
local_output_nid generation:  0.0009593963623046875
local_in_edges_tensor generation:  0.0008075237274169922
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.011849164962768555
local_output_nid generation:  0.0009443759918212891
local_in_edges_tensor generation:  0.0019822120666503906
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.011541366577148438
local_output_nid generation:  0.0009534358978271484
local_in_edges_tensor generation:  0.0007846355438232422
mini_batch_src_global generation:  0.0012347698211669922
r_  generation:  0.00952458381652832
local_output_nid generation:  0.0010352134704589844
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0008046627044677734
r_  generation:  0.006372690200805664
local_output_nid generation:  0.0010859966278076172
local_in_edges_tensor generation:  0.0007164478302001953
mini_batch_src_global generation:  0.0006930828094482422
r_  generation:  0.005829811096191406
local_output_nid generation:  0.001024484634399414
local_in_edges_tensor generation:  0.0006814002990722656
mini_batch_src_global generation:  0.0006313323974609375
r_  generation:  0.0055315494537353516
local_output_nid generation:  0.0009922981262207031
local_in_edges_tensor generation:  0.0006837844848632812
mini_batch_src_global generation:  0.0008082389831542969
r_  generation:  0.0071065425872802734
local_output_nid generation:  0.0009188652038574219
local_in_edges_tensor generation:  0.0006346702575683594
mini_batch_src_global generation:  0.0007121562957763672
r_  generation:  0.0053806304931640625
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0006639957427978516
mini_batch_src_global generation:  0.0008575916290283203
r_  generation:  0.0074155330657958984
local_output_nid generation:  0.0009529590606689453
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.0007684230804443359
r_  generation:  0.006060361862182617
local_output_nid generation:  0.0009560585021972656
local_in_edges_tensor generation:  0.0006551742553710938
mini_batch_src_global generation:  0.0008311271667480469
r_  generation:  0.007390737533569336
local_output_nid generation:  0.0009624958038330078
local_in_edges_tensor generation:  0.0006411075592041016
mini_batch_src_global generation:  0.0006556510925292969
r_  generation:  0.005495786666870117
local_output_nid generation:  0.0009150505065917969
local_in_edges_tensor generation:  0.0006575584411621094
mini_batch_src_global generation:  0.0007963180541992188
r_  generation:  0.006921291351318359
local_output_nid generation:  0.0009400844573974609
local_in_edges_tensor generation:  0.0007789134979248047
mini_batch_src_global generation:  0.0009639263153076172
r_  generation:  0.007494688034057617
local_output_nid generation:  0.0009312629699707031
local_in_edges_tensor generation:  0.0006694793701171875
mini_batch_src_global generation:  0.0008573532104492188
r_  generation:  0.007272243499755859
local_output_nid generation:  0.0009360313415527344
local_in_edges_tensor generation:  0.000659942626953125
mini_batch_src_global generation:  0.0007605552673339844
r_  generation:  0.006623744964599609
local_output_nid generation:  0.0009088516235351562
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0006992816925048828
r_  generation:  0.0066335201263427734
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.0006592273712158203
mini_batch_src_global generation:  0.0006120204925537109
r_  generation:  0.005304098129272461
local_output_nid generation:  0.0009315013885498047
local_in_edges_tensor generation:  0.0006537437438964844
mini_batch_src_global generation:  0.0005857944488525391
r_  generation:  0.005452156066894531
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0006384849548339844
mini_batch_src_global generation:  0.0007655620574951172
r_  generation:  0.007036685943603516
local_output_nid generation:  0.0008883476257324219
local_in_edges_tensor generation:  0.0006823539733886719
mini_batch_src_global generation:  0.0007588863372802734
r_  generation:  0.00676274299621582
local_output_nid generation:  0.0008778572082519531
local_in_edges_tensor generation:  0.0007874965667724609
mini_batch_src_global generation:  0.0007586479187011719
r_  generation:  0.0066111087799072266
local_output_nid generation:  0.0008921623229980469
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0007064342498779297
r_  generation:  0.006459712982177734
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0006773471832275391
mini_batch_src_global generation:  0.0007331371307373047
r_  generation:  0.006387948989868164
local_output_nid generation:  0.0008685588836669922
local_in_edges_tensor generation:  0.0006437301635742188
mini_batch_src_global generation:  0.0006437301635742188
r_  generation:  0.005469560623168945
local_output_nid generation:  0.0008435249328613281
local_in_edges_tensor generation:  0.0006289482116699219
mini_batch_src_global generation:  0.0007765293121337891
r_  generation:  0.007058143615722656
local_output_nid generation:  0.0008814334869384766
local_in_edges_tensor generation:  0.0008106231689453125
mini_batch_src_global generation:  0.0008263587951660156
r_  generation:  0.007500648498535156
----------------------check_connections_block total spend ----------------------------- 0.40175700187683105
generate_one_block  0.023645877838134766
generate_one_block  0.016185760498046875
generate_one_block  0.010859489440917969
generate_one_block  0.015257596969604492
generate_one_block  0.012596845626831055
generate_one_block  0.0168607234954834
generate_one_block  0.018710851669311523
generate_one_block  0.016160011291503906
generate_one_block  0.009118080139160156
generate_one_block  0.008708000183105469
generate_one_block  0.007813215255737305
generate_one_block  0.010707616806030273
generate_one_block  0.008419990539550781
generate_one_block  0.011275529861450195
generate_one_block  0.009781360626220703
generate_one_block  0.011119604110717773
generate_one_block  0.011505365371704102
generate_one_block  0.01031804084777832
generate_one_block  0.01140141487121582
generate_one_block  0.011180639266967773
generate_one_block  0.0093994140625
generate_one_block  0.009088993072509766
generate_one_block  0.007628202438354492
generate_one_block  0.0077724456787109375
generate_one_block  0.010387182235717773
generate_one_block  0.009839057922363281
generate_one_block  0.009601116180419922
generate_one_block  0.009300947189331055
generate_one_block  0.009591102600097656
generate_one_block  0.008029937744140625
generate_one_block  0.011025428771972656
generate_one_block  0.011357784271240234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047243356704711914
gen group dst list time:  0.009479761123657227
time for parepare:  0.023775339126586914
local_output_nid generation:  0.003515481948852539
local_in_edges_tensor generation:  0.008522272109985352
mini_batch_src_global generation:  0.00428009033203125
r_  generation:  0.04313302040100098
local_output_nid generation:  0.0056378841400146484
local_in_edges_tensor generation:  0.006686210632324219
mini_batch_src_global generation:  0.006241798400878906
r_  generation:  0.056244850158691406
local_output_nid generation:  0.004755735397338867
local_in_edges_tensor generation:  0.00441288948059082
mini_batch_src_global generation:  0.005394458770751953
r_  generation:  0.04438471794128418
local_output_nid generation:  0.008850574493408203
local_in_edges_tensor generation:  0.00672602653503418
mini_batch_src_global generation:  0.011562824249267578
r_  generation:  0.06186819076538086
local_output_nid generation:  0.005096435546875
local_in_edges_tensor generation:  0.004170894622802734
mini_batch_src_global generation:  0.00731205940246582
r_  generation:  0.04430890083312988
local_output_nid generation:  0.005082845687866211
local_in_edges_tensor generation:  0.004343986511230469
mini_batch_src_global generation:  0.005499601364135742
r_  generation:  0.049912214279174805
local_output_nid generation:  0.005696535110473633
local_in_edges_tensor generation:  0.0068204402923583984
mini_batch_src_global generation:  0.016636133193969727
r_  generation:  0.05865788459777832
local_output_nid generation:  0.005124092102050781
local_in_edges_tensor generation:  0.004136800765991211
mini_batch_src_global generation:  0.005559444427490234
r_  generation:  0.05106353759765625
local_output_nid generation:  0.002233266830444336
local_in_edges_tensor generation:  0.0018265247344970703
mini_batch_src_global generation:  0.0023136138916015625
r_  generation:  0.014780044555664062
local_output_nid generation:  0.0026063919067382812
local_in_edges_tensor generation:  0.0027008056640625
mini_batch_src_global generation:  0.0014567375183105469
r_  generation:  0.017461776733398438
local_output_nid generation:  0.0020852088928222656
local_in_edges_tensor generation:  0.0019221305847167969
mini_batch_src_global generation:  0.004511117935180664
r_  generation:  0.0207974910736084
local_output_nid generation:  0.004385471343994141
local_in_edges_tensor generation:  0.003084421157836914
mini_batch_src_global generation:  0.002072572708129883
r_  generation:  0.022329330444335938
local_output_nid generation:  0.004380464553833008
local_in_edges_tensor generation:  0.0032341480255126953
mini_batch_src_global generation:  0.002117156982421875
r_  generation:  0.02428579330444336
local_output_nid generation:  0.005951881408691406
local_in_edges_tensor generation:  0.007307529449462891
mini_batch_src_global generation:  0.010545969009399414
r_  generation:  0.03962588310241699
local_output_nid generation:  0.006609439849853516
local_in_edges_tensor generation:  0.0030851364135742188
mini_batch_src_global generation:  0.003801584243774414
r_  generation:  0.032288312911987305
local_output_nid generation:  0.004355669021606445
local_in_edges_tensor generation:  0.0033266544342041016
mini_batch_src_global generation:  0.003715991973876953
r_  generation:  0.03447723388671875
local_output_nid generation:  0.004996776580810547
local_in_edges_tensor generation:  0.0015201568603515625
mini_batch_src_global generation:  0.001729726791381836
r_  generation:  0.0107879638671875
local_output_nid generation:  0.00254058837890625
local_in_edges_tensor generation:  0.0017724037170410156
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.015184879302978516
local_output_nid generation:  0.00278472900390625
local_in_edges_tensor generation:  0.0018649101257324219
mini_batch_src_global generation:  0.0013687610626220703
r_  generation:  0.01731586456298828
local_output_nid generation:  0.003144502639770508
local_in_edges_tensor generation:  0.0022149085998535156
mini_batch_src_global generation:  0.0019164085388183594
r_  generation:  0.05014371871948242
local_output_nid generation:  0.002579212188720703
local_in_edges_tensor generation:  0.004949092864990234
mini_batch_src_global generation:  0.0017962455749511719
r_  generation:  0.015241861343383789
local_output_nid generation:  0.0020542144775390625
local_in_edges_tensor generation:  0.0018696784973144531
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.013269901275634766
local_output_nid generation:  0.0018169879913330078
local_in_edges_tensor generation:  0.0013229846954345703
mini_batch_src_global generation:  0.0010440349578857422
r_  generation:  0.00863790512084961
local_output_nid generation:  0.0019030570983886719
local_in_edges_tensor generation:  0.0014150142669677734
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.013277292251586914
local_output_nid generation:  0.00185394287109375
local_in_edges_tensor generation:  0.001361846923828125
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.013772010803222656
local_output_nid generation:  0.0021648406982421875
local_in_edges_tensor generation:  0.0017027854919433594
mini_batch_src_global generation:  0.0011968612670898438
r_  generation:  0.016599178314208984
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.0011816024780273438
mini_batch_src_global generation:  0.0012087821960449219
r_  generation:  0.010286808013916016
local_output_nid generation:  0.0018782615661621094
local_in_edges_tensor generation:  0.001373291015625
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.01479196548461914
local_output_nid generation:  0.0020503997802734375
local_in_edges_tensor generation:  0.0016279220581054688
mini_batch_src_global generation:  0.0012421607971191406
r_  generation:  0.01858806610107422
local_output_nid generation:  0.0020093917846679688
local_in_edges_tensor generation:  0.0015206336975097656
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.014312744140625
local_output_nid generation:  0.002160787582397461
local_in_edges_tensor generation:  0.0018010139465332031
mini_batch_src_global generation:  0.0015616416931152344
r_  generation:  0.018392562866210938
local_output_nid generation:  0.00202178955078125
local_in_edges_tensor generation:  0.0016782283782958984
mini_batch_src_global generation:  0.0014505386352539062
r_  generation:  0.019749879837036133
----------------------check_connections_block total spend ----------------------------- 1.4621870517730713
generate_one_block  0.07316327095031738
generate_one_block  0.09241247177124023
generate_one_block  0.05572199821472168
generate_one_block  0.07727932929992676
generate_one_block  0.0813758373260498
generate_one_block  0.06885671615600586
generate_one_block  0.09229660034179688
generate_one_block  0.07064437866210938
generate_one_block  0.02105116844177246
generate_one_block  0.0262908935546875
generate_one_block  0.031580448150634766
generate_one_block  0.037642717361450195
generate_one_block  0.03350257873535156
generate_one_block  0.06784820556640625
generate_one_block  0.043906211853027344
generate_one_block  0.04515719413757324
generate_one_block  0.014383554458618164
generate_one_block  0.019922494888305664
generate_one_block  0.023950815200805664
generate_one_block  0.03142905235290527
generate_one_block  0.01983928680419922
generate_one_block  0.017052412033081055
generate_one_block  0.012794017791748047
generate_one_block  0.014322757720947266
generate_one_block  0.016855478286743164
generate_one_block  0.022449016571044922
generate_one_block  0.015016317367553711
generate_one_block  0.017457008361816406
generate_one_block  0.03515172004699707
generate_one_block  0.019230127334594727
generate_one_block  0.024797677993774414
generate_one_block  0.02370429039001465
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.028523921966552734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

connection checking time:  1.4621870517730713
block generation total time  1.2470860481262207
average batch blocks generation time:  0.0389714390039444
block dataloader generation time/epoch 23.36891007423401
pseudo mini batch 0 input nodes size: 39281
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.026102066040039062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.026102066040039062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.04563331604003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.045654296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.031072616577148438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03229045867919922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03229045867919922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03229045867919922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([39281, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03229045867919922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([533, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0968327522277832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0968327522277832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09734106063842773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10204315185546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([600, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10236120223999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10236120223999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10293340682983398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11151647567749023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([559, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.112030029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.112030029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1125631332397461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12469959259033203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([516, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12541723251342773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12541723251342773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12590932846069336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14079618453979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([510, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14176607131958008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14176607131958008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14225244522094727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15976190567016602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([468, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1608576774597168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1608576774597168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16130399703979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1804957389831543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([472, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18184804916381836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18184804916381836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1822981834411621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2048048973083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([458, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20632696151733398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20632696151733398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20676374435424805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2316603660583496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([505, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23360919952392578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23360919952392578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23409080505371094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.26491355895996094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([10919, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3167386054992676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3167386054992676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 10919, 128]), torch.Size([1, 10919, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3271517753601074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0664868354797363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 10919, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0056724548339844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0204925537109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0353126525878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0203766822814941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([15540, 256])
first layer input nodes number: 39281
first layer output nodes number: 15540
edges number: 131535
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0356073379516602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0504274368286133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0543389320373535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0543389320373535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([338, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0862746238708496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0862746238708496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0869193077087402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0922088623046875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([293, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0924501419067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0924501419067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0930089950561523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1023473739624023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([208, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1026678085327148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1026678085327148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1030645370483398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1117925643920898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([170, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1122479438781738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1122479438781738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.112572193145752  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1219754219055176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([120, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1223902702331543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1223902702331543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1226191520690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1308588981628418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([109, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.131373405456543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.131373405456543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1315813064575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1405210494995117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([101, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.141097068786621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.141097068786621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1412897109985352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1509218215942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([77, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1514177322387695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1514177322387695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.151564598083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1599359512329102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1605463027954102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1605463027954102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1606969833374023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1703405380249023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1708903312683105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1708903312683105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1710143089294434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.179816722869873  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1803679466247559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1803679466247559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.180478572845459  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1891074180603027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1896867752075195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1896867752075195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1897916793823242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1987085342407227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.199143409729004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.199143409729004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1992177963256836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2060613632202148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.206629753112793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.206629753112793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2067155838012695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2152128219604492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2157468795776367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2157468795776367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2158231735229492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2239103317260742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2243800163269043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2243800163269043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.224442958831787  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.231555461883545  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2319817543029785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2319817543029785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2320351600646973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2384438514709473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2391095161437988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2391095161437988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2391858100891113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2488751411437988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.249549388885498  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.249549388885498  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2496237754821777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2595915794372559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2600736618041992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2600736618041992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2601251602172852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2673864364624023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.267744541168213  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.267744541168213  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2677807807922363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.273144245147705  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2736549377441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2736549377441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.273702621459961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2810935974121094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2814898490905762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2814898490905762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2815260887145996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2873969078063965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2880020141601562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2880020141601562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2880535125732422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2967567443847656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([705, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3136711120605469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3136711120605469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 705, 256]), torch.Size([1, 705, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3150157928466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5566530227661133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 705, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5272912979125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.527702808380127  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5281143188476562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.527681827545166  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2759, 40])
input nodes number: 15540
output nodes number: 2759
edges number: 31865
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5278129577636719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5278139114379883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03441333770751953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 1 input nodes size: 49891
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.031067848205566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.031067848205566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.054857730865478516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05487871170043945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.035326480865478516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03674745559692383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03674745559692383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03674745559692383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([49891, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03674745559692383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([599, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11509370803833008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11509370803833008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11566495895385742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12069320678710938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([685, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12106084823608398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12106084823608398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12171411514282227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13151311874389648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([601, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13204622268676758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13204622268676758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13261938095092773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14533758163452148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([554, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14610767364501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14610767364501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1466360092163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16225147247314453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([641, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16351556777954102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16351556777954102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16412687301635742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18638896942138672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([600, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18779993057250977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18779993057250977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18837213516235352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21299982070922852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([572, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21462297439575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21462297439575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21516847610473633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24311304092407227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([559, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24497270584106445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24497270584106445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24550580978393555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2762322425842285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([609, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2785792350769043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2785792350769043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2791600227355957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3175334930419922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([13241, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.38038110733032227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.38038110733032227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13241, 128]), torch.Size([1, 13241, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3930087089538574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2979435920715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13241, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2225513458251953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2403478622436523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2581443786621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.240208625793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([18661, 256])
first layer input nodes number: 49891
first layer output nodes number: 18661
edges number: 159160
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2585182189941406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2763147354125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.280764102935791  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.280764102935791  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([318, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3114032745361328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3114032745361328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3120098114013672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3179645538330078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([288, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3182148933410645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3182148933410645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3187642097473145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3276400566101074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([213, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.327979564666748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.327979564666748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.328385829925537  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3373236656188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([140, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3376588821411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3376588821411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.337925910949707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3456697463989258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.346261978149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.346261978149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3465499877929688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3569183349609375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([126, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3575010299682617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3575010299682617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.357741355895996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3680753707885742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([97, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.368607997894287  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.368607997894287  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.36879301071167  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3780436515808105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3786511421203613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3786511421203613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3788247108459473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3887181282043457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3894362449645996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3894362449645996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3896136283874512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4009661674499512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.40155029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.40155029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4016838073730469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.411163330078125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4119110107421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4119110107421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.412057876586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.423513412475586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4241089820861816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4241089820861816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4242196083068848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4336228370666504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4342050552368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4342050552368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4343023300170898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.443251609802246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4439029693603516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4439029693603516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4440021514892578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4538211822509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.454535961151123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.454535961151123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.454637050628662  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4653525352478027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4660248756408691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4660248756408691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4661145210266113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4762444496154785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4768695831298828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4768695831298828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4769477844238281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4863319396972656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4872851371765137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4872851371765137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.487393856048584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5012011528015137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5018773078918457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5018773078918457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5019536018371582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5121769905090332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5130043029785156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5130043029785156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5130901336669922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5251922607421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.526118278503418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.526118278503418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.526209831237793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.539759635925293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5403485298156738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5403485298156738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5404057502746582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5492749214172363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5497989654541016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5497989654541016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5498466491699219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5575714111328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5580320358276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5580320358276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5580720901489258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5648412704467773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([571, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5785417556762695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5785417556762695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5796308517456055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7716670036315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 571, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7437491416931152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7441668510437012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.744584560394287  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7441458702087402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2803, 40])
input nodes number: 18661
output nodes number: 2803
edges number: 31434
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7443122863769531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7443127632141113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0392303466796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 2 input nodes size: 45275
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.035332679748535156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.035332679748535156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05692148208618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05694246292114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03313159942626953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03412628173828125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03412628173828125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03412628173828125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([45275, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03412628173828125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([792, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08945512771606445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.08945512771606445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0902104377746582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09659099578857422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([915, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09708595275878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09708595275878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09795856475830078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11131000518798828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([821, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11204814910888672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11204814910888672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11283111572265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13069581985473633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([659, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.131561279296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.131561279296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 659, 128]), torch.Size([1, 659, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13218975067138672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1513080596923828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 659, 128])
m.shape torch.Size([638, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15251493453979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15251493453979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1531233787536621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.17534494400024414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([577, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1775355339050293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1775355339050293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1780858039855957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20256948471069336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([503, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20397329330444336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20397329330444336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2044529914855957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2284379005432129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([466, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.22997570037841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.22997570037841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23042011260986328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2557516098022461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([458, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2574949264526367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2574949264526367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2579317092895508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2858858108520508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([8659, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.32695674896240234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.32695674896240234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8659, 128]), torch.Size([1, 8659, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.33521461486816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9229335784912109  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8659, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8718967437744141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8857135772705078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8995304107666016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8856053352355957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([14488, 256])
first layer input nodes number: 45275
first layer output nodes number: 14488
edges number: 112334
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.8998699188232422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9136867523193359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9171409606933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9171409606933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([468, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9379525184631348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9379525184631348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.938845157623291  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.945986270904541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([430, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9463667869567871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9463667869567871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9471869468688965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9594893455505371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([330, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9600310325622559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9600310325622559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.960660457611084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9766030311584473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9771113395690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9771113395690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9775195121765137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.989356517791748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([171, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9899744987487793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9899744987487793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9903006553649902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.002042293548584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([123, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0025887489318848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0025887489318848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0028233528137207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.012911319732666  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0135812759399414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0135812759399414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0138044357299805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0249624252319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0255122184753418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0255122184753418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0256762504577637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0350260734558105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([63, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0354890823364258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0354890823364258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.035609245300293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.043299674987793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.043989658355713  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.043989658355713  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0441384315490723  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.054701328277588  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.055208683013916  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.055208683013916  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0553135871887207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0634961128234863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.064101219177246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.064101219177246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0642099380493164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.073451042175293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0740842819213867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0740842819213867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0741891860961914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0838403701782227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.084259033203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.084259033203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0843257904052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0909347534179688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0913772583007812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0913772583007812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.091440200805664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0981121063232422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.09844970703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.09844970703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0984954833984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.103668212890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.104184627532959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.104184627532959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1042475700378418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1118006706237793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1122021675109863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1122021675109863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1122498512268066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1183056831359863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1186108589172363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1186108589172363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.118645191192627  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1232457160949707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.123690128326416  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.123690128326416  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1237359046936035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.130190372467041  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1304302215576172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1304302215576172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1304550170898438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.134124755859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.134303092956543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.134303092956543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1343202590942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1369810104370117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1373043060302734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1373043060302734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1373329162597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1419677734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.14223051071167  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.14223051071167  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1422533988952637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1461215019226074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1530852317810059  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1530852317810059  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1536288261413574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2636170387268066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2459745407104492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2463879585266113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2468013763427734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2463669776916504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2773, 40])
input nodes number: 14488
output nodes number: 2773
edges number: 21056
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2464919090270996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2464923858642578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03596830368041992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 3 input nodes size: 49661
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0331273078918457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0331273078918457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.056807518005371094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05682849884033203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03521871566772461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.036676883697509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.036676883697509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.036676883697509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([49661, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.036676883697509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([604, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11702775955200195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11702775955200195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11760377883911133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12277030944824219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([605, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12305927276611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12305927276611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12363624572753906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13229084014892578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([586, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13284063339233398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13284063339233398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.13339948654174805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14569425582885742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([582, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14652490615844727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14652490615844727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1470799446105957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16321420669555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([615, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16440296173095703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16440296173095703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16498947143554688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18650102615356445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([605, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18793869018554688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18793869018554688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18851566314697266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21366405487060547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([553, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21522140502929688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21522140502929688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21574878692626953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24292707443237305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([535, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24531841278076172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24531841278076172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24582862854003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2750539779663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([545, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.27713775634765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.27713775634765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.27765750885009766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.31157732009887695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([13816, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.37772369384765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.37772369384765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13816, 128]), torch.Size([1, 13816, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.390899658203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3263931274414062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13816, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2504000663757324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2685637474060059  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2867274284362793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2684216499328613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([19046, 256])
first layer input nodes number: 49661
first layer output nodes number: 19046
edges number: 163821
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2870993614196777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3052630424499512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3101611137390137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3101611137390137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([350, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3412370681762695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3412370681762695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.341904640197754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3473100662231445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([272, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3474993705749512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3474993705749512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3480181694030762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3570752143859863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([203, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3574013710021973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3574013710021973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3577885627746582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3663067817687988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([176, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3667898178100586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3667898178100586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3671255111694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3768606185913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([143, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.37738037109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.37738037109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3776531219482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.387472152709961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([122, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3880395889282227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3880395889282227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3882722854614258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3982782363891602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3988080024719238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3988080024719238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3989911079406738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4081463813781738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([71, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4086008071899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4086008071899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.408736228942871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4164552688598633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4170279502868652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4170279502868652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4171690940856934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4262022972106934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([54, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4266510009765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4266510009765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4267539978027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4340667724609375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.434586524963379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.434586524963379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4346895217895508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.442723274230957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4433064460754395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4433064460754395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4434113502502441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4523282051086426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4528756141662598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4528756141662598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4529671669006348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4613900184631348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4619364738464355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4619364738464355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4620203971862793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4703288078308105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4708638191223145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4708638191223145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.470940113067627  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.479027271270752  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4794507026672363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4794507026672363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4795079231262207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.485973834991455  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4862723350524902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4862723350524902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4863104820251465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4908881187438965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.491457462310791  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.491457462310791  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4915223121643066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.499758243560791  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5002737045288086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5002737045288086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.500330924987793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5079984664916992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5085277557373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5085277557373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5085830688476562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5163822174072266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5168190002441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5168190002441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5168628692626953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.523355484008789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.523819923400879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.523819923400879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5238637924194336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5306634902954102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5313711166381836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5313711166381836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5314340591430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.541630744934082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5420608520507812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5420608520507812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5420989990234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5485458374023438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([714, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5656828880310059  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.5656828880310059  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.567044734954834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.8181662559509277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 714, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7896661758422852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7900772094726562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7904882431030273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7900562286376953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2758, 40])
input nodes number: 19046
output nodes number: 2758
edges number: 31854
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7902169227600098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.790217399597168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03919792175292969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 4 input nodes size: 42635
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.035216331481933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.035216331481933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05554628372192383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.055567264556884766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03186607360839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.032993316650390625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.032993316650390625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.032993316650390625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([42635, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.032993316650390625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([644, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09483575820922852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09483575820922852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.09544992446899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10039091110229492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([646, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10069990158081055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10069990158081055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10131597518920898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11120414733886719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([649, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11182451248168945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11182451248168945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 649, 128]), torch.Size([1, 649, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11244344711303711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1261439323425293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 649, 128])
m.shape torch.Size([579, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1269388198852539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1269388198852539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12749099731445312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14437198638916016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([586, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1454930305480957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1454930305480957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14605188369750977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16702604293823242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([524, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16824579238891602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16824579238891602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1687455177307129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1905655860900879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([523, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1920614242553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1920614242553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.19256019592285156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21831274032592773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([462, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21982574462890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.21982574462890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.22026634216308594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24538040161132812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([458, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24712562561035156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24712562561035156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.24756240844726562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2755165100097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([10211, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3239879608154297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3239879608154297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 10211, 128]), torch.Size([1, 10211, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.3338918685913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.026449203491211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 10211, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9683895111083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9829635620117188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9975376129150391  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9828495979309082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([15282, 256])
first layer input nodes number: 42635
first layer output nodes number: 15282
edges number: 125862
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.9978575706481934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0124316215515137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0163931846618652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0163931846618652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0412306785583496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0412306785583496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0419955253601074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0490632057189941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([328, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.049311637878418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.049311637878418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0499372482299805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0595293045043945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([249, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0599346160888672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0599346160888672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0604095458984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0708580017089844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([204, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0714049339294434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0714049339294434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.071794033050537  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0830779075622559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0837821960449219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0837821960449219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0841388702392578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0969791412353516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([131, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0975565910339355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.0975565910339355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.097806453704834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1085505485534668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1092333793640137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1092333793640137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1094622611999512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1209063529968262  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([81, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.121415138244629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.121415138244629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1215696334838867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.130375862121582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.131016731262207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.131016731262207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1311750411987305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1413068771362305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1418237686157227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1418237686157227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.141942024230957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1503381729125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1511249542236328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1511249542236328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1512775421142578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1631793975830078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1638298034667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1638298034667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.163949966430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.174163818359375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1747159957885742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1747159957885742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.174809455871582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1834077835083008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.183912754058838  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.183912754058838  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1839909553527832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1917328834533691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1924147605895996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1924147605895996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1925101280212402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2026190757751465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2030329704284668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2030329704284668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2030901908874512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2095561027526855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2100505828857422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2100505828857422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2101116180419922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2174358367919922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.217855453491211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.217855453491211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.217905044555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.224203109741211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.224635124206543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.224635124206543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2246828079223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2310724258422852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2316255569458008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2316255569458008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2316827774047852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.239750862121582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.240227222442627  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.240227222442627  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2402749061584473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2473320960998535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2476258277893066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2476258277893066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2476544380187988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.252089023590088  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2524948120117188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2524948120117188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2525310516357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.258401870727539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2587299346923828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2587299346923828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.258758544921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2635936737060547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([412, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2734789848327637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2734789848327637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2742648124694824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.423323154449463  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 412, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4013500213623047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4017610549926758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4021720886230469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4017400741577148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2758, 40])
input nodes number: 15282
output nodes number: 2758
edges number: 25312
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4018750190734863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4018754959106445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.035001277923583984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 5 input nodes size: 40319
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03186607360839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03186607360839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05139732360839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.05141878128051758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.031067848205566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.032423973083496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.032423973083496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.032423973083496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([40319, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.032423973083496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([445, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10466432571411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10466432571411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10508871078491211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10848379135131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([491, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10873985290527344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.10873985290527344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1092081069946289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11623191833496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([472, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11667299270629883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11667299270629883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.11712312698364258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12702608108520508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([471, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1276993751525879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1276993751525879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.12814855575561523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1411747932434082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([498, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1421375274658203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1421375274658203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.14261245727539062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.15970993041992188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([462, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16079425811767578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16079425811767578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.16123485565185547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18018054962158203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([452, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18146896362304688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.18146896362304688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.1819000244140625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20345306396484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([473, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20504188537597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20504188537597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.20549297332763672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.23120498657226562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([464, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2329707145690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2329707145690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2334132194519043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.2617335319519043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([12461, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.32093095779418945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.32093095779418945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12461, 128]), torch.Size([1, 12461, 128])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.33281469345092773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1765599250793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12461, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.107945442199707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.123861312866211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1397771835327148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.12373685836792  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([16689, 256])
first layer input nodes number: 40319
first layer output nodes number: 16689
edges number: 145723
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1400794982910156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1559953689575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1599745750427246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1599745750427246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([262, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1950597763061523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1950597763061523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.1955595016479492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2014284133911133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([231, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2016229629516602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2016229629516602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2020635604858398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2086725234985352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([175, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2089571952819824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2089571952819824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2092909812927246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2166342735290527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([148, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2170367240905762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2170367240905762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2173190116882324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2255053520202637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([138, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.226027488708496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.226027488708496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2262907028198242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2357664108276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([99, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2362060546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2362060546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2363948822021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2445144653320312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2450122833251953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2450122833251953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2451801300048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2535724639892578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2542190551757812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2542190551757812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2544002532958984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2647285461425781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2654080390930176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2654080390930176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.265577793121338  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.276442050933838  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.27720308303833  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.27720308303833  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2773709297180176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.28928804397583  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2899551391601562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.2899551391601562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.290090560913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3006534576416016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3014740943908691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3014740943908691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3016209602355957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3141045570373535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.314793586730957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.314793586730957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3149099349975586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3256139755249023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3262825012207031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3262825012207031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.326385498046875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3365821838378906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3372950553894043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3372950553894043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3373961448669434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.348111629486084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3488149642944336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3488149642944336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3489084243774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3594694137573242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3601579666137695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3601579666137695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.360243797302246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3705434799194336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3721318244934082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3721318244934082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3722424507141113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3862919807434082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3878679275512695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3878679275512695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.3879728317260742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4020299911499023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.403608798980713  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.403608798980713  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4037117958068848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4182343482971191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4198145866394043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4198145866394043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4199137687683105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4345927238464355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4352412223815918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4352412223815918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4353041648864746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4450602531433105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4455375671386719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4455375671386719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4455814361572266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.452688217163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4534740447998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4534740447998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4535408020019531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.464822769165039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([719, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4820656776428223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4820656776428223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 719, 256]), torch.Size([1, 719, 256])
----------------------------------------3
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.4834370613098145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.735447883605957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 719, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7029728889465332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7033982276916504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7038235664367676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7033767700195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2852, 40])
input nodes number: 16689
output nodes number: 2852
edges number: 36111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7035369873046875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 1.7035374641418457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.034770965576171875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 6 input nodes size: 46111
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0310821533203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0310821533203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.0530695915222168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.053090572357177734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.033537864685058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03505897521972656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03505897521972656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03505897521972656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([46111, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5955810546875 GB
    Memory Allocated: 0.03505897521972656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([491, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.11744213104248047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.11744213104248047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.11791038513183594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.12165641784667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([494, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.12189340591430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.12189340591430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.12236452102661133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.12943124771118164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([523, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.12994384765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.12994384765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.13044261932373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.14272022247314453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([511, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.14344549179077148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.14344549179077148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.14393281936645508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.1580653190612793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([475, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.15895414352416992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.15895414352416992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.1594071388244629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.17571496963500977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([485, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.17687606811523438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.17687606811523438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.1773386001586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.19722747802734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([491, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.19863510131835938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.19863510131835938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.19910335540771484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.22251605987548828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([509, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.22481203079223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.22481203079223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.2252974510192871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.25296640396118164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([503, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.2548823356628418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.2548823356628418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.25536203384399414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.28606271743774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([14574, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.35613536834716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.35613536834716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14574, 128]), torch.Size([1, 14574, 128])
----------------------------------------3
 Nvidia-smi: 4.6776123046875 GB
    Memory Allocated: 0.37003421783447266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3568525314331055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14574, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2784490585327148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2966222763061523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3147954940795898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2964801788330078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([19056, 256])
first layer input nodes number: 46111
first layer output nodes number: 19056
edges number: 168153
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.315141201019287  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3333144187927246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.337857723236084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.337857723236084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([297, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3727922439575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3727922439575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3733587265014648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.378565788269043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([204, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3786749839782715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3786749839782715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3790640830993652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3849005699157715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([191, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3852567672729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3852567672729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3856210708618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3936357498168945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([144, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3940072059631348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3940072059631348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3942818641662598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4022469520568848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([118, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.402677059173584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.402677059173584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4029021263122559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4110045433044434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([92, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4114227294921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4114227294921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4115982055664062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4191436767578125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([80, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4195942878723145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4195942878723145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4197468757629395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4273762702941895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([69, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.427830696105957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.427830696105957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.427962303161621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4354639053344727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4360904693603516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4360904693603516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4362430572509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4460086822509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4466919898986816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4466919898986816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4468426704406738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4575409889221191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4581108093261719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4581108093261719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4582271575927734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4673023223876953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4680171012878418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4680171012878418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4681448936462402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4790072441101074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4795432090759277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4795432090759277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4796347618103027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4880576133728027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4885635375976562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4885635375976562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4886417388916016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4963836669921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4968204498291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4968204498291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4968833923339844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5035552978515625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5042777061462402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5042777061462402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.504371166229248  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5149321556091309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5155391693115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5155391693115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.515615463256836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.524770736694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.525407314300537  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.525407314300537  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5254817008972168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.534928798675537  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5355310440063477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5355310440063477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.535597801208496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5445432662963867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5450677871704102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5450677871704102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5451231002807617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.552922248840332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5536818504333496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5536818504333496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5537562370300293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.564765453338623  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5652995109558105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5652995109558105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5653510093688965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5733332633972168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.573948860168457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.573948860168457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5740041732788086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5829648971557617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5836296081542969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5836296081542969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5836868286132812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.5933570861816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([837, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.614060878753662  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.614060878753662  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.6156573295593262  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.9025487899780273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 837, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.8704204559326172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.8708314895629883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.8712425231933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.8708105087280273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2758, 40])
input nodes number: 19056
output nodes number: 2758
edges number: 35922
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.8709592819213867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.870959758758545  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03763532638549805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 7 input nodes size: 43025
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0335235595703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0335235595703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05403947830200195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05406045913696289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.032052040100097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.033354759216308594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.033354759216308594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.033354759216308594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([43025, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.033354759216308594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([586, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10402297973632812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10402297973632812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10458183288574219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11025762557983398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([613, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11056280136108398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11056280136108398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11114740371704102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11991643905639648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([616, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12050533294677734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12050533294677734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1210927963256836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13479900360107422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([535, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13552570343017578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13552570343017578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13603591918945312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15155315399169922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([504, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15249967575073242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15249967575073242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15298032760620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17028379440307617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([516, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17151975631713867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17151975631713867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1720118522644043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19321584701538086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([471, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19454193115234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19454193115234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1949911117553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21745014190673828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([460, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2189803123474121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2189803123474121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21941900253295898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24442434310913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([459, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24617481231689453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24617481231689453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.246612548828125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.274627685546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([12150, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33300256729125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33300256729125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12150, 128]), torch.Size([1, 12150, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3451571464538574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1746878623962402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12150, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1079587936401367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1240854263305664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.140212059020996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1239590644836426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([16910, 256])
first layer input nodes number: 43025
first layer output nodes number: 16910
edges number: 144024
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1405348777770996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1566615104675293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1606931686401367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1606931686401367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([352, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.190680980682373  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.190680980682373  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.191352367401123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1991467475891113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([290, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.199368953704834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.199368953704834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1999220848083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2082228660583496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([224, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.208592414855957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.208592414855957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.209019660949707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.218419075012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([170, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2188591957092285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2188591957092285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2191834449768066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2285866737365723  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([144, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2291169166564941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2291169166564941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2293915748596191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2392792701721191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([121, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.239840030670166  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.239840030670166  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2400708198547363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2499947547912598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([93, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2505054473876953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2505054473876953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2506828308105469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.259552001953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2601094245910645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2601094245910645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2602696418762207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.269402027130127  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2699880599975586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2699880599975586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2701349258422852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2795343399047852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2801146507263184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2801146507263184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2802443504333496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2894530296325684  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.289980411529541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.289980411529541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2900872230529785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2984185218811035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2989420890808105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2989420890808105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2990374565124512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3071436882019043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3076834678649902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3076834678649902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3077731132507324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3160204887390137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3165273666381836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3165273666381836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.316605567932129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3243474960327148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3247265815734863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3247265815734863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.324781894683838  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3306450843811035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3312325477600098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3312325477600098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3313088417053223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3399300575256348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3405132293701172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3405132293701172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.340585708618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.349283218383789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3497490882873535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3497490882873535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.349804401397705  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3568291664123535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3573131561279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3573131561279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3573665618896484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.364522933959961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3650922775268555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3650922775268555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3651514053344727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.373488426208496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3739032745361328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3739032745361328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3739452362060547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3801555633544922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3805789947509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3805789947509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3806190490722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3868274688720703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3872499465942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3872499465942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3872880935668945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.393467903137207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3940720558166504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3940720558166504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.3941235542297363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4028267860412598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([657, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4185876846313477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4185876846313477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.4198408126831055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.6434144973754883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 657, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.616051197052002  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.6164627075195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.6168742179870605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.6164417266845703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2759, 40])
input nodes number: 16910
output nodes number: 2759
edges number: 30679
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.6165895462036133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.6165900230407715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03561878204345703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 8 input nodes size: 13291
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03205251693725586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03205251693725586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.038390159606933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03841209411621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017875194549560547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018290042877197266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018290042877197266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018290042877197266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([13291, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018290042877197266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([732, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03661155700683594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03661155700683594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03730964660644531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.043576717376708984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([801, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0439915657043457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0439915657043457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04475545883178711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0562138557434082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([644, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05675315856933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05675315856933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05736732482910156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0720524787902832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([560, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07281351089477539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07281351089477539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07334756851196289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08934640884399414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([515, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09030723571777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09030723571777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09079837799072266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10847949981689453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([394, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10936117172241211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10936117172241211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10973691940307617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12589406967163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([339, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12683773040771484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12683773040771484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 339, 128]), torch.Size([1, 339, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12716102600097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1433258056640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 339, 128])
m.shape torch.Size([328, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14447450637817383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14447450637817383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14478731155395508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16261720657348633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([271, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16362380981445312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16362380981445312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 271, 128]), torch.Size([1, 271, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16388225555419922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18042278289794922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 271, 128])
m.shape torch.Size([1772, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18874311447143555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18874311447143555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 1772, 128]), torch.Size([1, 1772, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19043302536010742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31041669845581055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 1772, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2951502799987793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3012118339538574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30727338790893555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3011641502380371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6356, 256])
first layer input nodes number: 13291
first layer output nodes number: 6356
edges number: 36601
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3073744773864746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31343603134155273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31495141983032227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31495141983032227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([481, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3338632583618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3338632583618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3347806930541992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3445119857788086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([453, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3449244499206543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3449244499206543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34578847885131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3596529960632324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([321, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36014699935913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36014699935913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36075925827026367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3748135566711426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([244, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3754458427429199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3754458427429199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37591123580932617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3894076347351074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([233, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3903007507324219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3903007507324219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3907451629638672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40674400329589844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40741586685180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40741586685180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4077115058898926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4204239845275879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42128562927246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42128562927246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4215717315673828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43587684631347656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4366030693054199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4366030693054199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43681859970092773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44910383224487305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4499220848083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4499220848083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45012617111206055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46318769454956055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46387386322021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46387386322021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46403026580810547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47513484954833984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4756593704223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4756593704223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4757680892944336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48424816131591797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4848513603210449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4848513603210449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48496007919311523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4942011833190918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4947967529296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4947967529296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49489593505859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5040206909179688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5045228004455566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5045228004455566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.504601001739502  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5123429298400879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5127511024475098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5127511024475098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.512810230255127  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5190777778625488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5195250511169434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5195250511169434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5195841789245605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5262656211853027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5266447067260742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5266447067260742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5266923904418945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.532414436340332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5328750610351562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5328750610351562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.532928466796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5397109985351562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5401411056518555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5401411056518555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5401887893676758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5465784072875977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5468816757202148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5468816757202148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5469141006469727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5514860153198242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5517525672912598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5517525672912598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5517792701721191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5557312965393066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5560355186462402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5560355186462402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5560641288757324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5604987144470215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.560727596282959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.560727596282959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5607485771179199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5641474723815918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5644831657409668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5644831657409668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.564511775970459  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5693469047546387  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([136, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5726008415222168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5726008415222168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5728602409362793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6185145378112793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 136, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6028923988342285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6033239364624023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6037554740905762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.603302001953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2894, 40])
input nodes number: 6356
output nodes number: 2894
edges number: 19061
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6033916473388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6033921241760254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01914215087890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 9 input nodes size: 19609
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017895221710205078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017895221710205078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027245521545410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0272674560546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.020907878875732422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021392345428466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021392345428466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021392345428466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([19609, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021392345428466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([833, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04472208023071289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04472208023071289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0455164909362793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05187177658081055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([806, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05224323272705078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05224323272705078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05301189422607422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06454181671142578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([791, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06531000137329102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06531000137329102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06606435775756836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08266019821166992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([669, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08371353149414062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08371353149414062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0843515396118164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10308599472045898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([644, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10430240631103516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10430240631103516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10491657257080078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12745189666748047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([495, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12856101989746094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12856101989746094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12903308868408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14933204650878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([419, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15049457550048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15049457550048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1508941650390625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17087364196777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 419, 128])
m.shape torch.Size([357, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17203569412231445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17203569412231445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17237615585327148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19178247451782227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([288, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19284820556640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19284820556640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19312286376953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21070098876953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([2467, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22232723236083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22232723236083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2467, 128]), torch.Size([1, 2467, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22467994689941406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3995809555053711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2467, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37896156311035156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3863706588745117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3937797546386719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38631248474121094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([7769, 256])
first layer input nodes number: 19609
first layer output nodes number: 7769
edges number: 46735
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39392805099487305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4013371467590332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4038729667663574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4038729667663574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([547, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4218864440917969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4218864440917969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4229297637939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43149852752685547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([394, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.431734561920166  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.431734561920166  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43248605728149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4440774917602539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([342, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44483327865600586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44483327865600586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44548559188842773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4605240821838379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([272, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4612436294555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4612436294555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4617624282836914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47736454010009766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([245, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4782829284667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4782829284667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47875022888183594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4955730438232422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49637746810913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49637746810913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4967207908630371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5114836692810059  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.51220703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.51220703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5124607086181641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5251445770263672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5259637832641602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5259637832641602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5261983871459961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5395708084106445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5402321815490723  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5402321815490723  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5404038429260254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5513901710510254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5519485473632812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5519485473632812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5520763397216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5611495971679688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5616464614868164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5616464614868164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5617475509643555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5696325302124023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5701818466186523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5701818466186523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5702810287475586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5787115097045898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5793743133544922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5793743133544922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5794830322265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5894851684570312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5900363922119141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5900363922119141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5901222229003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5986194610595703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5990381240844727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5990381240844727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5990991592407227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6055688858032227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6059384346008301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6059384346008301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6059880256652832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6115918159484863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6119756698608398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6119756698608398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6120233535766602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6177453994750977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6180505752563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6180505752563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6180868148803711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6226892471313477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6230549812316895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6230549812316895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6230950355529785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6284623146057129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6287884712219238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6287884712219238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6288228034973145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6336636543273926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6338081359863281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6338081359863281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6338233947753906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6360816955566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6362857818603516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6362857818603516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6363048553466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6392612457275391  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6394729614257812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6394729614257812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6394920349121094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6425819396972656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6427569389343262  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6427569389343262  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6427721977233887  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6453509330749512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([124, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6483230590820312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6483230590820312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6485595703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.690185546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 124, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6755366325378418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.675969123840332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6764016151428223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6759471893310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2901, 40])
input nodes number: 7769
output nodes number: 2901
edges number: 18059
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6760282516479492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6760287284851074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.022367000579833984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 10 input nodes size: 15589
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.020908832550048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.020908832550048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.028342247009277344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.028363704681396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018991470336914062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019378662109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019378662109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019378662109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([15589, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019378662109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([745, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03713178634643555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03713178634643555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 745, 128]), torch.Size([1, 745, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0378422737121582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04352617263793945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 745, 128])
m.shape torch.Size([833, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04396533966064453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04396533966064453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04475975036621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.056894779205322266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([700, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.057717323303222656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.057717323303222656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05838489532470703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07307147979736328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([602, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07399654388427734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07399654388427734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0745706558227539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09135723114013672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([537, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09235048294067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09235048294067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09286260604858398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11188983917236328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([415, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11282110214233398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11282110214233398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 415, 128]), torch.Size([1, 415, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11321687698364258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1302351951599121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 415, 128])
m.shape torch.Size([313, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13108205795288086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13108205795288086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13138055801391602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14630556106567383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([317, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14736557006835938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14736557006835938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14766788482666016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1648998260498047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([249, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1658172607421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1658172607421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 249, 128]), torch.Size([1, 249, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16605472564697266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18125247955322266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 249, 128])
m.shape torch.Size([1636, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1889348030090332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1889348030090332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 1636, 128]), torch.Size([1, 1636, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19049501419067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3045048713684082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 1636, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2897367477416992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2957897186279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30184268951416016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2957420349121094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6347, 256])
first layer input nodes number: 15589
first layer output nodes number: 6347
edges number: 35422
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30196094512939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.308013916015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3095273971557617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3095273971557617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([525, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3259100914001465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3259100914001465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 525, 256]), torch.Size([1, 525, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32691144943237305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33542919158935547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 525, 256])
m.shape torch.Size([464, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33582067489624023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33582067489624023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33670568466186523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3507394790649414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([360, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3515496253967285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3515496253967285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.352236270904541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.367342472076416  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([284, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3681473731994629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3681473731994629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36868906021118164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3853592872619629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([234, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3862133026123047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3862133026123047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3866596221923828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4027271270751953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.403409481048584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.403409481048584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40370893478393555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41658544540405273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4172968864440918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4172968864440918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4175410270690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4297480583190918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4306025505065918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4306025505065918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.430844783782959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44465208053588867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4454655647277832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4454655647277832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44567155838012695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45885515213012695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45938682556152344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45938682556152344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45951271057128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46845054626464844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4689903259277344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4689903259277344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4690990447998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47757911682128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47806692123413086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47806692123413086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47815656661987305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.485776424407959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4863314628601074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4863314628601074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4864230155944824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4948458671569824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4952983856201172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4952983856201172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49536895751953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5023555755615234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5027384757995605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5027384757995605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5027937889099121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5086569786071777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5090756416320801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5090756416320801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5091309547424316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5153813362121582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5156807899475098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5156807899475098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.515718936920166  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.520296573638916  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.520606517791748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.520606517791748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5206427574157715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.525245189666748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5253915786743164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5253915786743164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5254087448120117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5277090072631836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5279507637023926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5279507637023926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5279755592346191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5314717292785645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5316815376281738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5316815376281738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5317025184631348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5348076820373535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5349454879760742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5349454879760742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5349588394165039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5370283126831055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5371546745300293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5371546745300293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5371661186218262  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5390200614929199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5391988754272461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5391988754272461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5392141342163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5417928695678711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([80, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5437078475952148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5437078475952148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5438604354858398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5707159042358398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 80, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5576786994934082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5581068992614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.558535099029541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5580854415893555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2873, 40])
input nodes number: 6347
output nodes number: 2873
edges number: 16385
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5581502914428711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5581507682800293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.020176410675048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 11 input nodes size: 23899
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018987178802490234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018987178802490234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03038311004638672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.030405044555664062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.022950172424316406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023584365844726562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023584365844726562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023584365844726562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([23899, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023584365844726562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([655, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05402231216430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05402231216430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.054646968841552734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060321807861328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([744, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06071901321411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06071901321411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06142854690551758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07238292694091797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([709, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07304239273071289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07304239273071289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07371854782104492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08874702453613281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([633, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08961629867553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08961629867553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09021997451782227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1081385612487793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([575, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1092076301574707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1092076301574707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1097559928894043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12949705123901367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([529, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1307363510131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1307363510131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1312408447265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15330934524536133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([468, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1546192169189453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1546192169189453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15506553649902344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1773815155029297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([461, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17891693115234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17891693115234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17935657501220703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20441627502441406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([390, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2058701515197754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2058701515197754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20624208450317383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.23004579544067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([3817, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2480607032775879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2480607032775879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 3817, 128]), torch.Size([1, 3817, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.25170087814331055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5101532936096191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 3817, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4844932556152344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4930582046508789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5016231536865234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49299097061157227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([8981, 256])
first layer input nodes number: 23899
first layer output nodes number: 8981
edges number: 61495
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5018033981323242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5103683471679688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5127696990966797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5127696990966797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5359301567077637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5359301567077637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5367293357849121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5439257621765137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5442147254943848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5442147254943848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5448975563049316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5564217567443848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5569367408752441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5569367408752441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5575032234191895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5716147422790527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5722122192382812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5722122192382812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5726490020751953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5853157043457031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5860252380371094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5860252380371094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5863933563232422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5996456146240234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6004247665405273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6004247665405273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.600743293762207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6144399642944336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6151490211486816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6151490211486816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6153950691223145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6276974678039551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6285357475280762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6285357475280762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6287741661071777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6423640251159668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6430149078369141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6430149078369141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6431846618652344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6540489196777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.654752254486084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.654752254486084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6549086570739746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.666013240814209  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.666717529296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.666717529296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6668586730957031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6778678894042969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6785125732421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6785125732421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6786308288574219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6886825561523438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.689335823059082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.689335823059082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6894445419311523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6994466781616211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7001190185546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7001190185546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7002220153808594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.710418701171875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7111024856567383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7111024856567383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7111997604370117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7215108871459961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7220621109008789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7220621109008789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7221364974975586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7305421829223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7311263084411621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7311263084411621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.731198787689209  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.739896297454834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7405004501342773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7405004501342773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7405710220336914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7495336532592773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7500648498535156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7500648498535156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7501239776611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7580471038818359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7585945129394531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7585945129394531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7586517333984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7667198181152344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7670950889587402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7670950889587402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7671332359313965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7727789878845215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7732253074645996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7732253074645996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7732672691345215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7797713279724121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7802367210388184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7802367210388184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7802786827087402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.787076473236084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7874479293823242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7874479293823242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.787480354309082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7929601669311523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([254, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7990474700927734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7990474700927734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7995319366455078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8847980499267578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 254, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8647904396057129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8652219772338867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8656535148620605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8652000427246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2896, 40])
input nodes number: 8981
output nodes number: 2896
edges number: 23546
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8652925491333008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.865293025970459  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.024810791015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 12 input nodes size: 31096
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.022953510284423828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.022953510284423828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03857851028442383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.038599491119384766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027181625366210938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027792930603027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027792930603027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027792930603027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([31096, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027792930603027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([819, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060286521911621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060286521911621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06106758117675781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06731605529785156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([871, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06775617599487305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06775617599487305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06858682632446289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0817255973815918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([792, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0824432373046875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0824432373046875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08319854736328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10056114196777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([641, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10140609741210938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10140609741210938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10201740264892578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11974525451660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([570, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1215662956237793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1215662956237793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12210988998413086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1416792869567871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([496, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14282655715942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14282655715942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14329957962036133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16363954544067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([488, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1652073860168457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1652073860168457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16567277908325195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18894243240356445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([414, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19028902053833008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19028902053833008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 414, 128]), torch.Size([1, 414, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19068384170532227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21318864822387695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 414, 128])
m.shape torch.Size([345, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21447181701660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21447181701660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21480083465576172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.23585796356201172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([4209, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.25576353073120117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.25576353073120117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 4209, 128]), torch.Size([1, 4209, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2597775459289551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5451879501342773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 4209, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5163435935974121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5255417823791504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5347399711608887  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5254697799682617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([9645, 256])
first layer input nodes number: 31096
first layer output nodes number: 9645
edges number: 65250
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5349736213684082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5441718101501465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5464715957641602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5464715957641602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([538, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5632266998291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5632266998291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5642528533935547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5727090835571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([481, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5731210708618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5731210708618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5740385055541992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5880293846130371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([337, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5885424613952637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5885424613952637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5891852378845215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.604771614074707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.60540771484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.60540771484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6058826446533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6196556091308594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6202688217163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6202688217163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6206064224243164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6327600479125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6334624290466309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6334624290466309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6337504386901855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6461348533630371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.646885871887207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.646885871887207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6471395492553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6598234176635742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6603579521179199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6603579521179199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6605219841003418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6698718070983887  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6704130172729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6704130172729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6705503463745117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6793394088745117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6799821853637695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6799821853637695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6801233291625977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6901445388793945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6905713081359863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6905713081359863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6906609535217285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6976532936096191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6980586051940918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6980586051940918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6981329917907715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7044558525085449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7048687934875488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7048687934875488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7049374580383301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7112545967102051  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7116374969482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7116374969482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7116966247558594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7175502777099609  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7179388999938965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7179388999938965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.717994213104248  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7238574028015137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7241530418395996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7241530418395996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7241930961608887  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7287192344665527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7290587425231934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7290587425231934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7291007041931152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7341361045837402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7344613075256348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7344613075256348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.734499454498291  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7393441200256348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7396359443664551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7396359443664551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7396683692932129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7440133094787598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7442665100097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7442665100097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.744293212890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7480583190917969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7483882904052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7483882904052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7484207153320312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7532196044921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7534360885620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7534360885620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7534570693969727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.756709098815918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7569642066955566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7569642066955566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7569870948791504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7606949806213379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7609834671020508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7609834671020508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7610082626342773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7651987075805664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([131, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7683343887329102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7683343887329102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7685842514038086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8125600814819336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 131, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7990050315856934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7994160652160645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7998270988464355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7993950843811035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2758, 40])
input nodes number: 9645
output nodes number: 2758
edges number: 16762
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7994675636291504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7994680404663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.028988361358642578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 13 input nodes size: 40340
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027161121368408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027161121368408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0466923713684082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04671335220336914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.031067371368408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.032030582427978516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.032030582427978516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.032030582427978516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([40340, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.032030582427978516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([726, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08407115936279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08407115936279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 726, 128]), torch.Size([1, 726, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0847635269165039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0903024673461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 726, 128])
m.shape torch.Size([790, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09070968627929688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09070968627929688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09146308898925781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10276412963867188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([705, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10341739654541016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10341739654541016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10408973693847656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11980247497558594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([637, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1206812858581543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1206812858581543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12128877639770508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13943243026733398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([611, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14058542251586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14058542251586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14116811752319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16214513778686523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([505, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1632986068725586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1632986068725586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16378021240234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18448925018310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([492, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18589067459106445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18589067459106445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18635988235473633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20982027053833008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([462, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2113480567932129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2113480567932129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21178865432739258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.23690271377563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([426, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2385106086730957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2385106086730957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.23891687393188477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.26491785049438477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([8166, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30377721786499023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30377721786499023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8166, 128]), torch.Size([1, 8166, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31156492233276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8657565116882324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8166, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8175811767578125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.830474853515625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8433685302734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8303737640380859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([13520, 256])
first layer input nodes number: 40340
first layer output nodes number: 13520
edges number: 105688
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8436713218688965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.856564998626709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8597884178161621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8597884178161621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([452, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.882868766784668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.882868766784668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8837308883666992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8912687301635742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8915877342224121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8915877342224121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.892331600189209  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9039130210876465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([270, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9043197631835938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9043197631835938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9048347473144531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.917229175567627  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([209, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9177756309509277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9177756309509277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9181742668151855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9297347068786621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9304680824279785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9304680824279785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9308381080627441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9441590309143066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([122, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9446778297424316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9446778297424316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9449105262756348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9549164772033691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9555268287658691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9555268287658691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9557328224182129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9660325050354004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([81, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.966552734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.966552734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9667072296142578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9755134582519531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9761199951171875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9761199951171875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9762706756591797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9859142303466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9865984916687012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9865984916687012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9867491722106934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9974474906921387  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9979114532470703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9979114532470703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9980087280273438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0055961608886719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.006101131439209  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.006101131439209  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.006192684173584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.013974666595459  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0145163536071777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0145163536071777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.01460599899292  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0228533744812012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0232124328613281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0232124328613281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0232696533203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0289344787597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0295114517211914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0295114517211914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0295915603637695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0380830764770508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0385966300964355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0385966300964355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0386652946472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.046424388885498  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0469293594360352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0469293594360352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.046992301940918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0545454025268555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0548949241638184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0548949241638184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0549368858337402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0602660179138184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0607566833496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0607566833496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0608100891113281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0679664611816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0682473182678223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0682473182678223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0682778358459473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0725808143615723  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.073110580444336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.073110580444336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0731620788574219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0807838439941406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.081075668334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.081075668334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0811042785644531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0855388641357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0857677459716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0857677459716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0857887268066406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0891876220703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0894770622253418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0894770622253418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0895018577575684  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0936923027038574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([372, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.10261869430542  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.10261869430542  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1033282279968262  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2362418174743652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 372, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.216115951538086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2165298461914062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2169437408447266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2165088653564453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2775, 40])
input nodes number: 13520
output nodes number: 2775
edges number: 23430
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2166337966918945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.2166342735290527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03380775451660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 14 input nodes size: 34165
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.031070232391357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.031070232391357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04736137390136719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.047382354736328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027830123901367188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02859210968017578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02859210968017578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02859210968017578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([34165, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02859210968017578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06981706619262695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06981706619262695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07058858871459961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07691478729248047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([841, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0773310661315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0773310661315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07813310623168945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0901637077331543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([779, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09087705612182617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09087705612182617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 779, 128]), torch.Size([1, 779, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09161996841430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10796403884887695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 779, 128])
m.shape torch.Size([718, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10898256301879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10898256301879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10966730117797852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13096857070922852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([615, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13209247589111328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13209247589111328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13267898559570312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15471887588500977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([530, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15594196319580078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15594196319580078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1564474105834961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1788492202758789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([471, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18016862869262695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18016862869262695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1806178092956543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20307683944702148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([436, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2045154571533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2045154571533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20493125915527344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22863197326660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([416, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2302093505859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2302093505859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2306060791015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2559967041015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([5894, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2839031219482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2839031219482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 5894, 128]), torch.Size([1, 5894, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2895240783691406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6943340301513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 5894, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6570086479187012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6679844856262207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6789603233337402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6678986549377441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([11509, 256])
first layer input nodes number: 34165
first layer output nodes number: 11509
edges number: 83424
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6792168617248535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.690192699432373  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6929941177368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6929941177368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([537, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7116050720214844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7116050720214844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 537, 256]), torch.Size([1, 537, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7126293182373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7226829528808594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 537, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7229495048522949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7229495048522949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.723721981048584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7353091239929199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7357854843139648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7357854843139648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7363557815551758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7502708435058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7511172294616699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7511172294616699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7516188621520996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7669491767883301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7676692008972168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7676692008972168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7680544853210449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7819247245788574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7826089859008789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7826089859008789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7828989028930664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7953653335571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7959403991699219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7959403991699219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7961444854736328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8063488006591797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8069467544555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8069467544555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8071203231811523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8170137405395508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8176450729370117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8176450729370117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8178033828735352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8279352188110352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8284811973571777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8284811973571777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8286051750183105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8374075889587402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8379168510437012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8379168510437012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.838019847869873  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8460536003112793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8466019630432129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8466019630432129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8467011451721191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8551316261291504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.855494499206543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.855494499206543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8555574417114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8613481521606445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8616938591003418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8616938591003418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8617472648620605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8670344352722168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8673830032348633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8673830032348633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8674325942993164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8726892471313477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8730030059814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8730030059814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8730449676513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8777866363525391  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8780927658081055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8780927658081055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8781309127807617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8827085494995117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8829493522644043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8829493522644043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8829779624938965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8866114616394043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8869442939758301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8869442939758301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8869805335998535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8918366432189941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8922414779663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8922414779663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8922834396362305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8982000350952148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8985629081726074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8985629081726074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8985991477966309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9039626121520996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.904304027557373  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.904304027557373  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9043364524841309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9093623161315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9095892906188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9095892906188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9096102714538574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9130091667175293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.91339111328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.91339111328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9134235382080078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9189033508300781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([199, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9236688613891602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9236688613891602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9240484237670898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9908514022827148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 199, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9760327339172363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9764437675476074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9768548011779785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9764227867126465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2758, 40])
input nodes number: 11509
output nodes number: 2758
edges number: 18693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9765267372131348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.976527214050293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.030035018920898438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 15 input nodes size: 30771
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02782726287841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02782726287841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04345226287841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04347372055053711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027161598205566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.028031349182128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.028031349182128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.028031349182128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([30771, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.028031349182128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([680, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07389068603515625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07389068603515625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 680, 128]), torch.Size([1, 680, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0745391845703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0797271728515625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 680, 128])
m.shape torch.Size([672, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08004379272460938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08004379272460938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08068466186523438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09029769897460938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([610, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0908498764038086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0908498764038086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0914316177368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10515689849853516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([604, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10601806640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10601806640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 604, 128]), torch.Size([1, 604, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10659408569335938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12359380722045898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 604, 128])
m.shape torch.Size([599, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12473392486572266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12473392486572266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12530517578125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1462712287902832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([553, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1475677490234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1475677490234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14809513092041016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1707925796508789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([479, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17212772369384766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17212772369384766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17258453369140625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19542503356933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([515, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19716119766235352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19716119766235352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19765233993530273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22673416137695312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([449, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22841548919677734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22841548919677734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22884368896484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.25624847412109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([6898, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2889266014099121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2889266014099121  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 6898, 128]), torch.Size([1, 6898, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2955050468444824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7629876136779785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 6898, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7208333015441895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7323336601257324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7438340187072754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.732243537902832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([12059, 256])
first layer input nodes number: 30771
first layer output nodes number: 12059
edges number: 93077
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.744502067565918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7560024261474609  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7593202590942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7593202590942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7824010848999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7824010848999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7832326889038086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7898855209350586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7901406288146973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7901406288146973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7908062934875488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.801485538482666  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([255, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8018879890441895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8018879890441895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8023743629455566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8130745887756348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8136467933654785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8136467933654785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8140511512756348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.825777530670166  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8265175819396973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8265175819396973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8268914222717285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8403496742248535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8411316871643066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8411316871643066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8414521217346191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8552308082580566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8559455871582031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8559455871582031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8561935424804688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.86859130859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8693747520446777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8693747520446777  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8695998191833496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8824286460876465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8830776214599609  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8830776214599609  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8832454681396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8939876556396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8947210311889648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8947210311889648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8948831558227539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9063940048217773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9071907997131348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9071907997131348  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9073491096496582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9196972846984863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9202871322631836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9202871322631836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9203977584838867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9298009872436523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.930333137512207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.930333137512207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9304227828979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9386701583862305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.939150333404541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.939150333404541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9392247200012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9465889930725098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.947056770324707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.947056770324707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9471235275268555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9541997909545898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9547357559204102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9547357559204102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9548063278198242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9627809524536133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9633016586303711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9633016586303711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9633665084838867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9711484909057617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9717564582824707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9717564582824707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9718270301818848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9807896614074707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9812479019165039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9812479019165039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9812994003295898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9882001876831055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9886360168457031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9886360168457031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9886817932128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9951362609863281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9955577850341797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9955577850341797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9955997467041016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.001810073852539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0021276473999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0021276473999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0021581649780273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0068883895874023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0071606636047363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0071606636047363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.007185459136963  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.011202335357666  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0116052627563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0116052627563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0116395950317383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.017441749572754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([302, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0246810913085938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0246810913085938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.0252571105957031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1373872756958008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1173648834228516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1177868843078613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.118208885192871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1177654266357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2829, 40])
input nodes number: 12059
output nodes number: 2829
edges number: 23446
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1178879737854004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 1.1178884506225586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02962017059326172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 16 input nodes size: 10615
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027172565460205078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027172565460205078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03223419189453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.032256126403808594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.016609668731689453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.016942501068115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.016942501068115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.016942501068115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([10615, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.016942501068115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([730, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03114795684814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03114795684814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.031844139099121094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0382084846496582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([762, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.038587093353271484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.038587093353271484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 762, 128]), torch.Size([1, 762, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03931379318237305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05022621154785156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 762, 128])
m.shape torch.Size([670, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05082130432128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05082130432128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05146026611328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06551742553710938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([517, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06641483306884766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06641483306884766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06690788269042969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0812063217163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([453, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08203983306884766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08203983306884766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08247184753417969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09802436828613281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([360, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09883832931518555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09883832931518555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0991816520690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11394453048706055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([308, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11480093002319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11480093002319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11509466171264648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12978124618530273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([246, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13057279586791992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13057279586791992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13080739974975586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1441798210144043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 246, 128])
m.shape torch.Size([230, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1450495719909668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1450495719909668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14526891708374023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15930700302124023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([1123, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1645522117614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1645522117614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16562318801879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24216985702514648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.23066377639770508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.23581266403198242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24096155166625977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.23577213287353516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([5399, 256])
first layer input nodes number: 10615
first layer output nodes number: 5399
edges number: 28181
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2410426139831543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24619150161743164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24751615524291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24751615524291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([511, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.26386499404907227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.26386499404907227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.26483964920043945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.27328968048095703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([453, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.27367353439331055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.27367353439331055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2745375633239746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.28749799728393555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([388, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2884516716003418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2884516716003418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.28919172286987305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30547285079956055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([271, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30620908737182617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30620908737182617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30672597885131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32272911071777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([233, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3235907554626465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3235907554626465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3240351676940918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34003400802612305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([187, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34089040756225586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34089040756225586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3412470817565918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3565840721130371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35733461380004883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35733461380004883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35759782791137695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3707585334777832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.371457576751709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.371457576751709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37166357040405273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3834052085876465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3842453956604004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3842453956604004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38445329666137695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39775896072387695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3983759880065918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3983759880065918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39851903915405273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4086756706237793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40929174423217773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40929174423217773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40941572189331055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4190859794616699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4195084571838379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4195084571838379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.419588565826416  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42639780044555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42680788040161133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42680788040161133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4268765449523926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4331936836242676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4335498809814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4335498809814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4336051940917969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43908119201660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.439572811126709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.439572811126709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43964147567749023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44691991806030273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44727039337158203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44727039337158203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44731807708740234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45270633697509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4531073570251465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4531073570251465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4531569480895996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4591078758239746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45960235595703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45960235595703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4596595764160156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46692657470703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46724510192871094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46724510192871094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4672813415527344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.472137451171875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4724268913269043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4724268913269043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4724574089050293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4767603874206543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47696733474731445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47696733474731445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4769883155822754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48009347915649414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4802522659301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4802522659301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4802675247192383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4826326370239258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4828462600708008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4828462600708008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4828653335571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48595523834228516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4861302375793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4861302375793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4861454963684082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4887242317199707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([53, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.489990234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.489990234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49009132385253906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5078830718994141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4949049949645996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49533557891845703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49576616287231445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4953136444091797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2887, 40])
input nodes number: 5399
output nodes number: 2887
edges number: 16363
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49538469314575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49538516998291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017640113830566406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 17 input nodes size: 14858
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01661825180053711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01661825180053711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02370309829711914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023725032806396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01864147186279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019128799438476562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019128799438476562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019128799438476562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([14858, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019128799438476562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([546, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.040215492248535156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.040215492248535156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04073619842529297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04538583755493164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([639, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04573488235473633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04573488235473633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04634428024291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05567169189453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([627, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05626392364501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05626392364501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05686187744140625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07001686096191406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([567, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0708165168762207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0708165168762207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07135725021362305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08729982376098633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([468, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08814525604248047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08814525604248047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0885915756225586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1046590805053711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([416, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10562610626220703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10562610626220703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10602283477783203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12308216094970703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([341, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12402200698852539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12402200698852539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12434720993041992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14060735702514648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([374, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14187145233154297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14187145233154297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1422281265258789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16255855560302734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([288, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16374635696411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16374635696411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16402101516723633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18159914016723633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([2370, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1927628517150879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1927628517150879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2370, 128]), torch.Size([1, 2370, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1950230598449707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3580765724182129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2370, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3397250175476074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3469576835632324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3532862663269043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34600400924682617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6636, 256])
first layer input nodes number: 14858
first layer output nodes number: 6636
edges number: 42480
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3524951934814453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35936927795410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3613100051879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3613100051879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([365, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38379573822021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38379573822021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3844919204711914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39064979553222656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3909940719604492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3909940719604492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3916807174682617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40198802947998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4024810791015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4024810791015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4030342102050781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41532039642333984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4160127639770508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4160127639770508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41649341583251953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4304323196411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4312014579772949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4312014579772949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43160200119018555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44602155685424805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4467787742614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4467787742614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4470953941345215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4607100486755371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4615006446838379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4615006446838379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46176958084106445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4752163887023926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([162, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47632789611816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47632789611816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4766368865966797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4942493438720703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4949774742126465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4949774742126465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49517202377319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5076231956481934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5084681510925293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5084681510925293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5086550712585449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5219264030456543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5227212905883789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5227212905883789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5228815078735352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5353784561157227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5361404418945312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5361404418945312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5362796783447266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5481147766113281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5487823486328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5487823486328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5488948822021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5592479705810547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5598511695861816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5598511695861816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5599446296691895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5691971778869629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5698285102844238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5698285102844238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.569918155670166  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5794205665588379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5799450874328613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5799450874328613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5800156593322754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5879902839660645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5884780883789062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5884780883789062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5885391235351562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5958633422851562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5964384078979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5964384078979492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5965051651000977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6049833297729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6054797172546387  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6054797172546387  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6055350303649902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6129469871520996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6134772300720215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6134772300720215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.613532543182373  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6213316917419434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6218490600585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6218490600585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6219005584716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6295223236083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6298985481262207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6298985481262207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6299347877502441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.635551929473877  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6360201835632324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6360201835632324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6360621452331543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.642859935760498  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6431622505187988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6431622505187988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6431889533996582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6477017402648926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([201, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6525182723999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6525182723999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6529016494750977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7203760147094727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 201, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7010436058044434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7014765739440918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7019095420837402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7014546394348145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2903, 40])
input nodes number: 6636
output nodes number: 2903
edges number: 22897
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7015285491943359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7015290260314941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02008199691772461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 18 input nodes size: 18910
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018643856048583984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018643856048583984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027660846710205078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027682781219482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.020576000213623047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02113962173461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02113962173461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02113962173461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([18910, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02113962173461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([494, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04600048065185547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04600048065185547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.046471595764160156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.050240516662597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([568, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05054664611816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05054664611816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05108833312988281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05954599380493164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([547, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060057640075683594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060057640075683594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06057929992675781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0722036361694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([476, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07285070419311523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07285070419311523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07330465316772461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08646917343139648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([457, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08733177185058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08733177185058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0877676010131836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10345745086669922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([380, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10432672500610352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10432672500610352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10468912124633789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12027215957641602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([330, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12119245529174805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12119245529174805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 330, 128]), torch.Size([1, 330, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12150716781616211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13724279403686523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 330, 128])
m.shape torch.Size([344, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13913249969482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13913249969482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 344, 128]), torch.Size([1, 344, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13946056365966797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15816020965576172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 344, 128])
m.shape torch.Size([283, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1592106819152832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1592106819152832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 283, 128]), torch.Size([1, 283, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15948057174682617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17675352096557617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 283, 128])
m.shape torch.Size([3293, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1923208236694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1923208236694336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 3293, 128]), torch.Size([1, 3293, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1961498260498047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4269742965698242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 3293, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.404019832611084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4108595848083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41769933700561523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41080570220947266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([7172, 256])
first layer input nodes number: 18910
first layer output nodes number: 7172
edges number: 50279
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41784238815307617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4246821403503418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42694091796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42694091796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([335, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45166683197021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45166683197021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45230579376220703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4583091735839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([357, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4586763381958008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4586763381958008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45935726165771484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46997547149658203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4704399108886719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4704399108886719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47097206115722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48284149169921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4835023880004883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4835023880004883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4839620590209961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49729251861572266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49802398681640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49802398681640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49840545654296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5121383666992188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5128645896911621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5128645896911621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5131678581237793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5262084007263184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5269384384155273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5269384384155273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5271883010864258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5396814346313477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([128, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5405406951904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5405406951904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5407848358154297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5547008514404297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5555562973022461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5555562973022461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5557718276977539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5695657730102539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([109, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5705060958862305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5705060958862305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.570713996887207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.585474967956543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5861639976501465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5861639976501465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5863070487976074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5974650382995605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5982470512390137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5982470512390137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5983881950378418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6103854179382324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6111397743225098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6111397743225098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6112656593322754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6228470802307129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6236724853515625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6236724853515625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6237983703613281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.636260986328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6369481086730957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6369481086730957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.637047290802002  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6475605964660645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6479573249816895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6479573249816895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.648012638092041  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6542630195617676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6549053192138672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6549053192138672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6549835205078125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.66436767578125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6648998260498047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6648998260498047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6649627685546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6729564666748047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6734185218811035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6734185218811035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6734700202941895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6803708076477051  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6809029579162598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6809029579162598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6809582710266113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6887574195861816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.689274787902832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.689274787902832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.689326286315918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6969480514526367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.697598934173584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.697598934173584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.697659969329834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.707120418548584  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7073330879211426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7073330879211426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7073540687561035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7107529640197754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7111811637878418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7111811637878418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7112174034118652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7173418998718262  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([292, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7243404388427734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7243404388427734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7248973846435547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.82568359375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 292, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8040347099304199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8044710159301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8049073219299316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8044490814208984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2925, 40])
input nodes number: 7172
output nodes number: 2925
edges number: 25255
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8045282363891602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8045287132263184  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.022231578826904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 19 input nodes size: 25615
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02057933807373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02057933807373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.032793521881103516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03281545639038086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023776531219482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02445840835571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02445840835571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02445840835571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([25615, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02445840835571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([605, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.057552337646484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.057552337646484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.058129310607910156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0630488395690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([675, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06340408325195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06340408325195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06404781341552734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07464933395385742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([663, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07527589797973633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07527589797973633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07590818405151367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09019994735717773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([650, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09112358093261719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09112358093261719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 650, 128]), torch.Size([1, 650, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09174346923828125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11046791076660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 650, 128])
m.shape torch.Size([618, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11163139343261719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11163139343261719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11222076416015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13375377655029297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([535, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13498973846435547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13498973846435547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1354999542236328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15793418884277344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([483, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15929126739501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15929126739501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15975189208984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1827831268310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([442, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18423891067504883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18423891067504883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1846604347229004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20868730545043945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([364, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2100386619567871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2100386619567871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21038579940795898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.23260259628295898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([4396, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2533907890319824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2533907890319824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 4396, 128]), torch.Size([1, 4396, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.257962703704834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5660371780395508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 4396, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5359292030334473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5449233055114746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.553917407989502  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5448527336120605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([9431, 256])
first layer input nodes number: 25615
first layer output nodes number: 9431
edges number: 66997
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5541105270385742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5631046295166016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5653533935546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5653533935546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([400, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5894870758056641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5894870758056641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5902500152587891  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5965571403503418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([333, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5968160629272461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5968160629272461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5974512100219727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6084904670715332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6090092658996582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6090092658996582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6095623970031738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6226534843444824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.623295783996582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.623295783996582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6237516403198242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6369714736938477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6377964019775391  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6377964019775391  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.638214111328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6532516479492188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6540060043334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6540060043334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6543245315551758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6680212020874023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6688241958618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6688241958618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6690969467163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.682734489440918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6835670471191406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6835670471191406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.683807373046875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6975059509277344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6981301307678223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6981301307678223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6982941627502441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7087922096252441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7094602584838867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7094602584838867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7096090316772461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7201719284057617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.720911979675293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.720911979675293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7210588455200195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7325143814086914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7332830429077148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7332830429077148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7334222793579102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7452573776245117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7459378242492676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7459378242492676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7460522651672363  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7565808296203613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7573714256286621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7573714256286621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7574915885925293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7693877220153809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7700920104980469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7700920104980469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7701930999755859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7809085845947266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7816119194030762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7816119194030762  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.781705379486084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7922663688659668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7928733825683594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7928733825683594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7929496765136719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8021049499511719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8024821281433105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8024821281433105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.802527904510498  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8083415031433105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8088302612304688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8088302612304688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8088836669921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8160400390625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.816340446472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.816340446472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8163728713989258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8209447860717773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8214130401611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8214130401611328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8214588165283203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8282337188720703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8286552429199219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8286552429199219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8286952972412109  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8349037170410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8352155685424805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8352155685424805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8352441787719727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.839879035949707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8403263092041016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8403263092041016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8403644561767578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8468112945556641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([282, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8535685539245605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8535685539245605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8541064262390137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9517998695373535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 282, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9308104515075684  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9312467575073242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9316830635070801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9312248229980469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2927, 40])
input nodes number: 9431
output nodes number: 2927
edges number: 24341
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9313173294067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.9313178062438965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02575826644897461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 20 input nodes size: 14576
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023776531219482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023776531219482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.030726909637451172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.030748844146728516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018512725830078125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018972396850585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018972396850585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018972396850585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([14576, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018972396850585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([661, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03937482833862305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03937482833862305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04000520706176758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04504823684692383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([677, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.045378684997558594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.045378684997558594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.046024322509765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.055708885192871094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([616, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05626726150512695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05626726150512695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0568547248840332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07017755508422852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([546, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07092523574829102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07092523574829102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07144594192504883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08745813369750977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([511, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08841609954833984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08841609954833984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08890342712402344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10644721984863281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([403, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10735654830932617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10735654830932617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 403, 128]), torch.Size([1, 403, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10774087905883789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1242671012878418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 403, 128])
m.shape torch.Size([366, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12529659271240234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12529659271240234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 366, 128]), torch.Size([1, 366, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12564563751220703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1430978775024414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 366, 128])
m.shape torch.Size([322, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1441516876220703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1441516876220703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14445877075195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16196250915527344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([273, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1629805564880371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1629805564880371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 273, 128]), torch.Size([1, 273, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16324090957641602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17990350723266602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 273, 128])
m.shape torch.Size([2191, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19022083282470703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19022083282470703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2191, 128]), torch.Size([1, 2191, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19231033325195312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3457450866699219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2191, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3281693458557129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33443117141723633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34069299697875977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3343820571899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6566, 256])
first layer input nodes number: 14576
first layer output nodes number: 6566
edges number: 40525
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3408036231994629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.347811222076416  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3486309051513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3486309051513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([475, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3695034980773926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3695034980773926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3704094886779785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37791013717651367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37820911407470703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37820911407470703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3789548873901367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39065027236938477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39113378524780273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39113378524780273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39170026779174805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4041628837585449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40477943420410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40477943420410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4052257537841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4181690216064453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41904163360595703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41904163360595703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4194765090942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4351320266723633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43579721450805664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43579721450805664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43608903884887695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4486374855041504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4493732452392578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4493732452392578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44962310791015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4621162414550781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46289873123168945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46289873123168945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46312379837036133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4759526252746582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4767570495605469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4767570495605469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.476959228515625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.489898681640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([107, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4908261299133301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4908261299133301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.491030216217041  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5055203437805176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5062961578369141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5062961578369141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5064544677734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5188026428222656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5194501876831055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5194501876831055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5195703506469727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5297842025756836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5303363800048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5303363800048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5304298400878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5390281677246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5394525527954102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5394525527954102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5395193099975586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5461282730102539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5465998649597168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5465998649597168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5466666221618652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5537428855895996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5544323921203613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5544323921203613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5545220375061035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5646519660949707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5650320053100586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5650320053100586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5650815963745117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5710325241088867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5713887214660645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5713887214660645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5714306831359863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5767598152160645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5774331092834473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5774331092834473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5775055885314941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5872178077697754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5876622200012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5876622200012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.587709903717041  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5944333076477051  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5946922302246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5946922302246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5947189331054688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5986709594726562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5989537239074707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5989537239074707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5989804267883301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6031193733215332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6033053398132324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6033053398132324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6033225059509277  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6061034202575684  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6063718795776367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6063718795776367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6063947677612305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6102628707885742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([194, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6149129867553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6149129867553711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6152830123901367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6804075241088867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 194, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6627902984619141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6632237434387207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6636571884155273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6632018089294434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2906, 40])
input nodes number: 6566
output nodes number: 2906
edges number: 21107
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6632699966430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6632704734802246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01987600326538086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 21 input nodes size: 11838
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018509864807128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018509864807128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0241546630859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.024176597595214844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01720428466796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017624855041503906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017624855041503906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017624855041503906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([11838, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017624855041503906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([624, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0356292724609375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0356292724609375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 624, 128]), torch.Size([1, 624, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.036224365234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.041634559631347656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 624, 128])
m.shape torch.Size([609, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04191780090332031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04191780090332031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04249858856201172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05121040344238281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([610, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05179262161254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05179262161254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05237436294555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06517267227172852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([549, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06601619720458984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06601619720458984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06653976440429688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0818185806274414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([479, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08269882202148438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08269882202148438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08315563201904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09960079193115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([404, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10052824020385742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10052824020385742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10091352462768555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11748075485229492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([360, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11848974227905273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11848974227905273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 360, 128]), torch.Size([1, 360, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11883306503295898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13599920272827148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 360, 128])
m.shape torch.Size([329, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.137481689453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.137481689453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13779544830322266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15567970275878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([274, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15669870376586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15669870376586914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15696001052856445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17368364334106445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([1778, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18203115463256836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18203115463256836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 1778, 128]), torch.Size([1, 1778, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18372678756713867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30411672592163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 1778, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.28903818130493164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.29477548599243164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30051279067993164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.29473066329956055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6016, 256])
first layer input nodes number: 11838
first layer output nodes number: 6016
edges number: 36085
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30060291290283203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30634021759033203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30865955352783203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30865955352783203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32886791229248047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32886791229248047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3296537399291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3359403610229492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3362703323364258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3362703323364258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3369874954223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3484964370727539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34909534454345703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34909534454345703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3497285842895508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3643312454223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36501455307006836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36501455307006836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36550474166870117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3803443908691406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38102197647094727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38102197647094727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38138818740844727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39457178115844727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([183, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.395444393157959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.395444393157959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39579343795776367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41080236434936523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([166, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4117450714111328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4117450714111328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4120616912841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42789268493652344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([148, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42887258529663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42887258529663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4291548728942871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44524526596069336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([123, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4461684226989746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4461684226989746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44640302658081055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46141767501831055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4622330665588379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4622330665588379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4624180793762207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4755539894104004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4762439727783203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4762439727783203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47638511657714844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4873943328857422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4881315231323242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4881315231323242  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4882650375366211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49961376190185547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5004096031188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5004096031188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5005412101745605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5126490592956543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5132832527160645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5132832527160645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5133824348449707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5232014656066895  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5238728523254395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5238728523254395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5239682197570801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5340771675109863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5345373153686523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5345373153686523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5346002578735352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.541712760925293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5420737266540527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5420737266540527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5421195030212402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5476126670837402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5480399131774902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5480399131774902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5480895042419434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5543875694274902  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5548195838928223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5548195838928223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5548672676086426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5612568855285645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5616559982299805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5616559982299805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5616979598999023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5676145553588867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5678963661193848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5678963661193848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.567924976348877  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5721592903137207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5725045204162598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5725045204162598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5725369453430176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5775628089904785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5779004096984863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5779004096984863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5779309272766113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5828747749328613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5831365585327148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5831365585327148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5831594467163086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5870275497436523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([116, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5898036956787109  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5898036956787109  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5900249481201172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6289653778076172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 116, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6120214462280273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.612454891204834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6128883361816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6124329566955566  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2907, 40])
input nodes number: 6016
output nodes number: 2907
edges number: 20262
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6124997138977051  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6125001907348633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018453598022460938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 22 input nodes size: 8636
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01720428466796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01720428466796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021322250366210938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02134418487548828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.015677452087402344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01598644256591797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01598644256591797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01598644256591797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([8636, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01598644256591797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([742, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02879047393798828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02879047393798828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02949810028076172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03535270690917969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([816, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03577709197998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03577709197998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03655529022216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04912281036376953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([637, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04964494705200195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04964494705200195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.050252437591552734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06361722946166992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([525, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0643148422241211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0643148422241211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06481552124023438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07946491241455078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([465, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0803232192993164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0803232192993164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08076667785644531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09673118591308594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([364, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09755086898803711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09755086898803711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09789800643920898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11282491683959961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([293, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11362934112548828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11362934112548828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 293, 128]), torch.Size([1, 293, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11390876770019531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12788009643554688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 293, 128])
m.shape torch.Size([230, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1286177635192871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1286177635192871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 230, 128]), torch.Size([1, 230, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12883710861206055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14133977890014648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 230, 128])
m.shape torch.Size([187, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14203262329101562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14203262329101562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 187, 128]), torch.Size([1, 187, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1422109603881836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1536245346069336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 187, 128])
m.shape torch.Size([883, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1577458381652832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1577458381652832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15858793258666992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2188715934753418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 883, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20912408828735352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21402788162231445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2189316749572754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2139892578125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([5142, 256])
first layer input nodes number: 8636
first layer output nodes number: 5142
edges number: 25298
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21899795532226562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.22390174865722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2251276969909668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2251276969909668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([503, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24120616912841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24120616912841797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.24216556549072266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.25072288513183594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([485, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2511758804321289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2511758804321289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.25210094451904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2659769058227539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([360, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.266726016998291  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.266726016998291  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2674126625061035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.28346872329711914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2841629981994629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2841629981994629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.28467607498168945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.29989099502563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([254, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3008551597595215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3008551597595215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30133962631225586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31878042221069336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([194, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3196573257446289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3196573257446289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32002735137939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3359384536743164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3366551399230957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3366551399230957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3369107246398926  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34968996047973633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35051584243774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35051584243774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3507523536682129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36423349380493164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3648853302001953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3648853302001953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3650550842285156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3759193420410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37646913528442383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37646913528442383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37659502029418945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38553285598754883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3860940933227539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3860940933227539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38620662689208984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39498424530029297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3957700729370117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3957700729370117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39590930938720703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4077444076538086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40816211700439453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40816211700439453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4082365036010742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41508007049560547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4156351089477539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4156351089477539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41571903228759766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4240274429321289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42447566986083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42447566986083984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42454051971435547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4314146041870117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43184375762939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43184375762939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4319009780883789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4383668899536133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43868160247802734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43868160247802734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4387216567993164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4435281753540039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4437851905822754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4437851905822754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4438157081604004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4476914405822754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44780445098876953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44780445098876953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4478178024291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44960689544677734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44971561431884766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44971561431884766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44972705841064453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4513406753540039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45157718658447266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45157718658447266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4516000747680664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4549875259399414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4551668167114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4551668167114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4551839828491211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45784473419189453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4580354690551758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4580354690551758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4580526351928711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4608335494995117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4609866142272949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4609866142272949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4609999656677246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4632563591003418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([51, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.464475154876709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.464475154876709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4645724296569824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4816927909851074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 51, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46898508071899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46941661834716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4698481559753418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4693946838378906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2895, 40])
input nodes number: 5142
output nodes number: 2895
edges number: 16090
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4694533348083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4694538116455078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01662731170654297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 23 input nodes size: 12566
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01567554473876953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01567554473876953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02166748046875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021689414978027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017549514770507812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017913818359375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017913818359375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017913818359375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([12566, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017913818359375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([793, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03439474105834961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03439474105834961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.035151004791259766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.041201114654541016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([838, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.041622161865234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.041622161865234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04242134094238281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.055214881896972656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([739, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.055908203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.055908203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05661296844482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07234859466552734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([643, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07322263717651367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07322263717651367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07383584976196289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09202146530151367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([512, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09293556213378906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09293556213378906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09342384338378906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11100196838378906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1119394302368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1119394302368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11233329772949219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12926959991455078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([334, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1301875114440918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1301875114440918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 334, 128]), torch.Size([1, 334, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13050603866577148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14643239974975586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 334, 128])
m.shape torch.Size([278, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14733362197875977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14733362197875977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1475987434387207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16271066665649414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([260, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16369390487670898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16369390487670898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1639418601989746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1798110008239746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([1296, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1858668327331543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1858668327331543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1871027946472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2751173973083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 1296, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.26166296005249023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2674860954284668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.27330923080444336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2674403190612793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6106, 256])
first layer input nodes number: 12566
first layer output nodes number: 6106
edges number: 32158
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2734050750732422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.27922821044921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.28145599365234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.28145599365234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([523, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.29805469512939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.29805469512939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.29905223846435547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30773067474365234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([450, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30809736251831055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30809736251831055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30895566940307617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3226323127746582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([369, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3234066963195801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3234066963195801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3241105079650879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3402285575866699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([304, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3410453796386719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3410453796386719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3416252136230469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35864830017089844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([242, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35952138900756836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35952138900756836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.359982967376709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3765997886657715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3773379325866699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3773379325866699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3776583671569824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3914370536804199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39212465286254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39212465286254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3923649787902832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40438127517700195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40513038635253906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40513038635253906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4053459167480469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4176311492919922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41843175888061523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41843175888061523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41863203048706055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43144941329956055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43218564987182617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43218564987182617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43235158920288086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44413328170776367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44473791122436523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44473791122436523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44486188888549805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4545321464538574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([34, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4548625946044922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4548625946044922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4549274444580078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46043968200683594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46106958389282227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46106958389282227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46117067337036133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4704709053039551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47087812423706055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47087812423706055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47094297409057617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47736310958862305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47782087326049805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47782087326049805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47788572311401367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4847598075866699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4850349426269531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4850349426269531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4850730895996094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4893836975097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48969173431396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48969173431396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4897298812866211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4943075180053711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.494565486907959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.494565486907959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.494596004486084  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.498471736907959  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4986577033996582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4986577033996582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49867868423461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5014901161193848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5017104148864746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5017104148864746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5017333030700684  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5049605369567871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5051107406616211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5051107406616211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5051259994506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5073843002319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5075039863586426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5075039863586426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5075154304504395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5092892646789551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.50946044921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.50946044921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5094757080078125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5119476318359375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5121245384216309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5121245384216309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5121397972106934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5147185325622559  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([87, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5168013572692871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5168013572692871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5169672966003418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5461726188659668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5329413414001465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5333743095397949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5338072776794434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5333523750305176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2903, 40])
input nodes number: 6106
output nodes number: 2903
edges number: 16611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.533421516418457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5334219932556152  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01866769790649414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 24 input nodes size: 12094
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017550945281982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017550945281982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023317813873291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023339271545410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017325401306152344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017800331115722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017800331115722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017800331115722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([12094, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017800331115722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([350, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03801250457763672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03801250457763672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.038346290588378906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.041016578674316406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([408, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04123878479003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04123878479003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04162788391113281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04746437072753906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([421, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.047872066497802734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.047872066497802734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 421, 128]), torch.Size([1, 421, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.048273563385009766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05710649490356445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 421, 128])
m.shape torch.Size([418, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05770301818847656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05770301818847656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 418, 128]), torch.Size([1, 418, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.058101654052734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06966209411621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 418, 128])
m.shape torch.Size([393, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07039976119995117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07039976119995117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07077455520629883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08426713943481445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 393, 128])
m.shape torch.Size([379, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08516407012939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08516407012939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0855255126953125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10106754302978516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([320, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10195493698120117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10195493698120117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10226011276245117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11751890182495117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([301, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1185145378112793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1185145378112793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11880159378051758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1351637840270996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([226, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13599014282226562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13599014282226562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 226, 128]), torch.Size([1, 226, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13620567321777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14999961853027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 226, 128])
m.shape torch.Size([2445, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16155052185058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16155052185058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2445, 128]), torch.Size([1, 2445, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16388225555419922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3365144729614258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2445, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31752634048461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3229250907897949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3283238410949707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32288265228271484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([5661, 256])
first layer input nodes number: 12094
first layer output nodes number: 5661
edges number: 39472
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3284158706665039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3338146209716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33549022674560547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.33549022674560547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([292, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3595156669616699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3595156669616699  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36007261276245117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3655095100402832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([285, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36577892303466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36577892303466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36632251739501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37499427795410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([250, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3754434585571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3754434585571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37592029571533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3864107131958008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3870105743408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3870105743408203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38742637634277344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39948463439941406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4003725051879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4003725051879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40080738067626953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41646289825439453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([202, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41741037368774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41741037368774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41779565811157227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43436288833618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4352130889892578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4352130889892578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43550872802734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4502906799316406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45125818252563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45125818252563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45151758193969727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46630334854125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46706485748291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46706485748291016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46726131439208984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47983455657958984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([125, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4809379577636719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4809379577636719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48117637634277344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4981040954589844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49910593032836914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49910593032836914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49930810928344727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.515078067779541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5157499313354492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5157499313354492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5158777236938477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5267400741577148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5275387763977051  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5275387763977051  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5276703834533691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5397782325744629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5406413078308105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5406413078308105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5407729148864746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5538020133972168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.554356575012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.554356575012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.554438591003418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5631322860717773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5637836456298828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5637836456298828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5638694763183594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5735683441162109  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5744571685791016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5744571685791016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5745658874511719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5876121520996094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5881290435791016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5881290435791016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5881919860839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5961856842041016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5965743064880371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5965743064880371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5966181755065918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6024966239929199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6032247543334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6032247543334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6032991409301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6137876510620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6143159866333008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6143159866333008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6143693923950195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6222734451293945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6227331161499023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6227331161499023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.622776985168457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6295766830444336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.629908561706543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.629908561706543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.629939079284668  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.634882926940918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6353754997253418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6353754997253418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6354174613952637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6425089836120605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([198, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6472458839416504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6472458839416504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6476235389709473  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7140908241271973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 198, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6930923461914062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.693514347076416  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6939363479614258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6934928894042969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2832, 40])
input nodes number: 5661
output nodes number: 2832
edges number: 24104
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6935458183288574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6935462951660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01869487762451172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 25 input nodes size: 17082
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017314434051513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017314434051513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.025459766387939453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.025481224060058594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01969289779663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02020883560180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02020883560180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02020883560180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([17082, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02020883560180664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([547, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.043317317962646484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.043317317962646484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0438389778137207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.048177242279052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([653, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.048539161682128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.048539161682128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04916191101074219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0589141845703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([606, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05946969985961914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05946969985961914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06004762649536133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07354021072387695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 606, 128])
m.shape torch.Size([570, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07433843612670898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07433843612670898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07488203048706055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09064626693725586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([491, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09186601638793945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09186601638793945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09233427047729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1091914176940918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([445, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1102304458618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1102304458618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11065483093261719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12890338897705078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([369, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12992286682128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12992286682128906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13027477264404297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14787006378173828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([351, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1490330696105957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1490330696105957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1493678092956543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16844797134399414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([309, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16960668563842773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16960668563842773  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 309, 128]), torch.Size([1, 309, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16990137100219727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18876123428344727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 309, 128])
m.shape torch.Size([2737, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20166492462158203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20166492462158203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2737, 128]), torch.Size([1, 2737, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20428037643432617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3896050453186035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2737, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3693079948425293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37605810165405273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38280820846557617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3760051727294922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([7078, 256])
first layer input nodes number: 17082
first layer output nodes number: 7078
edges number: 46618
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3829374313354492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38968753814697266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3913750648498535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3913750648498535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([355, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41423988342285156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41423988342285156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4149169921875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4206671714782715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4210076332092285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4210076332092285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42168092727661133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43240976333618164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43291521072387695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43291521072387695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4334721565246582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4470381736755371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4480276107788086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4480276107788086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44854068756103516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4640822410583496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46477746963500977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46477746963500977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46515512466430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47875070571899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4795999526977539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4795999526977539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47994327545166016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4947061538696289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4960322380065918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4960322380065918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49631834030151367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5106234550476074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5113339424133301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5113339424133301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5115456581115723  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.523613452911377  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5245027542114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5245027542114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5247220993041992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5387601852416992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5395927429199219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5395927429199219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5397796630859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5530509948730469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5538773536682129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5538773536682129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5540432929992676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5669865608215332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5676417350769043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5676417350769043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5677638053894043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5781397819519043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5789909362792969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5789909362792969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5791301727294922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5919399261474609  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5925569534301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5925569534301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5926542282104492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6022844314575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6028704643249512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6028704643249512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6029543876647949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6118502616882324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6126236915588379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6126236915588379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.612724781036377  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.624147891998291  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6246533393859863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6246533393859863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.624718189239502  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.632500171661377  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6331081390380859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6331081390380859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6331787109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6421413421630859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6425809860229492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6425809860229492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6426305770874023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6492757797241211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6499624252319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6499624252319336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6500329971313477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6599836349487305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6605339050292969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6605339050292969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6605892181396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6687755584716797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.669044017791748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.669044017791748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6690707206726074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6732096672058105  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6734395027160645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6734395027160645  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6734604835510254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6768593788146973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6773567199707031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6773567199707031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.677398681640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6844902038574219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([172, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6886024475097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6886024475097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6889305114746094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7466697692871094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 172, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7269458770751953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7273745536804199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7278032302856445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7273530960083008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2875, 40])
input nodes number: 7078
output nodes number: 2875
edges number: 22408
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7274341583251953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7274346351623535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021218299865722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 26 input nodes size: 9753
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019699573516845703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019699573516845703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02435016632080078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.024371623992919922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.016204833984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01660919189453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01660919189453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01660919189453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([9753, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01660919189453125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([527, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03292417526245117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03292417526245117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.033426761627197266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03826618194580078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([590, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03857755661010742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03857755661010742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03914022445678711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.047968387603759766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([520, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0484309196472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0484309196472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04892683029174805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05983686447143555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([446, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0604395866394043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0604395866394043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060864925384521484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07319974899291992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([338, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07379293441772461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07379293441772461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07411527633666992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08571958541870117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([304, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08642816543579102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08642816543579102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08671808242797852  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09918451309204102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([280, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09997415542602539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09997415542602539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 280, 128]), torch.Size([1, 280, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10024118423461914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11359262466430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 280, 128])
m.shape torch.Size([211, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11426401138305664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11426401138305664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 211, 128]), torch.Size([1, 211, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11446523666381836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12593507766723633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 211, 128])
m.shape torch.Size([197, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1266798973083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1266798973083496  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 197, 128]), torch.Size([1, 197, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12686777114868164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13889169692993164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 197, 128])
m.shape torch.Size([1766, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1472187042236328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1472187042236328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 1766, 128]), torch.Size([1, 1766, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14890289306640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2684803009033203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 1766, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.25481700897216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.25975608825683594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2655029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2605252265930176  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([5179, 256])
first layer input nodes number: 9753
first layer output nodes number: 5179
edges number: 31646
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2655777931213379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.27051687240600586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2718939781188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2718939781188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([373, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2939271926879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2939271926879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.29463863372802734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.30096435546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3013143539428711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3013143539428711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3020143508911133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31325340270996094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3137626647949219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3137626647949219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3143310546875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32724761962890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([266, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32857465744018555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32857465744018555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32908201217651367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3437952995300293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3445558547973633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3445558547973633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3449583053588867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.35944652557373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3601393699645996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3601393699645996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36043500900268555  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37314748764038086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37394189834594727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37394189834594727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.374208927154541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3875603675842285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3882265090942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3882265090942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3884248733520508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3997316360473633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40054941177368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40054941177368164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.40075159072875977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41369104385375977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41437816619873047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41437816619873047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4145345687866211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42563915252685547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4261636734008789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4261636734008789  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4262723922729492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4347524642944336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43564414978027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43564414978027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43580055236816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4490947723388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44965410232543945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44965410232543945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4497513771057129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45870065689086914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45931148529052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45931148529052734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45940494537353516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4686574935913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.469144344329834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.469144344329834  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46921491622924805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47669553756713867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47718334197998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47718334197998047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4772481918334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4845762252807617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48513221740722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48513221740722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4852008819580078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4934406280517578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49402952194213867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49402952194213867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4940981864929199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5028185844421387  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5033321380615234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5033321380615234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5033893585205078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5110569000244141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5113554000854492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5113554000854492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.511387825012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5159597396850586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5165491104125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5165491104125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.516606330871582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5250749588012695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5254693031311035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5254693031311035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5255074501037598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5314202308654785  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5319762229919434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5319762229919434  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5320258140563965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5400595664978027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5403580665588379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5403580665588379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5403847694396973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5448975563049316  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([222, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5502185821533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5502185821533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5506420135498047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6251659393310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 222, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6062126159667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6066365242004395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.607060432434082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6066150665283203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2843, 40])
input nodes number: 5179
output nodes number: 2843
edges number: 22419
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6066703796386719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6066708564758301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.017398357391357422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 27 input nodes size: 14473
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01620006561279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01620006561279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023101329803466797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.023122787475585938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01845073699951172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01890850067138672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01890850067138672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01890850067138672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([14473, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01890850067138672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([545, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03924369812011719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03924369812011719  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.039763450622558594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.043921470642089844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([660, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.044291019439697266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.044291019439697266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04492044448852539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.054931640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([629, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.055516719818115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.055516719818115234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.056116580963134766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06967020034790039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([487, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07029914855957031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07029914855957031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07076358795166016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08423233032226562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([427, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08501815795898438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08501815795898438  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08542537689208984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10008525848388672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([409, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10105180740356445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10105180740356445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10144186019897461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11821413040161133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([359, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1192173957824707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1192173957824707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11955976486206055  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13667821884155273  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([323, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1377391815185547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1377391815185547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1380472183227539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15560531616210938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([284, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15667009353637695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15667009353637695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 284, 128]), torch.Size([1, 284, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15694093704223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17427492141723633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 284, 128])
m.shape torch.Size([2219, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18472051620483398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18472051620483398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2219, 128]), torch.Size([1, 2219, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18683671951293945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3412351608276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2219, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32305908203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32910728454589844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3351554870605469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3290596008300781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6342, 256])
first layer input nodes number: 14473
first layer output nodes number: 6342
edges number: 40132
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3352656364440918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34131383895874023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34285736083984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.34285736083984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([379, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3637700080871582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3637700080871582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36449289321899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3705582618713379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([392, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37095069885253906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37095069885253906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37169837951660156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38329553604125977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([312, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3838214874267578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3838214874267578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3844165802001953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39807701110839844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3987255096435547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3987255096435547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.39919471740722656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41280174255371094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41353321075439453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41353321075439453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41391658782958984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4277181625366211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42865562438964844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42865562438964844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42899322509765625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4435100555419922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([153, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44437074661254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44437074661254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44466257095336914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45925378799438477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([128, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46009206771850586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46009206771850586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46033620834350586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47425222396850586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.474977970123291  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.474977970123291  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47516489028930664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48712778091430664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4878420829772949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4878420829772949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48800230026245117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4993777275085449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([98, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5003337860107422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5003337860107422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5005207061767578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5151004791259766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5159759521484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5159759521484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5161361694335938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.529754638671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.530449390411377  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.530449390411377  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5305676460266113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5414471626281738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5420475006103516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5420475006103516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5421409606933594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5513935089111328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5519523620605469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5519523620605469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.552032470703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5605239868164062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5609607696533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5609607696533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5610198974609375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5677013397216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5681295394897461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5681295394897461  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5681829452514648  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5745916366577148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5750494003295898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5750494003295898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5751028060913086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5818853378295898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5823702812194824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5823702812194824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5824236869812012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5895800590515137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5900535583496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5900535583496094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5901031494140625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5970954895019531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5974545478820801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5974545478820801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5974907875061035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6028542518615723  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6032590866088867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6032590866088867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.603297233581543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6092100143432617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6095447540283203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6095447540283203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6095752716064453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6145191192626953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6147809028625488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6147809028625488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6148037910461426  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6186718940734863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([162, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6225533485412598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6225533485412598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6228623390197754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6772446632385254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 162, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6594958305358887  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6599245071411133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6603531837463379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6599030494689941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2875, 40])
input nodes number: 6342
output nodes number: 2875
edges number: 21248
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6599769592285156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6599774360656738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019813060760498047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 28 input nodes size: 15666
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01845550537109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01845550537109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.025925636291503906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.025946617126464844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019023895263671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019512176513671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019512176513671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019512176513671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([15666, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019512176513671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([615, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04149341583251953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04149341583251953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.042079925537109375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04685258865356445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([645, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04717445373535156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04717445373535156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 645, 128]), torch.Size([1, 645, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.047789573669433594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05782365798950195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 645, 128])
m.shape torch.Size([619, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05840158462524414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05840158462524414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05899190902709961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07256460189819336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([563, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0734395980834961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0734395980834961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07397651672363281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08954715728759766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([455, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0903635025024414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0903635025024414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09079742431640625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10641860961914062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([412, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10785579681396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10785579681396484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10824871063232422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12514400482177734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([338, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12607574462890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12607574462890625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 338, 128]), torch.Size([1, 338, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12639808654785156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1425151824951172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 338, 128])
m.shape torch.Size([323, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1435861587524414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1435861587524414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14389419555664062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1614522933959961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([243, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16234111785888672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16234111785888672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16257286071777344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17740440368652344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([2634, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1898484230041504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1898484230041504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2634, 128]), torch.Size([1, 2634, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.19236040115356445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3755507469177246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2634, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3556380271911621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3621678352355957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3686976432800293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36211681365966797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6847, 256])
first layer input nodes number: 15666
first layer output nodes number: 6847
edges number: 44238
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3688163757324219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37534618377685547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37729358673095703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37729358673095703  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([441, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3990931510925293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3990931510925293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3999342918395996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4066634178161621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4069352149963379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4069352149963379  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4076218605041504  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4184122085571289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([328, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41901493072509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41901493072509766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41964054107666016  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43367767333984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([256, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43434906005859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43434906005859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43483734130859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44899749755859375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44965696334838867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44965696334838867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4500155448913574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4629244804382324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4636507034301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4636507034301758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46395015716552734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47682666778564453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47747802734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47747802734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4777050018310547  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48905372619628906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4896554946899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4896554946899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48983287811279297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49994373321533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5005297660827637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5005297660827637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.500678539276123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.510200023651123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5110197067260742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5110197067260742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5111970901489258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5237913131713867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5244746208190918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5244746208190918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5246138572692871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5354743003845215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5361199378967285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5361199378967285  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5362381935119629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5462899208068848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5467181205749512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5467181205749512  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5467925071716309  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5536360740661621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5540971755981445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5540971755981445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5541677474975586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5611543655395508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5618257522583008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5618257522583008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5619192123413086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5718259811401367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5723328590393066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5723328590393066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5724015235900879  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5801606178283691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5807476043701172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5807476043701172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5808200836181641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5895175933837891  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5898966789245605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5898966789245605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.589942455291748  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5957560539245605  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5962629318237305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5962629318237305  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.596318244934082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6037302017211914  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6041831970214844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6041831970214844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6042308807373047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6109542846679688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6113948822021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6113948822021484  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6114387512207031  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6179313659667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6182270050048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6182270050048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.618255615234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6226902008056641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6229634284973145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6229634284973145  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.622988224029541  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6270051002502441  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6273617744445801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6273617744445801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6273922920227051  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6325497627258301  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([217, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6377487182617188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6377487182617188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6381626129150391  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7110080718994141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 217, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6923151016235352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6927337646484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6931524276733398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6927127838134766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2809, 40])
input nodes number: 6847
output nodes number: 2809
edges number: 21193
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.692774772644043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6927752494812012  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.020450592041015625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 29 input nodes size: 15608
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01901388168334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01901388168334961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.026456356048583984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.026477813720703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01898670196533203  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01940155029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01940155029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01940155029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([15608, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01940155029296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([917, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03875303268432617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.03875303268432617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0396275520324707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04662370681762695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([867, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.047013282775878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.047013282775878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.047840118408203125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060242652893066406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([690, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060991764068603516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060991764068603516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06164979934692383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07656526565551758  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([534, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0772547721862793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0772547721862793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07776403427124023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0934290885925293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([464, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09428071975708008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09428071975708008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09472322463989258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11065340042114258  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([361, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1114649772644043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1114649772644043  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11180925369262695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12661314010620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([308, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12746906280517578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12746906280517578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1277627944946289  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14244937896728516  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([277, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14335918426513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14335918426513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14362335205078125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15868091583251953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 277, 128])
m.shape torch.Size([213, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15946292877197266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15946292877197266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 213, 128]), torch.Size([1, 213, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1596660614013672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1726665496826172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 213, 128])
m.shape torch.Size([2089, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18277978897094727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18277978897094727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18477201461791992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3298506736755371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31355714797973633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.31996583938598633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.32637453079223633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.319915771484375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([6720, 256])
first layer input nodes number: 15608
first layer output nodes number: 6720
edges number: 38522
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3264927864074707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3329014778137207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3345036506652832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3345036506652832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([632, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3516817092895508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3516817092895508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3528871536254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36333465576171875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([497, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36368751525878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.36368751525878906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3646354675292969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3789329528808594  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([349, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37964963912963867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.37964963912963867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.38031530380249023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.395388126373291  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3959779739379883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3959779739379883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.3964357376098633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4097108840942383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4103665351867676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4103665351867676  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4107174873352051  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4233517646789551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([128, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42391443252563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42391443252563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42415857315063477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43465662002563477  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43528175354003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43528175354003906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43549346923828125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4460792541503906  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44671154022216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44671154022216797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44689464569091797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.45733165740966797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4578542709350586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4578542709350586  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4579896926879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4666566848754883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([50, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4670696258544922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4670696258544922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4671649932861328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4739360809326172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47434329986572266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47434329986572266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4744253158569336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4808225631713867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48125457763671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48125457763671875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48133277893066406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4879798889160156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48837852478027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48837852478027344  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4884452819824219  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4945869445800781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4947824478149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4947824478149414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4948148727416992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49802494049072266  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49829721450805664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49829721450805664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4983353614807129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5023789405822754  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5026984214782715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5026984214782715  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5027403831481934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5074820518493652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5079026222229004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5079026222229004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5079541206359863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5141339302062988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5144200325012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5144200325012207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5144543647766113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5188145637512207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.519162654876709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.519162654876709  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5192008018493652  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5243124961853027  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5245819091796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5245819091796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5246105194091797  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5286445617675781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5289535522460938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5289535522460938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5289840698242188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5335006713867188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5336127281188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5336127281188965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5336241722106934  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.535398006439209  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5357460975646973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5357460975646973  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5357766151428223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5407204627990723  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5408205986022949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5408205986022949  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.540830135345459  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5424418449401855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([175, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5466423034667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5466423034667969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5469760894775391  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6057224273681641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 175, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5918693542480469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5922918319702148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5927143096923828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5922703742980957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2834, 40])
input nodes number: 6720
output nodes number: 2834
edges number: 17109
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5923457145690918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.59234619140625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.020247459411621094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 30 input nodes size: 15977
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018990516662597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.018990516662597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.026608943939208984  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.026629924774169922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019165992736816406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01974773406982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01974773406982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01974773406982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([15977, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.01974773406982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([473, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04638099670410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04638099670410156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04683208465576172  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05044078826904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([533, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05072355270385742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05072355270385742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05123186111450195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05946683883666992  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([514, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.059947967529296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.059947967529296875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06043815612792969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07218503952026367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([475, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0728459358215332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0728459358215332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07329893112182617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08643579483032227  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08731317520141602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08731317520141602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.08775472640991211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10365056991577148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([410, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10460281372070312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10460281372070312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10499382019042969  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12180709838867188  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([394, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12292671203613281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12292671203613281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12330245971679688  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14208984375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([370, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14331340789794922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14331340789794922  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.14366626739501953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16377925872802734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([292, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16540861129760742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16540861129760742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.16568708419799805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.18350934982299805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([3583, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2004551887512207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.2004551887512207  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 3583, 128]), torch.Size([1, 3583, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20460987091064453  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4533677101135254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 3583, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4278988838195801  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4350581169128418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4422173500061035  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43500185012817383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([7507, 256])
first layer input nodes number: 15977
first layer output nodes number: 7507
edges number: 53932
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4423384666442871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44949769973754883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4517812728881836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4517812728881836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([343, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47585344314575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47585344314575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47650766372680664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48271656036376953  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([328, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4830203056335449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4830203056335449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4836459159851074  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4931807518005371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49367570877075195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49367570877075195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49420976638793945  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5069422721862793  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([198, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5074367523193359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5074367523193359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5078144073486328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5187664031982422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([173, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5194091796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5194091796875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5197391510009766  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5316181182861328  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5322489738464355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5322489738464355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5325121879577637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.543830394744873  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([154, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5447349548339844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5447349548339844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5450286865234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5597152709960938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5605683326721191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5605683326721191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5608162879943848  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5749497413635254  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5756564140319824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5756564140319824  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5758395195007324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5875582695007324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5881781578063965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5881781578063965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5883193016052246  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5983405113220215  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([99, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5999855995178223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5999855995178223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6001744270324707  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6149029731750488  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6156044006347656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6156044006347656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6157360076904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.626922607421875  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.627631664276123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.627631664276123  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6277499198913574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6386294364929199  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6394586563110352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6394586563110352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6395845413208008  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6520471572875977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6528496742248535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6528496742248535  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6529641151428223  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6650948524475098  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6658530235290527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6658530235290527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6659541130065918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6773772239685059  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6779642105102539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6779642105102539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6780385971069336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6869649887084961  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6874470710754395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6874470710754395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6875042915344238  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6947712898254395  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6951813697814941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6951813697814941  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6952271461486816  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7013611793518066  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7019729614257812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7019729614257812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7020359039306641  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7109107971191406  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7114043235778809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7114043235778809  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.711453914642334  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7187933921813965  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7191281318664551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7191281318664551  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7191605567932129  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7241864204406738  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7246789932250977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7246789932250977  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7247228622436523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7318296432495117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7323613166809082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7323613166809082  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7324070930480957  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7401432991027832  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([250, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7461276054382324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7461276054382324  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7466044425964355  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8305277824401855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 250, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8094387054443359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8098545074462891  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8102703094482422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8098335266113281  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2789, 40])
input nodes number: 7507
output nodes number: 2789
edges number: 24035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8099040985107422  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8099045753479004  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.020821571350097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

pseudo mini batch 31 input nodes size: 14995
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019159317016601562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019159317016601562  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027165889739990234  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.027187824249267578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.019548416137695312  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02012348175048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02012348175048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02012348175048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([14995, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.02012348175048828  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([523, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04644060134887695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04644060134887695  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.04693937301635742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05092954635620117  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([582, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.051235198974609375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.051235198974609375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.05179023742675781  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06030130386352539  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([585, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060860633850097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.060860633850097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.06141853332519531  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07369232177734375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([525, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07482290267944336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07482290267944336  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.07532358169555664  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.0898432731628418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([525, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09084463119506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09084463119506836  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.09134531021118164  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.10972404479980469  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([453, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11076974868774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11076974868774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 453, 128]), torch.Size([1, 453, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.11120176315307617  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.12977838516235352  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 453, 128])
m.shape torch.Size([399, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13089418411254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13089418411254883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.13127470016479492  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1503005027770996  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([347, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15143394470214844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.15143394470214844  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1517648696899414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17062759399414062  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([316, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17181825637817383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.17181825637817383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1721196174621582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.1914067268371582  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([3262, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20681047439575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.20681047439575195  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 3262, 128]), torch.Size([1, 3262, 128])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.21078729629516602  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.44205141067504883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 3262, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.41767454147338867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.42484331130981445  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43201208114624023  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4247870445251465  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([7517, 256])
first layer input nodes number: 14995
first layer output nodes number: 7517
edges number: 51918
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4321260452270508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.43929481506347656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4410872459411621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4410872459411621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

m.shape torch.Size([368, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46578407287597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46578407287597656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.46648597717285156  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.47318506240844727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([289, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4733901023864746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4733901023864746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4739413261413574  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.48335933685302734  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.483917236328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.483917236328125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4844684600830078  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.4965953826904297  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49721193313598633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49721193313598633  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.49765443801879883  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5104870796203613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5112991333007812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5112991333007812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5117092132568359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5264720916748047  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([179, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5276904106140137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5276904106140137  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5280318260192871  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5427126884460449  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5435042381286621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5435042381286621  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5437769889831543  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5574145317077637  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5582704544067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5582704544067383  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5585165023803711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5725412368774414  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([122, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5734739303588867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5734739303588867  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5737066268920898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5885992050170898  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([112, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5895595550537109  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5895595550537109  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.5897731781005859  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6049404144287109  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6055741310119629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6055741310119629  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6057076454162598  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.616121768951416  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6168508529663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6168508529663086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6169824600219727  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.628169059753418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.628840446472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.628840446472168  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6289529800415039  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6393060684204102  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6401381492614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6401381492614746  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6402640342712402  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6527266502380371  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6533417701721191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6533417701721191  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6534314155578613  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6629338264465332  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6632580757141113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6632580757141113  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6633038520812988  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6684765815734863  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6692218780517578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6692218780517578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6693115234375  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6800689697265625  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6806297302246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6806297302246094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6806964874267578  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6891746520996094  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6895980834960938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6895980834960938  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6896457672119141  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6960353851318359  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6967039108276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.6967039108276367  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.696772575378418  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7064542770385742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.707005500793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.707005500793457  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7070608139038086  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7152471542358398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7156214714050293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7156214714050293  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7156577110290527  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7212748527526855  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7216768264770508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7216768264770508  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7217130661010742  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7275838851928711  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7278890609741211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7278890609741211  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7279157638549805  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7324285507202148  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([290, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7393836975097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7393836975097656  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.7399368286132812  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8403234481811523  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

rst.shape  torch.Size([1, 290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8187379837036133  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8191742897033691  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.819610595703125  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8191523551940918  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

torch.Size([2927, 40])
input nodes number: 7517
output nodes number: 2927
edges number: 25193
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.8192510604858398  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.819251537322998  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021220684051513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021220684051513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2166748046875 GB
    Memory Allocated: 0.021220684051513672  GigaBytes
Max Memory Allocated: 1.9368419647216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008615940809249878 |0.002003282308578491 |0.11837978661060333 |8.58306884765625e-05 |0.07617049664258957 |0.004806041717529297 |
----------------------------------------------------------pseudo_mini_loss sum 3.9221205711364746
Total (block generation + training)time/epoch 30.086395621299744
Training time/epoch 6.764595985412598
Training time without block to device /epoch 6.700490951538086
Training time without total dataloading part /epoch 6.233161687850952
load block tensor time/epoch 0.2757101058959961
block to device time/epoch 0.06410503387451172
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1115397
Number of first layer input nodes during this epoch:  798220
Number of first layer output nodes during this epoch:  317177
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
