[05:23:00] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 32 parts and get 0 edge cuts
main start at this time 1651555365.8468978
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03545022010803223
global_2_local spend time (sec) 0.0360875129699707
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004882335662841797
A = g.adjacency_matrix() spent  0.007664680480957031
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08430838584899902
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2928171157836914
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1939516067504883

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.075 seconds
Split the graph: 0.019 seconds
Construct subgraphs: 0.039 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.13512396812438965
2842
2840
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2840
2843
total k batches seeds list generation spend  10.219756603240967
after graph partition
graph partition algorithm spend time 10.311192274093628
2842
2840
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2840
2843
partition_len_list
[21511, 21303, 21789, 20958, 21337, 21363, 21720, 21225, 21094, 21155, 20929, 20918, 21556, 21300, 20859, 21145, 21225, 21874, 21234, 20664, 21424, 21258, 21773, 20815, 20865, 21461, 21289, 21258, 21286, 21387, 21115, 21636]
shared_neighbor_graph_partition_s0 selection method  spend 10.396770238876343
time for parepare:  0.017828702926635742
local_output_nid generation:  0.0005633831024169922
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0012743473052978516
r_  generation:  0.006688594818115234
local_output_nid generation:  0.0006067752838134766
local_in_edges_tensor generation:  0.0007677078247070312
mini_batch_src_global generation:  0.001226186752319336
r_  generation:  0.006688117980957031
local_output_nid generation:  0.0006396770477294922
local_in_edges_tensor generation:  0.0007088184356689453
mini_batch_src_global generation:  0.0037488937377929688
r_  generation:  0.0068514347076416016
local_output_nid generation:  0.001194000244140625
local_in_edges_tensor generation:  0.0006914138793945312
mini_batch_src_global generation:  0.0007426738739013672
r_  generation:  0.0069353580474853516
local_output_nid generation:  0.0007741451263427734
local_in_edges_tensor generation:  0.0007321834564208984
mini_batch_src_global generation:  0.0007567405700683594
r_  generation:  0.006853818893432617
local_output_nid generation:  0.00070953369140625
local_in_edges_tensor generation:  0.0006718635559082031
mini_batch_src_global generation:  0.0007488727569580078
r_  generation:  0.006984233856201172
local_output_nid generation:  0.000720977783203125
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.0007772445678710938
r_  generation:  0.007144927978515625
local_output_nid generation:  0.000698089599609375
local_in_edges_tensor generation:  0.0007829666137695312
mini_batch_src_global generation:  0.0007607936859130859
r_  generation:  0.006894588470458984
local_output_nid generation:  0.0006999969482421875
local_in_edges_tensor generation:  0.0006663799285888672
mini_batch_src_global generation:  0.00074005126953125
r_  generation:  0.006805896759033203
local_output_nid generation:  0.0007014274597167969
local_in_edges_tensor generation:  0.00066375732421875
mini_batch_src_global generation:  0.0007543563842773438
r_  generation:  0.006894588470458984
local_output_nid generation:  0.0007088184356689453
local_in_edges_tensor generation:  0.0006494522094726562
mini_batch_src_global generation:  0.0007321834564208984
r_  generation:  0.006837368011474609
local_output_nid generation:  0.0007147789001464844
local_in_edges_tensor generation:  0.0006456375122070312
mini_batch_src_global generation:  0.0007252693176269531
r_  generation:  0.006871461868286133
local_output_nid generation:  0.0007009506225585938
local_in_edges_tensor generation:  0.0006570816040039062
mini_batch_src_global generation:  0.0007624626159667969
r_  generation:  0.007126569747924805
local_output_nid generation:  0.0007083415985107422
local_in_edges_tensor generation:  0.0006425380706787109
mini_batch_src_global generation:  0.0007648468017578125
r_  generation:  0.006995201110839844
local_output_nid generation:  0.0007119178771972656
local_in_edges_tensor generation:  0.0006563663482666016
mini_batch_src_global generation:  0.0007283687591552734
r_  generation:  0.006838083267211914
local_output_nid generation:  0.0006992816925048828
local_in_edges_tensor generation:  0.0006468296051025391
mini_batch_src_global generation:  0.0007526874542236328
r_  generation:  0.00707554817199707
local_output_nid generation:  0.0007238388061523438
local_in_edges_tensor generation:  0.0006611347198486328
mini_batch_src_global generation:  0.0007798671722412109
r_  generation:  0.00712132453918457
local_output_nid generation:  0.0007328987121582031
local_in_edges_tensor generation:  0.0006787776947021484
mini_batch_src_global generation:  0.0008022785186767578
r_  generation:  0.00721287727355957
local_output_nid generation:  0.0007510185241699219
local_in_edges_tensor generation:  0.0006659030914306641
mini_batch_src_global generation:  0.0007746219635009766
r_  generation:  0.007005453109741211
local_output_nid generation:  0.0007238388061523438
local_in_edges_tensor generation:  0.0006511211395263672
mini_batch_src_global generation:  0.0007379055023193359
r_  generation:  0.0068264007568359375
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.0006551742553710938
mini_batch_src_global generation:  0.0007758140563964844
r_  generation:  0.0071027278900146484
local_output_nid generation:  0.0007236003875732422
local_in_edges_tensor generation:  0.0006601810455322266
mini_batch_src_global generation:  0.0007643699645996094
r_  generation:  0.007092714309692383
local_output_nid generation:  0.0007250308990478516
local_in_edges_tensor generation:  0.0006771087646484375
mini_batch_src_global generation:  0.0008022785186767578
r_  generation:  0.007296323776245117
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.000652313232421875
mini_batch_src_global generation:  0.0007698535919189453
r_  generation:  0.0068356990814208984
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.0006546974182128906
mini_batch_src_global generation:  0.0007488727569580078
r_  generation:  0.0068166255950927734
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.0071680545806884766
mini_batch_src_global generation:  0.0010013580322265625
r_  generation:  0.007158041000366211
local_output_nid generation:  0.0006921291351318359
local_in_edges_tensor generation:  0.0007216930389404297
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.007210254669189453
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.0008723735809326172
r_  generation:  0.00696873664855957
local_output_nid generation:  0.0007309913635253906
local_in_edges_tensor generation:  0.0006678104400634766
mini_batch_src_global generation:  0.0008151531219482422
r_  generation:  0.007069826126098633
local_output_nid generation:  0.0007236003875732422
local_in_edges_tensor generation:  0.0006525516510009766
mini_batch_src_global generation:  0.0007963180541992188
r_  generation:  0.0069446563720703125
local_output_nid generation:  0.0007200241088867188
local_in_edges_tensor generation:  0.0006511211395263672
mini_batch_src_global generation:  0.0007784366607666016
r_  generation:  0.006990909576416016
local_output_nid generation:  0.0006933212280273438
local_in_edges_tensor generation:  0.0006461143493652344
mini_batch_src_global generation:  0.0007891654968261719
r_  generation:  0.007185935974121094
----------------------check_connections_block total spend ----------------------------- 0.39392685890197754
generate_one_block  0.01273965835571289
generate_one_block  0.011928081512451172
generate_one_block  0.012189388275146484
generate_one_block  0.011505365371704102
generate_one_block  0.011740922927856445
generate_one_block  0.011749505996704102
generate_one_block  0.01207280158996582
generate_one_block  0.011780977249145508
generate_one_block  0.011632204055786133
generate_one_block  0.012264251708984375
generate_one_block  0.011571407318115234
generate_one_block  0.011591911315917969
generate_one_block  0.01206064224243164
generate_one_block  0.011741161346435547
generate_one_block  0.011430978775024414
generate_one_block  0.011719942092895508
generate_one_block  0.011931180953979492
generate_one_block  0.012159109115600586
generate_one_block  0.011822223663330078
generate_one_block  0.011597156524658203
generate_one_block  0.012427330017089844
generate_one_block  0.01273965835571289
generate_one_block  0.012737751007080078
generate_one_block  0.011518001556396484
generate_one_block  0.011514663696289062
generate_one_block  0.012980222702026367
generate_one_block  0.011721611022949219
generate_one_block  0.011617183685302734
generate_one_block  0.012215375900268555
generate_one_block  0.012303829193115234
generate_one_block  0.012329816818237305
generate_one_block  0.012354612350463867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06338715553283691
gen group dst list time:  0.019314289093017578
time for parepare:  0.020815134048461914
local_output_nid generation:  0.0043222904205322266
local_in_edges_tensor generation:  0.01890110969543457
mini_batch_src_global generation:  0.005192756652832031
r_  generation:  0.057297468185424805
local_output_nid generation:  0.00659489631652832
local_in_edges_tensor generation:  0.0063931941986083984
mini_batch_src_global generation:  0.006527423858642578
r_  generation:  0.05967259407043457
local_output_nid generation:  0.006738185882568359
local_in_edges_tensor generation:  0.006219625473022461
mini_batch_src_global generation:  0.005556821823120117
r_  generation:  0.06207466125488281
local_output_nid generation:  0.0061969757080078125
local_in_edges_tensor generation:  0.006510257720947266
mini_batch_src_global generation:  0.006044864654541016
r_  generation:  0.06011486053466797
local_output_nid generation:  0.006442546844482422
local_in_edges_tensor generation:  0.008192062377929688
mini_batch_src_global generation:  0.007756710052490234
r_  generation:  0.061068058013916016
local_output_nid generation:  0.0063664913177490234
local_in_edges_tensor generation:  0.006803035736083984
mini_batch_src_global generation:  0.006716728210449219
r_  generation:  0.061992645263671875
local_output_nid generation:  0.0064771175384521484
local_in_edges_tensor generation:  0.007967948913574219
mini_batch_src_global generation:  0.011807441711425781
r_  generation:  0.06339836120605469
local_output_nid generation:  0.006324052810668945
local_in_edges_tensor generation:  0.005894899368286133
mini_batch_src_global generation:  0.006792545318603516
r_  generation:  0.06252551078796387
local_output_nid generation:  0.006405353546142578
local_in_edges_tensor generation:  0.006787300109863281
mini_batch_src_global generation:  0.006926298141479492
r_  generation:  0.06125211715698242
local_output_nid generation:  0.006349802017211914
local_in_edges_tensor generation:  0.007662296295166016
mini_batch_src_global generation:  0.007971048355102539
r_  generation:  0.06253910064697266
local_output_nid generation:  0.006258726119995117
local_in_edges_tensor generation:  0.006820201873779297
mini_batch_src_global generation:  0.007049560546875
r_  generation:  0.061324119567871094
local_output_nid generation:  0.006198883056640625
local_in_edges_tensor generation:  0.005823612213134766
mini_batch_src_global generation:  0.006650447845458984
r_  generation:  0.0615544319152832
local_output_nid generation:  0.006451129913330078
local_in_edges_tensor generation:  0.006018161773681641
mini_batch_src_global generation:  0.006879568099975586
r_  generation:  0.06374406814575195
local_output_nid generation:  0.006378173828125
local_in_edges_tensor generation:  0.0057027339935302734
mini_batch_src_global generation:  0.0068857669830322266
r_  generation:  0.0636744499206543
local_output_nid generation:  0.00641942024230957
local_in_edges_tensor generation:  0.00572514533996582
mini_batch_src_global generation:  0.0069386959075927734
r_  generation:  0.0629417896270752
local_output_nid generation:  0.006270170211791992
local_in_edges_tensor generation:  0.006013631820678711
mini_batch_src_global generation:  0.006689548492431641
r_  generation:  0.06355023384094238
local_output_nid generation:  0.006426095962524414
local_in_edges_tensor generation:  0.006737947463989258
mini_batch_src_global generation:  0.006738901138305664
r_  generation:  0.06655693054199219
local_output_nid generation:  0.006635189056396484
local_in_edges_tensor generation:  0.006787538528442383
mini_batch_src_global generation:  0.0077745914459228516
r_  generation:  0.0694272518157959
local_output_nid generation:  0.006437063217163086
local_in_edges_tensor generation:  0.006882190704345703
mini_batch_src_global generation:  0.007004976272583008
r_  generation:  0.06323719024658203
local_output_nid generation:  0.006147146224975586
local_in_edges_tensor generation:  0.006149768829345703
mini_batch_src_global generation:  0.006697416305541992
r_  generation:  0.0608522891998291
local_output_nid generation:  0.006342172622680664
local_in_edges_tensor generation:  0.006496429443359375
mini_batch_src_global generation:  0.007219791412353516
r_  generation:  0.06427574157714844
local_output_nid generation:  0.006310701370239258
local_in_edges_tensor generation:  0.006253957748413086
mini_batch_src_global generation:  0.006818056106567383
r_  generation:  0.0634152889251709
local_output_nid generation:  0.006424903869628906
local_in_edges_tensor generation:  0.0064508914947509766
mini_batch_src_global generation:  0.0073680877685546875
r_  generation:  0.06519031524658203
local_output_nid generation:  0.006127357482910156
local_in_edges_tensor generation:  0.005835294723510742
mini_batch_src_global generation:  0.006749153137207031
r_  generation:  0.06228518486022949
local_output_nid generation:  0.006243467330932617
local_in_edges_tensor generation:  0.00579833984375
mini_batch_src_global generation:  0.007161855697631836
r_  generation:  0.06267809867858887
local_output_nid generation:  0.006379365921020508
local_in_edges_tensor generation:  0.006317853927612305
mini_batch_src_global generation:  0.006971597671508789
r_  generation:  0.06403422355651855
local_output_nid generation:  0.0063283443450927734
local_in_edges_tensor generation:  0.00609898567199707
mini_batch_src_global generation:  0.006925344467163086
r_  generation:  0.06337833404541016
local_output_nid generation:  0.006310939788818359
local_in_edges_tensor generation:  0.005707263946533203
mini_batch_src_global generation:  0.00693964958190918
r_  generation:  0.0626211166381836
local_output_nid generation:  0.00634765625
local_in_edges_tensor generation:  0.006783723831176758
mini_batch_src_global generation:  0.006864309310913086
r_  generation:  0.06390571594238281
local_output_nid generation:  0.006348371505737305
local_in_edges_tensor generation:  0.005797147750854492
mini_batch_src_global generation:  0.0068721771240234375
r_  generation:  0.06433820724487305
local_output_nid generation:  0.0062580108642578125
local_in_edges_tensor generation:  0.005736112594604492
mini_batch_src_global generation:  0.006815195083618164
r_  generation:  0.062154293060302734
local_output_nid generation:  0.00628662109375
local_in_edges_tensor generation:  0.0063228607177734375
mini_batch_src_global generation:  0.007082223892211914
r_  generation:  0.06428170204162598
----------------------check_connections_block total spend ----------------------------- 3.143900156021118
generate_one_block  0.08259463310241699
generate_one_block  0.08257126808166504
generate_one_block  0.08444809913635254
generate_one_block  0.08094525337219238
generate_one_block  0.08217096328735352
generate_one_block  0.08230137825012207
generate_one_block  0.08466196060180664
generate_one_block  0.08669114112854004
generate_one_block  0.08598709106445312
generate_one_block  0.09876275062561035
generate_one_block  0.08071398735046387
generate_one_block  0.09648466110229492
generate_one_block  0.09036087989807129
generate_one_block  0.0841665267944336
generate_one_block  0.09027409553527832
generate_one_block  0.0859980583190918
generate_one_block  0.08240270614624023
generate_one_block  0.0866537094116211
generate_one_block  0.08275580406188965
generate_one_block  0.08023595809936523
generate_one_block  0.1151130199432373
generate_one_block  0.10919713973999023
generate_one_block  0.08412718772888184
generate_one_block  0.07937979698181152
generate_one_block  0.08009147644042969
generate_one_block  0.08329534530639648
generate_one_block  0.08337664604187012
generate_one_block  0.08567404747009277
generate_one_block  0.08346772193908691
generate_one_block  0.1179654598236084
generate_one_block  0.08090424537658691
generate_one_block  0.0830850601196289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  3.143900156021118
block generation total time  2.796858072280884
average batch blocks generation time:  0.08740181475877762
pseudo mini batch 0 input nodes size: 71069
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0545654296875 GB
    Memory Allocated: 0.036665916442871094  GigaBytes
Max Memory Allocated: 0.036665916442871094  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0545654296875 GB
    Memory Allocated: 0.036687374114990234  GigaBytes
Max Memory Allocated: 0.036687374114990234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0545654296875 GB
    Memory Allocated: 0.036687374114990234  GigaBytes
Max Memory Allocated: 0.036687374114990234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.0381321907043457  GigaBytes
Max Memory Allocated: 0.0381321907043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.0381321907043457  GigaBytes
Max Memory Allocated: 0.0381321907043457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.0381321907043457  GigaBytes
Max Memory Allocated: 0.0381321907043457  GigaBytes

torch.Size([71069, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.0381321907043457  GigaBytes
Max Memory Allocated: 0.0381321907043457  GigaBytes

m.shape torch.Size([780, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12261676788330078  GigaBytes
Max Memory Allocated: 0.12484407424926758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12261676788330078  GigaBytes
Max Memory Allocated: 0.12484407424926758  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12336063385009766  GigaBytes
Max Memory Allocated: 0.12484407424926758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.12931156158447266  GigaBytes
Max Memory Allocated: 0.1296834945678711  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([1052, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.13020753860473633  GigaBytes
Max Memory Allocated: 0.13023138046264648  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.13020753860473633  GigaBytes
Max Memory Allocated: 0.13023138046264648  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.1312108039855957  GigaBytes
Max Memory Allocated: 0.1312108039855957  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.14625978469848633  GigaBytes
Max Memory Allocated: 0.1472630500793457  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1109, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.14734458923339844  GigaBytes
Max Memory Allocated: 0.14738178253173828  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.14734458923339844  GigaBytes
Max Memory Allocated: 0.14738178253173828  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.14840221405029297  GigaBytes
Max Memory Allocated: 0.14840221405029297  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.1721639633178711  GigaBytes
Max Memory Allocated: 0.1737504005432129  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1168, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.17386293411254883  GigaBytes
Max Memory Allocated: 0.17391538619995117  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.17386293411254883  GigaBytes
Max Memory Allocated: 0.17391538619995117  GigaBytes

 h.shape torch.Size([1, 1168, 128]), torch.Size([1, 1168, 128])
----------------------------------------3
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.17497682571411133  GigaBytes
Max Memory Allocated: 0.17497682571411133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20727968215942383  GigaBytes
Max Memory Allocated: 0.20950746536254883  GigaBytes

rst.shape  torch.Size([1, 1168, 128])
m.shape torch.Size([1050, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20922613143920898  GigaBytes
Max Memory Allocated: 0.20950746536254883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20922613143920898  GigaBytes
Max Memory Allocated: 0.20950746536254883  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.21022748947143555  GigaBytes
Max Memory Allocated: 0.21022748947143555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.2462763786315918  GigaBytes
Max Memory Allocated: 0.2487797737121582  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([1026, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.24871110916137695  GigaBytes
Max Memory Allocated: 0.2487807273864746  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.24871110916137695  GigaBytes
Max Memory Allocated: 0.2487807273864746  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.24968957901000977  GigaBytes
Max Memory Allocated: 0.24968957901000977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.29252099990844727  GigaBytes
Max Memory Allocated: 0.2954564094543457  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([925, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.2951192855834961  GigaBytes
Max Memory Allocated: 0.2954564094543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.2951192855834961  GigaBytes
Max Memory Allocated: 0.2954564094543457  GigaBytes

 h.shape torch.Size([1, 925, 128]), torch.Size([1, 925, 128])
----------------------------------------3
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.2960014343261719  GigaBytes
Max Memory Allocated: 0.2960014343261719  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.34050655364990234  GigaBytes
Max Memory Allocated: 0.3435940742492676  GigaBytes

rst.shape  torch.Size([1, 925, 128])
m.shape torch.Size([868, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.34337663650512695  GigaBytes
Max Memory Allocated: 0.3435940742492676  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.34337663650512695  GigaBytes
Max Memory Allocated: 0.3435940742492676  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3442044258117676  GigaBytes
Max Memory Allocated: 0.3442044258117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.39221811294555664  GigaBytes
Max Memory Allocated: 0.39552927017211914  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([850, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.39545202255249023  GigaBytes
Max Memory Allocated: 0.3955378532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.39545202255249023  GigaBytes
Max Memory Allocated: 0.3955378532409668  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.39626264572143555  GigaBytes
Max Memory Allocated: 0.39626264572143555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.44829511642456055  GigaBytes
Max Memory Allocated: 0.45194292068481445  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([12683, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5084366798400879  GigaBytes
Max Memory Allocated: 0.5098543167114258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5084366798400879  GigaBytes
Max Memory Allocated: 0.5098543167114258  GigaBytes

 h.shape torch.Size([1, 12683, 128]), torch.Size([1, 12683, 128])
----------------------------------------3
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5205321311950684  GigaBytes
Max Memory Allocated: 0.5205321311950684  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3793091773986816  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

rst.shape  torch.Size([1, 12683, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3010764122009277  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3215909004211426  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3421053886413574  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3214302062988281  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

torch.Size([21511, 256])
first layer input nodes number: 71069
first layer output nodes number: 21511
edges number: 170188
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.342637062072754  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3631515502929688  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.369199275970459  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.369199275970459  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3924293518066406  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3924293518066406  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3932342529296875  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3996801376342773  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3999485969543457  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3999485969543457  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4006142616271973  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4109177589416504  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4113898277282715  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4113898277282715  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4119219779968262  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4248480796813965  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4254779815673828  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4254779815673828  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.4259223937988281  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4388103485107422  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4395108222961426  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4395108222961426  GigaBytes
Max Memory Allocated: 1.4398560523986816  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4398770332336426  GigaBytes
Max Memory Allocated: 1.4398770332336426  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4530606269836426  GigaBytes
Max Memory Allocated: 1.4539761543273926  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4537429809570312  GigaBytes
Max Memory Allocated: 1.4539761543273926  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4537429809570312  GigaBytes
Max Memory Allocated: 1.4539761543273926  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4540290832519531  GigaBytes
Max Memory Allocated: 1.4540290832519531  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.4663314819335938  GigaBytes
Max Memory Allocated: 1.4671897888183594  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.4670968055725098  GigaBytes
Max Memory Allocated: 1.4671897888183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.4670968055725098  GigaBytes
Max Memory Allocated: 1.4671897888183594  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.4673542976379395  GigaBytes
Max Memory Allocated: 1.4673542976379395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.4802289009094238  GigaBytes
Max Memory Allocated: 1.4811301231384277  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.4810075759887695  GigaBytes
Max Memory Allocated: 1.4811301231384277  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.4810075759887695  GigaBytes
Max Memory Allocated: 1.4811301231384277  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.7615966796875 GB
    Memory Allocated: 1.4812326431274414  GigaBytes
Max Memory Allocated: 1.4812326431274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.4940614700317383  GigaBytes
Max Memory Allocated: 1.4949617385864258  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.4947104454040527  GigaBytes
Max Memory Allocated: 1.4949617385864258  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.4947104454040527  GigaBytes
Max Memory Allocated: 1.4949617385864258  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.4948782920837402  GigaBytes
Max Memory Allocated: 1.4949617385864258  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.5056204795837402  GigaBytes
Max Memory Allocated: 1.506375789642334  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.5062575340270996  GigaBytes
Max Memory Allocated: 1.506375789642334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.5062575340270996  GigaBytes
Max Memory Allocated: 1.506375789642334  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.5064005851745605  GigaBytes
Max Memory Allocated: 1.5064005851745605  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.516557216644287  GigaBytes
Max Memory Allocated: 1.5172724723815918  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5170354843139648  GigaBytes
Max Memory Allocated: 1.5172724723815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5170354843139648  GigaBytes
Max Memory Allocated: 1.5172724723815918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.517134666442871  GigaBytes
Max Memory Allocated: 1.5172724723815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8045654296875 GB
    Memory Allocated: 1.5248708724975586  GigaBytes
Max Memory Allocated: 1.525416374206543  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8045654296875 GB
    Memory Allocated: 1.5256404876708984  GigaBytes
Max Memory Allocated: 1.5256438255310059  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8045654296875 GB
    Memory Allocated: 1.5256404876708984  GigaBytes
Max Memory Allocated: 1.5256438255310059  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.8045654296875 GB
    Memory Allocated: 1.5257759094238281  GigaBytes
Max Memory Allocated: 1.5257759094238281  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8162841796875 GB
    Memory Allocated: 1.5372867584228516  GigaBytes
Max Memory Allocated: 1.5380992889404297  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8162841796875 GB
    Memory Allocated: 1.5378937721252441  GigaBytes
Max Memory Allocated: 1.5380992889404297  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8162841796875 GB
    Memory Allocated: 1.5378937721252441  GigaBytes
Max Memory Allocated: 1.5380992889404297  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.8162841796875 GB
    Memory Allocated: 1.537996768951416  GigaBytes
Max Memory Allocated: 1.5380992889404297  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.5474724769592285  GigaBytes
Max Memory Allocated: 1.5481419563293457  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.5480537414550781  GigaBytes
Max Memory Allocated: 1.5481419563293457  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.5480537414550781  GigaBytes
Max Memory Allocated: 1.5481419563293457  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.5481433868408203  GigaBytes
Max Memory Allocated: 1.5481433868408203  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.5570182800292969  GigaBytes
Max Memory Allocated: 1.5576457977294922  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8377685546875 GB
    Memory Allocated: 1.5576658248901367  GigaBytes
Max Memory Allocated: 1.557668685913086  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8377685546875 GB
    Memory Allocated: 1.5576658248901367  GigaBytes
Max Memory Allocated: 1.557668685913086  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.8377685546875 GB
    Memory Allocated: 1.5577573776245117  GigaBytes
Max Memory Allocated: 1.5577573776245117  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.5674619674682617  GigaBytes
Max Memory Allocated: 1.5681486129760742  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.5680007934570312  GigaBytes
Max Memory Allocated: 1.5681486129760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.5680007934570312  GigaBytes
Max Memory Allocated: 1.5681486129760742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.5680732727050781  GigaBytes
Max Memory Allocated: 1.5681486129760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8553466796875 GB
    Memory Allocated: 1.576263427734375  GigaBytes
Max Memory Allocated: 1.57684326171875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8553466796875 GB
    Memory Allocated: 1.5768156051635742  GigaBytes
Max Memory Allocated: 1.57684326171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8553466796875 GB
    Memory Allocated: 1.5768156051635742  GigaBytes
Max Memory Allocated: 1.57684326171875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.8553466796875 GB
    Memory Allocated: 1.5768842697143555  GigaBytes
Max Memory Allocated: 1.5768842697143555  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 1.5851240158081055  GigaBytes
Max Memory Allocated: 1.585707664489746  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 1.585556983947754  GigaBytes
Max Memory Allocated: 1.585707664489746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 1.585556983947754  GigaBytes
Max Memory Allocated: 1.585707664489746  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 1.5856084823608398  GigaBytes
Max Memory Allocated: 1.585707664489746  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 1.592148780822754  GigaBytes
Max Memory Allocated: 1.5926122665405273  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 1.592634677886963  GigaBytes
Max Memory Allocated: 1.592637062072754  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 1.592634677886963  GigaBytes
Max Memory Allocated: 1.592637062072754  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 1.5926880836486816  GigaBytes
Max Memory Allocated: 1.5926880836486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 1.5998444557189941  GigaBytes
Max Memory Allocated: 1.6003518104553223  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 1.6002216339111328  GigaBytes
Max Memory Allocated: 1.6003518104553223  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 1.6002216339111328  GigaBytes
Max Memory Allocated: 1.6003518104553223  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 1.6002616882324219  GigaBytes
Max Memory Allocated: 1.6003518104553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8846435546875 GB
    Memory Allocated: 1.6059093475341797  GigaBytes
Max Memory Allocated: 1.6063098907470703  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8846435546875 GB
    Memory Allocated: 1.606353759765625  GigaBytes
Max Memory Allocated: 1.6063556671142578  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8846435546875 GB
    Memory Allocated: 1.606353759765625  GigaBytes
Max Memory Allocated: 1.6063556671142578  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.8846435546875 GB
    Memory Allocated: 1.6063976287841797  GigaBytes
Max Memory Allocated: 1.6063976287841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6128902435302734  GigaBytes
Max Memory Allocated: 1.6133508682250977  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6133127212524414  GigaBytes
Max Memory Allocated: 1.6133508682250977  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6133127212524414  GigaBytes
Max Memory Allocated: 1.6133508682250977  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6133527755737305  GigaBytes
Max Memory Allocated: 1.6133527755737305  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 1.6195611953735352  GigaBytes
Max Memory Allocated: 1.6200017929077148  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 1.6199393272399902  GigaBytes
Max Memory Allocated: 1.6200017929077148  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 1.6199393272399902  GigaBytes
Max Memory Allocated: 1.6200017929077148  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.8983154296875 GB
    Memory Allocated: 1.6199736595153809  GigaBytes
Max Memory Allocated: 1.6200017929077148  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.625535488128662  GigaBytes
Max Memory Allocated: 1.6259303092956543  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.625772476196289  GigaBytes
Max Memory Allocated: 1.6259303092956543  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.625772476196289  GigaBytes
Max Memory Allocated: 1.6259303092956543  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.62579345703125  GigaBytes
Max Memory Allocated: 1.6259303092956543  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6293392181396484  GigaBytes
Max Memory Allocated: 1.6295909881591797  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6368217468261719  GigaBytes
Max Memory Allocated: 1.636850357055664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6368217468261719  GigaBytes
Max Memory Allocated: 1.636850357055664  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 2.9080810546875 GB
    Memory Allocated: 1.6374053955078125  GigaBytes
Max Memory Allocated: 1.6374053955078125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9432373046875 GB
    Memory Allocated: 1.74360990524292  GigaBytes
Max Memory Allocated: 1.7509055137634277  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9432373046875 GB
    Memory Allocated: 1.7234344482421875  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9432373046875 GB
    Memory Allocated: 1.72385835647583  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.7242822647094727  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.723836898803711  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

torch.Size([2842, 40])
input nodes number: 21511
output nodes number: 2842
edges number: 23615
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.724442958831787  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.7244439125061035  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.04399824142456055  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

pseudo mini batch 1 input nodes size: 70345
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.039887428283691406  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.039887428283691406  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.07343053817749023  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.07345199584960938  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.039542198181152344  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.040966033935546875  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.040966033935546875  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.040966033935546875  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

torch.Size([70345, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.040966033935546875  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

m.shape torch.Size([798, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.12331676483154297  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.12331676483154297  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.12407779693603516  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1307544708251953  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([1149, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1314697265625  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1314697265625  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.13256549835205078  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1490020751953125  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1112, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1506962776184082  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1506962776184082  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.15175676345825195  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.17552995681762695  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1137, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1771683692932129  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1771683692932129  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.1782526969909668  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.20971155166625977  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1090, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.21176815032958984  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.21176815032958984  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.21280765533447266  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.2510499954223633  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([974, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.25331687927246094  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.25331687927246094  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.2542457580566406  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.2953042984008789  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([894, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.2978239059448242  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.2978239059448242  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.2986764907836914  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.3429756164550781  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([807, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.3456277847290039  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.3456277847290039  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.34639739990234375  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.39082813262939453  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.39388513565063477  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.39388513565063477  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.3946499824523926  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.44434499740600586  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12540, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.504509449005127  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.504509449005127  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 12540, 128]), torch.Size([1, 12540, 128])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 0.5164685249328613  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.365562915802002  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 12540, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.2894177436828613  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3097338676452637  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.330049991607666  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.309575080871582  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

torch.Size([21303, 256])
first layer input nodes number: 70345
first layer output nodes number: 21303
edges number: 167606
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3305764198303223  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3508925437927246  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3559718132019043  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3559718132019043  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3789868354797363  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3789868354797363  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3798012733459473  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3872933387756348  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([393, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3876419067382812  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3876419067382812  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.3883914947509766  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4001960754394531  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.400611400604248  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.400611400604248  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4011340141296387  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.415513515472412  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4161748886108398  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4161748886108398  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4166326522827148  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4299077987670898  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.430558681488037  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.430558681488037  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4309077262878418  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4434733390808105  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([127, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4440312385559082  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4440312385559082  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4442734718322754  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4546895027160645  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4553961753845215  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4553961753845215  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4556307792663574  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4673609733581543  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4680743217468262  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4680743217468262  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.46828031539917  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4800219535827637  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4807062149047852  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4807062149047852  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.480879783630371  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.491988182067871  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4926800727844238  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4926800727844238  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.4928345680236816  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5038037300109863  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5044245719909668  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5044245719909668  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5045504570007324  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5143694877624512  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5149297714233398  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5149297714233398  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5150327682495117  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.523787498474121  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5245485305786133  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5245485305786133  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.524672508239746  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5360784530639648  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5366358757019043  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5366358757019043  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5367236137390137  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5454096794128418  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5459861755371094  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5459861755371094  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5460681915283203  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5547618865966797  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5551514625549316  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5551514625549316  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5552048683166504  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5612397193908691  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5618505477905273  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5618505477905273  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.561924934387207  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5708513259887695  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.571298599243164  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.571298599243164  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5713520050048828  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.578134536743164  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5784001350402832  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5784001350402832  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5784306526184082  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5825200080871582  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5829472541809082  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5829472541809082  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.582991123199463  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5891766548156738  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5894980430603027  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5894980430603027  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5895304679870605  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5943293571472168  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5946307182312012  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5946307182312012  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5946593284606934  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5990939140319824  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5992789268493652  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5992789268493652  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.5992960929870605  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.6020770072937012  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.602552890777588  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.602552890777588  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.602592945098877  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.6093621253967285  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([323, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.6171469688415527  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.6171469688415527  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.6177630424499512  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.7341866493225098  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 323, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.7142109870910645  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.7146344184875488  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.7150578498840332  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.7146129608154297  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

torch.Size([2840, 40])
input nodes number: 21303
output nodes number: 2840
edges number: 23386
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.7147927284240723  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.7147932052612305  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.04359769821166992  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

pseudo mini batch 2 input nodes size: 71301
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.03954172134399414  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.03954172134399414  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.07354068756103516  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.0735621452331543  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.03999757766723633  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.04146146774291992  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.04146146774291992  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.04146146774291992  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

torch.Size([71301, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.04146146774291992  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

m.shape torch.Size([825, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.12605905532836914  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.12605905532836914  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1268458366394043  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13344860076904297  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([1050, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13421249389648438  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13421249389648438  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.13521385192871094  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.15023422241210938  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([1095, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.15129995346069336  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.15129995346069336  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1523442268371582  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.17603111267089844  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1150, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.17833185195922852  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.17833185195922852  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.1794285774230957  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.21123361587524414  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1140, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.21340322494506836  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.21340322494506836  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.21449041366577148  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.253629207611084  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1016, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.25599241256713867  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.25599241256713867  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2569613456726074  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.2991976737976074  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([1005, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.30206775665283203  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.30206775665283203  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3030261993408203  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3521103858947754  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([866, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3549346923828125  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3549346923828125  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.3557605743408203  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.40287208557128906  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.4059267044067383  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.4059267044067383  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.40669727325439453  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.45601367950439453  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([12834, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.5168256759643555  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.5168256759643555  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 12834, 128]), torch.Size([1, 12834, 128])
----------------------------------------3
 Nvidia-smi: 3.1151123046875 GB
    Memory Allocated: 0.5290651321411133  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4254179000854492  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 12834, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.3471741676330566  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.3679537773132324  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.3887333869934082  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.3677911758422852  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

torch.Size([21789, 256])
first layer input nodes number: 71301
first layer output nodes number: 21789
edges number: 172181
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.3892669677734375  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4100465774536133  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4161663055419922  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4161663055419922  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

m.shape torch.Size([402, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4402985572814941  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4402985572814941  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4410653114318848  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4471993446350098  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([343, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4474754333496094  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4474754333496094  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.448129653930664  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4583840370178223  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.458890438079834  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.458890438079834  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4594416618347168  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4728446006774902  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([192, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4733071327209473  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4733071327209473  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4736733436584473  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4842934608459473  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([221, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4851727485656738  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4851727485656738  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.4855942726135254  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5007691383361816  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5014524459838867  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5014524459838867  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5017480850219727  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.514460563659668  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5153584480285645  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5153584480285645  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5156464576721191  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5300469398498535  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5307183265686035  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5307183265686035  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5309205055236816  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5424447059631348  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5430965423583984  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5430965423583984  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5432624816894531  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5538825988769531  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.554616928100586  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.554616928100586  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.554779052734375  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5662899017333984  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5669493675231934  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5669493675231934  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5670828819274902  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5774970054626465  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5780415534973145  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5780415534973145  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5781426429748535  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5867352485656738  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5873723030090332  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5873723030090332  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.587477207183838  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.5971283912658691  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.597520351409912  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.597520351409912  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.597583293914795  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6038146018981934  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6044034957885742  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6044034957885742  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6044855117797852  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6131792068481445  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6135997772216797  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6135997772216797  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.613656997680664  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6201229095458984  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.620633602142334  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.620633602142334  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6206965446472168  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6282496452331543  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6288928985595703  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6288928985595703  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.62896728515625  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6384143829345703  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6389436721801758  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6389436721801758  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.639002799987793  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.646925926208496  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.647569179534912  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.647569179534912  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6476359367370605  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6570487022399902  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6574797630310059  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6574797630310059  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6575236320495605  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6640162467956543  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6642060279846191  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6642060279846191  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6642251014709473  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6671814918518066  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6675701141357422  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6675701141357422  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6676044464111328  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.673166275024414  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6734490394592285  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6734490394592285  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.673473834991455  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6776642799377441  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([325, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6854610443115234  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6854610443115234  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.6860809326171875  GigaBytes
Max Memory Allocated: 1.7514567375183105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.7970032691955566  GigaBytes
Max Memory Allocated: 1.8047518730163574  GigaBytes

rst.shape  torch.Size([1, 325, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.7758922576904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.7763161659240723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.7767400741577148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.7762947082519531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21789
output nodes number: 2842
edges number: 24110
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.7764792442321777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.776479721069336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.0441584587097168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 3 input nodes size: 70002
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.03999805450439453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.03999805450439453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.07337760925292969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.07339906692504883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.03937864303588867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04077482223510742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04077482223510742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04077482223510742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70002, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04077482223510742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([875, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1216731071472168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1216731071472168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.12250757217407227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1294102668762207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([1047, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1299915313720703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1299915313720703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.13099002838134766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1459674835205078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([1074, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1470046043395996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1470046043395996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.14802885055541992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1705622673034668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1111, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17216920852661133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17216920852661133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17322874069213867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.20441484451293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1080, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.20645999908447266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.20645999908447266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2074899673461914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.24486827850341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([971, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.24713134765625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.24713134765625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.24805736541748047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2878761291503906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([919, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2904806137084961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2904806137084961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.29135704040527344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3360171318054199  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([876, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.33892059326171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.33892059326171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3397560119628906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3874330520629883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([796, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.39043140411376953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.39043140411376953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3911905288696289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.4399442672729492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([12209, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.49778175354003906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.49778175354003906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12209, 128]), torch.Size([1, 12209, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.509425163269043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3362579345703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12209, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.261566162109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.2815532684326172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3015403747558594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.2813968658447266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20958, 256])
first layer input nodes number: 70002
first layer output nodes number: 20958
edges number: 164556
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3020639419555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3220510482788086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3270478248596191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3270478248596191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([460, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3494725227355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3494725227355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3503499031066895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3583030700683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3585872650146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3585872650146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.359304428100586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3739280700683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3743624687194824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3743624687194824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3748869895935059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3870577812194824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3876953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3876953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3881416320800781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4010848999023438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([163, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4016451835632324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4016451835632324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4019560813903809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4131484031677246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.413806438446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.413806438446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4140753746032715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4256396293640137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([157, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4265618324279785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4265618324279785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.42686128616333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4418339729309082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4424071311950684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4424071311950684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4425864219665527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.452805995941162  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.453650951385498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.453650951385498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4538569450378418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4670405387878418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.467668056488037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.467668056488037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4678130149841309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.478105068206787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.478677749633789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.478677749633789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4787940979003906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4878692626953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.48844575881958  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.48844575881958  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4885506629943848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4974675178527832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.498002529144287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.498002529144287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4980921745300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5063395500183105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5070619583129883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5070619583129883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5071706771850586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5179338455200195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.518542766571045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.518542766571045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5186305046081543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.527930736541748  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5282716751098633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5282716751098633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5283193588256836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.533707618713379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5343537330627441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5343537330627441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5344319343566895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.543816089630127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5442790985107422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5442790985107422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5443344116210938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5513591766357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.55171537399292  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.55171537399292  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.551755428314209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5571227073669434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5576987266540527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5576987266540527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.55775785446167  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5660948753356934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5663886070251465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5663886070251465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5664191246032715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5709357261657715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5714282989501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5714282989501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5714740753173828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5785694122314453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5787677764892578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5787677764892578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.578786849975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5818767547607422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5822134017944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5822134017944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5822420120239258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5870771408081055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([280, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5937910079956055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5937910079956055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.594325065612793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6913509368896484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6720356941223145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.672459602355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6728835105895996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.672438144683838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20958
output nodes number: 2842
edges number: 22739
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6726160049438477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6726164817810059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04336404800415039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 4 input nodes size: 70503
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.03937864303588867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.03937864303588867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.0729970932006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.07301855087280273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.03961753845214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04104423522949219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04104423522949219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04104423522949219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70503, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04104423522949219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([769, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.12352323532104492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.12352323532104492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.12425661087036133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.13070058822631836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([1140, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.13142108917236328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.13142108917236328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.1325082778930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.14881610870361328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1152, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.14992046356201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.14992046356201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.15101909637451172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17527484893798828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1124, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17686939239501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17686939239501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17794132232666016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.20926380157470703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1086, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2113170623779297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2113170623779297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.21235275268554688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2506074905395508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([942, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.25278472900390625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.25278472900390625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.25368309020996094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2925853729248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([947, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.29529714584350586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.29529714584350586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2962002754211426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.34147071838378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([897, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.34444093704223633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.34444093704223633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.34529638290405273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.39528894424438477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([793, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.39826440811157227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.39826440811157227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3990206718444824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.44747304916381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([12487, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.5066375732421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.5066375732421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12487, 128]), torch.Size([1, 12487, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.5185461044311523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3640518188476562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12487, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.287808895111084  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3081574440002441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3285059928894043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3079981803894043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21337, 256])
first layer input nodes number: 70503
first layer output nodes number: 21337
edges number: 167895
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.329033374786377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.349381923675537  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3544692993164062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3544692993164062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([392, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3775115013122559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3775115013122559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3782591819763184  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3844752311706543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.384878158569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.384878158569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3856487274169922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3974018096923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3977837562561035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3977837562561035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3982911109924316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4139366149902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4146251678466797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4146251678466797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4150924682617188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4286441802978516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4293527603149414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4293527603149414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4297266006469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4431848526000977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.443943977355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.443943977355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4442567825317383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.457707405090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4583520889282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4583520889282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4585790634155273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4699277877807617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4706063270568848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4706063270568848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4708027839660645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4820008277893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4826035499572754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4826035499572754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4827580451965332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4926457405090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4933762550354004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4933762550354004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4935364723205566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5049118995666504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5054874420166016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5054874420166016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.505605697631836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5148296356201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5155549049377441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5155549049377441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5156846046447754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5267090797424316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5272440910339355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5272440910339355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5273356437683105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5357584953308105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.536264419555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.536264419555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5363426208496094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5440845489501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5445504188537598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5445504188537598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5446171760559082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5516934394836426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5522446632385254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5522446632385254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5523171424865723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5605072975158691  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5608959197998047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5608959197998047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5609455108642578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5668964385986328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5673909187316895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5673909187316895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5674481391906738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5747151374816895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5753259658813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5753259658813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.575392723083496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5843381881713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5848050117492676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5848050117492676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5848546028137207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5918469429016113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.59226655960083  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.59226655960083  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.592308521270752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5985188484191895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5988364219665527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5988364219665527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5988669395446777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6035971641540527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6039137840270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6039137840270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6039423942565918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6085772514343262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6091399192810059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6091399192810059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6091876029968262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.617246150970459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6244549751281738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6244549751281738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6250290870666504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.7388200759887695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.7188076972961426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.7192316055297852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.7196555137634277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.719210147857666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21337
output nodes number: 2842
edges number: 23448
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.719390869140625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.7193913459777832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.043682098388671875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 5 input nodes size: 71393
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.03961753845214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.03961753845214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.07366037368774414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.07368183135986328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.04004192352294922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.041474342346191406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.041474342346191406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.041474342346191406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([71393, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.041474342346191406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([817, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.12431907653808594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.12431907653808594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.12509822845458984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.13140869140625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([1072, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.13204145431518555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.13204145431518555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.13306379318237305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.14839887619018555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([1116, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.14948415756225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.14948415756225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.15054845809936523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17433691024780273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1152, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17600202560424805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17600202560424805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.17710065841674805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.20896100997924805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1060, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2109389305114746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2109389305114746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.21194982528686523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.24834203720092773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([956, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.25057172775268555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.25057172775268555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2514834403991699  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2909674644470215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([915, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2935657501220703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.2935657501220703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.29443836212158203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3390164375305176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([845, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.34180355072021484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.34180355072021484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3426094055175781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3887338638305664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([816, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3918328285217285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.3918328285217285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.392611026763916  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.4434037208557129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([12614, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.5035614967346191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.5035614967346191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12614, 128]), torch.Size([1, 12614, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 0.5155911445617676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3696961402893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.2930679321289062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.313441276550293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3338146209716797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3132820129394531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21363, 256])
first layer input nodes number: 71393
first layer output nodes number: 21363
edges number: 168602
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3343486785888672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.354722023010254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3598155975341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3598155975341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([400, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3828544616699219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3828544616699219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3836174011230469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3906078338623047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3909187316894531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3909187316894531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.3916053771972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4024295806884766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4029254913330078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4029254913330078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4034805297851562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4176483154296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4183282852172852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4183282852172852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4188032150268555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4325761795043945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4332327842712402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4332327842712402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4335875511169434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4463591575622559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4471564292907715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4471564292907715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4474787712097168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4613394737243652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4619860649108887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4619860649108887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4622149467468262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4736590385437012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4743828773498535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4743828773498535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.47459077835083  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4864411354064941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4871678352355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4871678352355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4873509407043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4990696907043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4997472763061523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4997472763061523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4998998641967773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5107336044311523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.51133394241333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.51133394241333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.51145601272583  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.52097749710083  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5215048789978027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5215048789978027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5216021537780762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5298705101013184  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5303845405578613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5303845405578613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.530470371246338  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5383667945861816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5388894081115723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5388894081115723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5389695167541504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5469002723693848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5474371910095215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5474371910095215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.547513484954834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.555600643157959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5561623573303223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5561623573303223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.556236743927002  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5646424293518066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5651936531066895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5651936531066895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5652623176574707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5735020637512207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5740389823913574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5740389823913574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5741019248962402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5820956230163574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.582648754119873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.582648754119873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.582709789276123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.590888500213623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.591569423675537  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.591569423675537  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5916399955749512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.601590633392334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6019997596740723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6019997596740723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6020417213439941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6082520484924316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6086540222167969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6086540222167969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6086921691894531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6146049499511719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6150946617126465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6150946617126465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6151385307312012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6222453117370605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6226158142089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6226158142089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6226482391357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6281280517578125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6348638534545898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6348638534545898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.6353998184204102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.738032341003418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.7180500030517578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.7184739112854004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1815185546875 GB
    Memory Allocated: 1.718897819519043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1815185546875 GB
    Memory Allocated: 1.7184524536132812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21363
output nodes number: 2842
edges number: 23440
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1815185546875 GB
    Memory Allocated: 1.7186331748962402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1815185546875 GB
    Memory Allocated: 1.7186336517333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.044124603271484375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 6 input nodes size: 71271
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04004192352294922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04004192352294922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.07402658462524414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.07404804229736328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.03998374938964844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04144573211669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04144573211669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04144573211669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([71271, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04144573211669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([837, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1259913444519043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1259913444519043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.12678956985473633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.13351774215698242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([1044, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.13429021835327148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.13429021835327148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1352858543395996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.15022039413452148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1137, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.15134906768798828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.15134906768798828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1524333953857422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.17688417434692383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1053, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.17852401733398438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.17852401733398438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.17952823638916016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.2086505889892578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([1072, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.21070432662963867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.21070432662963867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.21172666549682617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.24925756454467773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([1050, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.25175046920776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.25175046920776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.25275182723999023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.29627370834350586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([919, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.2988405227661133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.2988405227661133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.2997169494628906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3439764976501465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([905, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.34699058532714844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.34699058532714844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3478536605834961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3980560302734375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([849, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.40126800537109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.40126800537109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.40207767486572266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.45466089248657227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([12854, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.5155487060546875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.5155487060546875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12854, 128]), torch.Size([1, 12854, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.5278072357177734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4243698120117188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12854, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3461389541625977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3668527603149414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3875665664672852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3666906356811523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21720, 256])
first layer input nodes number: 71271
first layer output nodes number: 21720
edges number: 172062
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3880996704101562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4088134765625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4144668579101562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4144668579101562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4381122589111328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4381122589111328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4389171600341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4453563690185547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([347, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4456210136413574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4456210136413574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4462828636169434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4568991661071777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4574189186096191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4574189186096191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4579815864562988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4705548286437988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([195, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4710235595703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4710235595703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.471395492553711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4821815490722656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.482865810394287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.482865810394287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4832110404968262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4956393241882324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4964241981506348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4964241981506348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4967408180236816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5103554725646973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5110583305358887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5110583305358887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5113024711608887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5235095024108887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5242104530334473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5242104530334473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5244145393371582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5360474586486816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.536776065826416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.536776065826416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.536959171295166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.548677921295166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5495667457580566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5495667457580566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5497612953186035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5635743141174316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5641117095947266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5641117095947266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5642261505126953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5731525421142578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5738911628723145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5738911628723145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5740227699279785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5852093696594238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5856809616088867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5856809616088867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5857629776000977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.593308448791504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5938329696655273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5938329696655273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5939130783081055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6018438339233398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.602308750152588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.602308750152588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6023755073547363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6094517707824707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6099720001220703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6099720001220703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6100406646728516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6177997589111328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.618239402770996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.618239402770996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6182947158813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6249322891235352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.625441074371338  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.625441074371338  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.625500202178955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.633009433746338  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6335277557373047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6335277557373047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.633584976196289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6412525177001953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6417045593261719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6417045593261719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6417522430419922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6484756469726562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6488757133483887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6488757133483887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6489157676696777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.654843807220459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6552257537841797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6552257537841797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6552619934082031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.660879135131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6612811088562012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6612811088562012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6613173484802246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6671881675720215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6677007675170898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6677007675170898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6677446365356445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6751585006713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([321, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6828498840332031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6828498840332031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.683462142944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7932519912719727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 321, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7726497650146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.773073673248291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7734975814819336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7730522155761719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21720
output nodes number: 2842
edges number: 24048
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.77323579788208  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7732362747192383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.044137001037597656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 7 input nodes size: 70908
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.03998374938964844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.03998374938964844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.07379531860351562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.07381677627563477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.0398106575012207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04123735427856445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04123735427856445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04123735427856445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70908, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.04123735427856445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([806, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1237030029296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1237030029296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.12447166442871094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.13108301162719727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([1002, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1316542625427246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1316542625427246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1002, 128]), torch.Size([1, 1002, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.13260984420776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1469435691833496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1002, 128])
m.shape torch.Size([1130, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.14808225631713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.14808225631713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.14915990829467773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.1728682518005371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([1097, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.17461824417114258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.17461824417114258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.17566442489624023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.20670366287231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1091, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.20878171920776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.20878171920776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.2098221778869629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.24833011627197266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([988, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.25063657760620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.25063657760620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.25157880783081055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.29278135299682617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([914, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.2953610420227051  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.2953610420227051  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.2962327003479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3408198356628418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([847, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3436150550842285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3436150550842285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3444228172302246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3906102180480957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([806, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3936653137207031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.3936653137207031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.39443397521972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.4439363479614258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([12544, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.5040988922119141  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.5040988922119141  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12544, 128]), torch.Size([1, 12544, 128])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 0.5160617828369141  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.365427017211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12544, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.2891321182250977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3093738555908203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.329615592956543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3092155456542969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21225, 256])
first layer input nodes number: 70908
first layer output nodes number: 21225
edges number: 167839
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3301458358764648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3503875732421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3554482460021973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3554482460021973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([409, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3785014152526855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3785014152526855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3792815208435059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3856024742126465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([344, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.385873794555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.385873794555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3865299224853516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.3972229957580566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([272, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.397679328918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.397679328918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.398198127746582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4128284454345703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4134917259216309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4134917259216309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4139494895935059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4272246360778809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4284687042236328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4284687042236328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4288806915283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4437122344970703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4443717002868652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4443717002868652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.444657802581787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4569602012634277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4576516151428223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4576516151428223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.457888126373291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4697136878967285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4705567359924316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4705567359924316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4707951545715332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4843850135803223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4850444793701172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4850444793701172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4852161407470703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4962024688720703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4968762397766113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4968762397766113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.4970269203186035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5077252388000488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5084114074707031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5084114074707031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5085487365722656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5192604064941406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5197224617004395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5197224617004395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5198101997375488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5272679328918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5279240608215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5279240608215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5280308723449707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5378575325012207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5384769439697266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5384769439697266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5385723114013672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.548013687133789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.548499584197998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.548499584197998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.548570156097412  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5560507774353027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5567078590393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5567078590393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5567936897277832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5664925575256348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5670380592346191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5670380592346191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5671067237854004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5753464698791504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5760045051574707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5760045051574707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5760807991027832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5857701301574707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5862255096435547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5862255096435547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5862770080566406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5931777954101562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5938634872436523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5938634872436523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.5939340591430664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6038846969604492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.604212760925293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.604212760925293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6042470932006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.609328269958496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.609713077545166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.609713077545166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6097493171691895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6153664588928223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6157684326171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6157684326171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.615804672241211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6216754913330078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6220498085021973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6220498085021973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.622082233428955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6275620460510254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([274, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6341300010681152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6341300010681152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.6346526145935059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.73862886428833  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 274, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7186474800109863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.719071388244629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7194952964782715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7190499305725098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21225
output nodes number: 2842
edges number: 23444
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7192296981811523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.7192301750183105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04387521743774414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 8 input nodes size: 70498
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.0398106575012207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.0398106575012207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07342672348022461  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07344818115234375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03961515426635742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04102754592895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04102754592895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04102754592895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70498, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04102754592895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12278223037719727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12278223037719727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12355661392211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12975168228149414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([1089, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13051319122314453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13051319122314453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13155174255371094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14713001251220703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1130, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14822721481323242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14822721481323242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14930486679077148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17321252822875977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([1036, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17496252059936523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17496252059936523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1759505271911621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20460271835327148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([1029, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20656204223632812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20656204223632812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20754337310791016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24287128448486328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([980, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24518442153930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24518442153930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24611902236938477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.28714609146118164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([928, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2897763252258301  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2897763252258301  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2906613349914551  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.33547449111938477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([878, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.338381290435791  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.338381290435791  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3392186164855957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3870244026184082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([814, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.39009904861450195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.39009904861450195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.39087533950805664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.4416041374206543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([12398, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5003342628479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5003342628479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12398, 128]), torch.Size([1, 12398, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5121579170227051  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.351637363433838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12398, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2760496139526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2961664199829102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3164796829223633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2962055206298828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21094, 256])
first layer input nodes number: 70498
first layer output nodes number: 21094
edges number: 166375
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.317007064819336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3371238708496094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3421530723571777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3421530723571777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([410, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3648438453674316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3648438453674316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3656258583068848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.372419834136963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([383, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.372765064239502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.372765064239502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3734955787658691  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.38594388961792  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3864927291870117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3864927291870117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3870973587036133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4044842720031738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4050354957580566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4050354957580566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.405458927154541  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.417738437652588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4184064865112305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4184064865112305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4187555313110352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.431321144104004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.432023525238037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.432023525238037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4323134422302246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.444779872894287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.445462703704834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.445462703704834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.44569730758667  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4574275016784668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4581561088562012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4581561088562012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4583659172058105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.470324993133545  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.470973014831543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.470973014831543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4711389541625977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4817590713500977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4824166297912598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4824166297912598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4825634956359863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4929909706115723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4936580657958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4936580657958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4937915802001953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5042057037353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.504831314086914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.504831314086914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5049457550048828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5146732330322266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5152158737182617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5152158737182617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5153074264526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5237302780151367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5242900848388672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5242900848388672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5243759155273438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5328731536865234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.533407211303711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.533407211303711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5334835052490234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5415706634521484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5421171188354492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5421171188354492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.542189598083496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.550379753112793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5509648323059082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5509648323059082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.551037311553955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.55973482131958  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5601487159729004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5601487159729004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5601983070373535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5664963722229004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5670194625854492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5670194625854492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5670766830444336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5747442245483398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5751385688781738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5751385688781738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5751805305480957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.58109712600708  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.58143949508667  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.58143949508667  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5814738273620605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.586555004119873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.586897373199463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.586897373199463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5869297981262207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5919556617736816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.592315673828125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.592315673828125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5923480987548828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5976009368896484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5978846549987793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5978846549987793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5979094505310059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.602099895477295  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([296, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6092000007629395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6092000007629395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.609764575958252  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7244553565979004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 296, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7048134803771973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7052373886108398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7056612968444824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7052159309387207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21094
output nodes number: 2842
edges number: 23067
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7053947448730469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.705395221710205  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.043642520904541016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 9 input nodes size: 70439
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03961515426635742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03961515426635742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07320308685302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07322454452514648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03958702087402344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04100990295410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04100990295410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04100990295410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70439, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04100990295410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([768, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1233210563659668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1233210563659668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1240534782409668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13057947158813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([1047, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1312117576599121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1312117576599121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13221025466918945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1471877098083496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([1074, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1482248306274414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1482248306274414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14924907684326172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17181873321533203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1073, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1733531951904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1733531951904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1743764877319336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20405197143554688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1100, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2061629295349121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2061629295349121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20721197128295898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24590444564819336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([993, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24822092056274414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24822092056274414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 993, 128]), torch.Size([1, 993, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24916791915893555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2904801368713379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 993, 128])
m.shape torch.Size([921, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.29308080673217773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.29308080673217773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2939591407775879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3385934829711914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([857, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.34142351150512695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.34142351150512695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3422408103942871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.388826847076416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([795, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3918299674987793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3918299674987793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.39258813858032227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.4413919448852539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([12527, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5015597343444824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5015597343444824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12527, 128]), torch.Size([1, 12527, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5135064125061035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3617205619812012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12527, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2855339050292969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.305708885192871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3258838653564453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3055510520935059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21155, 256])
first layer input nodes number: 70439
first layer output nodes number: 21155
edges number: 167562
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3264107704162598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.346585750579834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3516297340393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3516297340393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([385, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3744535446166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3744535446166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.375187873840332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.381148338317871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3814697265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3814697265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3821525573730469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3931846618652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3937287330627441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3937287330627441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3943142890930176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4096159934997559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4104280471801758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4104280471801758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4109296798706055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4310197830200195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.431619644165039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.431619644165039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4319572448730469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4441108703613281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4448766708374023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4448766708374023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.445185661315918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4584722518920898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4591116905212402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4591116905212402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.459336757659912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4705901145935059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4713621139526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4713621139526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4715814590454102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.484084129333496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4848051071166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4848051071166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4849882125854492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4967069625854492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4972882270812988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4972882270812988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4974217414855957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5069012641906738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5075960159301758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5075960159301758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5077333450317383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5184450149536133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5191493034362793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5191493034362793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5192770957946777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.530139446258545  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5308256149291992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5308256149291992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.530940055847168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.541468620300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5421113967895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5421113967895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.542210578918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5520296096801758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.552614688873291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.552614688873291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5526986122131348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5615944862365723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.562044620513916  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.562044620513916  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.562105655670166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.569002628326416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5695605278015137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5695605278015137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.569629192352295  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.577868938446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5783538818359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5783538818359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5784111022949219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5856781005859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5859966278076172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5859966278076172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5860328674316406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5908889770507812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.591313362121582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.591313362121582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5913572311401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5975427627563477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.597884178161621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.597884178161621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5979185104370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6029996871948242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6033635139465332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6033635139465332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6033978462219238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6087193489074707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.608945369720459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.608945369720459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.60896635055542  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6123652458190918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.612678050994873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.612678050994873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6127047538757324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6172175407409668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6242928504943848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6242928504943848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6248555183410645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7315998077392578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7118029594421387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7122268676757812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7126507759094238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.712205410003662  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21155
output nodes number: 2842
edges number: 23228
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7123847007751465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7123851776123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.043637752532958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 10 input nodes size: 70317
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03958702087402344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03958702087402344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07311677932739258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07313823699951172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.039528846740722656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04092216491699219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04092216491699219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04092216491699219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70317, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04092216491699219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([887, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12160348892211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12160348892211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12244939804077148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12961530685424805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([1082, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13081884384155273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13081884384155273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1082, 128]), torch.Size([1, 1082, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1318507194519043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14732885360717773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1082, 128])
m.shape torch.Size([1066, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14833784103393555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14833784103393555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1493544578552246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17172002792358398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1122, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17335176467895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17335176467895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1744217872619629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20572328567504883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1046, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20768213272094727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20768213272094727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2086796760559082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24523305892944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([957, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24747228622436523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24747228622436523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24838495254516602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.28789854049682617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([907, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2905454635620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2905454635620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2914104461669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3351612091064453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([874, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.33806276321411133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.33806276321411133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3388962745666504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.38697099685668945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([830, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.39011621475219727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.39011621475219727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.39090776443481445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.44210100173950195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([12158, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.4996790885925293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.4996790885925293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12158, 128]), torch.Size([1, 12158, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5112738609313965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3347506523132324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12158, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.260289192199707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2802486419677734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3008766174316406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2807607650756836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20929, 256])
first layer input nodes number: 70317
first layer output nodes number: 20929
edges number: 164100
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3014025688171387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.321362018585205  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3266453742980957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3266453742980957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([437, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3489985466003418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3489985466003418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3498320579528809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3579163551330566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3582091331481934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3582091331481934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3589129447937012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3726258277893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.373110294342041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.373110294342041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3736634254455566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3860268592834473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.386573314666748  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.386573314666748  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.38698148727417  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3988184928894043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3997173309326172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3997173309326172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.400115966796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4144668579101562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4151501655578613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4151501655578613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4154419898986816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.427990436553955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4286856651306152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4286856651306152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4289240837097168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.440845012664795  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4416484832763672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4416484832763672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4418773651123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4549236297607422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4555792808532715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4555792808532715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4557490348815918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4666132926940918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.467374324798584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.467374324798584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4675421714782715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.479459285736084  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4801158905029297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4801158905029297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4802494049072266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4906635284423828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.491323471069336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.491323471069336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4914436340332031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.501657485961914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5023598670959473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5023598670959473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5024762153625488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5131802558898926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.513620376586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.513620376586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5136909484863281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5206775665283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.521204948425293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.521204948425293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5212793350219727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5291643142700195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.529634952545166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.529634952545166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5296978950500488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5368103981018066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.537269115447998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.537269115447998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5373263359069824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5441927909851074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5445623397827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5445623397827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5446062088012695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5501775741577148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.550466537475586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.550466537475586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5504989624023438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5548439025878906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.555154800415039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.555154800415039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5551872253417969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5597591400146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.560126781463623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.560126781463623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5601630210876465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5655264854431152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5658469200134277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5658469200134277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5658774375915527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5706076622009277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5710349082946777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5710349082946777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.571073055267334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5772528648376465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5775799751281738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5775799751281738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.577608585357666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5824437141418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([288, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5893497467041016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5893497467041016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5898990631103516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6880803108215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 288, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.668806552886963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6692304611206055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.669654369354248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6692090034484863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20929
output nodes number: 2842
edges number: 22688
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.669386863708496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6693873405456543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04351091384887695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 11 input nodes size: 69861
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.039528846740722656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.039528846740722656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07284116744995117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07286262512207031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03931140899658203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.040701866149902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.040701866149902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.040701866149902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([69861, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.040701866149902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([836, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12116432189941406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12116432189941406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12196159362792969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12912559509277344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([1118, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1297931671142578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1297931671142578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.130859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1468524932861328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1135, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14794301986694336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14794301986694336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14902544021606445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.173126220703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1073, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17479753494262695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17479753494262695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17582082748413086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.20549631118774414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1089, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2075810432434082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2075810432434082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2086195945739746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2472543716430664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([952, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24945878982543945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.24945878982543945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2503666877746582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2896103858947754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([929, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.29225730895996094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.29225730895996094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.29314327239990234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3379645347595215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([902, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.34096240997314453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.34096240997314453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.34182262420654297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3920164108276367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3949723243713379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3949723243713379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3957247734069824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.44390010833740234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([12095, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.501197338104248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.501197338104248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12095, 128]), torch.Size([1, 12095, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5127320289611816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3320631980895996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12095, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2578163146972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2777652740478516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2977142333984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2776093482971191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20918, 256])
first layer input nodes number: 69861
first layer output nodes number: 20918
edges number: 163696
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2982368469238281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.318185806274414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3231730461120605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3231730461120605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3456683158874512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3456683158874512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3464789390563965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.354787826538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3551325798034668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3551325798034668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3558764457702637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3716444969177246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3721117973327637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3721117973327637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.372666835784912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3858084678649902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([209, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3863348960876465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3863348960876465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3867335319519043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3982939720153809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3989744186401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3989744186401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3993234634399414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4118890762329102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4125046730041504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4125046730041504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4127659797668457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4240021705627441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4246926307678223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4246926307678223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4249253273010254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4365601539611816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.437443733215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.437443733215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4376916885375977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4518251419067383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4526095390319824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4526095390319824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4528098106384277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4656271934509277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4662771224975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4662771224975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.466425895690918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4769887924194336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4776864051818848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4776864051818848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.47782564163208  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4886860847473145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4894585609436035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4894585609436035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4895977973937988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5014328956604004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5020508766174316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5020508766174316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5021557807922363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5118069648742676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5123872756958008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5123872756958008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.512476921081543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5213518142700195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5218982696533203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5218982696533203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5219764709472656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5302658081054688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5307960510253906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5307960510253906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5308666229248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5388412475585938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5392146110534668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5392146110534668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.539262294769287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5449843406677246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.545358657836914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.545358657836914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5454025268554688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.550973892211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5514087677001953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5514087677001953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5514564514160156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5578460693359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.558283805847168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.558283805847168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5583295822143555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.564784049987793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5652861595153809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5652861595153809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.565335750579834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5726752281188965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5730314254760742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5730314254760742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5730657577514648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5783872604370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.578657627105713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.578657627105713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5786824226379395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5826992988586426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5831255912780762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5831255912780762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5831618309020996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5892863273620605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([273, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5958280563354492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5958280563354492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.596348762512207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6969480514526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 273, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6775360107421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.67795991897583  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6783838272094727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.677938461303711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20918
output nodes number: 2842
edges number: 22845
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6781158447265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6781163215637207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.04328441619873047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 12 input nodes size: 70961
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03931140899658203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03931140899658203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07314825057983398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.07316970825195312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.03983592987060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.041275978088378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.041275978088378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.041275978088378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70961, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.041275978088378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12454795837402344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.12454795837402344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1253366470336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13164615631103516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([1093, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13247966766357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13247966766357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.13352203369140625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.14915752410888672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1164, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.15092706680297852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.15092706680297852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1520371437072754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17645883560180664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([1135, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1780686378479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.1780686378479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.17915105819702148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2105412483215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1073, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.21255826950073242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.21255826950073242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.21358156204223633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2505307197570801  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1066, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2530689239501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2530689239501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2540855407714844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.2979621887207031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([912, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.30049800872802734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.30049800872802734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.30136775970458984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.34548044204711914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([865, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3483452796936035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3483452796936035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3491702079772949  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.3971257209777832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([863, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.40041685104370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.40041685104370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.40123987197875977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.45391321182250977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([12558, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5140485763549805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5140485763549805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12558, 128]), torch.Size([1, 12558, 128])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 0.5260248184204102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.376338005065918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12558, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.2994155883789062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3199729919433594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3405303955078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.319812297821045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21556, 256])
first layer input nodes number: 70961
first layer output nodes number: 21556
edges number: 169457
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3410611152648926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3616185188293457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.366931438446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.366931438446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([399, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.390298843383789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.390298843383789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3910598754882812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.397282600402832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3976078033447266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3976078033447266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.3983078002929688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4090099334716797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([265, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4094243049621582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4094243049621582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4099297523498535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4238529205322266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4244961738586426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4244961738586426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.424940586090088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.437828540802002  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([172, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4384331703186035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4384331703186035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4387612342834473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4505715370178223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.451347827911377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.451347827911377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4516587257385254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4650273323059082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4657535552978516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4657535552978516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.46600341796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4784965515136719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.479163646697998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.479163646697998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4793601036071777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.49055814743042  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4913253784179688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.4913253784179688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.49151611328125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.50372314453125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.504493236541748  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.504493236541748  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5046648979187012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.516852855682373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5175285339355469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5175285339355469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5176658630371094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5283775329589844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5290932655334473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5290932655334473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5292229652404785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5402474403381348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5408449172973633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5408449172973633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5409460067749023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.550246238708496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5507879257202148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5507879257202148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5508718490600586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5591802597045898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5597872734069824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5597872734069824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.559873104095459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5689711570739746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5696048736572266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5696048736572266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5696887969970703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.579172134399414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5798821449279785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5798821449279785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.579969882965088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.590498447418213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5908527374267578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5908527374267578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5908966064453125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5964679718017578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5970125198364258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.5970125198364258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.597071647644043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.604994773864746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6054844856262207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6054844856262207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6055359840393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6127972602844238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6133570671081543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6133570671081543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6134123802185059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.621598720550537  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6220574378967285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6220574378967285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6221013069152832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6289010047912598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6291890144348145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6291890144348145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6292157173156738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6335415840148926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6338281631469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6338281631469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6338529586791992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6380434036254883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([287, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6449275016784668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.6449275016784668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.645474910736084  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7542366981506348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7339210510253906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7343449592590332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7347688674926758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.734323501586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21556
output nodes number: 2842
edges number: 23780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7345056533813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1873779296875 GB
    Memory Allocated: 1.7345061302185059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04393720626831055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 13 input nodes size: 71142
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03983592987060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03983592987060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07375907897949219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07378053665161133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.039922237396240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04134988784790039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04134988784790039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04134988784790039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([71142, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04134988784790039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([871, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12404489517211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12404489517211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12487554550170898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13166570663452148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([1020, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13222312927246094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13222312927246094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1331958770751953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14778709411621094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
m.shape torch.Size([1131, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14891862869262695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14891862869262695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14999723434448242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17448711395263672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1081, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17622137069702148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17622137069702148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17725229263305664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20812368392944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([1050, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2101116180419922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2101116180419922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21111297607421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.24799060821533203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([952, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.250213623046875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.250213623046875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.25112152099609375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2904396057128906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([913, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2930331230163574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2930331230163574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29390382766723633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3386259078979492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([858, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.341463565826416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.341463565826416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3422818183898926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.38892221450805664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([841, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3921222686767578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3921222686767578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.39292430877685547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.4445371627807617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([12583, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5046830177307129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5046830177307129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12583, 128]), torch.Size([1, 12583, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5166831016540527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3686890602111816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12583, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.2922172546386719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.312530517578125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3328437805175781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3123717308044434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21300, 256])
first layer input nodes number: 71142
first layer output nodes number: 21300
edges number: 168244
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3333759307861328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.353689193725586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3587675094604492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3587675094604492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3816156387329102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3816156387329102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3824472427368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3893232345581055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3895883560180664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3895883560180664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.390263557434082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4006147384643555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([302, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4011483192443848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4011483192443848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4017243385314941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4163169860839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4169096946716309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4169096946716309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.417346477508545  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4300131797790527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.430741786956787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.430741786956787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4311175346374512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4446444511413574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.445298671722412  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.445298671722412  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4455771446228027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4575514793395996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4582133293151855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4582133293151855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4584403038024902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4697890281677246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4703984260559082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4703984260559082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4705777168273926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.480797290802002  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4815125465393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4815125465393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4816899299621582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4930424690246582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4936943054199219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4936943054199219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4938411712646484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5042686462402344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5050201416015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5050201416015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5051689147949219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5167732238769531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.517322063446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.517322063446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5174250602722168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5261797904968262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5269279479980469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5269279479980469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5270500183105469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5382804870605469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5389060974121094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5389060974121094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5390033721923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5486335754394531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.549248218536377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.549248218536377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5493359565734863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.55863618850708  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5590229034423828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5590229034423828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5590763092041016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5651111602783203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5655746459960938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5655746459960938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5656318664550781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5724983215332031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5730061531066895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5730061531066895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5730652809143066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5805745124816895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5809288024902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5809288024902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5809688568115234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5863361358642578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5867586135864258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5867586135864258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5868024826049805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5929880142211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5932488441467285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5932488441467285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.593275547027588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5972275733947754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5975103378295898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5975103378295898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5975370407104492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6016759872436523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6021051406860352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6021051406860352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6021432876586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.608323097229004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6087427139282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6087427139282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.608778953552246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.614903450012207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([302, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6221418380737305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6221418380737305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6227178573608398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7338695526123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.714090347290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7145142555236816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7149381637573242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7144927978515625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21300
output nodes number: 2842
edges number: 23204
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7146730422973633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7146735191345215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.0439906120300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 14 input nodes size: 70107
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.039922237396240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.039922237396240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07335186004638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07337331771850586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.0394287109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.040828704833984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.040828704833984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.040828704833984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70107, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.040828704833984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12201976776123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12201976776123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12278461456298828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12927770614624023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([1018, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1298661231994629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1298661231994629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13083696365356445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1453995704650879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([1002, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1463475227355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1463475227355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1002, 128]), torch.Size([1, 1002, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14730310440063477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.16904020309448242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1002, 128])
m.shape torch.Size([1090, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17064142227172852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17064142227172852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17168092727661133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20264673233032227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1049, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20462799072265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20462799072265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2056283950805664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.24258852005004883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1049, 128])
m.shape torch.Size([983, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.24561309814453125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.24561309814453125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2465505599975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2876434326171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([896, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29016542434692383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29016542434692383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29101991653442383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3345952033996582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([870, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3383183479309082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3383183479309082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.33914804458618164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3864407539367676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([825, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.38956642150878906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.38956642150878906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3903532028198242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.441439151763916  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([12324, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.49981117248535156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.49981117248535156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12324, 128]), torch.Size([1, 12324, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5115642547607422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3460330963134766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12324, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.270914077758789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.290806770324707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.311568260192871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.291520118713379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20859, 256])
first layer input nodes number: 70107
first layer output nodes number: 20859
edges number: 165244
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3120927810668945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3319854736328125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.336958885192871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.336958885192871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.359175682067871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.359175682067871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3600282669067383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.367283821105957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([372, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3675727844238281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3675727844238281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3682823181152344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3813743591308594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.381812572479248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.381812572479248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3823370933532715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4001822471618652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4008469581604004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4008469581604004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4013066291809082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4146370887756348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([214, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.416299819946289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.416299819946289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.416707992553711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4314022064208984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4319939613342285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4319939613342285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4322571754455566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.443575382232666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4442377090454102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4442377090454102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.444462776184082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4557161331176758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4564032554626465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4564032554626465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.456601619720459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4679083824157715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4686570167541504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4686570167541504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.468843936920166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.480806827545166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4815211296081543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4815211296081543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4816813468933105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4930567741394043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.493642807006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.493642807006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4937629699707031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5031356811523438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5039176940917969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5039176940917969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5040569305419922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5158920288085938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.516397476196289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.516397476196289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5164852142333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.524557113647461  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5251998901367188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5251998901367188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5252971649169922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5349273681640625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.535383701324463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.535383701324463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5354504585266113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5425267219543457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5430779457092285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5430779457092285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5431504249572754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5513405799865723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5517945289611816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5517945289611816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.551851749420166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.558718204498291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5590877532958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5590877532958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5591316223144531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5647029876708984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5651745796203613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5651745796203613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5652260780334473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.572126865386963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5725626945495605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5725626945495605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.572608470916748  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5790629386901855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5795044898986816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5795044898986816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5795483589172363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.58604097366333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.586357593536377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.586357593536377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.586388111114502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.591118335723877  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5913686752319336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5913686752319336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5913915634155273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5950994491577148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5954113006591797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5954113006591797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.595438003540039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5999507904052734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([276, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6065692901611328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6065692901611328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.607095718383789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7204809188842773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 276, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7013635635375977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7017874717712402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7022113800048828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.701766014099121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20859
output nodes number: 2842
edges number: 22536
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7019429206848145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7019433975219727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04341888427734375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 15 input nodes size: 70394
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.0394287109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.0394287109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07299518585205078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07301664352416992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.0395655632019043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04097318649291992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04097318649291992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04097318649291992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70394, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04097318649291992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([815, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12236356735229492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12236356735229492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12314081192016602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12935876846313477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([1095, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13047456741333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13047456741333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13151884078979492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14718294143676758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1140, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14829158782958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14829158782958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14937877655029297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17338275909423828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1136, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17500591278076172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17500591278076172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17608928680419922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20753765106201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1130, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20969009399414062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20969009399414062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2107677459716797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2496967315673828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([972, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2519388198852539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2519388198852539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 972, 128]), torch.Size([1, 972, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2528657913208008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29300785064697266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 972, 128])
m.shape torch.Size([928, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2956418991088867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2956418991088867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2965269088745117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3411741256713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([877, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34407711029052734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34407711029052734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3449134826660156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.39345741271972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([866, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3967556953430176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3967556953430176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3975815773010254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.451261043548584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([12186, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5089554786682129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5089554786682129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12186, 128]), torch.Size([1, 12186, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5205769538879395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3458962440490723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12186, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.2707953453063965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.2909607887268066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3111262321472168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.2908029556274414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21145, 256])
first layer input nodes number: 70394
first layer output nodes number: 21145
edges number: 165617
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.311652660369873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3318181037902832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3376288414001465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3376288414001465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([390, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3604302406311035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3604302406311035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3611741065979004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3689589500427246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([364, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3692870140075684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3692870140075684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.369981288909912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3848042488098145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([302, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3853282928466797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3853282928466797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.385904312133789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.398996353149414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3996429443359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3996429443359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.400106430053711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4135475158691406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4142961502075195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4142961502075195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4146852493286133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4286928176879883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4294095039367676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4294095039367676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.429710865020752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.44266939163208  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4433398246765137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4433398246765137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4435725212097168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.455207347869873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.455944538116455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.455944538116455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4561562538146973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.468224048614502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4689140319824219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4689140319824219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4690895080566406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4803199768066406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4810781478881836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4810781478881836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.481245994567871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4931631088256836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.49375581741333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.49375581741333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.49387788772583  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.50339937210083  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5039958953857422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5039958953857422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5041046142578125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.513345718383789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5139164924621582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5139164924621582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5140118598937988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5227856636047363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.523451328277588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.523451328277588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.523552417755127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5335602760314941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5341010093688965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5341010093688965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5341792106628418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.542468547821045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.542891025543213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.542891025543213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5429482460021973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5494141578674316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5498270988464355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5498270988464355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5498785972595215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.556058406829834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5565519332885742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5565519332885742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5566091537475586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5638761520385742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.564267635345459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.564267635345459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5643115043640137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5701899528503418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5706486701965332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5706486701965332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5706963539123535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5774197578430176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5779008865356445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5779008865356445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5779485702514648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.585005760192871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5854263305664062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5854263305664062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5854663848876953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5916748046875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5921635627746582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5921635627746582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.592207431793213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5993142127990723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5996155738830566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5996155738830566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.599642276763916  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6041550636291504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6110100746154785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6110100746154785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.61155366897583  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7085556983947754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.688795566558838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6892194747924805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.689643383026123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6891980171203613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21145
output nodes number: 2842
edges number: 23202
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6893773078918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.689377784729004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04358530044555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 16 input nodes size: 70567
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.0395655632019043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.0395655632019043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07321453094482422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07323598861694336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03964805603027344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04106426239013672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04106426239013672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04106426239013672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70567, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04106426239013672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([816, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12291145324707031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12291145324707031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12368965148925781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1299152374267578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([1018, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13049697875976562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13049697875976562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1314678192138672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14603042602539062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([1204, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14726734161376953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14726734161376953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14841556549072266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17442607879638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1191, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17612361907958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17612361907958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1191, 128]), torch.Size([1, 1191, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1772594451904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21019840240478516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1191, 128])
m.shape torch.Size([1044, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21211957931518555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21211957931518555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21311521530151367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.24895811080932617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1035, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2514214515686035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2514214515686035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.252408504486084  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.295560359954834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([901, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29807424545288086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29807424545288086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2989335060119629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34256982803344727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([876, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34548187255859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34548187255859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3463172912597656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3948326110839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([821, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3989086151123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3989086151123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3996915817260742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.4513254165649414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([12319, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5096755027770996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5096755027770996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12319, 128]), torch.Size([1, 12319, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5214238166809082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3555541038513184  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12319, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.279980182647705  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3002219200134277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3204636573791504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3000636100769043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21225, 256])
first layer input nodes number: 70567
first layer output nodes number: 21225
edges number: 166552
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3209915161132812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.341233253479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3471074104309082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3471074104309082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3700637817382812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3700637817382812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3708362579345703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.377974510192871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([346, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.37825345993042  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.37825345993042  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.378913402557373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3909382820129395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3915109634399414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3915109634399414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3921079635620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4115419387817383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4121894836425781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4121894836425781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.41265869140625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4262657165527344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4268817901611328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4268817901611328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4272193908691406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4393730163574219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4401211738586426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4401211738586426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4404244422912598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4534649848937988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4542489051818848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4542489051818848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4545140266418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4677700996398926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4683914184570312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4683914184570312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4685783386230469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4792327880859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4800477027893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4800477027893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.480247974395752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.493065357208252  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4936766624450684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4936766624450684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4938178062438965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5038390159606934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5045194625854492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5045194625854492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.504654884338379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5152177810668945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5157155990600586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5157155990600586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5158090591430664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5237531661987305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5243563652038574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5243563652038574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5244555473327637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5335803031921387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.534217357635498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.534217357635498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5343146324157715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5439448356628418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5445308685302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5445308685302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5446147918701172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5535106658935547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.553945541381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.553945541381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5540046691894531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5606861114501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5610814094543457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5610814094543457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5611310005187988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5670819282531738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5675592422485352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5675592422485352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5676145553588867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5746393203735352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5750865936279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5750865936279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5751361846923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5817813873291016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5821990966796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5821990966796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5822429656982422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5884284973144531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5890326499938965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5890326499938965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5890917778015137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5978426933288574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.598236083984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.598236083984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5982742309570312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.60418701171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6046323776245117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6046323776245117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6046724319458008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.611161231994629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6113953590393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6113953590393066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6114163398742676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.614962100982666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6227898597717285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6227898597717285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6233525276184082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7410907745361328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7211813926696777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7216053009033203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.722029209136963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7215838432312012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21225
output nodes number: 2842
edges number: 23347
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7217636108398438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.721764087677002  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.043688297271728516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 17 input nodes size: 72000
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03964805603027344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03964805603027344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07398033142089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07400178909301758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.040331363677978516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.041803836822509766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.041803836822509766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.041803836822509766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([72000, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.041803836822509766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([842, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12713861465454102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12713861465454102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12794160842895508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13436555862426758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([1032, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1351327896118164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1351327896118164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13611698150634766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1508798599243164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([1119, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.15198850631713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.15198850631713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.15305566787719727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17685556411743164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1092, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1784048080444336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1784048080444336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17944622039794922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2104330062866211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1111, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21256113052368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21256113052368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21362066268920898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.25229835510253906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([962, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.25452089309692383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.25452089309692383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.25543832778930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2948880195617676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([948, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2975935935974121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2975935935974121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29849767684936523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34374189376831055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([919, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34679555892944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34679555892944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3476719856262207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3979067802429199  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([759, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.4007258415222168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.4007258415222168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.40144968032836914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.44937610626220703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 759, 128])
m.shape torch.Size([13090, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5115141868591309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5115141868591309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13090, 128]), torch.Size([1, 13090, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5239977836608887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4294829368591309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13090, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3496341705322266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3704948425292969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3913555145263672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3703317642211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21874, 256])
first layer input nodes number: 72000
first layer output nodes number: 21874
edges number: 173677
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3918938636779785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4127545356750488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4181084632873535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4181084632873535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([438, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.441596508026123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.441596508026123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.442431926727295  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4493803977966309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4496417045593262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4496417045593262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.450314998626709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4611115455627441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.461585521697998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.461585521697998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4621214866638184  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4742536544799805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([207, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4747815132141113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4747815132141113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4751763343811035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.486626148223877  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4873323440551758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4873323440551758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4876909255981445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5005998611450195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5012798309326172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5012798309326172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5015640258789062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.513784408569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5144095420837402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5144095420837402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5146269798278809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.525498867034912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5263128280639648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5263128280639648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5265417098999023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5395879745483398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5403127670288086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5403127670288086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5404977798461914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5523386001586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5531401634216309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5531401634216309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5533175468444824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5659117698669434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5665526390075684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5665526390075684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5666842460632324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5769495964050293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.577587604522705  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.577587604522705  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5777039527893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5875935554504395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5880727767944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5880727767944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5881547927856445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5957002639770508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5961709022521973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5961709022521973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5962433815002441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6034188270568848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6040029525756836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6040029525756836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6040849685668945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.612778663635254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6132912635803223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6132912635803223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6133599281311035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6211190223693848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6216239929199219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6216239929199219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6216869354248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6292400360107422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6297621726989746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6297621726989746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6298232078552246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6375746726989746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6379828453063965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6379828453063965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.638028621673584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.644162654876709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6445627212524414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6445627212524414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6446046829223633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6505212783813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6510658264160156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6510658264160156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6511192321777344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6590232849121094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6593141555786133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6593141555786133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6593427658081055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6637773513793945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6641168594360352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6641168594360352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6641473770141602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6690912246704102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6693992614746094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6693992614746094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6694259643554688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6739387512207031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([328, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.681807041168213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.681807041168213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6824326515197754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7943196296691895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 328, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7738823890686035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.774306297302246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7747302055358887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.774284839630127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21874
output nodes number: 2842
edges number: 23868
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7744693756103516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7744698524475098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04451274871826172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 18 input nodes size: 70545
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.040331363677978516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.040331363677978516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07396984100341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07399129867553711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03963756561279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04105377197265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04105377197265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04105377197265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70545, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04105377197265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([830, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12300252914428711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12300252914428711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1237940788269043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13106155395507812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([1104, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13218355178833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13218355178833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.13323640823364258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14902925491333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1142, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.15013647079467773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.15013647079467773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.15122556686401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1751856803894043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1140, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17681550979614258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17681550979614258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1779026985168457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20943117141723633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1015, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21130752563476562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21130752563476562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1015, 128]), torch.Size([1, 1015, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.21227550506591797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2480149269104004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1015, 128])
m.shape torch.Size([985, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2503490447998047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2503490447998047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 985, 128]), torch.Size([1, 985, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.25128841400146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29242515563964844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 985, 128])
m.shape torch.Size([929, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2950563430786133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2950563430786133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2959423065185547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34076356887817383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([921, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34383392333984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.34383392333984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3447122573852539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.39517784118652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([809, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3982105255126953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3982105255126953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.39898204803466797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.4484996795654297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([12359, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5070462226867676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5070462226867676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12359, 128]), torch.Size([1, 12359, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5188326835632324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3556714057922363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12359, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.2799887657165527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.300239086151123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3204894065856934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3000807762145996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21234, 256])
first layer input nodes number: 70545
first layer output nodes number: 21234
edges number: 166751
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3210172653198242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3412675857543945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.346330165863037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.346330165863037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([418, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3691515922546387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3691515922546387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3699488639831543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.376793384552002  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([365, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3770966529846191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3770966529846191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3777928352355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3907876014709473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3912787437438965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3912787437438965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.391833782196045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4104132652282715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4111123085021973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4111123085021973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4115967750549316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4256463050842285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4262981414794922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4262981414794922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4266529083251953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4394245147705078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4400086402893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4400086402893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.440260410308838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4510865211486816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.451775074005127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.451775074005127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4520058631896973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.463545322418213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4642605781555176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4642605781555176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4644665718078613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.476208209991455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([115, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.477128028869629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.477128028869629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4773473739624023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4913854598999023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4920639991760254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4920639991760254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.492220401763916  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5033249855041504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5040082931518555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5040082931518555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.504145622253418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.514857292175293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5155386924743652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5155386924743652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.515662670135498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.526200771331787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.526688575744629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.526688575744629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5267724990844727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5344934463500977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5349764823913574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5349764823913574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.535050868988037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5424151420593262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.542839527130127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.542839527130127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.542900562286377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.549370288848877  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.549816608428955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.549816608428955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5498757362365723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5565571784973145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5570344924926758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5570344924926758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.557093620300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5641889572143555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5647130012512207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5647130012512207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5647740364074707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5725255012512207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5730977058410645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5730977058410645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5731606483459473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5815949440002441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5820250511169434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5820250511169434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5820708274841309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5885252952575684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5889062881469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5889062881469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.588944435119629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.594590187072754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.594888687133789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.594888687133789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5949172973632812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5993518829345703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5997357368469238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5997357368469238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5997700691223145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6053318977355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6057991981506348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6057991981506348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6058392524719238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.6126084327697754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([293, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.61962890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.61962890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.620187759399414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7350244522094727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7158336639404297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7162575721740723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7166814804077148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7162361145019531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21234
output nodes number: 2842
edges number: 23194
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.7164158821105957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.716416358947754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04367685317993164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 19 input nodes size: 69161
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03963756561279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03963756561279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.0726161003112793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.07263755798339844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.038977622985839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04034900665283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04034900665283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04034900665283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([69161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04034900665283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([839, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.11967658996582031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.11967658996582031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12047672271728516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12716341018676758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([1098, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12781047821044922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12781047821044922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.12885761260986328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14456462860107422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1131, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1456589698791504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.1456589698791504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.14673757553100586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17046689987182617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1067, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17207098007202148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17207098007202148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.17308855056762695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2028365135192871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([1095, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20493841171264648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20493841171264648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.20598268508911133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.2446298599243164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.24694585800170898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.24694585800170898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.24789190292358398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.289182186126709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([898, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29170656204223633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29170656204223633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 898, 128]), torch.Size([1, 898, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.29256296157836914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3360733985900879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 898, 128])
m.shape torch.Size([856, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3389105796813965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3389105796813965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.33972692489624023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.386258602142334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([772, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3891634941101074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.3891634941101074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.38989973068237305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.43830251693725586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([11916, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.4947543144226074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.4947543144226074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 11916, 128]), torch.Size([1, 11916, 128])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.5061182975769043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3136706352233887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 11916, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.2405023574829102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.260209083557129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.2799158096313477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.2600550651550293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20664, 256])
first layer input nodes number: 69161
first layer output nodes number: 20664
edges number: 161365
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.280433177947998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3001399040222168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3051543235778809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3051543235778809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([443, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.327371597290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.327371597290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.328216552734375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.337362289428711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([366, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3376436233520508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3376436233520508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3383417129516602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3488130569458008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3492889404296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3492889404296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3498344421386719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3632993698120117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3638458251953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3638458251953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3642520904541016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3760337829589844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3769283294677734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3769283294677734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3773574829101562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3928070068359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3934459686279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.3934459686279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.393728256225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4058666229248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4065866470336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4065866470336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4068307876586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4190378189086914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4196772575378418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4196772575378418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4198660850524902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4306292533874512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4314866065979004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4314866065979004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4316964149475098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4451241493225098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4456634521484375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4456634521484375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.445791244506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.454864501953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4555301666259766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4555301666259766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4556617736816406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4659271240234375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.466611385345459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.466611385345459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4667353630065918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4772734642028809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.477849006652832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.477849006652832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4779462814331055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4868955612182617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.48750638961792  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.48750638961792  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4875998497009277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4968523979187012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4975123405456543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4975123405456543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.497605800628662  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5075125694274902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5080194473266602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5080194473266602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5080881118774414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5158472061157227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5161724090576172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5161724090576172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.516214370727539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.521249771118164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5217480659484863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5217480659484863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5218052864074707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5290722846984863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5295186042785645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5295186042785645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5295681953430176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5362133979797363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5366501808166504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5366501808166504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.536695957183838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5431504249572754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5435919761657715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5435919761657715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5436358451843262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.55012845993042  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5503182411193848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5503182411193848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.550337314605713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5532937049865723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.553748607635498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.553748607635498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.553788661956787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5602774620056152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.560903549194336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.560903549194336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5609569549560547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5699825286865234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([254, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.576059341430664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.576059341430664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.5765438079833984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2459716796875 GB
    Memory Allocated: 1.6618099212646484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 254, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2459716796875 GB
    Memory Allocated: 1.6427092552185059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2459716796875 GB
    Memory Allocated: 1.6431331634521484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.643557071685791  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6431117057800293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20664
output nodes number: 2842
edges number: 22541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.643287181854248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6432876586914062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04289960861206055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 20 input nodes size: 71084
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.038977622985839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.038977622985839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07287311553955078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07289457321166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03989458084106445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04132890701293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04132890701293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04132890701293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([71084, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04132890701293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([805, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12437820434570312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12437820434570312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12514591217041016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1312875747680664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([1090, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13216447830200195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13216447830200195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13320398330688477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14879655838012695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1102, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1507277488708496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1507277488708496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1517786979675293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17551374435424805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([1146, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17717409133911133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17717409133911133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1146, 128]), torch.Size([1, 1146, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1782670021057129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2099614143371582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1146, 128])
m.shape torch.Size([1084, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21199941635131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21199941635131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21303319931030273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2511725425720215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([998, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2535109519958496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2535109519958496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25446271896362305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2968173027038574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([920, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29941225051879883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29941225051879883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3002896308898926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34473657608032227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([843, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34751367568969727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34751367568969727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34831762313842773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3943791389465332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([798, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3974018096923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3974018096923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.398162841796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44723987579345703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([12638, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5074062347412109  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5074062347412109  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12638, 128]), torch.Size([1, 12638, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5194587707519531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3751888275146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12638, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2983722686767578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3188037872314453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3392353057861328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3186440467834473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21424, 256])
first layer input nodes number: 71084
first layer output nodes number: 21424
edges number: 169029
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3397669792175293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3601984977722168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3653063774108887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3653063774108887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([385, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3882932662963867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3882932662963867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3890275955200195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.394902229309082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([409, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3953213691711426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3953213691711426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.396101474761963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4078030586242676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.408226490020752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.408226490020752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.408764362335205  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4224514961242676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.423086166381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.423086166381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235343933105469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.436532974243164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4376025199890137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4376025199890137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4379973411560059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4522109031677246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4529190063476562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4529190063476562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4532184600830078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466094970703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466712474822998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466712474822998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4669299125671387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.47780179977417  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4784469604492188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4784469604492188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4786338806152344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.489288330078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.489973545074463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.489973545074463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490145206451416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.501131534576416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5017762184143066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5017762184143066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019211769104004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5122132301330566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5129656791687012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5129656791687012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5131144523620605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5247187614440918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5252327919006348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5252327919006348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5253300666809082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5335984230041504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5341248512268066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5341248512268066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.534212589263916  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5422844886779785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542832851409912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542832851409912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5429167747497559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551225185394287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5517024993896484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5517024993896484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5517711639404297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5590496063232422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5594921112060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5594921112060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5595512390136719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566232681274414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5667262077331543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5667262077331543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5667872428894043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5741114616394043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5745654106140137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5745654106140137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5746188163757324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5814013481140137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5819225311279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5819225311279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581979751586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5896472930908203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590195655822754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590195655822754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5902528762817383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5983209609985352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5989184379577637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5989184379577637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5989775657653809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6077284812927246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6082067489624023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6082067489624023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6082525253295898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6153478622436523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6155905723571777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6155905723571777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6156134605407715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.619321346282959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6196098327636719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6196098327636719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6196346282958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6238250732421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([303, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6310935020446777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6310935020446777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.63167142868042  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.739656925201416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 303, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7196903228759766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7201142311096191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7205381393432617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7200927734375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21424
output nodes number: 2842
edges number: 23398
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7202739715576172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7202744483947754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.043979644775390625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 21 input nodes size: 70453
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03989458084106445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03989458084106445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07348918914794922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07351064682006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03959369659423828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.041014671325683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.041014671325683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.041014671325683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70453, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.041014671325683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([857, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.123260498046875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.123260498046875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12407779693603516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1312255859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([1105, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13187074661254883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13187074661254883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13292455673217773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14873170852661133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1093, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14976835250854492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14976835250854492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15081071853637695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17451143264770508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1093, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17607498168945312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17607498168945312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17711734771728516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2081146240234375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1069, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2101421356201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2101421356201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21116161346435547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2483506202697754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([984, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2506561279296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2506561279296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25159454345703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2927093505859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([900, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2952442169189453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2952442169189453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29610252380371094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.340423583984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([844, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3432140350341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3432140350341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34401893615722656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39011192321777344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([823, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39324140548706055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39324140548706055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3940262794494629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44501399993896484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([12490, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.504178524017334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.504178524017334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12490, 128]), torch.Size([1, 12490, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.516089916229248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3617987632751465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12490, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2857871055603027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3060603141784668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3263335227966309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3059015274047852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21258, 256])
first layer input nodes number: 70453
first layer output nodes number: 21258
edges number: 167326
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3268604278564453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3471336364746094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3522019386291504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3522019386291504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([458, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3751096725463867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3751096725463867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3759832382202148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.383488655090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3837594985961914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3837594985961914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3844614028930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395909309387207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3963689804077148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3963689804077148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3969049453735352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.412581443786621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413194179534912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413194179534912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4136309623718262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.426297664642334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4269156455993652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4269156455993652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4272475242614746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.439195156097412  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.439894676208496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.439894676208496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.440180778503418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4524831771850586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4531140327453613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4531140327453613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4533333778381348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4643006324768066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4650444984436035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4650444984436035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4652562141418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4773240089416504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4778757095336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4778757095336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4780206680297852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4872980117797852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4881772994995117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4881772994995117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4883661270141602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5017728805541992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5023446083068848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5023446083068848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502464771270752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118374824523926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5125155448913574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5125155448913574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126376152038574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5230135917663574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5235400199890137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5235400199890137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5236296653747559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.531877040863037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5322628021240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5322628021240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5323238372802734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5383663177490234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5389413833618164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5389413833618164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5390214920043945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5475130081176758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5479960441589355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5479960441589355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5480608940124512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5553889274597168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5561246871948242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5561246871948242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5562143325805664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566971778869629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5674290657043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5674290657043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5674843788146973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5745091438293457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5749750137329102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5749750137329102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575026512145996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5819272994995117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5823440551757812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5823440551757812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582387924194336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5885734558105469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588935375213623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588935375213623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5889716148376465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5943350791931152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5945711135864258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5945711135864258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5945940017700195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5981416702270508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5983734130859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5983734130859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5983943939208984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6017932891845703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6023364067077637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6023364067077637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6023821830749512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101183891296387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([307, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6174721717834473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6174721717834473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6180577278137207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.734097957611084  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 307, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.71427583694458  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7146997451782227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7151236534118652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7146782875061035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21258
output nodes number: 2842
edges number: 23245
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7148585319519043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7148590087890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04364347457885742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 22 input nodes size: 71076
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03959369659423828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03959369659423828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0734853744506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07350683212280273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03989076614379883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.041356563568115234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.041356563568115234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.041356563568115234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([71076, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.041356563568115234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([769, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12613487243652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12613487243652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12686824798583984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1329488754272461  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([1111, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13384675979614258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13384675979614258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13490629196166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15079927444458008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1166, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15193748474121094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15193748474121094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15304946899414062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17751312255859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1166, 128])
m.shape torch.Size([1094, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17917251586914062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17917251586914062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18021583557128906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21108627319335938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1080, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21313953399658203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21313953399658203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21416950225830078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2516183853149414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([962, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25385570526123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25385570526123047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2547731399536133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2942228317260742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([932, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2977638244628906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3425121307373047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([879, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34542083740234375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34542083740234375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34625911712646484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.394866943359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39783382415771484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39783382415771484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3985862731933594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44695425033569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([12991, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5090780258178711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5090780258178711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12991, 128]), torch.Size([1, 12991, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5214672088623047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.427046775817871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12991, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3475685119628906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.368332862854004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3890972137451172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3681702613830566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21773, 256])
first layer input nodes number: 71076
first layer output nodes number: 21773
edges number: 172604
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3896288871765137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.410393238067627  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4155845642089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4155845642089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([394, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.439197063446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.439197063446045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.439948558807373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4469122886657715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([377, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4472613334655762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4472613334655762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4479804039001465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4589037895202637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4594035148620605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4594035148620605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4599719047546387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4733057022094727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.473855972290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.473855972290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4742698669433594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4862728118896484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4869790077209473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4869790077209473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4873414039611816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5003876686096191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.501014232635498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.501014232635498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5012812614440918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512763500213623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5135588645935059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5135588645935059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513822078704834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5269827842712402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5277509689331055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5277509689331055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5279741287231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540694236755371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5413269996643066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5413269996643066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5414910316467285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5519890785217285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5525221824645996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5525221824645996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5526442527770996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5613112449645996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5619268417358398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5619268417358398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5620489120483398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5715703964233398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5722708702087402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5722708702087402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5723967552185059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.583096981048584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5836338996887207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5836338996887207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5837254524230957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921483039855957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5927486419677734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5927486419677734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5928401947021484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6019039154052734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.602463722229004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.602463722229004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.602543830871582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6110353469848633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6116876602172852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6116876602172852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6117734909057617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6214723587036133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.621838092803955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.621838092803955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6218857765197754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.627607822418213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.628103256225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.628103256225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6281604766845703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.635427474975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6357460021972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6357460021972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.635782241821289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6406383514404297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.641024112701416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.641024112701416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.641064167022705  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.646711826324463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6470956802368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6470956802368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6471338272094727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6527795791625977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6530780792236328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6530780792236328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.653106689453125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.657541275024414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6580357551574707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6580357551574707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6580796241760254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6651864051818848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6655569076538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6655569076538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6655893325805664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6710691452026367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([338, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6791749000549316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6791749000549316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6798195838928223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.795816421508789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 338, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7752041816711426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7756280899047852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7760519981384277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.775606632232666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21773
output nodes number: 2842
edges number: 24041
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7757906913757324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7757911682128906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0440521240234375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 23 input nodes size: 69638
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03989076614379883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03989076614379883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07309675216674805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07311820983886719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039205074310302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0405879020690918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0405879020690918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0405879020690918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([69638, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0405879020690918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([821, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12065649032592773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12065649032592773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12143945693969727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12770318984985352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([1092, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12853384017944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12853384017944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12957525253295898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14519643783569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1146, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1463150978088379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1463150978088379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1146, 128]), torch.Size([1, 1146, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14740800857543945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17145204544067383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1146, 128])
m.shape torch.Size([1114, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17303037643432617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17303037643432617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17409276962280273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20531034469604492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1047, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.207275390625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.207275390625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20827388763427734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24481534957885742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([968, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2470855712890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2470855712890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24800872802734375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2877044677734375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([911, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2902836799621582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2902836799621582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2911524772644043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33585643768310547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([899, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3388514518737793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3388514518737793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3397088050842285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3898940086364746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([780, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39281272888183594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39281272888183594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3935565948486328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44175243377685547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([12037, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4987773895263672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4987773895263672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12037, 128]), torch.Size([1, 12037, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5102567672729492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3257713317871094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12037, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.251882553100586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.271733283996582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2915840148925781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2715778350830078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20815, 256])
first layer input nodes number: 69638
first layer output nodes number: 20815
edges number: 162901
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2921051979064941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3119559288024902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3169188499450684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3169188499450684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3392057418823242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3392057418823242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3400259017944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3486027717590332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.348942756652832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.348942756652832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.349686622619629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3660306930541992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3665008544921875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3665008544921875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3670578002929688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.380126953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([236, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38075590133667  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38075590133667  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3812060356140137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3942599296569824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.394996166229248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.394996166229248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3953776359558105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4091105461120605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4098544120788574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4098544120788574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.410163402557373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.423449993133545  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4239683151245117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4239683151245117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.424159049987793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4336957931518555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4344463348388672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4344463348388672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4346561431884766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.446615219116211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4472546577453613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4472546577453613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4474186897277832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4579167366027832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4587674140930176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4587674140930176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4589524269104004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.47208833694458  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4727997779846191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4727997779846191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.472944736480713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4842514991760254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4847097396850586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4847097396850586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.484797477722168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4922552108764648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4929614067077637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4929614067077637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4930758476257324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5036044120788574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.503951072692871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.503951072692871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5040082931518555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5096731185913086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5101203918457031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5101203918457031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.510183334350586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516855239868164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5173158645629883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5173158645629883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5173768997192383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5242738723754883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5246028900146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5246028900146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5246448516845703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5296802520751953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5301265716552734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5301265716552734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5301780700683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5367183685302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5371675491333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5371675491333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.537217140197754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5438623428344727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5443377494812012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5443377494812012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5443873405456543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551379680633545  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5518193244934082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5518193244934082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551863193511963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5583558082580566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5587358474731445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5587358474731445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.558772087097168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5643892288208008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5646367073059082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5646367073059082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564659595489502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5683674812316895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.568863868713379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.568863868713379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5689058303833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5759973526000977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58282470703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58282470703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5833683013916016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6875505447387695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6683382987976074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.66876220703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6691861152648926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6687407493591309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20815
output nodes number: 2842
edges number: 22625
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6689176559448242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6689181327819824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04315757751464844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 24 input nodes size: 69541
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039205074310302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039205074310302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07236480712890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07238626480102539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03915882110595703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.040543556213378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.040543556213378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.040543556213378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([69541, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.040543556213378906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([856, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12071800231933594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12071800231933594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12153434753417969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12842893600463867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([1076, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12904691696166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12904691696166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13007307052612305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14546537399291992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([1139, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14658164978027344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14658164978027344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14766788482666016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1717820167541504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([1128, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17339038848876953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17339038848876953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1128, 128]), torch.Size([1, 1128, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17446613311767578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20585155487060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1128, 128])
m.shape torch.Size([1078, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2078838348388672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2078838348388672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20891189575195312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24624347686767578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([979, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24853038787841797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24853038787841797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2494640350341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2904691696166992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([877, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29292964935302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29292964935302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2937660217285156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33570384979248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([900, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33871889114379883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33871889114379883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33957719802856445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3897976875305176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([777, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3927030563354492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3927030563354492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3934440612792969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4416389465332031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([12055, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.498751163482666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.498751163482666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12055, 128]), torch.Size([1, 12055, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5102477073669434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.32694673538208  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12055, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2529873847961426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.272885799407959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2936358451843262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2735815048217773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20865, 256])
first layer input nodes number: 69541
first layer output nodes number: 20865
edges number: 163083
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2941560745239258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3140544891357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3190293312072754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3190293312072754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3412160873413086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3412160873413086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3419885635375977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3503928184509277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.350691318511963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.350691318511963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3513703346252441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3652691841125488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([322, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.365858554840088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.365858554840088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3664727210998535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3799843788146973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3805885314941406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3805885314941406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3810405731201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3941497802734375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3948707580566406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3948707580566406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3952465057373047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.408773422241211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4094853401184082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4094853401184082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409782886505127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4225773811340332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4232969284057617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4232969284057617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235429763793945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4358453750610352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4366297721862793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4366297721862793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4368548393249512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449683666229248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4503154754638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4503154754638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.450479507446289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.460977554321289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4617414474487305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4617414474487305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.461909294128418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4738264083862305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.474461555480957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.474461555480957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4745912551879883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4847078323364258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4854159355163574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4854159355163574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4855437278747559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.496406078338623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4971919059753418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4971919059753418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.497321605682373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.509253978729248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5098085403442383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5098085403442383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5098962783813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5185823440551758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5189857482910156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5189857482910156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5190448760986328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5253124237060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5257134437561035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5257134437561035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5257668495178223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.531801700592041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532477855682373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532477855682373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532559871673584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5424017906188965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542776107788086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542776107788086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5428218841552734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548635482788086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5488319396972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5488319396972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5488548278808594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5519218444824219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.55241060256958  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.55241060256958  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5524601936340332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5594525337219238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5598115921020508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5598115921020508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5598478317260742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565211296081543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5655951499938965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5655951499938965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.56563138961792  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5712485313415527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5716729164123535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5716729164123535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5717110633850098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5778908729553223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5782642364501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5782642364501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5782966613769531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5837764739990234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([260, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5900077819824219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5900077819824219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5905036926269531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6885876655578613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 260, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6694755554199219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6698994636535645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.670323371887207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6698780059814453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20865
output nodes number: 2842
edges number: 22542
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6700553894042969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.670055866241455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.043116092681884766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 25 input nodes size: 70603
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03915882110595703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03915882110595703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07282495498657227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0728464126586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03966522216796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04109954833984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04109954833984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04109954833984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70603, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04109954833984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([860, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12401056289672852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12401056289672852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12483072280883789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1313920021057129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([1044, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13257598876953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13257598876953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13357162475585938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14850616455078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1124, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14961624145507812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14961624145507812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15068817138671875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17450714111328125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1128, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17612266540527344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17612266540527344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1128, 128]), torch.Size([1, 1128, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1771984100341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20856285095214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1128, 128])
m.shape torch.Size([1133, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21072626113891602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21072626113891602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2118067741394043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25078725814819336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1043, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2532310485839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2532310485839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2542257308959961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29711437225341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([930, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29972124099731445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29972124099731445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30060815811157227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.344973087310791  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([870, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34784841537475586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34784841537475586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3486781120300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39664363861083984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([826, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39977359771728516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39977359771728516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4005613327026367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45227909088134766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([12503, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5124320983886719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5124320983886719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12503, 128]), torch.Size([1, 12503, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5243558883666992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3709449768066406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12503, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2943730354309082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3148398399353027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3353066444396973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3146796226501465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21461, 256])
first layer input nodes number: 70603
first layer output nodes number: 21461
edges number: 168689
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3358349800109863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3563017845153809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3622636795043945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3622636795043945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3855462074279785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3855462074279785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3863167762756348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3924870491027832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([350, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3927745819091797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3927745819091797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.393442153930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4045343399047852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([263, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4049592018127441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4049592018127441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4054608345031738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4201102256774902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4207439422607422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4207439422607422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.421182632446289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4339046478271484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4352364540100098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4352364540100098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.43565034866333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4505505561828613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.451894760131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.451894760131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4522285461425781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4665813446044922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4673433303833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4673433303833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467606544494629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4807672500610352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([78, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4812355041503906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4812355041503906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.48138427734375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4898643493652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490664005279541  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490664005279541  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490856647491455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.503185749053955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5038490295410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5038490295410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5039997100830078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5146980285644531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5154266357421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5154266357421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5155715942382812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5268783569335938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.527486801147461  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.527486801147461  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5275993347167969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5371646881103516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5378332138061523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5378332138061523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5379438400268555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548121452331543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5487256050109863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5487256050109863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5488190650939941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5580716133117676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5585298538208008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5585298538208008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5585966110229492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5656728744506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5661473274230957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5661473274230957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5662102699279785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5733227729797363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5739779472351074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5739779472351074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5740580558776855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5836710929870605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58416748046875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58416748046875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5842266082763672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59173583984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921812057495117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921812057495117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5922307968139648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5988759994506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.599351406097412  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.599351406097412  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5994009971618652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6063933372497559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6068129539489746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6068129539489746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6068549156188965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.613065242767334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6133618354797363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6133618354797363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6133904457092285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6178250312805176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618053913116455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618053913116455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618074893951416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.621473789215088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6219019889831543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6219019889831543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6219382286071777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6280627250671387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.635709285736084  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.635709285736084  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6362910270690918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7507004737854004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7304573059082031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7308812141418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7313051223754883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7308597564697266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21461
output nodes number: 2842
edges number: 23686
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.731041431427002  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7310419082641602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.043750762939453125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 26 input nodes size: 70552
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03966522216796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03966522216796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07330703735351562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07332849502563477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03964090347290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0410618782043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0410618782043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0410618782043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70552, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0410618782043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([864, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12339067459106445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12339067459106445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12421464920043945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13132333755493164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([1057, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13242578506469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13242578506469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13343381881713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14855432510375977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([1131, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14966821670532227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14966821670532227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15074682235717773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17483997344970703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1089, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1765742301940918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1765742301940918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1776127815246582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20856809616088867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1060, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21057605743408203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21057605743408203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21158695220947266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2486429214477539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([1048, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25113582611083984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25113582611083984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2521352767944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29563045501708984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([910, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2981681823730469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2981681823730469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29903602600097656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3432130813598633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([839, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3459796905517578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3459796905517578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34677982330322266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3927154541015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39581298828125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39581298828125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3965902328491211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44742536544799805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([12476, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5065269470214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5065269470214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12476, 128]), torch.Size([1, 12476, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5184249877929688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3631858825683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12476, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2871170043945312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.307419776916504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3277225494384766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3072609901428223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21289, 256])
first layer input nodes number: 70552
first layer output nodes number: 21289
edges number: 167492
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3282504081726074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.34855318069458  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3536291122436523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3536291122436523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.376391887664795  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.376391887664795  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3772215843200684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3839335441589355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3841896057128906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3841896057128906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3848552703857422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3960342407226562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3965520858764648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3965520858764648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3971147537231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4137163162231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4142732620239258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4142732620239258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.414689064025879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4267473220825195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4275007247924805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4275007247924805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.427882194519043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.441615104675293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4422721862792969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4422721862792969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4425525665283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4546089172363281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4553637504577637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4553637504577637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4556174278259277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4683012962341309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4690356254577637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4690356254577637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4692492485046387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4814257621765137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.48203706741333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.48203706741333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4821953773498535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4923272132873535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4931516647338867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4931516647338867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.493330955505371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5060606002807617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.50673246383667  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.50673246383667  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5068697929382324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5175814628601074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5183086395263672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5183086395263672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5184402465820312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5296268463134766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5301733016967773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5301733016967773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5302667617797852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.538865089416504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5395450592041016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5395450592041016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5396480560302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.549844741821289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5502982139587402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5502982139587402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5503649711608887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557441234588623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5579309463500977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5579309463500977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5579957962036133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565323829650879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565781593322754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565781593322754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5658388137817383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5727052688598633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5731611251831055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5731611251831055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5732145309448242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5799970626831055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5803542137145996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5803542137145996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5803942680358887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.585761547088623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5860490798950195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5860490798950195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5860795974731445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5903825759887695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5908317565917969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5908317565917969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5908756256103516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5973682403564453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5977058410644531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5977058410644531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.597738265991211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6027641296386719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603057861328125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603057861328125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6030845642089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6074104309082031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6077661514282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6077661514282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6077966690063477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6129541397094727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([298, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6200995445251465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6200995445251465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6206679344177246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.732889175415039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 298, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.713376522064209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7138004302978516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7142243385314941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7137789726257324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21289
output nodes number: 2842
edges number: 23114
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7139592170715332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7139596939086914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04369068145751953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 27 input nodes size: 70578
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03964090347290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03964090347290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07329511642456055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07331657409667969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03965330123901367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04105997085571289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04105997085571289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04105997085571289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70578, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04105997085571289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([819, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1225118637084961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1225118637084961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12329292297363281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12954139709472656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([1167, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13059329986572266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13059329986572266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13170623779296875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14840030670166016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1199, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14955902099609375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14955902099609375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1199, 128]), torch.Size([1, 1199, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15070247650146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1758584976196289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1199, 128])
m.shape torch.Size([1120, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17742300033569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17742300033569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17849111557006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20962095260620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1135, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2117929458618164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2117929458618164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2128753662109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2518901824951172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1010, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2542386054992676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2542386054992676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2552018165588379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2971634864807129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([905, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29970264434814453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29970264434814453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3005657196044922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3445253372192383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([894, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3475041389465332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3475041389465332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3483567237854004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3984189033508301  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([811, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4014730453491211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4014730453491211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40224647521972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4545464515686035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([12198, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.512324333190918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.512324333190918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12198, 128]), torch.Size([1, 12198, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5239572525024414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3500661849975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12198, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2749571800231934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2952303886413574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3155035972595215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2950716018676758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21258, 256])
first layer input nodes number: 70578
first layer output nodes number: 21258
edges number: 165731
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3160314559936523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3363046646118164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3421211242675781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3421211242675781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.364767074584961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.364767074584961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3655529022216797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3733701705932617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.373661994934082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.373661994934082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3743410110473633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.388998031616211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.389538288116455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.389538288116455  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.390120029449463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4098930358886719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4104557037353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4104557037353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.410879135131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4231586456298828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4239563941955566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4239563941955566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4243569374084473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4387764930725098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.43955659866333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.43955659866333  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4398808479309082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4538235664367676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4544286727905273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4544286727905273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.454646110534668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4655179977416992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4663090705871582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4663090705871582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4665322303771973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4792523384094238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4798760414123535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4798760414123535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4800381660461426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4904141426086426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4910635948181152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4910635948181152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.491208553314209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5015006065368652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5021896362304688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5021896362304688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5023269653320312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5130386352539062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5135583877563477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5135583877563477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513655662536621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5219240188598633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522550106048584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522550106048584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5226531028747559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5321288108825684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5327773094177246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5327773094177246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5328764915466309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5426955223083496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5431795120239258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5431795120239258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5432500839233398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5507307052612305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5513720512390137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5513720512390137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5514559745788574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5609393119812012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561485767364502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561485767364502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5615544319152832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5697941780090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5702271461486816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5702271461486816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5702786445617676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5768189430236816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577341079711914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577341079711914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5773983001708984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5850658416748047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5855374336242676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5855374336242676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5855870246887207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5925793647766113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5930190086364746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5930190086364746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5930628776550293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.599555492401123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5997662544250488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5997662544250488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5997872352600098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603039264678955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6033825874328613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6033825874328613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6034131050109863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6083569526672363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6086187362670898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6086187362670898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6086416244506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6125097274780273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([284, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6193222999572754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6193222999572754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6198639869689941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7167096138000488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.69712495803833  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6975488662719727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6979727745056152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6975274085998535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21258
output nodes number: 2842
edges number: 23018
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6977076530456543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6977081298828125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04367351531982422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 28 input nodes size: 70240
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03965330123901367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03965330123901367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07314634323120117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07316780090332031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039492130279541016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04091501235961914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04091501235961914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04091501235961914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70240, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04091501235961914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([814, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12330055236816406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12330055236816406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12407684326171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13092851638793945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([1096, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13158559799194336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13158559799194336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1326308250427246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14830923080444336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1138, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1494145393371582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1494145393371582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15049982070922852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17496824264526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1053, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17659235000610352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17659235000610352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1775965690612793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20671892166137695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([1102, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20884418487548828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20884418487548828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20989513397216797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24871253967285156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([1018, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2510995864868164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2510995864868164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25207042694091797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29485607147216797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([888, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2973346710205078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2973346710205078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29818153381347656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34142494201660156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([864, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3442974090576172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3442974090576172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3451213836669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3920879364013672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([845, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39530229568481445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39530229568481445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39610815048217773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44806432723999023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([12468, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5071134567260742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5071134567260742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12468, 128]), torch.Size([1, 12468, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5190038681030273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3632230758666992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12468, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2870769500732422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3073768615722656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.327676773071289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.307218074798584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21286, 256])
first layer input nodes number: 70240
first layer output nodes number: 21286
edges number: 167663
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.328202247619629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3485021591186523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3535771369934082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3535771369934082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3764615058898926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3764615058898926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3772664070129395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3837056159973145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3840241432189941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3840241432189941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3847393989562988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3963894844055176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.396897315979004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.396897315979004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3974695205688477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4133152961730957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4138636589050293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4138636589050293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4142775535583496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4262804985046387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.427015781402588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.427015781402588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4273896217346191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4408478736877441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4415664672851562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4415664672851562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4418659210205078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.454742431640625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4553799629211426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4553799629211426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4556031227111816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4667611122131348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4674878120422363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4674878120422363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467695713043213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.479546070098877  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4801864624023438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4801864624023438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4803504943847656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4908485412597656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4915356636047363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4915356636047363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4916882514953613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5025219917297363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5032386779785156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5032386779785156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5033817291259766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5145397186279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5150914192199707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5150914192199707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5151944160461426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523949146270752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5244603157043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5244603157043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5245461463928223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532442569732666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5329246520996094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5329246520996094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532999038696289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5403633117675781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540816307067871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540816307067871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5408811569213867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.547755241394043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548353672027588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548353672027588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5484318733215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5572686195373535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5578017234802246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5578017234802246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557868480682373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5658793449401855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5664515495300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5664515495300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5665183067321777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5749964714050293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575547695159912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575547695159912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575608730316162  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.583787441253662  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5842185020446777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5842185020446777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5842642784118652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5907187461853027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5911197662353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5911197662353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5911598205566406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5970878601074219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5975122451782227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5975122451782227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5975522994995117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6037607192993164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6039619445800781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6039619445800781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6039810180664062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6070709228515625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6073384284973145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6073384284973145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6073613166809082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.611229419708252  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618546962738037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618546962738037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.619128704071045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7352666854858398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7154350280761719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7158589363098145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.716282844543457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7158374786376953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21286
output nodes number: 2842
edges number: 23256
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.716017723083496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7160181999206543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04354429244995117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 29 input nodes size: 70537
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039492130279541016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039492130279541016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07312679290771484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07314825057983398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039633750915527344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0410614013671875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0410614013671875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0410614013671875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70537, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0410614013671875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([830, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1237955093383789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1237955093383789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1245870590209961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1310892105102539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([1040, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1316852569580078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1316852569580078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1040, 128]), torch.Size([1, 1040, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1326770782470703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1475543975830078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1040, 128])
m.shape torch.Size([1160, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14871788024902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14871788024902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1498241424560547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1741619110107422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
m.shape torch.Size([1080, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17566871643066406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17566871643066406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1766986846923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20740699768066406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1141, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20961236953735352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20961236953735352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21070051193237305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24987363815307617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([940, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25201892852783203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25201892852783203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2529153823852539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29279565811157227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([987, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2956418991088867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2956418991088867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2965831756591797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34435272216796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([940, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34746789932250977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34746789932250977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34836435317993164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3994622230529785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([818, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.402524471282959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.402524471282959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4033045768737793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45458459854125977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([12451, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5135655403137207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5135655403137207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12451, 128]), torch.Size([1, 12451, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5254397392272949  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3685078620910645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12451, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2920851707458496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.31248140335083  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3328776359558105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.312321662902832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21387, 256])
first layer input nodes number: 70537
first layer output nodes number: 21387
edges number: 168356
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3334054946899414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3538017272949219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.359738826751709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.359738826751709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([442, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.382528305053711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.382528305053711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.383371353149414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3902173042297363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3904590606689453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3904590606689453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3911170959472656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.402944564819336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4034547805786133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4034547805786133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4040098190307617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4197688102722168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4203486442565918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4203486442565918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.420773983001709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4331088066101074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4345464706420898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4345464706420898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4349431991577148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4492254257202148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([133, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4497942924499512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4497942924499512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4500479698181152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.46095609664917  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.461784839630127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.461784839630127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4620556831359863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.475597858428955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4762701988220215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4762701988220215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4764704704284668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4878859519958496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4885993003845215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4885993003845215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4887785911560059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5002532005310059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.500798225402832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.500798225402832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5009241104125977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.509861946105957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.510571002960205  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.510571002960205  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5107102394104004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5215706825256348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5222740173339844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5222740173339844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5224018096923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.53326416015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5338125228881836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5338125228881836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5339059829711914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5425043106079102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5431575775146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5431575775146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5432567596435547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5530757904052734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5537328720092773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5537328720092773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5538263320922852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5637331008911133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564255714416504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564255714416504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564326286315918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.572300910949707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5725107192993164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5725107192993164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5725393295288086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575972557067871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5764946937561035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5764946937561035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5765538215637207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5840630531311035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846729278564453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846729278564453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5847396850585938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5936851501464844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5940747261047363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5940747261047363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5941166877746582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6000332832336426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6007390022277832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6007390022277832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6008076667785645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6109700202941895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.611210823059082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.611210823059082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112356185913086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6150789260864258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6154866218566895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6154866218566895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.615522861480713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6213936805725098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6216297149658203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6216297149658203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6216506958007812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6251964569091797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([284, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6328959465026855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6328959465026855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6334376335144043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7409114837646484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7212128639221191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7216367721557617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7220606803894043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7216153144836426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21387
output nodes number: 2842
edges number: 23135
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7217965126037598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.721796989440918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04369974136352539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 30 input nodes size: 70401
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039633750915527344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039633750915527344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07320356369018555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07322502136230469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03956890106201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04097461700439453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04097461700439453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04097461700439453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70401, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04097461700439453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([870, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1223912239074707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1223912239074707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12322092056274414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12985849380493164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([1077, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13084077835083008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13084077835083008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1318678855895996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14727449417114258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1119, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1483616828918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1483616828918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1494288444519043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17305850982666016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1120, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17498159408569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17498159408569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17604970932006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20733022689819336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1077, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2093639373779297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2093639373779297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21039104461669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2476506233215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([936, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2498149871826172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2498149871826172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25070762634277344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2896080017089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([914, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29221248626708984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29221248626708984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29308414459228516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3378124237060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([924, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34090137481689453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34090137481689453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3417825698852539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3923196792602539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([810, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.395355224609375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.395355224609375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39612770080566406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4457411766052246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([12268, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5038533210754395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5038533210754395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12268, 128]), torch.Size([1, 12268, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5155529975891113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3462681770324707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12268, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2711124420166016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2912492752075195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3115224838256836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2912282943725586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21115, 256])
first layer input nodes number: 70401
first layer output nodes number: 21115
edges number: 165622
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.312049388885498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.332186222076416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.337812900543213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.337812900543213  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3604469299316406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3604469299316406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3612861633300781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3689098358154297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3691787719726562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3691787719726562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3698616027832031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.383819580078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3843259811401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3843259811401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3848867416381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4050512313842773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4056167602539062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4056167602539062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.406036376953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4182052612304688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4189376831054688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4189376831054688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4193115234375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.432769775390625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.433499813079834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.433499813079834  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4338030815124512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4468436241149902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4476275444030762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4476275444030762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.447892665863037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.461148738861084  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4618620872497559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4618620872497559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4620718955993652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4740309715270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4746613502502441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4746613502502441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4748234748840332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4851994514465332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4857912063598633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4857912063598633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4859247207641602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4954042434692383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4960989952087402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4960989952087402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4962363243103027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5069479942321777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5075368881225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5075368881225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.507645606994629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5168867111206055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5174574851989746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5174574851989746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5175528526306152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5263266563415527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5268445014953613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5268445014953613  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5269246101379395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5348553657531738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5354785919189453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5354785919189453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5355663299560547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5448665618896484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545191764831543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545191764831543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5452375411987305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.550410270690918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.550877571105957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.550877571105957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5509347915649414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5578012466430664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5583438873291016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5583438873291016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5584068298339844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5664005279541016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566789150238037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566789150238037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5668330192565918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57271146774292  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5731897354125977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5731897354125977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5732393264770508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5802316665649414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5806713104248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5806713104248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5807151794433594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5872077941894531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.587587833404541  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.587587833404541  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5876240730285645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5932412147521973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5935993194580078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5935993194580078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5936317443847656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5988845825195312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5990991592407227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5990991592407227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5991182327270508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.602341651916504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609468936920166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609468936920166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6100354194641113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7272677421569824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.707707405090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7081308364868164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7085542678833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7081093788146973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2840, 40])
input nodes number: 21115
output nodes number: 2840
edges number: 22976
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7082877159118652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7082881927490234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04358100891113281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 31 input nodes size: 70911
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039568424224853516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.039568424224853516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07338142395019531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07340288162231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.03981161117553711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04125833511352539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04125833511352539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04125833511352539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70911, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04125833511352539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([835, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12577390670776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12577390670776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1265702247619629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13294076919555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([1117, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1336078643798828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1336078643798828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1346731185913086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15155696868896484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1177, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1527080535888672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1527080535888672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1177, 128]), torch.Size([1, 1177, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15383052825927734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17852497100830078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1177, 128])
m.shape torch.Size([1083, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18009662628173828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18009662628173828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18112945556640625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21166324615478516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([1064, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2136836051940918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2136836051940918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21469831466674805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25180578231811523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([996, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.254148006439209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.254148006439209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2550978660583496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.296475887298584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 996, 128])
m.shape torch.Size([956, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.299191951751709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.299191951751709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30010366439819336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3456892967224121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([849, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34847211837768555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34847211837768555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34928178787231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3960261344909668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3990631103515625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3990631103515625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3998279571533203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4487781524658203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12757, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5092258453369141  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5092258453369141  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12757, 128]), torch.Size([1, 12757, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5213918685913086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3851795196533203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12757, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.306971549987793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3276052474975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3482389450073242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3274435997009277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21636, 256])
first layer input nodes number: 70911
first layer output nodes number: 21636
edges number: 170500
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.348769187927246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3694028854370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375485897064209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375485897064209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([434, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3986005783081055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3986005783081055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.399428367614746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4060649871826172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.406362533569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.406362533569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4070682525634766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4179348945617676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4184269905090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4184269905090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4189858436584473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4323692321777344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4329895973205566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4329895973205566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4334359169006348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4463791847229004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4469923973083496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4469923973083496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.447324275970459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4592719078063965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4599308967590332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4599308967590332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4602036476135254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4719319343566895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4726638793945312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4726638793945312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.472909927368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4852123260498047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4858970642089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4858970642089844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4860973358154297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4975128173828125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4982261657714844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4982261657714844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4984054565429688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5098800659179688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5105595588684082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5105595588684082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5107121467590332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5215458869934082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522146224975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522146224975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522268295288086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.531789779663086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5324668884277344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5324668884277344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5325889587402344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5429649353027344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.543428897857666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.543428897857666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5435090065002441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5508790016174316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5512561798095703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5512561798095703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5513153076171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557168960571289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5577597618103027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5577597618103027  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5578417778015137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566535472869873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.567032814025879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.567032814025879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5670995712280273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5746431350708008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5749859809875488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5749859809875488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5750298500061035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580294132232666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5808954238891602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5808954238891602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5809640884399414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5896844863891602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5902528762817383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5902528762817383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590315818786621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.598750114440918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.599256992340088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.599256992340088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5993103981018066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6068406105041504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072378158569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072378158569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072778701782227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.613205909729004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6136937141418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6136937141418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6137394905090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6208348274230957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6211881637573242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6211881637573242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.621220588684082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6264734268188477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes
[05:23:26] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 32 parts and get 0 edge cuts

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6268033981323242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6268033981323242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6268320083618164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.631667137145996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([311, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6391258239746094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6391258239746094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.639719009399414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.746769905090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 311, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7267165184020996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7271404266357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7275643348693848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.727118968963623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2843, 40])
input nodes number: 21636
output nodes number: 2843
edges number: 23484
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7273025512695312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7273030281066895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04392719268798828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049477577209472656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049477577209472656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019216611981391907 |0.013082966208457947 |0.13205402344465256 |9.072571992874146e-05 |0.07279561460018158 |0.003691434860229492 |
----------------------------------------------------------pseudo_mini_loss sum 5.339412212371826
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2939124
Number of first layer input nodes during this epoch:  2258398
Number of first layer output nodes during this epoch:  680726
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04947710037231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01947951316833496
global_2_local spend time (sec) 0.04814624786376953
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0046384334564208984
A = g.adjacency_matrix() spent  0.007686138153076172
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08552098274230957
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.332747459411621
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.324193000793457

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.081 seconds
Split the graph: 0.020 seconds
Construct subgraphs: 0.066 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.16895437240600586
2842
2840
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2840
2843
total k batches seeds list generation spend  10.489496946334839
after graph partition
graph partition algorithm spend time 10.577667713165283
2842
2840
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2840
2843
partition_len_list
[21345, 21331, 20851, 21615, 21302, 21073, 21324, 21404, 21108, 21171, 20807, 21714, 21299, 21321, 21096, 21306, 21059, 21390, 21485, 20843, 21476, 21098, 21694, 21345, 20907, 21136, 21584, 21383, 20650, 21392, 21184, 21741]
shared_neighbor_graph_partition_s0 selection method  spend 10.68003225326538
time for parepare:  0.01702117919921875
local_output_nid generation:  0.0006952285766601562
local_in_edges_tensor generation:  0.0009274482727050781
mini_batch_src_global generation:  0.0012691020965576172
r_  generation:  0.006640195846557617
local_output_nid generation:  0.0006895065307617188
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.0012259483337402344
r_  generation:  0.006781578063964844
local_output_nid generation:  0.0007340908050537109
local_in_edges_tensor generation:  0.0007319450378417969
mini_batch_src_global generation:  0.0008223056793212891
r_  generation:  0.00644230842590332
local_output_nid generation:  0.0007479190826416016
local_in_edges_tensor generation:  0.0007338523864746094
mini_batch_src_global generation:  0.0008018016815185547
r_  generation:  0.006753683090209961
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0007739067077636719
r_  generation:  0.006783246994018555
local_output_nid generation:  0.0007638931274414062
local_in_edges_tensor generation:  0.0007050037384033203
mini_batch_src_global generation:  0.0007524490356445312
r_  generation:  0.0068895816802978516
local_output_nid generation:  0.0007786750793457031
local_in_edges_tensor generation:  0.0006964206695556641
mini_batch_src_global generation:  0.0007774829864501953
r_  generation:  0.006873607635498047
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0007445812225341797
r_  generation:  0.006804943084716797
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0007357597351074219
mini_batch_src_global generation:  0.0007457733154296875
r_  generation:  0.006871700286865234
local_output_nid generation:  0.0007746219635009766
local_in_edges_tensor generation:  0.0006899833679199219
mini_batch_src_global generation:  0.0008533000946044922
r_  generation:  0.006945610046386719
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0006830692291259766
mini_batch_src_global generation:  0.0008461475372314453
r_  generation:  0.006850004196166992
local_output_nid generation:  0.0008189678192138672
local_in_edges_tensor generation:  0.0007350444793701172
mini_batch_src_global generation:  0.0008029937744140625
r_  generation:  0.007168292999267578
local_output_nid generation:  0.0008244514465332031
local_in_edges_tensor generation:  0.0006878376007080078
mini_batch_src_global generation:  0.00079345703125
r_  generation:  0.007069110870361328
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0006809234619140625
mini_batch_src_global generation:  0.0007719993591308594
r_  generation:  0.007069587707519531
local_output_nid generation:  0.0007965564727783203
local_in_edges_tensor generation:  0.0006930828094482422
mini_batch_src_global generation:  0.0007648468017578125
r_  generation:  0.0070078372955322266
local_output_nid generation:  0.0008020401000976562
local_in_edges_tensor generation:  0.0006773471832275391
mini_batch_src_global generation:  0.0007796287536621094
r_  generation:  0.00708460807800293
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0007050037384033203
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.006997823715209961
local_output_nid generation:  0.0008375644683837891
local_in_edges_tensor generation:  0.0006935596466064453
mini_batch_src_global generation:  0.0008156299591064453
r_  generation:  0.007128000259399414
local_output_nid generation:  0.0008356571197509766
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0008206367492675781
r_  generation:  0.0072095394134521484
local_output_nid generation:  0.0008444786071777344
local_in_edges_tensor generation:  0.0006902217864990234
mini_batch_src_global generation:  0.0007808208465576172
r_  generation:  0.006960391998291016
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0006864070892333984
mini_batch_src_global generation:  0.0007998943328857422
r_  generation:  0.00718998908996582
local_output_nid generation:  0.0008115768432617188
local_in_edges_tensor generation:  0.0006916522979736328
mini_batch_src_global generation:  0.0007801055908203125
r_  generation:  0.008479833602905273
local_output_nid generation:  0.0008327960968017578
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0008301734924316406
r_  generation:  0.007300376892089844
local_output_nid generation:  0.0008220672607421875
local_in_edges_tensor generation:  0.0006737709045410156
mini_batch_src_global generation:  0.0007965564727783203
r_  generation:  0.007109165191650391
local_output_nid generation:  0.0008311271667480469
local_in_edges_tensor generation:  0.0006868839263916016
mini_batch_src_global generation:  0.0007731914520263672
r_  generation:  0.0070340633392333984
local_output_nid generation:  0.0008034706115722656
local_in_edges_tensor generation:  0.0006833076477050781
mini_batch_src_global generation:  0.0007762908935546875
r_  generation:  0.006998538970947266
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0007884502410888672
r_  generation:  0.0072705745697021484
local_output_nid generation:  0.0008020401000976562
local_in_edges_tensor generation:  0.0006742477416992188
mini_batch_src_global generation:  0.0007920265197753906
r_  generation:  0.007077932357788086
local_output_nid generation:  0.0007886886596679688
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0008034706115722656
r_  generation:  0.006913423538208008
local_output_nid generation:  0.0008027553558349609
local_in_edges_tensor generation:  0.0006871223449707031
mini_batch_src_global generation:  0.0007748603820800781
r_  generation:  0.007056713104248047
local_output_nid generation:  0.0007784366607666016
local_in_edges_tensor generation:  0.0006623268127441406
mini_batch_src_global generation:  0.0007627010345458984
r_  generation:  0.0070455074310302734
local_output_nid generation:  0.0007605552673339844
local_in_edges_tensor generation:  0.0006721019744873047
mini_batch_src_global generation:  0.0007719993591308594
r_  generation:  0.007293701171875
----------------------check_connections_block total spend ----------------------------- 0.387958288192749
generate_one_block  0.021034717559814453
generate_one_block  0.012382745742797852
generate_one_block  0.011797428131103516
generate_one_block  0.012226343154907227
generate_one_block  0.012131690979003906
generate_one_block  0.011938810348510742
generate_one_block  0.012024164199829102
generate_one_block  0.012052297592163086
generate_one_block  0.012040853500366211
generate_one_block  0.012003183364868164
generate_one_block  0.011695146560668945
generate_one_block  0.012266874313354492
generate_one_block  0.012093305587768555
generate_one_block  0.01179194450378418
generate_one_block  0.011761903762817383
generate_one_block  0.011841058731079102
generate_one_block  0.016541481018066406
generate_one_block  0.012719869613647461
generate_one_block  0.012579917907714844
generate_one_block  0.011784076690673828
generate_one_block  0.012525796890258789
generate_one_block  0.011869668960571289
generate_one_block  0.012284994125366211
generate_one_block  0.012034416198730469
generate_one_block  0.011732816696166992
generate_one_block  0.011760950088500977
generate_one_block  0.012581586837768555
generate_one_block  0.01210474967956543
generate_one_block  0.011667966842651367
generate_one_block  0.012094974517822266
generate_one_block  0.011933565139770508
generate_one_block  0.01256108283996582
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03376007080078125
gen group dst list time:  0.019789695739746094
time for parepare:  0.021174907684326172
local_output_nid generation:  0.004670619964599609
local_in_edges_tensor generation:  0.011653661727905273
mini_batch_src_global generation:  0.005549192428588867
r_  generation:  0.061882972717285156
local_output_nid generation:  0.006557941436767578
local_in_edges_tensor generation:  0.006214618682861328
mini_batch_src_global generation:  0.0075969696044921875
r_  generation:  0.06092119216918945
local_output_nid generation:  0.006439924240112305
local_in_edges_tensor generation:  0.0054700374603271484
mini_batch_src_global generation:  0.005330562591552734
r_  generation:  0.05995750427246094
local_output_nid generation:  0.00664210319519043
local_in_edges_tensor generation:  0.00555419921875
mini_batch_src_global generation:  0.006263256072998047
r_  generation:  0.0632476806640625
local_output_nid generation:  0.006540775299072266
local_in_edges_tensor generation:  0.0055844783782958984
mini_batch_src_global generation:  0.006468772888183594
r_  generation:  0.06331682205200195
local_output_nid generation:  0.006483793258666992
local_in_edges_tensor generation:  0.005317211151123047
mini_batch_src_global generation:  0.006456851959228516
r_  generation:  0.06209397315979004
local_output_nid generation:  0.006559848785400391
local_in_edges_tensor generation:  0.005454063415527344
mini_batch_src_global generation:  0.006661176681518555
r_  generation:  0.06548047065734863
local_output_nid generation:  0.006551504135131836
local_in_edges_tensor generation:  0.005278110504150391
mini_batch_src_global generation:  0.006778717041015625
r_  generation:  0.06294417381286621
local_output_nid generation:  0.0065839290618896484
local_in_edges_tensor generation:  0.006155729293823242
mini_batch_src_global generation:  0.006955146789550781
r_  generation:  0.0621950626373291
local_output_nid generation:  0.006512880325317383
local_in_edges_tensor generation:  0.006062984466552734
mini_batch_src_global generation:  0.00676274299621582
r_  generation:  0.06380939483642578
local_output_nid generation:  0.006445169448852539
local_in_edges_tensor generation:  0.005971193313598633
mini_batch_src_global generation:  0.0066776275634765625
r_  generation:  0.062487125396728516
local_output_nid generation:  0.006675243377685547
local_in_edges_tensor generation:  0.005766868591308594
mini_batch_src_global generation:  0.0069348812103271484
r_  generation:  0.06629133224487305
local_output_nid generation:  0.006983757019042969
local_in_edges_tensor generation:  0.005668163299560547
mini_batch_src_global generation:  0.007287740707397461
r_  generation:  0.064666748046875
local_output_nid generation:  0.006621360778808594
local_in_edges_tensor generation:  0.005765676498413086
mini_batch_src_global generation:  0.006992340087890625
r_  generation:  0.06373214721679688
local_output_nid generation:  0.006428241729736328
local_in_edges_tensor generation:  0.006281375885009766
mini_batch_src_global generation:  0.00677490234375
r_  generation:  0.0631265640258789
local_output_nid generation:  0.006491899490356445
local_in_edges_tensor generation:  0.005487680435180664
mini_batch_src_global generation:  0.007256507873535156
r_  generation:  0.06378984451293945
local_output_nid generation:  0.006546974182128906
local_in_edges_tensor generation:  0.005804538726806641
mini_batch_src_global generation:  0.006893634796142578
r_  generation:  0.06430649757385254
local_output_nid generation:  0.006640911102294922
local_in_edges_tensor generation:  0.006024837493896484
mini_batch_src_global generation:  0.006929874420166016
r_  generation:  0.0650019645690918
local_output_nid generation:  0.006751060485839844
local_in_edges_tensor generation:  0.0072784423828125
mini_batch_src_global generation:  0.0072367191314697266
r_  generation:  0.06495857238769531
local_output_nid generation:  0.006384134292602539
local_in_edges_tensor generation:  0.005302906036376953
mini_batch_src_global generation:  0.0067157745361328125
r_  generation:  0.06267476081848145
local_output_nid generation:  0.006735324859619141
local_in_edges_tensor generation:  0.006066799163818359
mini_batch_src_global generation:  0.0073108673095703125
r_  generation:  0.06576156616210938
local_output_nid generation:  0.0064830780029296875
local_in_edges_tensor generation:  0.005337238311767578
mini_batch_src_global generation:  0.006979942321777344
r_  generation:  0.06338357925415039
local_output_nid generation:  0.0066144466400146484
local_in_edges_tensor generation:  0.005682468414306641
mini_batch_src_global generation:  0.0073168277740478516
r_  generation:  0.06557440757751465
local_output_nid generation:  0.006541728973388672
local_in_edges_tensor generation:  0.006335258483886719
mini_batch_src_global generation:  0.00706028938293457
r_  generation:  0.0643765926361084
local_output_nid generation:  0.006448984146118164
local_in_edges_tensor generation:  0.005831480026245117
mini_batch_src_global generation:  0.007138967514038086
r_  generation:  0.06270384788513184
local_output_nid generation:  0.006493091583251953
local_in_edges_tensor generation:  0.00612950325012207
mini_batch_src_global generation:  0.006876945495605469
r_  generation:  0.06357288360595703
local_output_nid generation:  0.006595134735107422
local_in_edges_tensor generation:  0.005954742431640625
mini_batch_src_global generation:  0.007562160491943359
r_  generation:  0.06593465805053711
local_output_nid generation:  0.006522655487060547
local_in_edges_tensor generation:  0.005764484405517578
mini_batch_src_global generation:  0.0071032047271728516
r_  generation:  0.06524515151977539
local_output_nid generation:  0.006360292434692383
local_in_edges_tensor generation:  0.0053577423095703125
mini_batch_src_global generation:  0.006859779357910156
r_  generation:  0.06224370002746582
local_output_nid generation:  0.006543397903442383
local_in_edges_tensor generation:  0.006279706954956055
mini_batch_src_global generation:  0.006975650787353516
r_  generation:  0.06502795219421387
local_output_nid generation:  0.006451845169067383
local_in_edges_tensor generation:  0.005275249481201172
mini_batch_src_global generation:  0.007142782211303711
r_  generation:  0.06532931327819824
local_output_nid generation:  0.006520748138427734
local_in_edges_tensor generation:  0.005518198013305664
mini_batch_src_global generation:  0.007176637649536133
r_  generation:  0.06554651260375977
----------------------check_connections_block total spend ----------------------------- 3.1598591804504395
generate_one_block  0.08882641792297363
generate_one_block  0.09952926635742188
generate_one_block  0.08131933212280273
generate_one_block  0.08337783813476562
generate_one_block  0.08469367027282715
generate_one_block  0.08153605461120605
generate_one_block  0.08431458473205566
generate_one_block  0.08347868919372559
generate_one_block  0.08410525321960449
generate_one_block  0.0844428539276123
generate_one_block  0.08672094345092773
generate_one_block  0.08607935905456543
generate_one_block  0.08769392967224121
generate_one_block  0.08666563034057617
generate_one_block  0.08230924606323242
generate_one_block  0.08693408966064453
generate_one_block  0.08362722396850586
generate_one_block  0.08467435836791992
generate_one_block  0.08688974380493164
generate_one_block  0.08150076866149902
generate_one_block  0.08497071266174316
generate_one_block  0.08556771278381348
generate_one_block  0.08533310890197754
generate_one_block  0.08481502532958984
generate_one_block  0.08193778991699219
generate_one_block  0.08341097831726074
generate_one_block  0.08598780632019043
generate_one_block  0.08495664596557617
generate_one_block  0.08040571212768555
generate_one_block  0.08409810066223145
generate_one_block  0.08434271812438965
generate_one_block  0.08587384223937988
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04947710037231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

connection checking time:  3.1598591804504395
block generation total time  2.720419406890869
average batch blocks generation time:  0.08501310646533966
block dataloader generation time/epoch 17.635822534561157
pseudo mini batch 0 input nodes size: 70654
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04536151885986328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04536151885986328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07905197143554688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07907342910766602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04523897171020508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046658992767333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046658992767333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046658992767333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70654, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046658992767333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([833, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12880373001098633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12880373001098633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12959814071655273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13669490814208984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([1083, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13776350021362305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13776350021362305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13879632949829102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15428876876831055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([1147, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15541315078735352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15541315078735352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15650701522827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18070316314697266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([1152, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18235349655151367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18235349655151367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18345212936401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21531248092651367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1141, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2174835205078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2174835205078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21857166290283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25774478912353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1023, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26012754440307617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26012754440307617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26110315322875977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30332326889038086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([923, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30591630935668945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30591630935668945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3067965507507324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35106849670410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([919, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35413408279418945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35413408279418945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3550105094909668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4054436683654785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([799, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4084343910217285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4084343910217285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4091963768005371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45874786376953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([12325, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5171370506286621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5171370506286621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12325, 128]), torch.Size([1, 12325, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5288910865783691  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3638038635253906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12325, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2880010604858398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3083572387695312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3287134170532227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3081979751586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21345, 256])
first layer input nodes number: 70654
first layer output nodes number: 21345
edges number: 167145
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3292417526245117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3495979309082031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.354687213897705  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.354687213897705  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([389, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3776836395263672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3776836395263672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3784255981445312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.385451316833496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([357, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3857669830322266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3857669830322266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3864479064941406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3993754386901855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3998456001281738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3998456001281738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4003815650939941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4181904792785645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4198131561279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4198131561279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4203071594238281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4453678131103516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4470114707946777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4470114707946777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4474234580993652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4622550010681152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.462902545928955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.462902545928955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4631848335266113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.47532320022583  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.476029872894287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.476029872894287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4762701988220215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4882864952087402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4890122413635254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4890122413635254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4892220497131348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5011811256408691  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5018377304077148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5018377304077148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5020055770874023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5127477645874023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5133562088012695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5133562088012695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513493537902832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5232439041137695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5239577293395996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5239577293395996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5240988731384277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5351080894470215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5359601974487305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5359601974487305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5361127853393555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5490827560424805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5496439933776855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5496439933776855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.549741268157959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5586905479431152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5592880249023438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5592880249023438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5593795776367188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5684432983398438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5689454078674316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5689454078674316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5690178871154785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5767006874084473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5771722793579102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5771722793579102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577235221862793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5843477249145508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5847411155700684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5847411155700684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5847907066345215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5907416343688965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5911321640014648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5911321640014648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5911779403686523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969915390014648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.597407341003418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.597407341003418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5974531173706055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035871505737305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6040449142456055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6040449142456055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6040925979614258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6108160018920898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.611236572265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.611236572265625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112785339355469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6174888610839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6177639961242676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6177639961242676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.617790699005127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.62192964553833  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6223807334899902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6223807334899902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6224207878112793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6289095878601074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6291437149047852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6291437149047852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629164695739746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6327104568481445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640028953552246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640028953552246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640610694885254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7516260147094727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.731651782989502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7320756912231445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.732499599456787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7320542335510254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21345
output nodes number: 2842
edges number: 23403
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7322349548339844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7322359085083008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049291133880615234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 1 input nodes size: 71331
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045239925384521484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045239925384521484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0792531967163086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07927465438842773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045562744140625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04698467254638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04698467254638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04698467254638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([71331, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04698467254638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([851, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12940549850463867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12940549850463867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1302170753479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13715505599975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([1062, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13776206970214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13776206970214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13877487182617188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15396690368652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1145, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15509843826293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15509843826293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1561903953552246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18021345138549805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([1125, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18181324005126953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18181324005126953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18288612365722656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21418094635009766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1065, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21618366241455078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21618366241455078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21719932556152344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25396108627319336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([1016, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2563600540161133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2563600540161133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25732898712158203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3000802993774414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([892, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30257320404052734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30257320404052734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 892, 128]), torch.Size([1, 892, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3034238815307617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34754276275634766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 892, 128])
m.shape torch.Size([899, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35054683685302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35054683685302734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35140419006347656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40165233612060547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([833, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4047985076904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4047985076904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4055929183959961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4581418037414551  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([12443, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5170774459838867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5170774459838867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12443, 128]), torch.Size([1, 12443, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5289440155029297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3716130256652832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12443, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2954845428466797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3158273696899414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3361701965332031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3156681060791016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21331, 256])
first layer input nodes number: 71331
first layer output nodes number: 21331
edges number: 167694
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3367037773132324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3570466041564941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3621325492858887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3621325492858887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([434, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3847551345825195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3847551345825195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3855829238891602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3922109603881836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([346, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3924622535705566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3924622535705566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3931221961975098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4048700332641602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4053735733032227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4053735733032227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4059247970581055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.421642780303955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4230327606201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4230327606201172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235267639160156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4458866119384766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.446610450744629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.446610450744629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.446995735168457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4608659744262695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4615788459777832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4615788459777832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4618782997131348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.474754810333252  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4753317832946777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4753317832946777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4755377769470215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.485837459564209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.486595630645752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.486595630645752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.486809253692627  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.498985767364502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4996404647827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4996404647827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4998083114624023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5105504989624023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5112357139587402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5112357139587402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5113883018493652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5222220420837402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5229496955871582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5229496955871582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523094654083252  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5344014167785645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5350098609924316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5350098609924316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5351223945617676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5446877479553223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5450692176818848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5450692176818848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5451359748840332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5512776374816895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551863670349121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551863670349121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5519514083862305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5606374740600586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5611705780029297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5611705780029297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5612468719482422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5693340301513672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569911003112793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569911003112793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5699872970581055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.578608512878418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5790605545043945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5790605545043945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.579117774963379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.585984230041504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5863709449768066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5863709449768066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5864167213439941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5922303199768066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5926823616027832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5926823616027832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5927319526672363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.599377155303955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5998716354370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5998716354370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5999231338500977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6071844100952148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6075220108032227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6075220108032227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6075563430786133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6126375198364258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6128954887390137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6128954887390137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6129202842712402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6167635917663574  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6171274185180664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6171274185180664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6171598434448242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6224126815795898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6228351593017578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6228351593017578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6228713989257812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6289958953857422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6360664367675781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6360664367675781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6366291046142578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7432208061218262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.723668098449707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7240915298461914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7245149612426758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7240700721740723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2840, 40])
input nodes number: 21331
output nodes number: 2840
edges number: 22970
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.724250316619873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7242507934570312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04961967468261719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 2 input nodes size: 69477
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0455622673034668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0455622673034668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07869148254394531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07871294021606445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0446782112121582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04606199264526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04606199264526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04606199264526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([69477, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04606199264526367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([852, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12620830535888672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12620830535888672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 852, 128]), torch.Size([1, 852, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12702083587646484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13392305374145508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 852, 128])
m.shape torch.Size([1106, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13457155227661133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13457155227661133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13562631607055664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15144777297973633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1127, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15253257751464844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15253257751464844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15360736846923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17725276947021484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1113, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17904996871948242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17904996871948242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18011140823364258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2113184928894043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1076, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21335315704345703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21335315704345703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21437931060791016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2516617774963379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([980, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2539525032043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2539525032043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25488710403442383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2959141731262207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([876, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2983708381652832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2983708381652832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2992062568664551  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3410801887512207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([825, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3438096046447754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3438096046447754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34459638595581055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39073991775512695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([812, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3938312530517578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3938312530517578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3946056365966797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44564247131347656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([12084, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5028762817382812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5028762817382812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12084, 128]), torch.Size([1, 12084, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5144004821777344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3330078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12084, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.25905179977417  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2789368629455566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2997136116027832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2796730995178223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20851, 256])
first layer input nodes number: 69477
first layer output nodes number: 20851
edges number: 163037
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3002333641052246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3201184272766113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.325089931488037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.325089931488037  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([456, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3473329544067383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3473329544067383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3482027053833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3566770553588867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3569631576538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3569631576538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3576784133911133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.373488426208496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([316, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.37404203414917  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.37404203414917  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3746447563171387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3879046440124512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3884687423706055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3884687423706055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3888978958129883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4013433456420898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([170, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4019460678100586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4019460678100586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4022703170776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4139432907104492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4146404266357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4146404266357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4149246215820312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.427145004272461  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4277901649475098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4277901649475098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4280133247375488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.439171314239502  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4397978782653809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4397978782653809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4399809837341309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4504179954528809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4511570930480957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4511570930480957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4513401985168457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4630589485168457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.463822841644287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.463822841644287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4639925956726074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4760451316833496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4766478538513184  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4766478538513184  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4767718315124512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4864420890808105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.486933708190918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.486933708190918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.487025260925293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.494807243347168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.495436191558838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.495436191558838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4955391883850098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5050148963928223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5056767463684082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5056767463684082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5057778358459473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5157856941223145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5163698196411133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5163698196411133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516453742980957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5253496170043945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.525815486907959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.525815486907959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5258784294128418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5329909324645996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5334010124206543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5334010124206543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5334525108337402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5396323204040527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5400738716125488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5400738716125488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5401253700256348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5466656684875488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5470967292785645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5470967292785645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5471444129943848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5535340309143066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5540103912353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5540103912353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5540599822998047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5610523223876953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561572551727295  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561572551727295  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5616240501403809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5692458152770996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569727897644043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569727897644043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5697736740112305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576869010925293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5771780014038086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5771780014038086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5772066116333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5818414688110352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5821270942687988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5821270942687988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5821518898010254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5863423347473145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([272, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5928659439086914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5928659439086914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5933847427368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6928372383117676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 272, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6737065315246582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6741304397583008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6745543479919434  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6741089820861816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20851
output nodes number: 2842
edges number: 22554
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6742863655090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6742868423461914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04863166809082031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 3 input nodes size: 71323
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044678688049316406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044678688049316406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07868814468383789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07870960235595703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045558929443359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046996116638183594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046996116638183594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046996116638183594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([71323, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046996116638183594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([903, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1300649642944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1300649642944336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 903, 128]), torch.Size([1, 903, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13092613220214844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1378154754638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 903, 128])
m.shape torch.Size([1135, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13884925842285156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13884925842285156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13993167877197266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15616798400878906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1151, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1572732925415039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1572732925415039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1151, 128]), torch.Size([1, 1151, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1583709716796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18284177780151367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1151, 128])
m.shape torch.Size([1145, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1844768524169922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1844768524169922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18556880950927734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21723556518554688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([1115, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21934795379638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21934795379638672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2204113006591797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2590827941894531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1019, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26146650314331055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26146650314331055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2624382972717285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3045773506164551  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([927, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30718564987182617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30718564987182617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 927, 128]), torch.Size([1, 927, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30806970596313477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3523545265197754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 927, 128])
m.shape torch.Size([913, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3553953170776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3553953170776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3562660217285156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40648746490478516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([797, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4094724655151367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4094724655151367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4102325439453125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.46057653427124023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([12510, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5207433700561523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5207433700561523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12510, 128]), torch.Size([1, 12510, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5326738357543945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3797369003295898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12510, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.303102970123291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.323716640472412  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3443303108215332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3235554695129395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21615, 256])
first layer input nodes number: 71323
first layer output nodes number: 21615
edges number: 168961
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3448638916015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3654775619506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.371401309967041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.371401309967041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([440, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.394759178161621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.394759178161621  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3955984115600586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4023122787475586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 440, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4026098251342773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4026098251342773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4033212661743164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4146337509155273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([270, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4150567054748535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4150567054748535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.415571689605713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.430677890777588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4312663078308105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4312663078308105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4316859245300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.443854808807373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444495677947998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444495677947998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4448332786560059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.456986904144287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.457723617553711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.457723617553711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4580230712890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4708995819091797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4716248512268066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4716248512268066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4718728065490723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4842705726623535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4849543571472168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4849543571472168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.485154628753662  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.496570110321045  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4972400665283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4972400665283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4974098205566406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5082740783691406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5089197158813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5089197158813477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5090646743774414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5193567276000977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5198869705200195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5198869705200195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5199956893920898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5284757614135742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5291481018066406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5291481018066406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5292682647705078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5394821166992188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5399718284606934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5399718284606934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540055751800537  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.547776699066162  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548354148864746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548354148864746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5484418869018555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5571279525756836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557790756225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557790756225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5578842163085938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5677909851074219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5682673454284668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5682673454284668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5683321952819824  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575660228729248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576183795928955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576183795928955  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5762486457824707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5840306282043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5845346450805664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5845346450805664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5845937728881836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921030044555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5925121307373047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5925121307373047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5925579071044922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5986919403076172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5990538597106934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5990538597106934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5990920066833496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6044707298278809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6048355102539062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6048355102539062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6048717498779297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6102352142333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.610788345336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.610788345336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.61083984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6188220977783203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6194376945495605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6194376945495605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.619493007659912  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6284537315368652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6287260055541992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6287260055541992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6287508010864258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6329412460327148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6405887603759766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6405887603759766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6411895751953125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.756422519683838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.736128807067871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7365527153015137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7369766235351562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7365312576293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21615
output nodes number: 2842
edges number: 23731
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7367138862609863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7367143630981445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04965829849243164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 4 input nodes size: 70433
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045558929443359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045558929443359375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07914400100708008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07916545867919922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045134544372558594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04656791687011719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04656791687011719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04656791687011719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70433, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04656791687011719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([808, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12954282760620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12954282760620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13031339645385742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13650798797607422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([1036, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13762474060058594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13762474060058594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1386127471923828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15343284606933594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([1087, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1544938087463379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1544938087463379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15553045272827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17930126190185547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1084, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18172788619995117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18172788619995117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18276166915893555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21366453170776367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1086, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21573686599731445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21573686599731445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21677255630493164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2553286552429199  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([948, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2575230598449707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2575230598449707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25842714309692383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29758501052856445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([921, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30020713806152344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30020713806152344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3010854721069336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3458571434020996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([842, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3486299514770508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3486299514770508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34943294525146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3955717086791992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([796, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3985862731933594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3985862731933594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39934539794921875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44859886169433594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([12694, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5087661743164062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5087661743164062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12694, 128]), torch.Size([1, 12694, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5208721160888672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3803939819335938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12694, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3035650253295898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3238801956176758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3441953659057617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3237214088439941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21302, 256])
first layer input nodes number: 70433
first layer output nodes number: 21302
edges number: 168882
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3447222709655762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.365037441253662  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3701162338256836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3701162338256836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3931374549865723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3931374549865723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3939518928527832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4004673957824707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4007349014282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4007349014282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4014043807983398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.411646842956543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4121570587158203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4121570587158203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4127159118652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4255599975585938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.426137924194336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.426137924194336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4265632629394531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4388980865478516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4396371841430664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4396371841430664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4400148391723633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4536104202270508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4543156623840332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4543156623840332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4546113014221191  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4673237800598145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4681048393249512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4681048393249512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4683680534362793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4815287590026855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4822664260864258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4822664260864258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4824819564819336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.494767189025879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4953083992004395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4953083992004395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4954514503479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5046067237854004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5054292678833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5054292678833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5056066513061523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5182008743286133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5187044143676758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5187044143676758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5188112258911133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5271425247192383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5278043746948242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5278043746948242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5279226303100586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5379743576049805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5385527610778809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5385527610778809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5386500358581543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5475993156433105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5481700897216797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5481700897216797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548257827758789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5569438934326172  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5574913024902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5574913024902344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5575695037841797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5658588409423828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5662813186645508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5662813186645508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5663385391235352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5728044509887695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5732336044311523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5732336044311523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.573287010192871  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.579695701599121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801362991333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801362991333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801877975463867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5867280960083008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5872869491577148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5872869491577148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5873479843139648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955266952514648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5960731506347656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5960731506347656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59613037109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6041984558105469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6046142578125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6046142578125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6046562194824219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6108665466308594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111207008361816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111207008361816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111454963684082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6149888038635254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.615175724029541  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.615175724029541  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6151928901672363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.617973804473877  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618288516998291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618288516998291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6183152198791504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6228280067443848  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6303839683532715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6303839683532715  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6309847831726074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.739915370941162  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7199430465698242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7203669548034668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7207908630371094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7203454971313477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21302
output nodes number: 2842
edges number: 23393
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7205257415771484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7205262184143066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0492100715637207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 5 input nodes size: 69952
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045134544372558594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045134544372558594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0784902572631836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07851171493530273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04490518569946289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0463109016418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0463109016418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0463109016418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([69952, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0463109016418457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([873, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12766361236572266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12766361236572266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1284961700439453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13515663146972656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([1033, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13619709014892578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13619709014892578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1033, 128]), torch.Size([1, 1033, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13718223571777344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15195941925048828  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1033, 128])
m.shape torch.Size([1136, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1530919075012207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1530919075012207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1541752815246582  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17859697341918945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1099, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1802525520324707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1802525520324707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18130064010620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21236085891723633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1099, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21445703506469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21445703506469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21550512313842773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2540435791015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([936, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.256197452545166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.256197452545166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25709009170532227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29594850540161133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([927, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2985963821411133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2985963821411133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 927, 128]), torch.Size([1, 927, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2994804382324219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34428930282592773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 927, 128])
m.shape torch.Size([904, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34729576110839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34729576110839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3481578826904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39838409423828125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([750, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4011716842651367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4011716842651367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4018869400024414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4493846893310547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([12316, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5077543258666992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5077543258666992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12316, 128]), torch.Size([1, 12316, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5194997787475586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3534269332885742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12316, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2782926559448242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2983894348144531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.318486213684082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.298232078552246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21073, 256])
first layer input nodes number: 69952
first layer output nodes number: 21073
edges number: 165485
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3190093040466309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3391060829162598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.344130516052246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.344130516052246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([432, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3668837547302246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3668837547302246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3677077293395996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3749747276306152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3752741813659668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3752741813659668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3759799003601074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3894953727722168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.390059471130371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.390059471130371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3906660079956055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4101896286010742  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4107823371887207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4107823371887207  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.411226749420166  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.42411470413208  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4248151779174805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4248151779174805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4251813888549805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4383649826049805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([115, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.438845157623291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.438845157623291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4390645027160645  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4484963417053223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([101, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4490666389465332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4490666389465332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4492592811584473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4588913917541504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4596948623657227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4596948623657227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4599180221557617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4726381301879883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4732275009155273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4732275009155273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4733819961547852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4832696914672852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.483961582183838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.483961582183838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.484114170074463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.494947910308838  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4955482482910156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4955482482910156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4956703186035156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5051918029785156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5058574676513672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5058574676513672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5059776306152344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5161914825439453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5170564651489258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5170564651489258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.517197608947754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5301828384399414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530691146850586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530691146850586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5307731628417969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5388927459716797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5394287109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5394287109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5395050048828125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5475921630859375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5481233596801758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5481233596801758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5481939315795898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556168556213379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5567378997802734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5567378997802734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5568084716796875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565277099609375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5658302307128906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5658302307128906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5658950805664062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5741310119628906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5745553970336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5745553970336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5746030807495117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5809926986694336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5815649032592773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5815649032592773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5816240310668945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.589961051940918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590355396270752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590355396270752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590395450592041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5963234901428223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.596705436706543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.596705436706543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5967416763305664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6023588180541992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.602783203125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.602783203125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6028213500976562  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6090011596679688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6093053817749023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6093053817749023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6093320846557617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.613844871520996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6205835342407227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6205835342407227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.621119499206543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7338228225708008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.71415376663208  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7145776748657227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7150015830993652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7145562171936035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21073
output nodes number: 2842
edges number: 23112
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7147350311279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.714735507965088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04891490936279297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 6 input nodes size: 70720
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04490518569946289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04490518569946289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07862710952758789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07864856719970703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04527139663696289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04670572280883789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04670572280883789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04670572280883789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70720, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04670572280883789  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([834, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12975502014160156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12975502014160156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13055038452148438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13691329956054688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([1060, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13794994354248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13794994354248047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1389608383178711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15412425994873047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([1080, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15516376495361328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15516376495361328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15619373321533203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17885303497314453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1042, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18032550811767578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18032550811767578  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1813192367553711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21013736724853516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([1089, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21223688125610352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21223688125610352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21327543258666992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25217723846435547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([925, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2543044090270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2543044090270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 925, 128]), torch.Size([1, 925, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2551865577697754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2936234474182129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 925, 128])
m.shape torch.Size([904, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2961997985839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2961997985839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2970619201660156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3407325744628906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([893, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3437080383300781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3437080383300781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3445596694946289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3946723937988281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([794, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39765405654907227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39765405654907227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39841127395629883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4470381736755371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([12703, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5072321891784668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5072321891784668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12703, 128]), torch.Size([1, 12703, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5193467140197754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3794779777526855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12703, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3025951385498047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3229312896728516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3432674407958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3227720260620117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21324, 256])
first layer input nodes number: 70720
first layer output nodes number: 21324
edges number: 169005
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3437962532043457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3641324043273926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3700337409973145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3700337409973145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3930253982543945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3930253982543945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3938169479370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4004936218261719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([397, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4008612632751465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4008612632751465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.401618480682373  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4131159782409668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413550853729248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413550853729248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4140887260437012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4266161918640137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4271588325500488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4271588325500488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4275612831115723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.439232349395752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4399638175964355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4399638175964355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4403338432312012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4536547660827637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4542889595031738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4542889595031738  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4545598030090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4662060737609863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4668784141540527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4668784141540527  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4671072959899902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4785513877868652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4793291091918945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4793291091918945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4795503616333008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492161750793457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492873191833496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492873191833496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4930543899536133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5046510696411133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5052237510681152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5052237510681152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5053553581237793  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5146994590759277  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.515395164489746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.515395164489746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5155324935913086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5262441635131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5267291069030762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5267291069030762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5268206596374512  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5346026420593262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5353193283081055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5353193283081055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535435676574707  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5461397171020508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5468621253967285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5468621253967285  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5469727516174316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557924747467041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5583744049072266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5583744049072266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.558441162109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5655174255371094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5659456253051758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5659456253051758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5660028457641602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5724687576293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.573061466217041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.573061466217041  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.573133945465088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581831455230713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5823488235473633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5823488235473633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5824098587036133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5901613235473633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5906972885131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5906972885131836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5907564163208008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.598679542541504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5992846488952637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5992846488952637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5993475914001465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608222484588623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6085948944091797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6085948944091797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608633041381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.614278793334961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.614619255065918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.614619255065918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6146516799926758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6196775436401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6199932098388672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6199932098388672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6200218200683594  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6246566772460938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6251959800720215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6251959800720215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.625241756439209  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6329779624938965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([287, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6398515701293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6398515701293945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6403989791870117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7416963577270508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.721768856048584  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7221927642822266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7226166725158691  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7221713066101074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21324
output nodes number: 2842
edges number: 23373
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7223520278930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7223525047302246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04935169219970703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 7 input nodes size: 71155
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04527139663696289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04527139663696289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07920074462890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07922220230102539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04547882080078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04690074920654297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04690074920654297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04690074920654297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([71155, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04690074920654297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([859, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12930059432983398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12930059432983398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13011980056762695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1371302604675293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([1110, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13777923583984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13777923583984375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1388378143310547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15471649169921875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1150, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15668010711669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15668010711669922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1150, 128]), torch.Size([1, 1150, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1577768325805664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18190479278564453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1150, 128])
m.shape torch.Size([1170, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18358802795410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18358802795410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1170, 128]), torch.Size([1, 1170, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18470382690429688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21706199645996094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1170, 128])
m.shape torch.Size([1059, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21902894973754883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21902894973754883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.22003889083862305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2563967704772949  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([1019, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2588071823120117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2588071823120117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2597789764404297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3023872375488281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([938, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30503225326538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30503225326538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3059267997741699  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35065412521362305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([851, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3534531593322754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3534531593322754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3542647361755371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40120363235473633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([834, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4043769836425781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4043769836425781  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40517234802246094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4569668769836426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([12414, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5157637596130371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5157637596130371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12414, 128]), torch.Size([1, 12414, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5276026725769043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3683476448059082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12414, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2922930717468262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3127055168151855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.333117961883545  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3125457763671875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21404, 256])
first layer input nodes number: 71155
first layer output nodes number: 21404
edges number: 167638
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3336501121520996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.354062557220459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3591656684875488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3591656684875488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([424, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.381941795349121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.381941795349121  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3827505111694336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3895063400268555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([355, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.389784812927246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.389784812927246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3904619216918945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4021902084350586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.402665138244629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.402665138244629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.403203010559082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4194378852844238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4200611114501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4200611114501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4205036163330078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4333362579345703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.434037685394287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.434037685394287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.434403896331787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.447587490081787  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.448298454284668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.448298454284668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.448594093322754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4613065719604492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4620404243469238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4620404243469238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4622902870178223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4747834205627441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4755735397338867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4755735397338867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4758005142211914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4887380599975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4894466400146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4894466400146484  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4896278381347656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5012245178222656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019893646240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019893646240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5021591186523438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.514211654663086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5148248672485352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5148248672485352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5149507522583008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5247697830200195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5254912376403809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5254912376403809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.525620937347412  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5366454124450684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.537130355834961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.537130355834961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5372142791748047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5449352264404297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5454587936401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5454587936401367  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5455389022827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5534696578979492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.553919792175293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.553919792175293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5539846420288086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5608587265014648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561410903930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561410903930664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561483383178711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5696735382080078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.570258617401123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.570258617401123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57033109664917  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.579028606414795  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5794768333435059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5794768333435059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5795302391052246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5863127708435059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5868706703186035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5868706703186035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5869317054748535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5951104164123535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5956377983093262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5956377983093262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5956931114196777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603492259979248  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603787899017334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603787899017334  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603818416595459  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608335018157959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6087217330932617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6087217330932617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6087579727172852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.614375114440918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6145782470703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6145782470703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6145973205566406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6176872253417969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6180009841918945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6180009841918945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618027687072754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6225404739379883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([290, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629495620727539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629495620727539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6300487518310547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7431650161743164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.723456859588623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7238807678222656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7243046760559082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7238593101501465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21404
output nodes number: 2842
edges number: 23140
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7240405082702637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7240409851074219  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04953765869140625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 8 input nodes size: 70293
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04547882080078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04547882080078125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07899713516235352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07901859283447266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045067787170410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046482086181640625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046482086181640625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046482086181640625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70293, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046482086181640625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([817, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1282029151916504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1282029151916504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1289820671081543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13529491424560547  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([1087, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13608026504516602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13608026504516602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1371169090270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15266656875610352  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1085, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1537003517150879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1537003517150879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15473508834838867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17749929428100586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1164, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17995738983154297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17995738983154297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18106746673583984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21325969696044922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([1074, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21526527404785156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21526527404785156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21628952026367188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2531623840332031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([940, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2553396224975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2553396224975586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25623607635498047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29505395889282227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([857, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2974662780761719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2974662780761719  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29828357696533203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33954763412475586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([804, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34232425689697266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34232425689697266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3430910110473633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.38686466217041016  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([843, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39009904861450195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39009904861450195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3909029960632324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44259214401245117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([12437, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5014944076538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5014944076538086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12437, 128]), torch.Size([1, 12437, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5133552551269531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3554754257202148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12437, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.279911994934082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3000421524047852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.320328712463379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3000411987304688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21108, 256])
first layer input nodes number: 70293
first layer output nodes number: 21108
edges number: 166300
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.320854663848877  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.34098482131958  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3465461730957031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3465461730957031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3695192337036133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3695192337036133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3703088760375977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3768949508666992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([350, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3771729469299316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3771729469299316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.377840518951416  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3896303176879883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3901357650756836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3901357650756836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.390690803527832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4069652557373047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4076299667358398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4076299667358398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.408097267150879  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4216489791870117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.422299861907959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.422299861907959  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4226508140563965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4352850914001465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([171, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4361724853515625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4361724853515625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4364986419677734  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4505233764648438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.451188087463379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.451188087463379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4514226913452148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4631528854370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4639124870300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4639124870300293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.46412992477417  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4765238761901855  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4773411750793457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4773411750793457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4775452613830566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4906067848205566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4912161827087402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4912161827087402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4913573265075684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5013785362243652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019636154174805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019636154174805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5020818710327148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.511305809020996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118465423583984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118465423583984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5119457244873047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.520376205444336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5209765434265137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5209765434265137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.52107572555542  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530200481414795  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5307297706604004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5307297706604004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5308117866516113  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5389313697814941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.539438247680664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.539438247680664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.539510726928711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5471935272216797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5476188659667969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5476188659667969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5476760864257812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5541419982910156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5546855926513672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5546855926513672  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5547523498535156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5627632141113281  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5631628036499023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5631628036499023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5632104873657227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5692663192749023  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569681167602539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569681167602539  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5697269439697266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5758609771728516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5762805938720703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5762805938720703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576324462890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582509994506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.583073616027832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.583073616027832  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5831289291381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5913152694702148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5917954444885254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5917954444885254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.591841220855713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5989365577697754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5993561744689941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5993561744689941  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5993943214416504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605574131011963  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6060857772827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6060857772827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6061296463012695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6135435104370117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([289, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6204657554626465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6204657554626465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6210169792175293  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.732797622680664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 289, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.712885856628418  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7133097648620605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7137336730957031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7132883071899414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21108
output nodes number: 2842
edges number: 23358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7134671211242676  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7134675979614258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04909944534301758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 9 input nodes size: 70835
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045067787170410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045067787170410156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07884454727172852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07886600494384766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04532623291015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046733856201171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046733856201171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046733856201171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70835, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046733856201171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([843, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1283278465270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1283278465270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12913179397583008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13556337356567383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([1095, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1364274024963379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1364274024963379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13747167587280273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1531357765197754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1110, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15420150756835938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15420150756835938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1552600860595703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17862796783447266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1127, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1806926727294922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1806926727294922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18176746368408203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2131214141845703  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1121, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2152566909790039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2152566909790039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2163257598876953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2551002502441406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([970, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2573409080505371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2573409080505371  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25826597213745117  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2980508804321289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([945, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30074262619018555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30074262619018555  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30164384841918945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34681224822998047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([866, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34966516494750977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34966516494750977  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3504910469055176  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39847612380981445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([774, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4013848304748535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4013848304748535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40212297439575195  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4499526023864746  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([12320, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5083298683166504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5083298683166504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12320, 128]), torch.Size([1, 12320, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5200791358947754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3542771339416504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12320, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2789373397827148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2991275787353516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3193178176879883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2989697456359863  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21171, 256])
first layer input nodes number: 70835
first layer output nodes number: 21171
edges number: 166005
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.319847583770752  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3400378227233887  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.345085620880127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.345085620880127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([409, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.367607593536377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.367607593536377  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3683876991271973  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375532627105713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([372, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3758578300476074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3758578300476074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3765673637390137  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.389688491821289  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3901324272155762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3901324272155762  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3906607627868652  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.408759593963623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4094719886779785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4094719886779785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409956455230713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4240059852600098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.42472505569458  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.42472505569458  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4251065254211426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4388394355773926  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4394564628601074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4394564628601074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4397234916687012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4512057304382324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4518799781799316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4518799781799316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4521088600158691  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4635529518127441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4642767906188965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4642767906188965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.464484691619873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.476335048675537  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4771223068237305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4771223068237305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4773187637329102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4898920059204102  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490668773651123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490668773651123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490842342376709  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5031657218933105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.503861427307129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.503861427307129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.504002571105957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5150117874145508  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5156450271606445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5156450271606445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.515761375427246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.525650978088379  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5262303352355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5262303352355957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5263276100158691  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5352768898010254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535874366760254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535874366760254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535965919494629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545029640197754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545546531677246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545546531677246  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5456209182739258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5535058975219727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.553945541381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.553945541381836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5540046691894531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5606861114501953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5612449645996094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5612449645996094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5613136291503906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5695533752441406  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701594352722168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701594352722168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5702300071716309  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5791926383972168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5795960426330566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5795960426330566  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5796418190002441  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5857758522033691  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5862913131713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5862913131713867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5863447189331055  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5938749313354492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594353199005127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594353199005127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5944008827209473  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6014580726623535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6017518043518066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6017518043518066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6017804145812988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.606215000152588  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066207885742188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066207885742188  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066570281982422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612527847290039  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612971305847168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612971305847168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6130094528198242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6194562911987305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([259, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6256608963012695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6256608963012695  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.626154899597168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7369470596313477  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 259, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7175064086914062  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7179303169250488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7183542251586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7179088592529297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 21171
output nodes number: 2842
edges number: 22892
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.718088150024414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7180886268615723  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0493464469909668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 10 input nodes size: 69692
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04532623291015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04532623291015625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07855796813964844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07857942581176758  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04478120803833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04616689682006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04616689682006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04616689682006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([69692, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04616689682006836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([805, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12636280059814453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12636280059814453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12713050842285156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13366127014160156  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([1068, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13442611694335938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13442611694335938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13544464111328125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15072250366210938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([1175, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15189409255981445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15189409255981445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1175, 128]), torch.Size([1, 1175, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1530146598815918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17766714096069336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1175, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1792125701904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1792125701904297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1802654266357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2113780975341797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1053, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2133622169494629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2133622169494629  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21436643600463867  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25117969512939453  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([963, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2534327507019043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2534327507019043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2543511390686035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2939152717590332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([866, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29634666442871094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29634666442871094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29717254638671875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33867549896240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([863, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3415546417236328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3415546417236328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3423776626586914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.38928985595703125  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3923459053039551  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3923459053039551  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39311647415161133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44277048110961914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([12102, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5000920295715332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5000920295715332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12102, 128]), torch.Size([1, 12102, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5116333961486816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3314251899719238  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12102, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.257368564605713  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2772116661071777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2970547676086426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2770562171936035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([20807, 256])
first layer input nodes number: 69692
first layer output nodes number: 20807
edges number: 163183
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2975759506225586  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3174190521240234  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3223800659179688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3223800659179688  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3447556495666504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3447556495666504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.34556245803833  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3538336753845215  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.354128360748291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.354128360748291  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.354820728302002  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.367072582244873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3676433563232422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3676433563232422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3682498931884766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3817481994628906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3823142051696777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3823142051696777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3827452659606934  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3952460289001465  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3959293365478516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3959293365478516  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3962860107421875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4091262817382812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4097557067871094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4097557067871094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4100227355957031  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4215049743652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4222731590270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4222731590270996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4225287437438965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4353079795837402  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.436018466949463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.436018466949463  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4362263679504395  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4480767250061035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4488639831542969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4488639831542969  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4490604400634766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4616336822509766  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4624581336975098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4624581336975098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4626412391662598  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4756417274475098  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4762377738952637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4762377738952637  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4763617515563965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4860320091247559  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.486593246459961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.486593246459961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4866962432861328  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4954509735107422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4961867332458496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4961867332458496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4963068962097168  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.507361888885498  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5078134536743164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5078134536743164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5078859329223633  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.515061378479004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5155153274536133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5155153274536133  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.515580177307129  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5224542617797852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5230216979980469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5230216979980469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5230960845947266  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5315017700195312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5319547653198242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5319547653198242  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5320119857788086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5388784408569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5392999649047852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5392999649047852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5393495559692383  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5456476211547852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5460429191589355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5460429191589355  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5460867881774902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5519652366638184  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5522704124450684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5522704124450684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5523028373718262  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5568747520446777  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5573835372924805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5573835372924805  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5574331283569336  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564772605895996  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5651922225952148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5651922225952148  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565232276916504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5714406967163086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5717082023620605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5717082023620605  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.571732997894287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5757498741149902  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5760607719421387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5760607719421387  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576087474822998  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5806002616882324  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([280, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5873150825500488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5873150825500488  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5878491401672363  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.687453269958496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6681513786315918  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6685752868652344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.668999195098877  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6685538291931152  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([2842, 40])
input nodes number: 20807
output nodes number: 2842
edges number: 22725
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6687307357788086  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6687312126159668  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.048740386962890625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

pseudo mini batch 11 input nodes size: 70853
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04478120803833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04478120803833008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0785665512084961  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07858800888061523  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045334815979003906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04679298400878906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04679298400878906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04679298400878906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([70853, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04679298400878906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([798, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1313014030456543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1313014030456543  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13206243515014648  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13815069198608398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([1052, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13877344131469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13877344131469727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13977670669555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15482568740844727  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1125, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15624666213989258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15624666213989258  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1573195457458496  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18114233016967773  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1124, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18274974822998047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18274974822998047  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1838216781616211  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21514415740966797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1133, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21730947494506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21730947494506836  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21838998794555664  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2573704719543457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1016, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2597370147705078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2597370147705078  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26070594787597656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3029747009277344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([957, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30568456649780273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30568456649780273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3065972328186035  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3522305488586426  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([924, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3552989959716797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3552989959716797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35618019104003906  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40656232833862305  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([783, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4094820022583008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4094820022583008  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4102287292480469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4585857391357422  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([12802, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5192570686340332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5192570686340332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12802, 128]), torch.Size([1, 12802, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.531466007232666  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.427483081817627  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12802, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.349289894104004  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3699979782104492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3907060623168945  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3698358535766602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

torch.Size([21714, 256])
first layer input nodes number: 70853
first layer output nodes number: 21714
edges number: 171692
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3912363052368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4119443893432617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4179978370666504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4179978370666504  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4414911270141602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4414911270141602  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4422636032104492  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4484434127807617  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4487361907958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4487361907958984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4494094848632812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4598488807678223  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([269, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4602880477905273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4602880477905273  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.460801124572754  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4739203453063965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([244, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.474602222442627  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.474602222442627  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4750676155090332  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4885640144348145  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4891819953918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4891819953918457  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4895195960998535  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5016732215881348  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5024676322937012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5024676322937012  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5027861595153809  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5164828300476074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5172119140625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5172119140625  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5174636840820312  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5300521850585938  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5306878089904785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5306878089904785  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530876636505127  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.541639804840088  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5423674583435059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5423674583435059  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542548656463623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.554145336151123  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5547852516174316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5547852516174316  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5549302101135254  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5652222633361816  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5659852027893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5659852027893066  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5661358833312988  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5778889656066895  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785751342773438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785751342773438  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5787010192871094  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5894012451171875  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5900382995605469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5900382995605469  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5901451110839844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5999717712402344  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6004838943481445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6004838943481445  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6005640029907227  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608494758605957  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6090459823608398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6090459823608398  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6091241836547852  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6174135208129883  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6177897453308105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6177897453308105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6178412437438965  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6236605644226074  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.624223232269287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.624223232269287  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6242918968200684  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6325316429138184  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.633016586303711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.633016586303711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6330738067626953  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640340805053711  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640878677368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640878677368164  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6409378051757812  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6488609313964844  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.649561882019043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.649561882019043  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6496343612670898  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6598539352416992  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6602821350097656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6602821350097656  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6603260040283203  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.666818618774414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.667304515838623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.667304515838623  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6673502922058105  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.674445629119873  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6746883392333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6746883392333984  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6747112274169922  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6784191131591797  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6788463592529297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6788463592529297  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6788825988769531  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.685007095336914  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6923675537109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6923675537109375  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.692941665649414  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.797001838684082  GigaBytes
Max Memory Allocated: 1.8048319816589355  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7765536308288574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7769775390625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7774014472961426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7769560813903809  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21714
output nodes number: 2842
edges number: 23905
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.777139663696289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7771401405334473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04947662353515625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 12 input nodes size: 70342
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045334815979003906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045334815979003906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07887649536132812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07889795303344727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04651689529418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04651689529418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04651689529418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70342, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04651689529418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([829, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12909746170043945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12909746170043945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12988805770874023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1365652084350586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([1132, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13724946975708008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13724946975708008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13832902908325195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15452241897583008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1079, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15552616119384766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15552616119384766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15655517578125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17950773239135742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1043, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1809825897216797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1809825897216797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1819772720336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21082305908203125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([1101, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2129507064819336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2129507064819336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21400070190429688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2528700828552246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([965, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25510597229003906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25510597229003906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2560262680053711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29559898376464844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([921, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29821300506591797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29821300506591797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2990913391113281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.343808650970459  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([848, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3466043472290039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3466043472290039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3474130630493164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39364147186279297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([791, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39663171768188477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39663171768188477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3973860740661621  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44647979736328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([12590, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5066494941711426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5066494941711426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12590, 128]), torch.Size([1, 12590, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5186562538146973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.37113618850708  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12590, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.294753074645996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3150653839111328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3353776931762695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3149065971374512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21299, 256])
first layer input nodes number: 70342
first layer output nodes number: 21299
edges number: 168047
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3359041213989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3562164306640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3612947463989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3612947463989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3842072486877441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3842072486877441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3850140571594238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3914685249328613  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([389, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3918132781982422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3918132781982422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3925552368164062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4039077758789062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4043326377868652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4043326377868652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4048590660095215  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4184761047363281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([205, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4190011024475098  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4190011024475098  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4193921089172363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4307312965393066  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4319210052490234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4319210052490234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4323158264160156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4465293884277344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.447248935699463  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.447248935699463  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.44755220413208  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4605927467346191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.461167812347412  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.461167812347412  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4613738059997559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4716734886169434  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4722933769226074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4722933769226074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4724726676940918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4826922416687012  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4833641052246094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4833641052246094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4835319519042969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4942741394042969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4949979782104492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4949979782104492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4951581954956055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5065336227416992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5072574615478516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5072574615478516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5074024200439453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5187091827392578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5195136070251465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5195136070251465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5196585655212402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.531980037689209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5325326919555664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5325326919555664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532628059387207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5414018630981445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5419197082519531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5419197082519531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5419998168945312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5499305725097656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.550539493560791  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.550539493560791  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5506253242492676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5597233772277832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5602803230285645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5602803230285645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5603547096252441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5687603950500488  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5693116188049316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5693116188049316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569380283355713  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577620029449463  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5783123970031738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5783123970031738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.578392505645752  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5885663032531738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58892822265625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58892822265625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5889701843261719  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5945930480957031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594956874847412  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594956874847412  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5949950218200684  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6003737449645996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6008596420288086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6008596420288086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.600907325744629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6079645156860352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6081733703613281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6081733703613281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608194351196289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6114463806152344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6119003295898438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6119003295898438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6119403839111328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618429183959961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6188015937805176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6188015937805176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6188340187072754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6243138313293457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([287, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6311941146850586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6311941146850586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6317415237426758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.73842191696167  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7194232940673828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7198472023010254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.720271110534668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7198257446289062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21299
output nodes number: 2842
edges number: 23282
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.720005989074707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7200064659118652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04914999008178711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 13 input nodes size: 70794
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07884836196899414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07886981964111328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04530668258666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0467228889465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0467228889465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0467228889465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70794, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0467228889465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([863, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12880277633666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12880277633666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12962579727172852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13697290420532227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([1109, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1376190185546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1376190185546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13867664337158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.154541015625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1126, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15650224685668945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15650224685668945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1575760841369629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18140268325805664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1103, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1829695701599121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1829695701599121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1840214729309082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21512365341186523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1096, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2172107696533203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2172107696533203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21825599670410156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2567424774169922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1021, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2591409683227539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2591409683227539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1021, 128]), torch.Size([1, 1021, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2601146697998047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30278587341308594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1021, 128])
m.shape torch.Size([978, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30556344985961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30556344985961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30649614334106445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35400819778442383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([893, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3569483757019043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3569483757019043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3578000068664551  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4071383476257324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([807, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41017580032348633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41017580032348633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41094541549682617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.46198463439941406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([12325, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5203700065612793  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5203700065612793  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12325, 128]), torch.Size([1, 12325, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5321240425109863  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3666605949401855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12325, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2909245491027832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3112578392028809  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3315911293029785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.311098575592041  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21321, 256])
first layer input nodes number: 70794
first layer output nodes number: 21321
edges number: 166980
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3321208953857422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3524541854858398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3583312034606934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3583312034606934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([444, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3809928894042969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3809928894042969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3818397521972656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3890752792358398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([366, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3893556594848633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3893556594848633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3900537490844727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4034433364868164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4039535522460938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4039535522460938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4045219421386719  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4230356216430664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([198, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235129356384277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235129356384277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4238905906677246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.434842586517334  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.435595989227295  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.435595989227295  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4359698295593262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4494280815124512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4500889778137207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4500889778137207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4503693580627441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.462425708770752  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4631938934326172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4631938934326172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4634513854980469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4763259887695312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4771432876586914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4771432876586914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4773778915405273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4907503128051758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4913945198059082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4913945198059082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4915623664855957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5023045539855957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5030760765075684  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5030760765075684  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5032458305358887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5152983665466309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5157952308654785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5157952308654785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5159001350402832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5240826606750488  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.524768352508545  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.524768352508545  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.524890422821045  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535266399383545  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535780429840088  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535780429840088  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5358681678771973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5439400672912598  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544461727142334  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544461727142334  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544541835784912  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5524725914001465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5530238151550293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5530238151550293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5531020164489746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5613913536071777  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5618600845336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5618600845336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5619230270385742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569035530090332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5695924758911133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5695924758911133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5696611404418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5779008865356445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5783510208129883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5783510208129883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.578404426574707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5851869583129883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5855989456176758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5855989456176758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5856447219848633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5917787551879883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5922365188598633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5922365188598633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5922842025756836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5990076065063477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5994281768798828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5994281768798828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5994701385498047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6056804656982422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6060614585876465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6060614585876465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.60609769821167  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6117148399353027  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6122055053710938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6122055053710938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6122493743896484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6193561553955078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6197032928466797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6197032928466797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6197338104248047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6248912811279297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([284, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.631700038909912  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.631700038909912  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6322417259216309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7444257736206055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.724855899810791  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7252798080444336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7257037162780762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7252583503723145  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21321
output nodes number: 2842
edges number: 23002
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7254390716552734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7254395484924316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04934883117675781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 14 input nodes size: 69676
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04530668258666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04530668258666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07853078842163086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07855224609375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04477357864379883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0461726188659668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0461726188659668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0461726188659668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([69676, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0461726188659668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([860, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12721586227416992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12721586227416992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1280360221862793  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13502836227416992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([1099, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1356663703918457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1356663703918457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13671445846557617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1524357795715332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1195, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15362119674682617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15362119674682617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15476083755493164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17983293533325195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([1064, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18129253387451172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18129253387451172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18230724334716797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21173381805419922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1063, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2137608528137207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2137608528137207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21477460861206055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25203895568847656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([987, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25435590744018555  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25435590744018555  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2552971839904785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2965126037597656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([984, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29932641983032227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29932641983032227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.300264835357666  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3479485511779785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([879, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.350832462310791  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.350832462310791  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3516707420349121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39974069595336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([846, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4029521942138672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4029521942138672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4037590026855469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4566049575805664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([12119, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5139894485473633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5139894485473633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12119, 128]), torch.Size([1, 12119, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5255470275878906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3464574813842773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12119, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2717266082763672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2918453216552734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.312154769897461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2918787002563477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21096, 256])
first layer input nodes number: 69676
first layer output nodes number: 21096
edges number: 164860
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.312675952911377  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3327946662902832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3385734558105469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3385734558105469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.361107349395752  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.361107349395752  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3619256019592285  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3701467514038086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3704452514648438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3704452514648438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3711471557617188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3866639137268066  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3872156143188477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3872156143188477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.387812614440918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.401407241821289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4019660949707031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4019660949707031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4023914337158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4147262573242188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.415412425994873  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.415412425994873  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.415769100189209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4286093711853027  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4293079376220703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4293079376220703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4295978546142578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4420642852783203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4428009986877441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4428009986877441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4430508613586426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4555439949035645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4562110900878906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4562110900878906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4564075469970703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4676055908203125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4683122634887695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4683122634887695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.468489646911621  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.479842185974121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4803977012634277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4803977012634277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4805254936218262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4895987510681152  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490349292755127  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490349292755127  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4904961585998535  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019516944885254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502547264099121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502547264099121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5026578903198242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5120611190795898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126056671142578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126056671142578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126972198486328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5211200714111328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5216937065124512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5216937065124512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5217814445495605  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5304675102233887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5310869216918945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5310869216918945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.531174659729004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5404748916625977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5410618782043457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5410618782043457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.541140079498291  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5499768257141113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5504117012023926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5504117012023926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5504670143127441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5571045875549316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5575270652770996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5575270652770996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5575766563415527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5638747215270996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5643796920776367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5643796920776367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5644350051879883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5718469619750977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57222318649292  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57222318649292  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.572263240814209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5779109001159668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5783147811889648  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5783147811889648  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.578354835510254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5842828750610352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.584580421447754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.584580421447754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.584609031677246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5890436172485352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5893168449401855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5893168449401855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.589341640472412  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5933585166931152  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5937151908874512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5937151908874512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5937457084655762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5989031791687012  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([290, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6058564186096191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6058564186096191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6064095497131348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7073373794555664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6883912086486816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6888151168823242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6892390251159668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.688793659210205  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21096
output nodes number: 2842
edges number: 22884
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6889724731445312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6889729499816895  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.048766136169433594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 15 input nodes size: 70676
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04477357864379883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04477357864379883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07847452163696289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07849597930908203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04525041580200195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04667806625366211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04667806625366211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04667806625366211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70676, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04667806625366211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([808, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12933111190795898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12933111190795898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13010168075561523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13654565811157227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([1066, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1371769905090332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1371769905090332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13819360733032227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1534428596496582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1106, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15451669692993164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15451669692993164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15557146072387695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1793217658996582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1119, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18092870712280273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18092870712280273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18199586868286133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21326589584350586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1057, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21525239944458008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21525239944458008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21626043319702148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2529592514038086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([983, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2552676200866699  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2552676200866699  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25620508193969727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29729795455932617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([907, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29985666275024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29985666275024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3007216453552246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34511661529541016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([909, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34815168380737305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34815168380737305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34901857376098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39936208724975586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([834, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4025077819824219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4025077819824219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4033031463623047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45578575134277344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([12517, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.515934944152832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.515934944152832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12517, 128]), torch.Size([1, 12517, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5278720855712891  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3754091262817383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12517, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2989835739135742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3193025588989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3396215438842773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3191437721252441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21306, 256])
first layer input nodes number: 70676
first layer output nodes number: 21306
edges number: 168214
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3401503562927246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3604693412780762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.365549087524414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.365549087524414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([417, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3883895874023438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3883895874023438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3891849517822266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3956522941589355  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([371, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395967960357666  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395967960357666  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3966755867004395  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4077482223510742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([263, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4081530570983887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4081530570983887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4086546897888184  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4241786003112793  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.42476224899292  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.42476224899292  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4251761436462402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4371790885925293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4384965896606445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4384965896606445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.438887596130371  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4529638290405273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4537029266357422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4537029266357422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4540119171142578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4672985076904297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4680051803588867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4680051803588867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4682493209838867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4804563522338867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4812803268432617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4812803268432617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4815149307250977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.494887351989746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4962944984436035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4962944984436035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4965195655822754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5109238624572754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5116863250732422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5116863250732422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118598937988281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5241832733154297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5248050689697266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5248050689697266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.524932861328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5349006652832031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5355291366577148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5355291366577148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5356435775756836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5453710556030273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545851230621338  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545851230621338  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5459332466125488  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.553478717803955  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5540032386779785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5540032386779785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5540833473205566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562014102935791  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562392234802246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562392234802246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5624475479125977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5683107376098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5688214302062988  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5688214302062988  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5688881874084473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5764317512512207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5768070220947266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5768070220947266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5768547058105469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5825767517089844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5829858779907227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5829858779907227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.583033561706543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5890893936157227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5895590782165527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5895590782165527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5896105766296387  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5965113639831543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969281196594238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969281196594238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969719886779785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6031575202941895  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035799980163574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035799980163574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6036219596862793  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6098322868347168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.610086441040039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.610086441040039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101112365722656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6139545440673828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6141853332519531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6141853332519531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.614206314086914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.617605209350586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6181254386901855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6181254386901855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6181693077087402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6255831718444824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([302, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6328177452087402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6328177452087402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6333937644958496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7443361282348633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7245464324951172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7249703407287598  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7253942489624023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7249488830566406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21306
output nodes number: 2842
edges number: 23215
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7251291275024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7251296043395996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049315452575683594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 16 input nodes size: 70196
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04525041580200195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04525041580200195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07872247695922852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07874393463134766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04502153396606445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04643106460571289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04643106460571289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04643106460571289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70196, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04643106460571289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([832, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12803077697753906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12803077697753906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12882423400878906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1352691650390625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([1067, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13614320755004883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13614320755004883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1371607780456543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15242433547973633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([1107, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15349912643432617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15349912643432617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1545548439025879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1777806282043457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([1085, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17989253997802734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17989253997802734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18092727661132812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21184062957763672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1042, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2138075828552246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2138075828552246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21480131149291992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2515277862548828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([997, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25388336181640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25388336181640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 997, 128]), torch.Size([1, 997, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2548341751098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.296234130859375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 997, 128])
m.shape torch.Size([871, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29866600036621094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29866600036621094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2994966506958008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34104013442993164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([859, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3439016342163086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3439016342163086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34472084045410156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3914213180541992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([739, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3941831588745117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3941831588745117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39488792419433594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4404158592224121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([12460, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4994773864746094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4994773864746094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12460, 128]), torch.Size([1, 12460, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5113601684570312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3550376892089844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12460, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2795662879943848  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.299649715423584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3197331428527832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.299492359161377  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21059, 256])
first layer input nodes number: 70196
first layer output nodes number: 21059
edges number: 166039
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3202581405639648  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3406381607055664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.346282958984375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.346282958984375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([429, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3688931465148926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3688931465148926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3697113990783691  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3764691352844238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([371, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3767733573913574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3767733573913574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3774809837341309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3893542289733887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([273, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3897876739501953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3897876739501953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3903083801269531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4057388305664062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4063243865966797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4063243865966797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4067440032958984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4189128875732422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4203362464904785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4203362464904785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.420729160308838  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4348740577697754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4355545043945312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4355545043945312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4358444213867188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4483108520507812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449101448059082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449101448059082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449366569519043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4626226425170898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4634284973144531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4634284973144531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4636611938476562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4769248962402344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4775094985961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4775094985961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4776639938354492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4875516891479492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4882822036743164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4882822036743164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4884424209594727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4998178482055664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5005836486816406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5005836486816406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5007362365722656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126380920410156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5131616592407227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5131616592407227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513260841369629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5216913223266602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5223040580749512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5223040580749512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5224051475524902  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.531705379486084  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532179832458496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532179832458496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5322542190551758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5396184921264648  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5401291847229004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5401291847229004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5402016639709473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.547884464263916  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5483713150024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5483713150024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548436164855957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5557641983032227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5561566352844238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5561566352844238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556206226348877  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562157154083252  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5625476837158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5625476837158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5625934600830078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5684070587158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5690054893493652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5690054893493652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5690703392028809  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5777602195739746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5783624649047852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5783624649047852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.578425407409668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5873003005981445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5877737998962402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5877737998962402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5878214836120605  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5948786735534668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.595235824584961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.595235824584961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5952701568603516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6005916595458984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6008844375610352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6008844375610352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6009111404418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6052370071411133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6056623458862305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6056623458862305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605698585510254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6118230819702148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([276, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6184368133544922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6184368133544922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6189632415771484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7247600555419922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 276, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7052350044250488  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7056589126586914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.706082820892334  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7056374549865723  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21059
output nodes number: 2842
edges number: 22962
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7058162689208984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7058167457580566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04903984069824219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 17 input nodes size: 70844
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04502153396606445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04502153396606445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07880258560180664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07882404327392578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04533052444458008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04677152633666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04677152633666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04677152633666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70844, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04677152633666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([805, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13014650344848633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13014650344848633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13091421127319336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1370558738708496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([1040, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13778305053710938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13778305053710938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1040, 128]), torch.Size([1, 1040, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13877487182617188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15365219116210938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1040, 128])
m.shape torch.Size([1106, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1547384262084961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1547384262084961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1557931900024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17954349517822266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1093, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18110084533691406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18110084533691406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1821432113647461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21314048767089844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1059, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21514415740966797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21514415740966797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2161540985107422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2530999183654785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([989, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25542449951171875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25542449951171875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25636768341064453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2975921630859375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([851, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2999610900878906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2999610900878906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30077266693115234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34140491485595703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([865, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3442988395690918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3442988395690918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3451237678527832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39214468002319336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([799, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39516115188598633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39516115188598633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3959231376647949  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44482946395874023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([12783, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5054025650024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5054025650024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12783, 128]), torch.Size([1, 12783, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5175933837890625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3831415176391602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12783, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3059186935424805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3263177871704102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3467168807983398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.326158046722412  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21390, 256])
first layer input nodes number: 70844
first layer output nodes number: 21390
edges number: 169702
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3472466468811035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3676457405090332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3727455139160156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3727455139160156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395902156829834  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395902156829834  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3966670036315918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4028019905090332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.403125286102295  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.403125286102295  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.403825283050537  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4144024848937988  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4148688316345215  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4148688316345215  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4154086112976074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4287586212158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.429469108581543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.429469108581543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4299554824829102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4440603256225586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4448342323303223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4448342323303223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4452252388000488  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.459301471710205  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4599308967590332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4599308967590332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4602036476135254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4719319343566895  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4727778434753418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4727778434753418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4730563163757324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4869799613952637  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4875712394714355  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4875712394714355  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4877524375915527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4980807304382324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4986910820007324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4986910820007324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4988455772399902  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5087332725524902  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5093770027160645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5093770027160645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5095200538635254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.519676685333252  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5203771591186523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5203771591186523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5205163955688477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.531376838684082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532022476196289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532022476196289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5321407318115234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5421924591064453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5428333282470703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5428333282470703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5429401397705078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5527667999267578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5531306266784668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5531306266784668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.553189754486084  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5590434074401855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.559518814086914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.559518814086914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5595855712890625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5666618347167969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5671052932739258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5671052932739258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.567164421081543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5738458633422852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5743722915649414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5743722915649414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.574437141418457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582219123840332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582740306854248  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582740306854248  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582801342010498  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590552806854248  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5908513069152832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5908513069152832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5908856391906738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5954861640930176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5958919525146484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5958919525146484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5959339141845703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6018505096435547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6023545265197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6023545265197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6024041175842285  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609743595123291  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6099514961242676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6099514961242676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6099724769592285  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6132245063781738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6134796142578125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6134796142578125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6135025024414062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6172103881835938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6176834106445312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6176834106445312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6177234649658203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6244926452636719  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([327, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6323299407958984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6323299407958984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6329536437988281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7456274032592773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 327, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7254853248596191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7259092330932617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7263331413269043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7258877754211426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21390
output nodes number: 2842
edges number: 23557
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7260689735412598  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.726069450378418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04942893981933594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 18 input nodes size: 70748
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04533052444458008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04533052444458008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07906579971313477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0790872573852539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04528474807739258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0467228889465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0467228889465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0467228889465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70748, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0467228889465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([803, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12984943389892578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12984943389892578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.130615234375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13674163818359375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([1075, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13771390914916992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13771390914916992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13873910903930664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15411710739135742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1132, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15522384643554688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15522384643554688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15630340576171875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18015289306640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1134, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1817760467529297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1817760467529297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18285751342773438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21428489685058594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1120, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2164144515991211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2164144515991211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2174825668334961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2562398910522461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1045, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2586956024169922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2586956024169922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2596921920776367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30271244049072266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([908, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30524492263793945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30524492263793945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30611085891723633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3499569892883301  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([872, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35285043716430664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35285043716430664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3536820411682129  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4019761085510254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([857, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40612268447875977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40612268447875977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4069399833679199  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4592471122741699  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([12539, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5193853378295898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5193853378295898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12539, 128]), torch.Size([1, 12539, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5313434600830078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3803701400756836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12539, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.303553581237793  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3240432739257812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3445329666137695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.323883056640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21485, 256])
first layer input nodes number: 70748
first layer output nodes number: 21485
edges number: 169190
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.345062255859375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3655519485473633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3709311485290527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3709311485290527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3942217826843262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3942217826843262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395007610321045  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.401360034942627  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4016518592834473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4016518592834473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4023308753967285  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413160800933838  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413701057434082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413701057434082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4142827987670898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.429640769958496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4302687644958496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4302687644958496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4307246208190918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4439444541931152  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([164, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444504737854004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444504737854004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4448175430297852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4560785293579102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4568333625793457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4568333625793457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.45713472366333  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4700932502746582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4707436561584473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4707436561584473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.470970630645752  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4823193550109863  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4830288887023926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4830288887023926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4832329750061035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.494865894317627  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4956202507019043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4956202507019043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4958090782165527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5078940391540527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.508549690246582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.508549690246582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5086984634399414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.519261360168457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5198636054992676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5198636054992676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5199856758117676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5295071601867676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530196189880371  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530196189880371  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530320167541504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540858268737793  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5415210723876953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5415210723876953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5416316986083984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551809310913086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5522384643554688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5522384643554688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.55230712890625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5591049194335938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5597915649414062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5597915649414062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5598869323730469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5699958801269531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.570594310760498  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.570594310760498  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5706744194030762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5797266960144043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801444053649902  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801444053649902  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580197811126709  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.586606502532959  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5870299339294434  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5870299339294434  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5870795249938965  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5933775901794434  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.593919277191162  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.593919277191162  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5939784049987793  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6019015312194824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6022372245788574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6022372245788574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6022734642028809  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6073832511901855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.60770845413208  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.60770845413208  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.607740879058838  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6125397682189941  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6127986907958984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6127986907958984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612823486328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6166667938232422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6170082092285156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6170082092285156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6170387268066406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6219825744628906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6224751472473145  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6224751472473145  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6225171089172363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6296086311340332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([318, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6372289657592773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6372289657592773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6378355026245117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7538294792175293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 318, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7335734367370605  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7339973449707031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7344212532043457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.733975887298584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21485
output nodes number: 2842
edges number: 23689
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7341575622558594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7341580390930176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04937887191772461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 19 input nodes size: 70417
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04528474807739258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04528474807739258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07886219024658203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07888364791870117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045126914978027344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046520233154296875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046520233154296875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046520233154296875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70417, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046520233154296875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([817, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1271677017211914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1271677017211914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1279468536376953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13484525680541992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([1054, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13546085357666016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13546085357666016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13646602630615234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15154361724853516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([1092, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1526031494140625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1526031494140625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15364456176757812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17655563354492188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1121, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17890357971191406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17890357971191406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17997264862060547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21126365661621094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1031, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21318721771240234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21318721771240234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2141704559326172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2503933906555176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([946, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2526082992553711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2526082992553711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 946, 128]), torch.Size([1, 946, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2535104751586914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2927560806274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 946, 128])
m.shape torch.Size([912, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2955970764160156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2955970764160156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2964668273925781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3403511047363281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([846, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3431434631347656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3431434631347656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3439502716064453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3907966613769531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([807, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3938565254211426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3938565254211426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3946261405944824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44448280334472656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([12217, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5023531913757324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5023531913757324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12217, 128]), torch.Size([1, 12217, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5140042304992676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3413634300231934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12217, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2668309211730957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2867083549499512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3065857887268066  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.286552906036377  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([20843, 256])
first layer input nodes number: 70417
first layer output nodes number: 20843
edges number: 164101
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.307112693786621  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3269901275634766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3319597244262695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3319597244262695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([399, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3543686866760254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3543686866760254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3551297187805176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3628158569335938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([394, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3631930351257324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3631930351257324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3639445304870605  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3785948753356934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3791217803955078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3791217803955078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3797187805175781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.400075912475586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.400731086730957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.400731086730957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4012041091918945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.414921760559082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4156179428100586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4156179428100586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4159879684448242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4293088912963867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4299545288085938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4299545288085938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4302291870117188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4420394897460938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4426288604736328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4426288604736328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4428348541259766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.453134536743164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4537620544433594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4537620544433594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4539432525634766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4642715454101562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4649858474731445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4649858474731445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.465163230895996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.476515769958496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4772539138793945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4772539138793945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4774179458618164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4890642166137695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.489786148071289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.489786148071289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4899311065673828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5012378692626953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019035339355469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019035339355469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5020256042480469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5124015808105469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5127782821655273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5127782821655273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5128450393676758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.518986701965332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5196127891540527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5196127891540527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5197062492370605  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.528958797454834  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5295467376708984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5295467376708984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5296306610107422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5385265350341797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5390844345092773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5390844345092773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.539158821105957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5475645065307617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5480341911315918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5480341911315918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548093318939209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5551886558532715  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5557823181152344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5557823181152344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5558509826660156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5645713806152344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565030574798584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565030574798584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.56508207321167  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5719828605651855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.572399616241455  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.572399616241455  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5724434852600098  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5786290168762207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5790109634399414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5790109634399414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5790491104125977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846948623657227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5849084854125977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5849084854125977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5849294662475586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588181495666504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588569164276123  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588569164276123  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5886034965515137  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594165325164795  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59437894821167  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59437894821167  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594398021697998  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5976214408874512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6044602394104004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6044602394104004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605003833770752  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7021522521972656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6827893257141113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.683213233947754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6836371421813965  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6831917762756348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 20843
output nodes number: 2842
edges number: 22783
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6833686828613281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6833691596984863  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04910707473754883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 20 input nodes size: 70980
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045126914978027344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045126914978027344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07897281646728516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0789942741394043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0453953742980957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04683828353881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04683828353881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04683828353881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70980, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04683828353881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([764, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1302165985107422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1302165985107422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13094520568847656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13677406311035156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([1045, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1374979019165039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1374979019165039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13849449157714844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1534433364868164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([1149, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1545886993408203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1545886993408203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1556844711303711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17979145050048828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1122, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18138360977172852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18138360977172852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18245363235473633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21370363235473633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1078, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21573877334594727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21573877334594727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2167668342590332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25386953353881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([1012, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25625085830688477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25625085830688477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1012, 128]), torch.Size([1, 1012, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2572159767150879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29982995986938477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1012, 128])
m.shape torch.Size([994, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30266523361206055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30266523361206055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30361318588256836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35158300399780273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([860, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35438966751098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35438966751098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3552098274230957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40216875076293945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([859, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4054450988769531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4054450988769531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4062643051147461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4586935043334961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([12593, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5188307762145996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5188307762145996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12593, 128]), torch.Size([1, 12593, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5308403968811035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3835234642028809  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12593, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3064112663269043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.326892375946045  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3473734855651855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3267321586608887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21476, 256])
first layer input nodes number: 70980
first layer output nodes number: 21476
edges number: 169750
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3479046821594238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3683857917785645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3737201690673828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3737201690673828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3970322608947754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3970322608947754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3978066444396973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4040098190307617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([334, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4042649269104004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4042649269104004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4049019813537598  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.414980411529541  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4155645370483398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4155645370483398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4161615371704102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.430891990661621  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4314894676208496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4314894676208496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.431933879852295  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444821834564209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.445474624633789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.445474624633789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.445821762084961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4583187103271484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4589757919311523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4589757919311523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4592504501342773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4710607528686523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4718384742736816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4718384742736816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4720978736877441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4850678443908691  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.485722541809082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.485722541809082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.485917091369629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4970064163208008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([116, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.49794340133667  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.49794340133667  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4981646537780762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5123248100280762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5129547119140625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5129547119140625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513101577758789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523529052734375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5242066383361816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5242066383361816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5243420600891113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.534904956817627  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5354948043823242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5354948043823242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5356035232543945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544844627380371  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5454649925231934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5454649925231934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5455679893493652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5550436973571777  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5555577278137207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5555577278137207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5556378364562988  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5635685920715332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564134120941162  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564134120941162  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5642142295837402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5727057456970215  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5732502937316895  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5732502937316895  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5733227729797363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5815129280090332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5820159912109375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5820159912109375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5820789337158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5896320343017578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5902061462402344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5902061462402344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5902729034423828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5987510681152344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5992112159729004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5992112159729004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5992627143859863  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.606163501739502  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.606522560119629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.606522560119629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6065607070922852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6119394302368164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6123847961425781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6123847961425781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6124286651611328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6189212799072266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6192588806152344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6192588806152344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6192913055419922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6243171691894531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6246109008789062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6246109008789062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6246376037597656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6289634704589844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629204273223877  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629204273223877  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629225254058838  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6327710151672363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640561580657959  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640561580657959  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.641162395477295  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.754225730895996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.733945369720459  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7343692779541016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7347931861877441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7343478202819824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21476
output nodes number: 2842
edges number: 23716
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7345294952392578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.734529972076416  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04950094223022461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 21 input nodes size: 70028
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0453953742980957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0453953742980957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07878732681274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07880878448486328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494142532348633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04635000228881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04635000228881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04635000228881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70028, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04635000228881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([832, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1278667449951172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1278667449951172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1286602020263672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1350078582763672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([1047, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13596391677856445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13596391677856445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1369624137878418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15193986892700195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([1108, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15302562713623047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15302562713623047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1540822982788086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17800617218017578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1111, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18010234832763672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18010234832763672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18116188049316406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21234798431396484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1070, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2143692970275879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2143692970275879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21538972854614258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25254392623901367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([1004, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25490617752075195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25490617752075195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1004, 128]), torch.Size([1, 1004, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25586366653442383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29741716384887695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1004, 128])
m.shape torch.Size([969, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3001728057861328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3001728057861328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 969, 128]), torch.Size([1, 969, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30109691619873047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3473024368286133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 969, 128])
m.shape torch.Size([874, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3501744270324707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3501744270324707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35100793838500977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3989872932434082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([806, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40202951431274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40202951431274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4027981758117676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4519925117492676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([12277, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5101494789123535  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5101494789123535  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12277, 128]), torch.Size([1, 12277, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.521857738494873  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3531651496887207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12277, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2778806686401367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2980012893676758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3181219100952148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2978439331054688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21098, 256])
first layer input nodes number: 70028
first layer output nodes number: 21098
edges number: 165867
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.31864595413208  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3387665748596191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.344620704650879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.344620704650879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([445, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3673901557922363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3673901557922363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.368238925933838  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3758430480957031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([357, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3761053085327148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3761053085327148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.376786231994629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3901281356811523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3906183242797852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3906183242797852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3911676406860352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4080047607421875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([207, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4085259437561035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4085259437561035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4089207649230957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4203705787658691  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4212303161621094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4212303161621094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4216270446777344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4359092712402344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4366455078125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4366455078125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4369544982910156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4502410888671875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4510555267333984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4510555267333984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4513301849365234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4650630950927734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4657025337219238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4657025337219238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.465895175933838  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4768757820129395  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4775581359863281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4775581359863281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4777297973632812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4887161254882812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4894089698791504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4894089698791504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4895634651184082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.500532627105713  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5011215209960938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5011215209960938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.501241683959961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5106143951416016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.51121187210083  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.51121187210083  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5113205909729004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.520561695098877  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521094799041748  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521094799041748  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5211844444274902  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5294318199157715  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5298986434936523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5298986434936523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5299711227416992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5371465682983398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5376005172729492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5376005172729492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5376653671264648  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544539451599121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545060634613037  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545060634613037  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5451292991638184  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5528883934020996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5533442497253418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5533442497253418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5534014701843262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5602679252624512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.560654640197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.560654640197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5607004165649414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566514015197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566911220550537  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566911220550537  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5669550895690918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57283353805542  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5733695030212402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5733695030212402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5734248161315918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581223964691162  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581620216369629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581620216369629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581660270690918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5875883102416992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588076114654541  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588076114654541  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5881218910217285  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.595217227935791  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955042839050293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955042839050293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955309867858887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5998568534851074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.600235939025879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.600235939025879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6002683639526367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605748176574707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([302, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6136112213134766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6136112213134766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.614187240600586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7357239723205566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 302, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7160310745239258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7164549827575684  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.716878890991211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7164335250854492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21098
output nodes number: 2842
edges number: 23113
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7166123390197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7166128158569336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04895782470703125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 22 input nodes size: 71439
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494142532348633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494142532348633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07900619506835938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07902765274047852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04561424255371094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.047069549560546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.047069549560546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.047069549560546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([71439, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.047069549560546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([874, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1316080093383789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1316080093383789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13244152069091797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13910961151123047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([1051, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1397843360900879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1397843360900879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14078664779663086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1558213233947754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1085, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1578226089477539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1578226089477539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1588573455810547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1825275421142578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1143, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1841902732849121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1841902732849121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18528032302856445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21689176559448242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([1086, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21893596649169922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21893596649169922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2199716567993164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2581644058227539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2604846954345703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2604846954345703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2614307403564453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30272769927978516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([965, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30547571182250977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30547571182250977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3063960075378418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35241079330444336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([896, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35536861419677734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35536861419677734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35622310638427734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40573596954345703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([821, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40945911407470703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40945911407470703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41024208068847656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.46183204650878906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([12781, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5223851203918457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5223851203918457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12781, 128]), torch.Size([1, 12781, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.534574031829834  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.399986743927002  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12781, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3217964172363281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3424854278564453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3631744384765625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3423237800598145  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21694, 256])
first layer input nodes number: 71439
first layer output nodes number: 21694
edges number: 171307
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3637089729309082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3843979835510254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3904924392700195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3904924392700195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4139518737792969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4139518737792969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.414724349975586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.420914649963379  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([344, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.421189785003662  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.421189785003662  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4218459129333496  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4320931434631348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4325814247131348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4325814247131348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4331212043762207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4460721015930176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4466557502746582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4466557502746582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4470791816711426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4593586921691895  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4601678848266602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4601678848266602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4605588912963867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.474635124206543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4752531051635742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4752531051635742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4755220413208008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.487086296081543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4877862930297852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4877862930297852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.488022804260254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4998483657836914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5005912780761719  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5005912780761719  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5008049011230469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5129814147949219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5138006210327148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5138006210327148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5140047073364258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5270662307739258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5276851654052734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5276851654052734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5278282165527344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.537984848022461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5387487411499023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5387487411499023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5388994216918945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5506525039672852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.55137300491333  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.55137300491333  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5515046119689941  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5626912117004395  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5633130073547363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5633130073547363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.563417911529541  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5730690956115723  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5736894607543945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5736894607543945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5737848281860352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.583226203918457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5839571952819824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5839571952819824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5840601921081543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594977855682373  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5954957008361816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5954957008361816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955662727355957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035408973693848  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6039795875549316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6039795875549316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6040349006652832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6106724739074707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6110601425170898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6110601425170898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111059188842773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6169195175170898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6173715591430664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6173715591430664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6174211502075195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6240663528442383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6243877410888672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6243877410888672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6244220733642578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629262924194336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6296091079711914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6296091079711914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629643440246582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6347246170043945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6350884437561035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6350884437561035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6351227760314941  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640444278717041  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6408252716064453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6408252716064453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640859603881836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6464214324951172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6467275619506836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6467275619506836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.646754264831543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6512670516967773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.658823013305664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.658823013305664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.659423828125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.766510009765625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7460823059082031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7465062141418457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7469301223754883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7464847564697266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21694
output nodes number: 2842
edges number: 23870
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7466678619384766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7466683387756348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049753665924072266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 23 input nodes size: 70866
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04561424255371094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04561424255371094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0794057846069336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07942724227905273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04534101486206055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04677248001098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04677248001098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04677248001098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70866, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04677248001098633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([824, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12958812713623047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12958812713623047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13037395477294922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13675737380981445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([1060, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1373753547668457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1373753547668457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13838624954223633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1535496711730957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([1104, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15462350845336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15462350845336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15567636489868164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17941904067993164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1068, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18092966079711914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18092966079711914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18194818496704102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2114853858947754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([1099, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21359634399414062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21359634399414062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2146444320678711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2534193992614746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([998, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2557506561279297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2557506561279297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2567024230957031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2981243133544922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([944, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3007993698120117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3007993698120117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3016996383666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3467130661010742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([897, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3496847152709961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3496847152709961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3505401611328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40033435821533203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([772, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40321969985961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40321969985961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40395593643188477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45171213150024414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([12579, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5118908882141113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5118908882141113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12579, 128]), torch.Size([1, 12579, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5238871574401855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375622272491455  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12579, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2990336418151855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.319389820098877  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3397459983825684  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.319230556488037  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21345, 256])
first layer input nodes number: 70866
first layer output nodes number: 21345
edges number: 168533
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3402762413024902  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3606324195861816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3657217025756836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3657217025756836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([408, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3887720108032227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3887720108032227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3895502090454102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3959970474243164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3963022232055664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3963022232055664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3969907760620117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.407444953918457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4079198837280273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4079198837280273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.408461570739746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4229226112365723  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235129356384277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235129356384277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4239401817321777  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4363303184509277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4370970726013184  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4370970726013184  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.437486171722412  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.451493740081787  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4522395133972168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4522395133972168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4525504112243652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.465919017791748  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4665913581848145  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4665913581848145  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4668259620666504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4785561561584473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4793000221252441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4793000221252441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4795136451721191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4916901588439941  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4923362731933594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4923362731933594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492502212524414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.503122329711914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5038948059082031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5038948059082031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5040645599365234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5161170959472656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5168676376342773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5168676376342773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5170183181762695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5287714004516602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5293073654174805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5293073654174805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5294084548950195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5380010604858398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5385756492614746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5385756492614746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5386710166931152  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5474448204040527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548029899597168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548029899597168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5481195449829102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5569944381713867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5575122833251953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5575122833251953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557586669921875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5654716491699219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5660343170166016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5660343170166016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5661087036132812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.574514389038086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5748858451843262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5748858451843262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5749335289001465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580655574798584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5811681747436523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5811681747436523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5812273025512695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5887365341186523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5890908241271973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5890908241271973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5891308784484863  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5944981575012207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5950932502746582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5950932502746582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5951542854309082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6037602424621582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6042346954345703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6042346954345703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6042823791503906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6113395690917969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.611654281616211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.611654281616211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.611684799194336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.616415023803711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6166210174560547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6166210174560547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6166400909423828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.619729995727539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6200666427612305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6200666427612305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6200952529907227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6249303817749023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.63277006149292  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.63277006149292  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6333518028259277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7444534301757812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7244443893432617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7248682975769043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7252922058105469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7248468399047852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21345
output nodes number: 2842
edges number: 23442
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7250275611877441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7250280380249023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049417972564697266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 24 input nodes size: 69522
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04534101486206055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04534101486206055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0784916877746582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07851314544677734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04470014572143555  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04609823226928711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04609823226928711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04609823226928711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([69522, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04609823226928711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([817, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12704133987426758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12704133987426758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12782049179077148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13487482070922852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([1041, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13547801971435547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13547801971435547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13647079467773438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15136241912841797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([1122, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15247106552124023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15247106552124023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15354108810424805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17782163619995117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1073, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17933320999145508  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17933320999145508  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18035650253295898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21048974990844727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1051, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21248388290405273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21248388290405273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2134861946105957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2504739761352539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([939, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25265932083129883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25265932083129883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2535548210144043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2927870750427246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([952, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29575157165527344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29575157165527344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2966594696044922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3420543670654297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([887, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3449840545654297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3449840545654297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34582996368408203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3957653045654297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([744, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39853525161743164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39853525161743164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3992447853088379  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4455094337463379  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([12281, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5037150382995605  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5037150382995605  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12281, 128]), torch.Size([1, 12281, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5154271125793457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3469977378845215  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12281, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2721748352050781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2921133041381836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3127832412719727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2926888465881348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([20907, 256])
first layer input nodes number: 69522
first layer output nodes number: 20907
edges number: 164712
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3133034706115723  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3332419395446777  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3382267951965332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3382267951965332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([426, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3607444763183594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3607444763183594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3615570068359375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3690714836120605  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([381, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3693976402282715  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3693976402282715  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.370124340057373  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3840899467468262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3845572471618652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3845572471618652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3851065635681152  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.402961254119873  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4035634994506836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4035634994506836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4039983749389648  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.416609764099121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4174838066101074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4174838066101074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4178900718688965  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4325156211853027  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4331779479980469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4331779479980469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4334640502929688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4457664489746094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4465117454528809  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4465117454528809  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.446763515472412  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4593520164489746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4599876403808594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4599876403808594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4601764678955078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4709396362304688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4715805053710938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4715805053710938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4717426300048828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4821186065673828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4827585220336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4827585220336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4829015731811523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.493058204650879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.493727207183838  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.493727207183838  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4938607215881348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.504274845123291  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.504958152770996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.504958152770996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.505082130432129  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.515620231628418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516158103942871  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516158103942871  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516249656677246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.524672508239746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5250844955444336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5250844955444336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5251493453979492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.531569480895996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5321426391601562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5321426391601562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5322227478027344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5407142639160156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.541182041168213  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.541182041168213  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5412449836730957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5483574867248535  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5489144325256348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5489144325256348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548983097076416  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557222843170166  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5577077865600586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5577077865600586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.557765007019043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5650320053100586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5654420852661133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5654420852661133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5654878616333008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5716218948364258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5719642639160156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5719642639160156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.572000503540039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5771102905273438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5775766372680664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5775766372680664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577622413635254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.584397315979004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846705436706543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846705436706543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846972465515137  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5888361930847168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5891547203063965  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5891547203063965  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5891833305358887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.593818187713623  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5942654609680176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5942654609680176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5943036079406738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.60075044631958  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6077237129211426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6077237129211426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608278751373291  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7264385223388672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7069878578186035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.707411766052246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7078356742858887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.707390308380127  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 20907
output nodes number: 2842
edges number: 22868
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7075676918029785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7075681686401367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04868602752685547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 25 input nodes size: 70102
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04470014572143555  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04470014572143555  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07812738418579102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07814884185791016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04497671127319336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04638338088989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04638338088989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04638338088989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70102, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04638338088989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([822, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12772798538208008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12772798538208008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12851190567016602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13478326797485352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([1055, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13593292236328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13593292236328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13693904876708984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15203094482421875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([1221, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1532745361328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1532745361328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1221, 128]), torch.Size([1, 1221, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15443897247314453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18120336532592773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1221, 128])
m.shape torch.Size([1129, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18277454376220703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18277454376220703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1129, 128]), torch.Size([1, 1129, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1838512420654297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2152261734008789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1129, 128])
m.shape torch.Size([1089, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2172842025756836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2172842025756836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21832275390625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2565608024597168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([984, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25885677337646484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25885677337646484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2597951889038086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30090999603271484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([928, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30353832244873047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30353832244873047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30442333221435547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34902477264404297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([850, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3518247604370117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3518247604370117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35263538360595703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39891719818115234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([825, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4020524024963379  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4020524024963379  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40283918380737305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45449018478393555  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([12233, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5124282836914062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5124282836914062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12233, 128]), torch.Size([1, 12233, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5240945816040039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3525066375732422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12233, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.277428150177002  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2975850105285645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.317741870880127  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2974271774291992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21136, 256])
first layer input nodes number: 70102
first layer output nodes number: 21136
edges number: 165511
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3182663917541504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.338423252105713  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3434624671936035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3434624671936035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3661389350891113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3661389350891113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3669228553771973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3744778633117676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3747668266296387  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3747668266296387  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3754420280456543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3891692161560059  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3897171020507812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3897171020507812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3903026580810547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4096031188964844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4102678298950195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4102678298950195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4107427597045898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.424515724182129  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([180, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4251437187194824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4251437187194824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4254870414733887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4378466606140137  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4385919570922852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4385919570922852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4388952255249023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4519357681274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.452578067779541  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.452578067779541  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.452803134918213  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4640564918518066  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.464789867401123  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.464789867401123  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4649996757507324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4769587516784668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4776496887207031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4776496887207031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4778251647949219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4890556335449219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4897947311401367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4897947311401367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4899587631225586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5016050338745117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5022106170654297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5022106170654297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5023345947265625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5120048522949219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5125775337219238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5125775337219238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126824378967285  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521599292755127  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5223093032836914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5223093032836914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522425651550293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5331296920776367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5337848663330078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5337848663330078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5338859558105469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.543893814086914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544492244720459  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544492244720459  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5445780754089355  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5536761283874512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5541715621948242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5541715621948242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5542383193969727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561781883239746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5623044967651367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5623044967651367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5623693466186523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701513290405273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5706901550292969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5706901550292969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5707530975341797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5787467956542969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5791902542114258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5791902542114258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.579239845275879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5858850479125977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5862064361572266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5862064361572266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5862407684326172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5910816192626953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5914483070373535  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5914483070373535  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.591484546661377  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5968480110168457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5972528457641602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5972528457641602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5972909927368164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6032037734985352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6034502983093262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6034502983093262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.60347318649292  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6071810722351074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6076083183288574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6076083183288574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6076445579528809  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6137690544128418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6205029487609863  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6205029487609863  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6210389137268066  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7174997329711914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6978874206542969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6983113288879395  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.698735237121582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6982898712158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21136
output nodes number: 2842
edges number: 23051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6984691619873047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.698469638824463  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04899168014526367  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 26 input nodes size: 71402
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04497671127319336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04497671127319336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07902383804321289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07904529571533203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04559659957885742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04704904556274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04704904556274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04704904556274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([71402, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04704904556274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([785, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13154029846191406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13154029846191406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13228893280029297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13827800750732422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([1113, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13901281356811523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13901281356811523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1400742530822754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15599584579467773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1131, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15776729583740234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15776729583740234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1588459014892578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1826915740966797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1090, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18423128128051758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18423128128051758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1852707862854004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21623659133911133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1098, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21833467483520508  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21833467483520508  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21938180923461914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2579817771911621  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([952, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26018190383911133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26018190383911133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2610898017883301  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30012941360473633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([893, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3026561737060547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3026561737060547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30350780487060547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3469057083129883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([858, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34975290298461914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34975290298461914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3505711555480957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39721155166625977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([814, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4002957344055176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4002957344055176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40107202529907227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4516634941101074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([12850, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5125489234924316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5125489234924316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12850, 128]), torch.Size([1, 12850, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.524803638458252  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4213242530822754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12850, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3430490493774414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.363633155822754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3842172622680664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3634719848632812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21584, 256])
first layer input nodes number: 71402
first layer output nodes number: 21584
edges number: 170907
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.384751319885254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4053354263305664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4104814529418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4104814529418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([379, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4338841438293457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4338841438293457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4346070289611816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.440474033355713  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4408354759216309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4408354759216309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4415526390075684  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4523100852966309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4528107643127441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4528107643127441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4533791542053223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4661364555358887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466721534729004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466721534729004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4671525955200195  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4796533584594727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4804420471191406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4804420471191406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4808349609375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4949798583984375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4956426620483398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4956426620483398  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.495926856994629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5081472396850586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5088934898376465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5088934898376465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5091452598571777  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5217337608337402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5224385261535645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5224385261535645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5226445198059082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.534386157989502  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5350275039672852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5350275039672852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535191535949707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545689582824707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.54640531539917  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.54640531539917  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5465636253356934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5578036308288574  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5585174560546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5585174560546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5586605072021484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5698184967041016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703930854797363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703930854797363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5704998970031738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5795788764953613  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5800881385803223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5800881385803223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801739692687988  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5880703926086426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5886330604553223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5886330604553223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5887188911437988  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5972161293029785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5976781845092773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5976781845092773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5977449417114258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6048212051391602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6053876876831055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6053876876831055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6054620742797852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6138677597045898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.61433744430542  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.61433744430542  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.614396572113037  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6214919090270996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6218256950378418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6218256950378418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6218657493591309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6269526481628418  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6273894309997559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6273894309997559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6274371147155762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.633826732635498  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6342835426330566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6342835426330566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.634331226348877  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.641054630279541  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6414752006530762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6414752006530762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.641517162322998  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6477274894714355  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.648087501525879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.648087501525879  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6481218338012695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6534433364868164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.653890609741211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.653890609741211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6539306640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6604194641113281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.660745620727539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.660745620727539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6607742309570312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.665609359741211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([326, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6734285354614258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6734285354614258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6740503311157227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7874393463134766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 326, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7670326232910156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7674565315246582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7678804397583008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.767435073852539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21584
output nodes number: 2842
edges number: 23837
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7676177024841309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.767618179321289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0497279167175293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 27 input nodes size: 70937
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04559659957885742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04559659957885742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0794219970703125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07944345474243164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04537487030029297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046807289123535156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046807289123535156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046807289123535156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70937, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046807289123535156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([798, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1296405792236328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1296405792236328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.130401611328125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13660860061645508  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([1125, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13730096817016602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13730096817016602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13837385177612305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15446710586547852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1131, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15647029876708984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15647029876708984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1575489044189453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1813945770263672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1089, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18293237686157227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18293237686157227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18397092819213867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21492624282836914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1095, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21701765060424805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21701765060424805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2180619239807129  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25664806365966797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([959, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25886964797973633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25886964797973633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2597842216491699  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29911088943481445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([920, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3017244338989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3017244338989258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30260181427001953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34721851348876953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([863, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35007190704345703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35007190704345703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3508949279785156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39780712127685547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([809, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4008674621582031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4008674621582031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4016389846801758  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4511089324951172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([12594, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5112700462341309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5112700462341309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12594, 128]), torch.Size([1, 12594, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5232806205749512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3760313987731934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12594, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2994260787963867  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3198184967041016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3402109146118164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3196587562561035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21383, 256])
first layer input nodes number: 70937
first layer output nodes number: 21383
edges number: 168591
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3407416343688965  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3611340522766113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3662323951721191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3662323951721191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3893513679504395  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3893513679504395  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3901371955871582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3964238166809082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([394, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3967885971069336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3967885971069336  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3975400924682617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4088869094848633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409341812133789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409341812133789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409891128540039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4238743782043457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([198, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.424361228942871  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.424361228942871  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.424738883972168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4356908798217773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4363622665405273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4363622665405273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4367036819458008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4489946365356445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449758529663086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449758529663086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4500675201416016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4633541107177734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4641213417053223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4641213417053223  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4643826484680176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4774479866027832  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4781556129455566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4781556129455566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4783635139465332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4902138710021973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4908714294433594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4908714294433594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4910392761230469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5017814636230469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5024280548095703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5024280548095703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502573013305664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5128650665283203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5134167671203613  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5134167671203613  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5135293006896973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5223069190979004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5229430198669434  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5229430198669434  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523057460784912  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5327849388122559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5335025787353516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5335025787353516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.533620834350586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5445003509521484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5450468063354492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5450468063354492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5451326370239258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5536298751831055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5542502403259277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5542502403259277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.554337978363037  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5636382102966309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5640406608581543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5640406608581543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5640959739685059  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703463554382324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5709400177001953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5709400177001953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5710124969482422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5797100067138672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801582336425781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801582336425781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5802116394042969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5869941711425781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.587442398071289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.587442398071289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5874919891357422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594137191772461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5947084426879883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5947084426879883  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5947675704956055  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603104591369629  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035194396972656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035194396972656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035614013671875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609771728515625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101951599121094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101951599121094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6102352142333984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6164436340332031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6167774200439453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6167774200439453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6168079376220703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6217517852783203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6220135688781738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6220135688781738  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6220364570617676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6259045600891113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([304, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6331977844238281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6331977844238281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6337776184082031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.744856834411621  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7247838973999023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.725207805633545  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7256317138671875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7251863479614258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21383
output nodes number: 2842
edges number: 23509
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.725367546081543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7253680229187012  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049456119537353516  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 28 input nodes size: 69598
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04537487030029297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04537487030029297  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07856178283691406  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0785832405090332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044736385345458984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04611063003540039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04611063003540039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04611063003540039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([69598, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04611063003540039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([823, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1256399154663086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1256399154663086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12642478942871094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1331033706665039  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([1057, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13445043563842773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13445043563842773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13545846939086914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15057897567749023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([1109, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15166139602661133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15166139602661133  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15271902084350586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17598676681518555  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1147, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17764568328857422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17764568328857422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1787395477294922  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21081066131591797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([1071, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21281719207763672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21281719207763672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2138385772705078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2508091926574707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([906, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25289058685302734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25289058685302734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2537546157836914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29120922088623047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([908, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2947559356689453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2947559356689453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2956218719482422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3393993377685547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([852, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34221649169921875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34221649169921875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 852, 128]), torch.Size([1, 852, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3430290222167969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.38999176025390625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 852, 128])
m.shape torch.Size([785, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39295434951782227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39295434951782227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39370298385620117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.441802978515625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([11992, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4986109733581543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4986109733581543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 11992, 128]), torch.Size([1, 11992, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.510047435760498  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3226008415222168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 11992, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2491841316223145  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2688775062561035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2885708808898926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.268723487854004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([20650, 256])
first layer input nodes number: 69598
first layer output nodes number: 20650
edges number: 161800
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2890915870666504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3087849617004395  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3144822120666504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3144822120666504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([449, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.336575984954834  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.336575984954834  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3374323844909668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3460040092468262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3463101387023926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3463101387023926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.347038745880127  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.361645221710205  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([273, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3620681762695312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3620681762695312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.362588882446289  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375108242034912  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3757705688476562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3757705688476562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3762283325195312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3895034790039062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3901972770690918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3901972770690918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3905634880065918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4037470817565918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4044232368469238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4044232368469238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.404707431793213  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4169278144836426  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4177212715148926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4177212715148926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4179863929748535  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4312424659729004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4318714141845703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4318714141845703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4320602416992188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4428234100341797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4435076713562012  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4435076713562012  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4436793327331543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4546656608581543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4554643630981445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4554643630981445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4556398391723633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4680986404418945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.468677043914795  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.468677043914795  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.468797206878662  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4781699180603027  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.478813648223877  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.478813648223877  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4789299964904785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4888195991516113  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4893865585327148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4893865585327148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4894819259643555  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.498255729675293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4989213943481445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4989213943481445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4990224838256836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5090303421020508  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5094413757324219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5094413757324219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5095024108886719  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5159721374511719  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5164799690246582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5164799690246582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5165467262268066  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.52409029006958  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.524498462677002  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.524498462677002  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.524549961090088  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5307297706604004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5313096046447754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5313096046447754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5313763618469238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5398545265197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5402412414550781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5402412414550781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5402851104736328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546163558959961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546468734741211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546468734741211  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5465011596679688  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5510730743408203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5515213012695312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5515213012695312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551565170288086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5580577850341797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5582475662231445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5582475662231445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5582666397094727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561223030090332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5617222785949707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5617222785949707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5617661476135254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5688729286193848  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5692200660705566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5692200660705566  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5692505836486816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5744080543518066  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([269, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5808568000793457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5808568000793457  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5813698768615723  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6861720085144043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 269, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6671857833862305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.667609691619873  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6680335998535156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.667588233947754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 20650
output nodes number: 2842
edges number: 22405
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6677637100219727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6677641868591309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04866647720336914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 29 input nodes size: 71033
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044736385345458984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044736385345458984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07860755920410156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0786290168762207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04542064666748047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04685211181640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04685211181640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04685211181640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([71033, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04685211181640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([860, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12972497940063477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12972497940063477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13054513931274414  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13710641860961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([1055, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13832664489746094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13832664489746094  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13933277130126953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15442466735839844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([1121, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15645837783813477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15645837783813477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15752744674682617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1813349723815918  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1070, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18284130096435547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18284130096435547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18386173248291016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2134542465209961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([1051, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21544981002807617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21544981002807617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21645212173461914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25337886810302734  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1012, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25577306747436523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25577306747436523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1012, 128]), torch.Size([1, 1012, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25673818588256836  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29846715927124023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1012, 128])
m.shape torch.Size([979, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3012523651123047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3012523651123047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3021860122680664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34972667694091797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([883, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.352628231048584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.352628231048584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3534703254699707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40155935287475586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([854, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40551185607910156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40551185607910156  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4063262939453125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4584503173828125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([12507, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.518589973449707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.518589973449707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12507, 128]), torch.Size([1, 12507, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.530517578125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3773775100708008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12507, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3008079528808594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3212089538574219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3416099548339844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3210492134094238  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21392, 256])
first layer input nodes number: 71033
first layer output nodes number: 21392
edges number: 168613
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3421411514282227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3625421524047852  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3679652214050293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3679652214050293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([451, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.390995979309082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.390995979309082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3918561935424805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.398737907409668  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.398984432220459  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.398984432220459  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.399655818939209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4108366966247559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([268, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4112739562988281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4112739562988281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4117851257324219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4262309074401855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([210, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4267830848693848  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4267830848693848  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4271836280822754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4387993812561035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4395217895507812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4395217895507812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4398880004882812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4530715942382812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4538345336914062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4538345336914062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4541473388671875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4675979614257812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4682960510253906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4682960510253906  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4685382843017578  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4806499481201172  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.481290340423584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.481290340423584  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4814791679382324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4922423362731934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4931254386901855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4931254386901855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4933409690856934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5071349143981934  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5078539848327637  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5078539848327637  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5080180168151855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5196642875671387  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.520174503326416  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.520174503326416  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5202813148498535  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5286126136779785  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5292973518371582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5292973518371582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5294194221496582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5397953987121582  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5403342247009277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5403342247009277  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5404257774353027  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5488486289978027  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5494084358215332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5494084358215332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5494942665100098  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5579915046691895  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5586695671081543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5586695671081543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.558764934539795  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5688738822937012  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5693340301513672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5693340301513672  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.56939697265625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5765094757080078  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5768704414367676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5768704414367676  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576916217803955  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582409381866455  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5828886032104492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5828886032104492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5829439163208008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5899686813354492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5904345512390137  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5904345512390137  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5904860496520996  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5973868370056152  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5979762077331543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5979762077331543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5980372428894043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066431999206543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6071982383728027  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6071982383728027  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072535514831543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6154398918151855  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.615856647491455  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.615856647491455  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6158967018127441  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6221051216125488  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6223950386047363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6223950386047363  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6224217414855957  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6267476081848145  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6270341873168945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6270341873168945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.627058982849121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6312494277954102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6383256912231445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6383256912231445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6388883590698242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7522811889648438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7323417663574219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7327656745910645  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.733189582824707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7327442169189453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2842, 40])
input nodes number: 21392
output nodes number: 2842
edges number: 23380
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7329254150390625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7329258918762207  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04949951171875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 30 input nodes size: 70247
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04542064666748047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04542064666748047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07891702651977539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07893848419189453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04504585266113281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04646110534667969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04646110534667969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04646110534667969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([70247, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04646110534667969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([769, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1282634735107422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1282634735107422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1289968490600586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1350569725036621  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([1132, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13585662841796875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13585662841796875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13693618774414062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15312957763671875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1149, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15423345565795898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15423345565795898  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15532922744750977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17943620681762695  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1085, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18095779418945312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18095779418945312  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1819925308227539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2129058837890625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1100, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2150111198425293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2150111198425293  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21606016159057617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2547125816345215  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1039, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25716066360473633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25716066360473633  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1039, 128]), torch.Size([1, 1039, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2581515312194824  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30124807357788086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1039, 128])
m.shape torch.Size([882, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3036966323852539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3036966323852539  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 882, 128]), torch.Size([1, 882, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3045377731323242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3474559783935547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 882, 128])
m.shape torch.Size([858, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3503084182739258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3503084182739258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35112667083740234  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3977670669555664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([782, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4007139205932617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4007139205932617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4014596939086914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44975852966308594  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([12388, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5084562301635742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5084562301635742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12388, 128]), torch.Size([1, 12388, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5204706192016602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3592729568481445  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12388, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2836670875549316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3038697242736816  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3240723609924316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3037118911743164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21184, 256])
first layer input nodes number: 70247
first layer output nodes number: 21184
edges number: 166510
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3245978355407715  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3448004722595215  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.349851131439209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.349851131439209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3727593421936035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3727593421936035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3735318183898926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.380363941192627  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38069486618042  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38069486618042  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.381406307220459  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3935046195983887  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([296, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3940024375915527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3940024375915527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3945670127868652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4121990203857422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4127821922302246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4127821922302246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4132113456726074  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.425656795501709  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4264764785766602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4264764785766602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4268712997436523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.441084861755371  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4418563842773438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4418563842773438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4421768188476562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4559555053710938  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4565153121948242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4565153121948242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4567193984985352  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466923713684082  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467782974243164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467782974243164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4680213928222656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4816112518310547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4821929931640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4821929931640625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4823474884033203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4922351837158203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492811679840088  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492811679840088  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4929413795471191  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502150058746338  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5027832984924316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5027832984924316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5029091835021973  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512728214263916  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513230800628662  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513230800628662  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.51332426071167  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521268367767334  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5218591690063477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5218591690063477  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521956443786621  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5309057235717773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5314764976501465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5314764976501465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5315642356872559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540250301361084  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540696620941162  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540696620941162  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5407614707946777  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.547635555267334  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5480647087097168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5480647087097168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5481219291687012  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5545878410339355  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5553603172302246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5553603172302246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5554537773132324  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.56666898727417  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5674529075622559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5674529075622559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5675444602966309  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5791716575622559  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5795459747314453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5795459747314453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57958984375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5854682922363281  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5859079360961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5859079360961914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.585953712463379  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5924081802368164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5928092002868652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5928092002868652  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5928492546081543  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5987772941589355  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5991592407226562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5991592407226562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5991954803466797  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6048126220703125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6051926612854004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6051926612854004  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605226993560791  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6107888221740723  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111407279968262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111407279968262  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111712455749512  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6163287162780762  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6233057975769043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6233057975769043  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6238608360290527  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7383999824523926  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7185406684875488  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7189640998840332  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7193875312805176  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.718942642211914  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([2840, 40])
input nodes number: 21184
output nodes number: 2840
edges number: 23297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7191214561462402  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7191219329833984  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04908037185668945  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

pseudo mini batch 31 input nodes size: 71360
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04504537582397461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04504537582397461  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07907247543334961  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07909393310546875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04557609558105469  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04703807830810547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04703807830810547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04703807830810547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([71360, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04703807830810547  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([792, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13166570663452148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13166570663452148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13242101669311523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13878870010375977  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([1054, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13941621780395508  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13941621780395508  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14042139053344727  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15549898147583008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([1113, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15658855438232422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15658855438232422  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15764999389648438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.181427001953125  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18300199508666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18300199508666992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18405485153198242  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21516752243041992  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1127, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21732807159423828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21732807159423828  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21840286254882812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2572803497314453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2595810890197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2595810890197754  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2605271339416504  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30268192291259766  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([949, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3053765296936035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3053765296936035  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30628156661987305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3515739440917969  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([932, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3546767234802246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3546767234802246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35556554794311523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40622854232788086  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([843, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40940189361572266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40940189361572266  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4102058410644531  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.46231698989868164  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([12835, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5231170654296875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5231170654296875  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 12835, 128]), torch.Size([1, 12835, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5353574752807617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4317207336425781  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 12835, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3534064292907715  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3741402626037598  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.394874095916748  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3739781379699707  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

torch.Size([21741, 256])
first layer input nodes number: 71360
first layer output nodes number: 21741
edges number: 172278
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3954076766967773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4161415100097656  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4219274520874023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4219274520874023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

m.shape torch.Size([409, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4453558921813965  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4453558921813965  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4461359977722168  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.453331470489502  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4536223411560059  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4536223411560059  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4542975425720215  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.464731216430664  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4652042388916016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4652042388916016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4657402038574219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4783496856689453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4789352416992188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4789352416992188  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4793586730957031  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.49163818359375  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4923925399780273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4923925399780273  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4927759170532227  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.506577491760254  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.507216453552246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.507216453552246  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.507491111755371  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.519301414489746  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.520052433013916  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.520052433013916  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5203042030334473  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5328927040100098  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.533651351928711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.533651351928711  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5338706970214844  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5463733673095703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5469989776611328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5469989776611328  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5471611022949219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5575370788574219  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5581483840942383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5581483840942383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5582857131958008  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5680360794067383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.568802833557129  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.568802833557129  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.568953514099121  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5807065963745117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581392765045166  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581392765045166  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5815186500549316  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5922188758850098  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5929059982299805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5929059982299805  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5930204391479492  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035490036010742  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.604245662689209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.604245662689209  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6043524742126465  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.614926815032959  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6153783798217773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6153783798217773  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6154451370239258  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6225214004516602  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.622964859008789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.622964859008789  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6230239868164062  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6297054290771484  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6302318572998047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6302318572998047  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6302967071533203  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6380786895751953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6384963989257812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6384963989257812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6385459899902344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6448440551757812  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6454038619995117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6454038619995117  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6454648971557617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6536436080932617  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6541709899902344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6541709899902344  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.654226303100586  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6620254516601562  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6624822616577148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6624822616577148  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6625280380249023  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6693029403686523  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6696395874023438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6696395874023438  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6696720123291016  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6746978759765625  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6750354766845703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6750354766845703  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6750659942626953  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6800098419189453  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6803407669067383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6803407669067383  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6803693771362305  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6852045059204102  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([308, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6925911903381348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6925911903381348  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.693178653717041  GigaBytes
Max Memory Allocated: 1.8048529624938965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7984609603881836  GigaBytes
Max Memory Allocated: 1.8058042526245117  GigaBytes

rst.shape  torch.Size([1, 308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7780756950378418  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7784996032714844  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.778923511505127  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7784781455993652  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([2843, 40])
input nodes number: 21741
output nodes number: 2843
edges number: 23832
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7786622047424316  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7786626815795898  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049729347229003906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049729347229003906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049729347229003906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01847345381975174 |0.002008996903896332 |0.11751498281955719 |8.919835090637207e-05 |0.0716194435954094 |0.004685401916503906 |
----------------------------------------------------------pseudo_mini_loss sum 4.127057075500488
Total (block generation + training)time/epoch 24.47071862220764
Training time/epoch 6.834665060043335
Training time without block to device /epoch 6.770377159118652
Training time without total dataloading part /epoch 6.0598413944244385
load block tensor time/epoch 0.5911505222320557
block to device time/epoch 0.06428790092468262
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2938359
Number of first layer input nodes during this epoch:  2257925
Number of first layer output nodes during this epoch:  680434
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0497288703918457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019300460815429688
global_2_local spend time (sec) 0.05243873596191406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004312276840209961
A = g.adjacency_matrix() spent  0.010577678680419922
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08402061462402344
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.290358543395996
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})[05:23:49] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 32 parts and get 0 edge cuts

auxiliary_graph_no_diag generation spent  1.1675963401794434

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.001 seconds
Metis partitioning: 0.070 seconds
Split the graph: 0.018 seconds
Construct subgraphs: 0.037 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.12759160995483398
2842
2840
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2840
2843
total k batches seeds list generation spend  9.936904668807983
after graph partition
graph partition algorithm spend time 10.017126560211182
2842
2840
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2842
2840
2843
partition_len_list
[21033, 21092, 20493, 21096, 21831, 21152, 21290, 21070, 20907, 21074, 21493, 21797, 21314, 21665, 21608, 21201, 21406, 20959, 20958, 20776, 21250, 20954, 21101, 21480, 21242, 20957, 21518, 21698, 21358, 21726, 21710, 21207]
shared_neighbor_graph_partition_s0 selection method  spend 10.120185136795044
time for parepare:  0.016357421875
local_output_nid generation:  0.0006835460662841797
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.0012412071228027344
r_  generation:  0.006691694259643555
local_output_nid generation:  0.0007379055023193359
local_in_edges_tensor generation:  0.0007350444793701172
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.0069103240966796875
local_output_nid generation:  0.0007817745208740234
local_in_edges_tensor generation:  0.0006909370422363281
mini_batch_src_global generation:  0.00083160400390625
r_  generation:  0.006407737731933594
local_output_nid generation:  0.0007879734039306641
local_in_edges_tensor generation:  0.0006461143493652344
mini_batch_src_global generation:  0.0007755756378173828
r_  generation:  0.006582975387573242
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.0006635189056396484
mini_batch_src_global generation:  0.0007691383361816406
r_  generation:  0.006886005401611328
local_output_nid generation:  0.0007810592651367188
local_in_edges_tensor generation:  0.0006413459777832031
mini_batch_src_global generation:  0.0007791519165039062
r_  generation:  0.006712198257446289
local_output_nid generation:  0.0008003711700439453
local_in_edges_tensor generation:  0.000637054443359375
mini_batch_src_global generation:  0.0007390975952148438
r_  generation:  0.006970405578613281
local_output_nid generation:  0.0007863044738769531
local_in_edges_tensor generation:  0.0006368160247802734
mini_batch_src_global generation:  0.0008230209350585938
r_  generation:  0.0067386627197265625
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0006380081176757812
mini_batch_src_global generation:  0.0007288455963134766
r_  generation:  0.00685572624206543
local_output_nid generation:  0.0007908344268798828
local_in_edges_tensor generation:  0.0006291866302490234
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.00696110725402832
local_output_nid generation:  0.0007929801940917969
local_in_edges_tensor generation:  0.0006275177001953125
mini_batch_src_global generation:  0.0007729530334472656
r_  generation:  0.007124423980712891
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0006453990936279297
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.007203102111816406
local_output_nid generation:  0.0008304119110107422
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.0007827281951904297
r_  generation:  0.00706171989440918
local_output_nid generation:  0.000820159912109375
local_in_edges_tensor generation:  0.0006375312805175781
mini_batch_src_global generation:  0.0007867813110351562
r_  generation:  0.007158517837524414
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0007390975952148438
mini_batch_src_global generation:  0.0008299350738525391
r_  generation:  0.007260560989379883
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0006778240203857422
mini_batch_src_global generation:  0.0007815361022949219
r_  generation:  0.0069925785064697266
local_output_nid generation:  0.0008246898651123047
local_in_edges_tensor generation:  0.0006279945373535156
mini_batch_src_global generation:  0.0007860660552978516
r_  generation:  0.00713658332824707
local_output_nid generation:  0.0008273124694824219
local_in_edges_tensor generation:  0.0006325244903564453
mini_batch_src_global generation:  0.0007658004760742188
r_  generation:  0.007029294967651367
local_output_nid generation:  0.0008161067962646484
local_in_edges_tensor generation:  0.0006356239318847656
mini_batch_src_global generation:  0.0007572174072265625
r_  generation:  0.006854057312011719
local_output_nid generation:  0.0008180141448974609
local_in_edges_tensor generation:  0.0006191730499267578
mini_batch_src_global generation:  0.00087738037109375
r_  generation:  0.007031440734863281
local_output_nid generation:  0.0008094310760498047
local_in_edges_tensor generation:  0.0006585121154785156
mini_batch_src_global generation:  0.0007784366607666016
r_  generation:  0.006990194320678711
local_output_nid generation:  0.0008139610290527344
local_in_edges_tensor generation:  0.0006213188171386719
mini_batch_src_global generation:  0.0007665157318115234
r_  generation:  0.0069942474365234375
local_output_nid generation:  0.0008227825164794922
local_in_edges_tensor generation:  0.0006160736083984375
mini_batch_src_global generation:  0.0007507801055908203
r_  generation:  0.0070493221282958984
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0007112026214599609
mini_batch_src_global generation:  0.0009145736694335938
r_  generation:  0.007233858108520508
local_output_nid generation:  0.0008499622344970703
local_in_edges_tensor generation:  0.0006375312805175781
mini_batch_src_global generation:  0.0007677078247070312
r_  generation:  0.0074651241302490234
local_output_nid generation:  0.0009214878082275391
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.0009195804595947266
r_  generation:  0.007230520248413086
local_output_nid generation:  0.0010006427764892578
local_in_edges_tensor generation:  0.0007538795471191406
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.007290363311767578
local_output_nid generation:  0.0009491443634033203
local_in_edges_tensor generation:  0.0007081031799316406
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.0076601505279541016
local_output_nid generation:  0.0008990764617919922
local_in_edges_tensor generation:  0.0006585121154785156
mini_batch_src_global generation:  0.0009045600891113281
r_  generation:  0.007341146469116211
local_output_nid generation:  0.0008831024169921875
local_in_edges_tensor generation:  0.0006763935089111328
mini_batch_src_global generation:  0.0009348392486572266
r_  generation:  0.007328510284423828
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0007390975952148438
mini_batch_src_global generation:  0.000978708267211914
r_  generation:  0.007471323013305664
local_output_nid generation:  0.0008289813995361328
local_in_edges_tensor generation:  0.0006167888641357422
mini_batch_src_global generation:  0.0008726119995117188
r_  generation:  0.0073089599609375
----------------------check_connections_block total spend ----------------------------- 0.39176011085510254
generate_one_block  0.021334409713745117
generate_one_block  0.012468338012695312
generate_one_block  0.012022972106933594
generate_one_block  0.012073278427124023
generate_one_block  0.012350797653198242
generate_one_block  0.011901378631591797
generate_one_block  0.012148380279541016
generate_one_block  0.011925935745239258
generate_one_block  0.01202702522277832
generate_one_block  0.012048959732055664
generate_one_block  0.012614965438842773
generate_one_block  0.012666702270507812
generate_one_block  0.012081384658813477
generate_one_block  0.012328147888183594
generate_one_block  0.012436389923095703
generate_one_block  0.011905908584594727
generate_one_block  0.016977310180664062
generate_one_block  0.012660026550292969
generate_one_block  0.012035131454467773
generate_one_block  0.012038230895996094
generate_one_block  0.012180089950561523
generate_one_block  0.011914968490600586
generate_one_block  0.011941909790039062
generate_one_block  0.012575626373291016
generate_one_block  0.011929988861083984
generate_one_block  0.01195073127746582
generate_one_block  0.012417793273925781
generate_one_block  0.012636423110961914
generate_one_block  0.012079477310180664
generate_one_block  0.012204885482788086
generate_one_block  0.012356281280517578
generate_one_block  0.011932849884033203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02341437339782715
gen group dst list time:  0.019115209579467773
time for parepare:  0.018559694290161133
local_output_nid generation:  0.004359006881713867
local_in_edges_tensor generation:  0.008129358291625977
mini_batch_src_global generation:  0.0054247379302978516
r_  generation:  0.05818486213684082
local_output_nid generation:  0.006682157516479492
local_in_edges_tensor generation:  0.006249666213989258
mini_batch_src_global generation:  0.00664830207824707
r_  generation:  0.060562849044799805
local_output_nid generation:  0.006366729736328125
local_in_edges_tensor generation:  0.0052089691162109375
mini_batch_src_global generation:  0.005381345748901367
r_  generation:  0.05934405326843262
local_output_nid generation:  0.006563663482666016
local_in_edges_tensor generation:  0.005526542663574219
mini_batch_src_global generation:  0.005864381790161133
r_  generation:  0.061318159103393555
local_output_nid generation:  0.006886959075927734
local_in_edges_tensor generation:  0.006314992904663086
mini_batch_src_global generation:  0.0069158077239990234
r_  generation:  0.06516242027282715
local_output_nid generation:  0.006854057312011719
local_in_edges_tensor generation:  0.005362510681152344
mini_batch_src_global generation:  0.006723642349243164
r_  generation:  0.0630192756652832
local_output_nid generation:  0.006873369216918945
local_in_edges_tensor generation:  0.005151271820068359
mini_batch_src_global generation:  0.0068132877349853516
r_  generation:  0.06393837928771973
local_output_nid generation:  0.006455898284912109
local_in_edges_tensor generation:  0.00536346435546875
mini_batch_src_global generation:  0.006912708282470703
r_  generation:  0.06283855438232422
local_output_nid generation:  0.0064618587493896484
local_in_edges_tensor generation:  0.006791591644287109
mini_batch_src_global generation:  0.006906032562255859
r_  generation:  0.0633399486541748
local_output_nid generation:  0.006377696990966797
local_in_edges_tensor generation:  0.005586862564086914
mini_batch_src_global generation:  0.006846189498901367
r_  generation:  0.06349611282348633
local_output_nid generation:  0.006569385528564453
local_in_edges_tensor generation:  0.0058863162994384766
mini_batch_src_global generation:  0.007515907287597656
r_  generation:  0.06584620475769043
local_output_nid generation:  0.0066792964935302734
local_in_edges_tensor generation:  0.006072282791137695
mini_batch_src_global generation:  0.007452249526977539
r_  generation:  0.06678318977355957
local_output_nid generation:  0.00653839111328125
local_in_edges_tensor generation:  0.005330801010131836
mini_batch_src_global generation:  0.006967782974243164
r_  generation:  0.06462216377258301
local_output_nid generation:  0.006640195846557617
local_in_edges_tensor generation:  0.005309104919433594
mini_batch_src_global generation:  0.007203102111816406
r_  generation:  0.06560993194580078
local_output_nid generation:  0.006608486175537109
local_in_edges_tensor generation:  0.005398273468017578
mini_batch_src_global generation:  0.006967067718505859
r_  generation:  0.0663766860961914
local_output_nid generation:  0.006424427032470703
local_in_edges_tensor generation:  0.005264759063720703
mini_batch_src_global generation:  0.007102251052856445
r_  generation:  0.06420397758483887
local_output_nid generation:  0.006632328033447266
local_in_edges_tensor generation:  0.0054759979248046875
mini_batch_src_global generation:  0.006929874420166016
r_  generation:  0.06516003608703613
local_output_nid generation:  0.006357431411743164
local_in_edges_tensor generation:  0.005450248718261719
mini_batch_src_global generation:  0.0070035457611083984
r_  generation:  0.06326436996459961
local_output_nid generation:  0.006474018096923828
local_in_edges_tensor generation:  0.005232095718383789
mini_batch_src_global generation:  0.006926536560058594
r_  generation:  0.06329083442687988
local_output_nid generation:  0.0062754154205322266
local_in_edges_tensor generation:  0.005165815353393555
mini_batch_src_global generation:  0.006711006164550781
r_  generation:  0.06325221061706543
local_output_nid generation:  0.0065190792083740234
local_in_edges_tensor generation:  0.005824089050292969
mini_batch_src_global generation:  0.006737232208251953
r_  generation:  0.06456327438354492
local_output_nid generation:  0.006345272064208984
local_in_edges_tensor generation:  0.0053386688232421875
mini_batch_src_global generation:  0.006946086883544922
r_  generation:  0.06355857849121094
local_output_nid generation:  0.006509065628051758
local_in_edges_tensor generation:  0.005593299865722656
mini_batch_src_global generation:  0.006899595260620117
r_  generation:  0.06583142280578613
local_output_nid generation:  0.006637096405029297
local_in_edges_tensor generation:  0.005866050720214844
mini_batch_src_global generation:  0.007487297058105469
r_  generation:  0.06627440452575684
local_output_nid generation:  0.006560325622558594
local_in_edges_tensor generation:  0.005270957946777344
mini_batch_src_global generation:  0.00712275505065918
r_  generation:  0.06582069396972656
local_output_nid generation:  0.006355762481689453
local_in_edges_tensor generation:  0.005190849304199219
mini_batch_src_global generation:  0.007030963897705078
r_  generation:  0.06379961967468262
local_output_nid generation:  0.006537675857543945
local_in_edges_tensor generation:  0.005467414855957031
mini_batch_src_global generation:  0.007422447204589844
r_  generation:  0.06543302536010742
local_output_nid generation:  0.006570339202880859
local_in_edges_tensor generation:  0.0055849552154541016
mini_batch_src_global generation:  0.007708549499511719
r_  generation:  0.06615734100341797
local_output_nid generation:  0.006517171859741211
local_in_edges_tensor generation:  0.005608797073364258
mini_batch_src_global generation:  0.007174968719482422
r_  generation:  0.06578826904296875
local_output_nid generation:  0.006516218185424805
local_in_edges_tensor generation:  0.005372524261474609
mini_batch_src_global generation:  0.0071048736572265625
r_  generation:  0.06600189208984375
local_output_nid generation:  0.006521701812744141
local_in_edges_tensor generation:  0.005222797393798828
mini_batch_src_global generation:  0.007199764251708984
r_  generation:  0.0658111572265625
local_output_nid generation:  0.006300926208496094
local_in_edges_tensor generation:  0.005185842514038086
mini_batch_src_global generation:  0.007076740264892578
r_  generation:  0.06457161903381348
----------------------check_connections_block total spend ----------------------------- 3.159727096557617
generate_one_block  0.08107805252075195
generate_one_block  0.09786748886108398
generate_one_block  0.0803077220916748
generate_one_block  0.08240389823913574
generate_one_block  0.08630967140197754
generate_one_block  0.08310556411743164
generate_one_block  0.08381199836730957
generate_one_block  0.08293986320495605
generate_one_block  0.08172154426574707
generate_one_block  0.0833740234375
generate_one_block  0.08561944961547852
generate_one_block  0.0897369384765625
generate_one_block  0.08516764640808105
generate_one_block  0.08562040328979492
generate_one_block  0.08647346496582031
generate_one_block  0.08487629890441895
generate_one_block  0.08395934104919434
generate_one_block  0.08527231216430664
generate_one_block  0.08595991134643555
generate_one_block  0.0813899040222168
generate_one_block  0.08929705619812012
generate_one_block  0.08948683738708496
generate_one_block  0.0877983570098877
generate_one_block  0.08626532554626465
generate_one_block  0.08501458168029785
generate_one_block  0.08308911323547363
generate_one_block  0.08671021461486816
generate_one_block  0.08746623992919922
generate_one_block  0.08519172668457031
generate_one_block  0.08783936500549316
generate_one_block  0.08655619621276855
generate_one_block  0.08363485336303711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0497288703918457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

connection checking time:  3.159727096557617
block generation total time  2.7353453636169434
average batch blocks generation time:  0.08547954261302948
block dataloader generation time/epoch 17.35635483264923
pseudo mini batch 0 input nodes size: 70041
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045575618743896484  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045575618743896484  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07897377014160156  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0789952278137207  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494667053222656  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046356201171875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046356201171875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046356201171875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([70041, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046356201171875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([797, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12784862518310547  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12784862518310547  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12860870361328125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13492727279663086  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([1078, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13597345352172852  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13597345352172852  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13700151443481445  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15242242813110352  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([1114, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1535019874572754  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1535019874572754  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15456438064575195  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17793703079223633  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1070, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17993879318237305  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17993879318237305  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18095922470092773  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21055173873901367  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([1084, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21262598037719727  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21262598037719727  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21365976333618164  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2522854804992676  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([927, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25442075729370117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25442075729370117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 927, 128]), torch.Size([1, 927, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25530481338500977  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2941737174987793  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 927, 128])
m.shape torch.Size([944, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2973499298095703  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2973499298095703  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2982501983642578  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3432636260986328  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([861, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3460979461669922  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3460979461669922  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34691905975341797  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3937225341796875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([780, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39665937423706055  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39665937423706055  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3974032402038574  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44581174850463867  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([12378, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.504462718963623  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.504462718963623  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 12378, 128]), torch.Size([1, 12378, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5162672996520996  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3543925285339355  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 12378, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2790355682373047  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2990942001342773  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.319523811340332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2993083000183105  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([21033, 256])
first layer input nodes number: 70041
first layer output nodes number: 21033
edges number: 165853
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3200478553771973  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.34010648727417  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3451213836669922  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3451213836669922  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3679633140563965  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3679633140563965  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3687357902526855  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3756251335144043  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3759446144104004  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3759446144104004  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3766446113586426  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3888611793518066  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38936185836792  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38936185836792  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3899245262145996  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4071173667907715  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4076628684997559  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4076628684997559  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4080729484558105  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4199652671813965  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4215502738952637  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4215502738952637  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4219679832458496  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4370055198669434  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4375925064086914  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4375925064086914  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4378557205200195  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449173927307129  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449997901916504  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449997901916504  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4502687454223633  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.463810920715332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4644908905029297  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4644908905029297  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4646930694580078  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.476217269897461  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4768776893615723  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4768776893615723  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4770455360412598  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4877877235412598  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4884634017944336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4884634017944336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4886140823364258  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.499312400817871  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5000195503234863  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5000195503234863  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5001606941223145  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5111699104309082  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118145942687988  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118145942687988  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5119328498840332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521984577178955  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5224628448486328  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5224628448486328  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5225448608398438  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.53009033203125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5307221412658691  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5307221412658691  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5308175086975098  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5402588844299316  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540989875793457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540989875793457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.541092872619629  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5520105361938477  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552605152130127  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552605152130127  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552685260772705  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5617375373840332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562269687652588  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562269687652588  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5623364448547363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703473091125488  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5707120895385742  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5707120895385742  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.570755958557129  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5763273239135742  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576634407043457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576634407043457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5766687393188477  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5812692642211914  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5816173553466797  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5816173553466797  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5816535949707031  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5867633819580078  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5872502326965332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5872502326965332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5872979164123535  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5943551063537598  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5948810577392578  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5948810577392578  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594930648803711  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6026172637939453  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6029906272888184  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6029906272888184  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603024959564209  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6085867881774902  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6090312004089355  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6090312004089355  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6090693473815918  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.615516185760498  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6222009658813477  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6222009658813477  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6227331161499023  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7337098121643066  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7139291763305664  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.714353084564209  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7147769927978516  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7143316268920898  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([2842, 40])
input nodes number: 21033
output nodes number: 2842
edges number: 23227
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7145099639892578  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7145109176635742  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0489659309387207  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

pseudo mini batch 1 input nodes size: 70083
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494762420654297  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494762420654297  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07836580276489258  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07838726043701172  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0449676513671875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046372413635253906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046372413635253906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046372413635253906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([70083, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046372413635253906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([840, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12770891189575195  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12770891189575195  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1285099983215332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1349186897277832  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([1064, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13603973388671875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13603973388671875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.137054443359375  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15227508544921875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1156, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15342140197753906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15342140197753906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1545238494873047  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17906951904296875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1118, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1806507110595703  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1806507110595703  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1817169189453125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21297645568847656  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1054, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21495628356933594  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21495628356933594  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21596145629882812  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2525949478149414  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([984, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25490760803222656  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25490760803222656  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2558460235595703  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29697608947753906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([921, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29958105087280273  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29958105087280273  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3004593849182129  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3451108932495117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([899, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3481011390686035  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3481011390686035  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34895849227905273  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39908266067504883  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([800, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4020872116088867  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4020872116088867  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4028501510620117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4516782760620117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([12256, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5097379684448242  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5097379684448242  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 12256, 128]), torch.Size([1, 12256, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5214262008666992  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3513517379760742  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 12256, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2762556076049805  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.296370506286621  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3164854049682617  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.296213150024414  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([21092, 256])
first layer input nodes number: 70083
first layer output nodes number: 21092
edges number: 165481
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3170099258422852  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3371248245239258  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.342153549194336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.342153549194336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.364781379699707  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.364781379699707  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3655920028686523  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3731961250305176  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3734850883483887  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3734850883483887  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.374173641204834  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3871073722839355  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.387660026550293  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.387660026550293  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3882532119750977  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4063692092895508  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4069724082946777  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4069724082946777  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4074187278747559  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4203619956970215  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4210858345031738  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4210858345031738  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.421461582183838  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4349884986877441  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4356598854064941  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4356598854064941  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4359440803527832  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.448164463043213  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.448850154876709  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.448850154876709  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.449084758758545  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4608149528503418  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4614744186401367  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4614744186401367  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4616670608520508  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4726476669311523  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4732866287231445  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4732866287231445  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4734487533569336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4838247299194336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4844937324523926  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4844937324523926  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.484642505645752  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4952054023742676  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4958820343017578  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4958820343017578  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4960174560546875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5065803527832031  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5071473121643066  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5071473121643066  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5072522163391113  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5161690711975098  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5167789459228516  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5167789459228516  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5168800354003906  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5261802673339844  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5267491340637207  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5267491340637207  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.52683687210083  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5355229377746582  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5359692573547363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5359692573547363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.536034107208252  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5429081916809082  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.54347562789917  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.54347562789917  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5435500144958496  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5519556999206543  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5525398254394531  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5525398254394531  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5526123046875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561309814453125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561844825744629  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561844825744629  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5619077682495117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569901466369629  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.570253849029541  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.570253849029541  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57029390335083  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5756611824035645  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576064109802246  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576064109802246  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.576106071472168  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5820226669311523  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582627773284912  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.582627773284912  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5826869010925293  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.591437816619873  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5917892456054688  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5917892456054688  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5918235778808594  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5971450805664062  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5973048210144043  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5973048210144043  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5973200798034668  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5997920036315918  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6001534461975098  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6001534461975098  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6001839637756348  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6053414344787598  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612318515777588  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612318515777588  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6128735542297363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.733842372894287  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7142796516418457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.71470308303833  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7151265144348145  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.714681625366211  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([2840, 40])
input nodes number: 21092
output nodes number: 2840
edges number: 22986
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.714859962463379  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.714860439300537  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.048975467681884766  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

pseudo mini batch 2 input nodes size: 69231
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0449671745300293  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0449671745300293  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07797908782958984  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07800054550170898  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044560909271240234  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04592275619506836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04592275619506836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04592275619506836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([69231, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04592275619506836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([838, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12481546401977539  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12481546401977539  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12561464309692383  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1325540542602539  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([1078, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13318252563476562  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13318252563476562  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13421058654785156  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14963150024414062  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([1092, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1506795883178711  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1506795883178711  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15172100067138672  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17463207244873047  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1061, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17613506317138672  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17613506317138672  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17714691162109375  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20739459991455078  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([1068, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20943498611450195  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20943498611450195  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21045351028442383  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24783563613891602  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([965, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25008726119995117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25008726119995117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2510075569152832  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2907853126525879  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([866, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2932910919189453  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2932910919189453  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2941169738769531  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33541107177734375  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([856, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33826351165771484  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33826351165771484  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3390798568725586  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.38561153411865234  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([761, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.38846921920776367  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.38846921920776367  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.38919496536254883  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.43656015396118164  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([11908, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4929790496826172  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4929790496826172  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 11908, 128]), torch.Size([1, 11908, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5043354034423828  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.311361312866211  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 11908, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2385406494140625  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2580842971801758  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.277627944946289  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2579312324523926  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([20493, 256])
first layer input nodes number: 69231
first layer output nodes number: 20493
edges number: 160483
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2781457901000977  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.297689437866211  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3033676147460938  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3033676147460938  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([437, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3255414962768555  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3255414962768555  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3263750076293945  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.335404396057129  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([393, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3357434272766113  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3357434272766113  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3364930152893066  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3477368354797363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3482184410095215  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3482184410095215  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3487849235534668  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3622889518737793  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3628172874450684  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3628172874450684  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3632197380065918  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3748908042907715  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3756318092346191  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3756318092346191  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3760056495666504  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3894639015197754  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3902173042297363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3902173042297363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3905282020568848  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4038968086242676  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.404616355895996  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.404616355895996  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4048643112182617  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.417262077331543  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.418022632598877  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.418022632598877  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4182419776916504  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4307446479797363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4314484596252441  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4314484596252441  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4316277503967285  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4431023597717285  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4436955451965332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4436955451965332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.443830966949463  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4534459114074707  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4539704322814941  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4539704322814941  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4540772438049316  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4624085426330566  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4629087448120117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4629087448120117  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4630002975463867  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4707822799682617  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.471498966217041  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.471498966217041  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4716153144836426  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4823193550109863  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.482947826385498  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.482947826385498  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4830451011657715  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4926753044128418  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4934344291687012  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4934344291687012  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4935412406921387  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5048632621765137  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5052714347839355  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5052714347839355  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.50532865524292  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5117945671081543  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512223720550537  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512223720550537  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5122771263122559  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5186858177185059  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5191783905029297  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5191783905029297  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.519235610961914  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5265026092529297  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5269126892089844  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5269126892089844  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5269584655761719  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5330924987792969  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5335888862609863  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5335888862609863  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5336403846740723  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5409016609191895  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5412192344665527  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5412192344665527  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5412516593933105  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5460505485534668  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546457290649414  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546457290649414  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5464954376220703  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552408218383789  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5526766777038574  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5526766777038574  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552701473236084  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556718349456787  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556960105895996  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556960105895996  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556981086730957  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5605268478393555  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([263, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566835880279541  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566835880279541  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5673375129699707  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.676908016204834  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6578335762023926  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6582574844360352  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6586813926696777  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.658236026763916  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([2842, 40])
input nodes number: 20493
output nodes number: 2842
edges number: 22268
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6584110260009766  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6584115028381348  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04845905303955078  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

pseudo mini batch 3 input nodes size: 70147
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04456138610839844  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04456138610839844  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07801008224487305  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07803153991699219  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0449981689453125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04640483856201172  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04640483856201172  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04640483856201172  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([70147, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04640483856201172  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([823, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12783479690551758  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12783479690551758  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12861967086791992  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13489866256713867  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([1055, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1359567642211914  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1359567642211914  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.136962890625  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1520547866821289  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([1130, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1531682014465332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1531682014465332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15424585342407227  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17850065231323242  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([1130, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1802506446838379  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1802506446838379  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18132829666137695  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21271371841430664  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([1082, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21475458145141602  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21475458145141602  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1082, 128]), torch.Size([1, 1082, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21578645706176758  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2540583610534668  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1082, 128])
m.shape torch.Size([977, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25633764266967773  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25633764266967773  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25726938247680664  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2982306480407715  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([947, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30092573165893555  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30092573165893555  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30182886123657227  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3470420837402344  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([880, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.349947452545166  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.349947452545166  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3507866859436035  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3993077278137207  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([806, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4023470878601074  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4023470878601074  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40311574935913086  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45240068435668945  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([12266, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.510505199432373  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.510505199432373  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 12266, 128]), torch.Size([1, 12266, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5222029685974121  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3527865409851074  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 12266, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.277587890625  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2977066040039062  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3178253173828125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2975492477416992  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([21096, 256])
first layer input nodes number: 70147
first layer output nodes number: 21096
edges number: 165698
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3183503150939941  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3384690284729004  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.343498706817627  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.343498706817627  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3661155700683594  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3661155700683594  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3669166564941406  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3744378089904785  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([343, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3746967315673828  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3746967315673828  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3753509521484375  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3887052536010742  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3892521858215332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3892521858215332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3898301124572754  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409350872039795  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4099388122558594  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4099388122558594  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4103736877441406  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4229850769042969  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4237003326416016  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4237003326416016  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4240703582763672  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4373912811279297  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4380946159362793  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4380946159362793  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4383883476257324  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4510188102722168  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.45180082321167  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.45180082321167  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.452064037322998  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4652247428894043  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4660239219665527  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4660239219665527  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466254711151123  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4794096946716309  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.480168342590332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.480168342590332  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.480360984802246  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492690086364746  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4934206008911133  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4934206008911133  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4935846328735352  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5052309036254883  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.505688190460205  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.505688190460205  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5057854652404785  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5133728981018066  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5139474868774414  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5139474868774414  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5140504837036133  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5228052139282227  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5235786437988281  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5235786437988281  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5237045288085938  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5352859497070312  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5357747077941895  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5357747077941895  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5358529090881348  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5435948371887207  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544248104095459  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544248104095459  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544339656829834  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.554044246673584  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5545830726623535  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5545830726623535  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5546555519104004  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5628457069396973  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5632672309875488  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5632672309875488  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5633206367492676  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5697293281555176  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703601837158203  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703601837158203  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5704326629638672  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5796375274658203  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580003261566162  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580003261566162  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580045223236084  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5856680870056152  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5861854553222656  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5861854553222656  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5862388610839844  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5937690734863281  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5940051078796387  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5940051078796387  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5940299034118652  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5976996421813965  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5979833602905273  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5979833602905273  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5980100631713867  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6021490097045898  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6026220321655273  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6026220321655273  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6026639938354492  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609461784362793  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6097869873046875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6097869873046875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6098155975341797  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6146507263183594  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([276, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6212682723999023  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6212682723999023  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6217947006225586  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7362947463989258  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 276, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7176260948181152  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7180500030517578  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7184739112854004  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7180285453796387  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([2842, 40])
input nodes number: 21096
output nodes number: 2842
edges number: 22978
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7182073593139648  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.718207836151123  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0490107536315918  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

pseudo mini batch 4 input nodes size: 72019
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0449981689453125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0449981689453125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0801544189453125  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.08017587661743164  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04670572280883789  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0481724739074707  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0481724739074707  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0481724739074707  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([72019, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0481724739074707  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13304996490478516  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13304996490478516  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1338214874267578  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14005231857299805  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([1106, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14072132110595703  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14072132110595703  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14177608489990234  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15759754180908203  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1099, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15864229202270508  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15864229202270508  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15969038009643555  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18341398239135742  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1157, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18509674072265625  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18509674072265625  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18620014190673828  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2181987762451172  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([1075, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.22021007537841797  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.22021007537841797  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2212352752685547  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25814247131347656  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1013, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2605280876159668  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2605280876159668  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26149415969848633  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30394792556762695  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([954, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30664920806884766  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30664920806884766  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3075590133666992  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3531203269958496  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([856, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35593080520629883  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35593080520629883  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3567471504211426  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4039158821105957  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([776, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40683794021606445  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40683794021606445  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4075779914855957  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4553494453430176  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([12986, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.517479419708252  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.517479419708252  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 12986, 128]), torch.Size([1, 12986, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5298638343811035  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.435448169708252  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 12986, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.35591459274292  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3767342567443848  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3975539207458496  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3765711784362793  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

torch.Size([21831, 256])
first layer input nodes number: 72019
first layer output nodes number: 21831
edges number: 172769
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3980927467346191  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.418912410736084  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4241175651550293  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4241175651550293  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4476780891418457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4476780891418457  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4484715461730957  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.455744743347168  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.456070899963379  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.456070899963379  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4567880630493164  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467545509338379  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467954158782959  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467954158782959  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.468461513519287  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4808411598205566  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([227, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4814605712890625  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4814605712890625  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.481893539428711  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4944496154785156  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.495203971862793  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.495203971862793  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.495589256286621  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5094594955444336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5101089477539062  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5101089477539062  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5103874206542969  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5223617553710938  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5230097770690918  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5230097770690918  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5232329368591309  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.534390926361084  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5351099967956543  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5351099967956543  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535315990447998  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5470576286315918  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5476469993591309  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5476469993591309  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5477995872497559  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5575652122497559  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5582003593444824  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5582003593444824  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5583415031433105  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5683627128601074  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5689687728881836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5689687728881836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5690908432006836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5786123275756836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5791974067687988  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5791974067687988  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5793042182922363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5883831977844238  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5889296531677246  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5889296531677246  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5890212059020996  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5974440574645996  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5980710983276367  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5980710983276367  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5981664657592773  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6076078414916992  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608266830444336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608266830444336  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6083602905273438  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6182670593261719  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6188201904296875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6188201904296875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6188945770263672  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6273002624511719  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6278514862060547  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6278514862060547  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.627920150756836  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.636159896850586  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6367831230163574  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6367831230163574  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6368556022644043  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6460604667663574  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6465721130371094  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6465721130371094  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6466293334960938  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.654296875  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6548643112182617  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6548643112182617  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.654923439025879  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6632604598999023  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.66377592086792  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.66377592086792  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6638274192810059  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6714491844177246  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6717829704284668  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6717829704284668  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6718153953552246  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6768412590026855  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6772232055664062  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6772232055664062  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6772575378417969  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6828193664550781  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6830792427062988  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6830792427062988  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6831021308898926  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6869702339172363  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6945281028747559  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6945281028747559  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6951289176940918  GigaBytes
Max Memory Allocated: 1.8063077926635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.8033432960510254  GigaBytes
Max Memory Allocated: 1.8108534812927246  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7828259468078613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.783249855041504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7836737632751465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7832283973693848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21831
output nodes number: 2842
edges number: 23966
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7834129333496094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7834134101867676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.05087709426879883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 5 input nodes size: 70395
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04670572280883789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04670572280883789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.08027267456054688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.08029413223266602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045116424560546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70395, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04653167724609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([803, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12851858139038086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12851858139038086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12928438186645508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13634586334228516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([1069, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13698244094848633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13698244094848633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1380019187927246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15329408645629883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1121, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1543879508972168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1543879508972168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1554570198059082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17926454544067383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1135, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1808948516845703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1808948516845703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1819772720336914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21341514587402344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1046, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21536779403686523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21536779403686523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21636533737182617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25267457962036133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([950, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25489377975463867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25489377975463867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2557997703552246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29489660263061523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([855, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29729747772216797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29729747772216797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2981128692626953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33907079696655273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([888, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34205055236816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34205055236816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3428974151611328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3930320739746094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([854, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3962736129760742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3962736129760742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39708805084228516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45009422302246094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([12431, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5089626312255859  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5089626312255859  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12431, 128]), torch.Size([1, 12431, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.520817756652832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3626513481140137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12431, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.286844253540039  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.307016372680664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.327188491821289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3068585395812988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21152, 256])
first layer input nodes number: 70395
first layer output nodes number: 21152
edges number: 166859
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3277149200439453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3478870391845703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3529300689697266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3529300689697266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3755488395690918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3755488395690918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3763346672058105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.382685661315918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([384, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.383030891418457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.383030891418457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.383763313293457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395909309387207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3963680267333984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3963680267333984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3969135284423828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4135408401489258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([261, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4149565696716309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4149565696716309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.415454387664795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.438107967376709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([173, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4386906623840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4386906623840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4390206336975098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.450899600982666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4515538215637207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4515538215637207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.45182466506958  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4634709358215332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4641966819763184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4641966819763184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4644408226013184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4766478538513184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4774255752563477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4774255752563477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4776487350463867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4903688430786133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([111, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4912176132202148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4912176132202148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.491429328918457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.504979133605957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5055460929870605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5055460929870605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5056796073913574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5151591300964355  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5158538818359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5158538818359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5159912109375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.526702880859375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5272574424743652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5272574424743652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.527360439300537  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5361151695251465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5366759300231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5366759300231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5367693901062012  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.54536771774292  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5459403991699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5459403991699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5460281372070312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5547142028808594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5551605224609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5551605224609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5552253723144531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5620994567871094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562574863433838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562574863433838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5626378059387207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5697503089904785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701274871826172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701274871826172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701751708984375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575897216796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5763235092163086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5763235092163086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5763731002807617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5826711654663086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5832490921020508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5832490921020508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5833120346069336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5917463302612305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921573638916016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921573638916016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5922012329101562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5983867645263672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5986881256103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5986881256103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5987186431884766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6032352447509766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6036009788513184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6036009788513184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603635311126709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6089568138122559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609227180480957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609227180480957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6092519760131836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6132688522338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6135106086730957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6135106086730957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6135315895080566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.617077350616455  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6243958473205566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6243958473205566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6249775886535645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7372851371765137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.717707633972168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7181315422058105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7185554504394531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7181100845336914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21152
output nodes number: 2842
edges number: 22989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7182893753051758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.718289852142334  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049149513244628906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 6 input nodes size: 70559
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045116424560546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045116424560546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07876157760620117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07878303527832031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04519462585449219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046627044677734375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046627044677734375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046627044677734375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70559, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046627044677734375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([768, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12938356399536133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12938356399536133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13011598587036133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13625335693359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([1067, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13690471649169922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13690471649169922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1379222869873047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15318584442138672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([1119, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15427780151367188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15427780151367188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15534496307373047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17882251739501953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1080, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18074560165405273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18074560165405273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18177556991577148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21164464950561523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1075, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21369266510009766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21369266510009766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21471786499023438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25216150283813477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1008, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2545328140258789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2545328140258789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2554941177368164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2971353530883789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([907, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2996821403503418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2996821403503418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30054712295532227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34503936767578125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([865, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34790658950805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34790658950805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34873151779174805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3957524299621582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([807, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3988032341003418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3988032341003418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39957284927368164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4488401412963867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([12594, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5090022087097168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5090022087097168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12594, 128]), torch.Size([1, 12594, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5210127830505371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3737635612487793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12594, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.297173023223877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.317476749420166  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.337780475616455  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3173179626464844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21290, 256])
first layer input nodes number: 70559
first layer output nodes number: 21290
edges number: 168474
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.338308334350586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.358612060546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3636879920959473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3636879920959473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([397, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3868498802185059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3868498802185059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3876070976257324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3936676979064941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3939814567565918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3939814567565918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3946681022644043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.405545711517334  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4060821533203125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4060821533203125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4066638946533203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4210262298583984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4216580390930176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4216580390930176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4221158027648926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4353909492492676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.436070442199707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.436070442199707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4364309310913086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4494085311889648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4501051902770996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4501051902770996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.450395107269287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4628615379333496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4635038375854492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4635038375854492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4637269973754883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4748849868774414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4755196571350098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4755196571350098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4757046699523926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.486250400543213  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4869365692138672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4869365692138672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4871082305908203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4980945587158203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4989027976989746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4989027976989746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4990801811218262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.511674404144287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5124530792236328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5124530792236328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126094818115234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5248088836669922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5254459381103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5254459381103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.525564193725586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5356159210205078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5361566543579102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5361566543579102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5362482070922852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5446710586547852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545109748840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545109748840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5451784133911133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551976203918457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.55269193649292  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.55269193649292  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5527911186218262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5633044242858887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5637779235839844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5637779235839844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5638427734375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5711708068847656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5716452598571777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5716452598571777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.571704387664795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5787997245788574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5792031288146973  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5792031288146973  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5792508125305176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5853066444396973  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5857396125793457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5857396125793457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.585787296295166  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.592176914215088  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5927109718322754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5927109718322754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.592766284942627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6005654335021973  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6009011268615723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6009011268615723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.600935459136963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6060166358947754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6064224243164062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6064224243164062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6064605712890625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6123733520507812  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6127967834472656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6127967834472656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6128349304199219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6190147399902344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6195034980773926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6195034980773926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6195454597473145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6266369819641113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([298, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6337766647338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6337766647338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6343450546264648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7413315773010254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 298, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7213854789733887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7218093872070312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7222332954406738  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.721787929534912  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21290
output nodes number: 2842
edges number: 23570
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.721968173980713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.721968650817871  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0492711067199707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 7 input nodes size: 70640
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04519462585449219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04519462585449219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07887840270996094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07889986038208008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04523324966430664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046643733978271484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046643733978271484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046643733978271484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70640, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046643733978271484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([810, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12838268280029297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12838268280029297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12915515899658203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13533496856689453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([1065, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13611412048339844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13611412048339844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1371297836303711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15236473083496094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([1132, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15347623825073242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15347623825073242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1545557975769043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17878103256225586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1058, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18049955368041992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18049955368041992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18150854110717773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2107691764831543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([1068, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21281099319458008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21281099319458008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21382951736450195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25124216079711914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([917, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2533564567565918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2533564567565918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25423097610473633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29271364212036133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([883, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2952237129211426  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2952237129211426  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2960658073425293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.33852720260620117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([896, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3415241241455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3415241241455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3423786163330078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3925495147705078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([821, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3956456184387207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3956456184387207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39642858505249023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4472784996032715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([12420, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5061101913452148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5061101913452148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12420, 128]), torch.Size([1, 12420, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5179548263549805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3589239120483398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2833290100097656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3034229278564453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.323516845703125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3032655715942383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21070, 256])
first layer input nodes number: 70640
first layer output nodes number: 21070
edges number: 166348
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.324045181274414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3441390991210938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3491625785827637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3491625785827637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([439, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3716692924499512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3716692924499512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3725066184997559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3792853355407715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3795876502990723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3795876502990723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.380302906036377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3926568031311035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3931903839111328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3931903839111328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3937797546386719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409602165222168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([203, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.410088062286377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.410088062286377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.410475254058838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.421703815460205  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.423220157623291  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.423220157623291  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.423637866973877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4386754035949707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([131, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4392223358154297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4392223358154297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4394721984863281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.450216293334961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4509391784667969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4509391784667969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4511795043945312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.46319580078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4639906883239746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4639906883239746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4642176628112793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4771552085876465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.47798490524292  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.47798490524292  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4781928062438965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4914984703063965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4920673370361328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4920673370361328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4922008514404297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5016803741455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5022797584533691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5022797584533691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5023999214172363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.511772632598877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5123586654663086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5123586654663086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512465476989746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5215444564819336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5220160484313965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5220160484313965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5220961570739746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.529466152191162  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5298972129821777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5298972129821777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5299639701843262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5365729331970215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.537001132965088  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.537001132965088  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.537062168121338  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.543531894683838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5440707206726074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5440707206726074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5441412925720215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5521159172058105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5525546073913574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5525546073913574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552609920501709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5592474937438965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5597219467163086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5597219467163086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5597772598266602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5668020248413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5672860145568848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5672860145568848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5673394203186035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.574495792388916  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5748729705810547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5748729705810547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5749130249023438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5805606842041016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5809245109558105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5809245109558105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580960750579834  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5863242149353027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5865602493286133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5865602493286133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.586583137512207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5901308059692383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590561866760254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590561866760254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5906000137329102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5967798233032227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59710693359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59710693359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5971355438232422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6019706726074219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([304, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6092610359191895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6092610359191895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6098408699035645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7278680801391602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7090139389038086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7094378471374512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7098617553710938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.709416389465332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21070
output nodes number: 2842
edges number: 22847
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7095952033996582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7095956802368164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0492558479309082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 8 input nodes size: 69746
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04523324966430664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04523324966430664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0784907341003418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07851219177246094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04480695724487305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0462040901184082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0462040901184082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0462040901184082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([69746, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0462040901184082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([818, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12700176239013672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12700176239013672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12778186798095703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13487625122070312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([1112, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13554668426513672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13554668426513672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13660717010498047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15251445770263672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1070, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15351486206054688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15351486206054688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15453529357910156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17711734771728516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([1066, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17864036560058594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17864036560058594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.179656982421875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2091388702392578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1074, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21119117736816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21119117736816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21221542358398438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.24970149993896484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([986, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2520103454589844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2520103454589844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 986, 128]), torch.Size([1, 986, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25295066833496094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2941093444824219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 986, 128])
m.shape torch.Size([912, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29668331146240234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29668331146240234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29755306243896484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3422689437866211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([862, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3451223373413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3451223373413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3459444046020508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3928232192993164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([744, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39560508728027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39560508728027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3963146209716797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44175148010253906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([12263, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.49987125396728516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.49987125396728516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12263, 128]), torch.Size([1, 12263, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.511566162109375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3419523239135742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12263, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2672820091247559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2872204780578613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3078904151916504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2877960205078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([20907, 256])
first layer input nodes number: 69746
first layer output nodes number: 20907
edges number: 164408
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3084120750427246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.32835054397583  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3333353996276855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3333353996276855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3559551239013672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3559551239013672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3567619323730469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.364342212677002  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([398, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3647041320800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3647041320800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3654632568359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3796977996826172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38010835647583  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38010835647583  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3806309700012207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3959107398986816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([209, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3964533805847168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3964533805847168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3968520164489746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4084124565124512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409193515777588  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409193515777588  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4095826148986816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235901832580566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.42435884475708  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.42435884475708  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4246773719787598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4383740425109863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4390692710876465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4390692710876465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4393115043640137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.451423168182373  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.452155590057373  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.452155590057373  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4523673057556152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.46443510055542  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4650473594665527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4650473594665527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4652056694030762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4753375053405762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.475998878479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.475998878479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4761457443237305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4865732192993164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4871978759765625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4871978759765625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4873237609863281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4971427917480469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4978065490722656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4978065490722656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4979267120361328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5081405639648438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5088176727294922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5088176727294922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5089302062988281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5192832946777344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5197787284851074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5197787284851074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5198569297790527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5275988578796387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5279779434204102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5279779434204102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5280332565307617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5338964462280273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5345301628112793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5345301628112793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5346121788024902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5438799858093262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5442314147949219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5442314147949219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5442771911621094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5497703552246094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5501108169555664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5501108169555664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5501508712768555  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5552377700805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.555619716644287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.555619716644287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.555661678314209  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5612845420837402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5617060661315918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5617060661315918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5617499351501465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5679354667663574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5687007904052734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5687007904052734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5687751770019531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5797843933105469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5802335739135742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5802335739135742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580277442932129  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5870771408081055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5874090194702148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5874090194702148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5874395370483398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5923833847045898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5927834510803223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5927834510803223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.592817783355713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5986199378967285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([282, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6053791046142578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6053791046142578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605916976928711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7242484092712402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 282, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.704702377319336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7051262855529785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.705550193786621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7051048278808594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 20907
output nodes number: 2842
edges number: 22978
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.705282211303711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7052826881408691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04879331588745117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 9 input nodes size: 70031
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04480695724487305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04480695724487305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0782003402709961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07822179794311523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494285583496094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04635429382324219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04635429382324219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04635429382324219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70031, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04635429382324219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([857, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12794828414916992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12794828414916992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12876558303833008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13530397415161133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([1035, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13613653182983398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13613653182983398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13712358474731445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15192937850952148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([1146, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1530752182006836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1530752182006836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1146, 128]), torch.Size([1, 1146, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15416812896728516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1788043975830078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1146, 128])
m.shape torch.Size([1085, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1803274154663086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1803274154663086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18136215209960938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21227550506591797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1037, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21423053741455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21423053741455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21521949768066406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2517580986022949  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([953, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25399017333984375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25399017333984375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2548990249633789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2942647933959961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([912, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29685449600219727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29685449600219727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29772424697875977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.342440128326416  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([833, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3451828956604004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3451828956604004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3459773063659668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3921799659729004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3952803611755371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3952803611755371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3960576057434082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4470987319946289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([12401, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5058426856994629  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5058426856994629  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12401, 128]), torch.Size([1, 12401, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5176692008972168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3573517799377441  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12401, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2819323539733887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.302030086517334  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3221278190612793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.301872730255127  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21074, 256])
first layer input nodes number: 70031
first layer output nodes number: 21074
edges number: 166001
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3226518630981445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3427495956420898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3477740287780762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3477740287780762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([460, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3707704544067383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3707704544067383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.371647834777832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.378777027130127  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([348, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.379007339477539  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.379007339477539  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3796710968017578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3913812637329102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3918943405151367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3918943405151367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3924531936645508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4103269577026367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4108667373657227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4108667373657227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4112730026245117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4230546951293945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4236879348754883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4236879348754883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4240198135375977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4359674453735352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4366607666015625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4366607666015625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4369449615478516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4491653442382812  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4498310089111328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4498310089111328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4500598907470703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4615039825439453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4622430801391602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4622430801391602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4624547958374023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.474522590637207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4753079414367676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4753079414367676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4755043983459473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4880776405334473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.488729476928711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.488729476928711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4888782501220703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.499441146850586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5001177787780762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5001177787780762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5002532005310059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5108160972595215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5114750862121582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5114750862121582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5115952491760254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5218091011047363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522449016571045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522449016571045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5225558280944824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5323824882507324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5328540802001953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5328540802001953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.532928466796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540292739868164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5408611297607422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5408611297607422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5409412384033203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5494327545166016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5498390197753906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5498390197753906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5498943328857422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5561447143554688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5566730499267578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5566730499267578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5567378997802734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5645198822021484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5650238990783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5650238990783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5650830268859863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5725922584533691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5730562210083008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5730562210083008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5731077194213867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5800085067749023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5804443359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5804443359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5804901123046875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.586944580078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5874667167663574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5874667167663574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5875182151794434  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.595139980316162  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955796241760254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955796241760254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5956215858459473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.602125644683838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6022815704345703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6022815704345703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6022968292236328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6047687530517578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605245590209961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605245590209961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.60528564453125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6120548248291016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([299, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6192193031311035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6192193031311035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6197896003723145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.735672950744629  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 299, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7157726287841797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7161965370178223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7166204452514648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7161750793457031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21074
output nodes number: 2842
edges number: 23334
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7163538932800293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7163543701171875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04896688461303711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 10 input nodes size: 71294
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494285583496094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04494285583496094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07893848419189453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07895994186401367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045545101165771484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04698324203491211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04698324203491211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04698324203491211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71294, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04698324203491211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13023138046264648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13023138046264648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13100576400756836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13720083236694336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([1131, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13797426223754883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13797426223754883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1390528678894043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15523195266723633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1141, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15663433074951172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15663433074951172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15772247314453125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18166160583496094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1132, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18327665328979492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18327665328979492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1843562126159668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2157454490661621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1032, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2176661491394043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2176661491394043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21865034103393555  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25460386276245117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([949, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25682687759399414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25682687759399414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25773191452026367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2968630790710449  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([914, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29946136474609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29946136474609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30033302307128906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3450613021850586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([924, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34815025329589844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34815025329589844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3490314483642578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3995685577392578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([818, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40263843536376953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40263843536376953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40341854095458984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4551219940185547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([12640, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5152788162231445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5152788162231445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12640, 128]), torch.Size([1, 12640, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5273332595825195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3831987380981445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12640, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3062224388122559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3267197608947754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.347217082977295  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3265595436096191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21493, 256])
first layer input nodes number: 71294
first layer output nodes number: 21493
edges number: 169431
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.347750186920166  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3682475090026855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3733720779418945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3733720779418945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3965120315551758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3965120315551758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3972978591918945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4043817520141602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([372, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4047040939331055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4047040939331055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4054136276245117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4162206649780273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.416696548461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.416696548461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.417245864868164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.430978775024414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4316000938415527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4316000938415527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.432044506072998  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444932460784912  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4455466270446777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4455466270446777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.445878505706787  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4578261375427246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4585022926330566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4585022926330566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4587807655334473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4707551002502441  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.471463680267334  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.471463680267334  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4717040061950684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.483720302581787  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4844613075256348  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4844613075256348  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4846749305725098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4968514442443848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4977221488952637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4977221488952637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4979376792907715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5117316246032715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5124602317810059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5124602317810059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126261711120605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5244078636169434  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5250654220581055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5250654220581055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5251989364624023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5356130599975586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5361576080322266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5361576080322266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5362586975097656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544851303100586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5453133583068848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5453133583068848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.54539155960083  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5525860786437988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5531392097473145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5531392097473145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5532231330871582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5615315437316895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5620665550231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5620665550231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5621428489685059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5702300071716309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5707149505615234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5707149505615234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.570779800415039  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5781078338623047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785984992980957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785984992980957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5786595344543457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5859837532043457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5865588188171387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5865588188171387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.586625576019287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5951037406921387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955638885498047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5955638885498047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5956153869628906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6025161743164062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6028943061828613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6028943061828613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6029343605041504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6085820198059082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609046459197998  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609046459197998  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6090922355651855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6158671379089355  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.616076946258545  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.616076946258545  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6160979270935059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6193499565124512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6197595596313477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6197595596313477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.619795799255371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.625666618347168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6260871887207031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6260871887207031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6261234283447266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6322479248046875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6396546363830566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6396546363830566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6402440071105957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.748579502105713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7284808158874512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7289047241210938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7293286323547363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7288832664489746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21493
output nodes number: 2842
edges number: 23533
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.72906494140625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7290654182434082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04964113235473633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 11 input nodes size: 71723
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045545101165771484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045545101165771484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07974529266357422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07976675033569336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045749664306640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04721260070800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04721260070800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04721260070800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71723, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04721260070800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([836, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13186168670654297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13186168670654297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1326589584350586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1392822265625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([1089, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1399221420288086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1399221420288086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.140960693359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1565389633178711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1166, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15768766403198242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15768766403198242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1587996482849121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18326330184936523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1166, 128])
m.shape torch.Size([1089, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1847844123840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1847844123840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1858229637145996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21663141250610352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1076, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21867752075195312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21867752075195312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21970367431640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2570686340332031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([994, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2593994140625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2593994140625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2603473663330078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3016815185546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([918, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3042716979980469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3042716979980469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3051471710205078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34946537017822266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([919, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35253334045410156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35253334045410156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3534097671508789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4038734436035156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([820, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.406954288482666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.406954288482666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40773630142211914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4599118232727051  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([12890, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5209851264953613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5209851264953613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12890, 128]), torch.Size([1, 12890, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5332779884338379  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.43021821975708  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12890, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.351905345916748  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.372692584991455  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.393479824066162  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3725299835205078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21797, 256])
first layer input nodes number: 71723
first layer output nodes number: 21797
edges number: 172270
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3940162658691406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4148035049438477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.420362949371338  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.420362949371338  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4439210891723633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4439210891723633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4447145462036133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4510622024536133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([362, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4513616561889648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4513616561889648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.452052116394043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.46305513381958  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4635348320007324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4635348320007324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4640803337097168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4761977195739746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4767403602600098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4767403602600098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.477144718170166  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4888710975646973  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.489553451538086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.489553451538086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4899044036865234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5025386810302734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5032110214233398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5032110214233398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5034914016723633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.515547752380371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5162959098815918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5162959098815918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516547679901123  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5291361808776855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5299253463745117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5299253463745117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5301523208618164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5430898666381836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5437898635864258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5437898635864258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5439691543579102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5554437637329102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5562291145324707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5562291145324707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5564026832580566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5687260627746582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5692949295043945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5692949295043945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569413185119629  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5786371231079102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57912015914917  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.57912015914917  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.579209804534912  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.586829662322998  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5874099731445312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5874099731445312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5875053405761719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5962791442871094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5968775749206543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5968775749206543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969691276550293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6060328483581543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066503524780273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066503524780273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6067380905151367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6160383224487305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.616502285003662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.616502285003662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.616565227508545  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6236777305603027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.624185562133789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.624185562133789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6242485046386719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6318016052246094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.632375717163086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.632375717163086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6324424743652344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.640920639038086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6412711143493652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6412711143493652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6413111686706543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6466784477233887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6471009254455566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6471009254455566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6471447944641113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6533303260803223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6535911560058594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6535911560058594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6536178588867188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6575698852539062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6579375267028809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6579375267028809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6579718589782715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6632933616638184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6637625694274902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6637625694274902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.663804531097412  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6706023216247559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6711583137512207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6711583137512207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.671205997467041  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6792645454406738  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([322, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6869778633117676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6869778633117676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6875920295715332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7979412078857422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 322, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7774195671081543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7778434753417969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7782673835754395  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7778220176696777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21797
output nodes number: 2842
edges number: 23962
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7780060768127441  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7780065536499023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04991006851196289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 12 input nodes size: 71102
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045749664306640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045749664306640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07965373992919922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07967519760131836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045453548431396484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04687833786010742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04687833786010742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04687833786010742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71102, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04687833786010742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([821, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1293025016784668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1293025016784668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13008546829223633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13683700561523438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([1097, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13769769668579102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13769769668579102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13874387741088867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15443658828735352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1153, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1555628776550293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1555628776550293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1566624641418457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18085336685180664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1108, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18249940872192383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18249940872192383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18355607986450195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21462488174438477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1029, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21654987335205078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21654987335205078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2175312042236328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2536330223083496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([1018, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2560548782348633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2560548782348633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25702571868896484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2988862991333008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([905, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3014216423034668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3014216423034668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30228471755981445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3468790054321289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([905, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3498997688293457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3498997688293457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35076284408569336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4010453224182129  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40399980545043945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40399980545043945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.404752254486084  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.452908992767334  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([12489, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5120849609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5120849609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12489, 128]), torch.Size([1, 12489, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5239953994750977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3696365356445312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12489, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2934603691101074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3137869834899902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.334113597869873  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3136277198791504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21314, 256])
first layer input nodes number: 71102
first layer output nodes number: 21314
edges number: 167725
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3346452713012695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3549718856811523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.360053539276123  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.360053539276123  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3829693794250488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3829693794250488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3837552070617676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3903236389160156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3906211853027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3906211853027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.391305923461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.40260648727417  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4031381607055664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4031381607055664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4037160873413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4201555252075195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4207892417907715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4207892417907715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4212470054626465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4345221519470215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4351778030395508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4351778030395508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4355287551879883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4481630325317383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4488873481750488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4488873481750488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4491848945617676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4619793891906738  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4626178741455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4626178741455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4628410339355469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4739990234375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4748024940490723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4748024940490723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.475029468536377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4879670143127441  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.488588809967041  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.488588809967041  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.48875093460083  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.49912691116333  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4997572898864746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4997572898864746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4998984336853027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5099196434020996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5106210708618164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5106210708618164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5107603073120117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521620750427246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522301197052002  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.522301197052002  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5224251747131348  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5329632759094238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5336637496948242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5336637496948242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5337800979614258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5444841384887695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5450453758239746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5450453758239746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545133113861084  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.553819179534912  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5543088912963867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5543088912963867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5543794631958008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5618600845336914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562286376953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562286376953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5623435974121094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5688095092773438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5693202018737793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5693202018737793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.569383144378662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5769362449645996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577354907989502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577354907989502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577404499053955  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.583702564239502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.584043025970459  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.584043025970459  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5840811729431152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5891928672790527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5897698402404785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5897698402404785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5898289680480957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5981659889221191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5985603332519531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5985603332519531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5986003875732422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6045284271240234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.604931354522705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.604931354522705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6049695014953613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.61088228225708  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112170219421387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112170219421387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112475395202637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6161913871765137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6165452003479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6165452003479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6165757179260254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6217331886291504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([298, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6288785934448242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6288785934448242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6294469833374023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7412304878234863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 298, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7213654518127441  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7217893600463867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7222132682800293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7217679023742676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21314
output nodes number: 2842
edges number: 23298
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7219486236572266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7219491004943848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04951763153076172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 13 input nodes size: 71722
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045453548431396484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045453548431396484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07965326309204102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07967472076416016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04574918746948242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.047197818756103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.047197818756103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.047197818756103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71722, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.047197818756103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([839, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1317152976989746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1317152976989746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13251543045043945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1389164924621582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([1087, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13955307006835938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13955307006835938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14058971405029297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15613937377929688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1181, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15731048583984375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15731048583984375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1181, 128]), torch.Size([1, 1181, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15843677520751953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18321514129638672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1181, 128])
m.shape torch.Size([1110, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1847691535949707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1847691535949707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18582773208618164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21673250198364258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1083, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21878528594970703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21878528594970703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.219818115234375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25806331634521484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([996, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26039648056030273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26039648056030273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.26134634017944336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30272436141967773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 996, 128])
m.shape torch.Size([947, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30541038513183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30541038513183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30631351470947266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3514699935913086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([884, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35439062118530273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35439062118530273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35523366928100586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4035506248474121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([804, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40657949447631836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40657949447631836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.407346248626709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45727062225341797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([12734, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5176076889038086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5176076889038086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12734, 128]), torch.Size([1, 12734, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5297517776489258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.391982078552246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12734, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3137998580932617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3344612121582031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3551225662231445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3342995643615723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21665, 256])
first layer input nodes number: 71722
first layer output nodes number: 21665
edges number: 170664
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.355659008026123  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3763203620910645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3820061683654785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3820061683654785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([428, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.405259609222412  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.405259609222412  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4060759544372559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4127535820007324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413062572479248  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413062572479248  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.413774013519287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4249448776245117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4253878593444824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4253878593444824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4259161949157715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4379515647888184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([202, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4384641647338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4384641647338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4388494491577148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4500226974487305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4509406089782715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4509406089782715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4513506889343262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466113567352295  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4667506217956543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4667506217956543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467029094696045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4790034294128418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4797253608703613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4797253608703613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4799695014953613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4921765327453613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4928698539733887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4928698539733887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4930720329284668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.50459623336792  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.505239486694336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.505239486694336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5054035186767578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5159015655517578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5164637565612793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5164637565612793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5165915489196777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5256648063659668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5263938903808594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5263938903808594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5265369415283203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5376949310302734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.538280963897705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.538280963897705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5383896827697754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.547630786895752  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5482888221740723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5482888221740723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5483975410461426  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5583996772766113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5588703155517578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5588703155517578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5589447021484375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5663089752197266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5668773651123047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5668773651123047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5669574737548828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575448989868164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5760550498962402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5760550498962402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5761351585388184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5851874351501465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5855722427368164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5855722427368164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5856218338012695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5915727615356445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921192169189453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921192169189453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5921821594238281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6001758575439453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6006741523742676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6006741523742676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6007294654846191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6081414222717285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6086907386779785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6086907386779785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608747959136963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6168160438537598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.617271900177002  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.617271900177002  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6173176765441895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6240925788879395  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6244292259216309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6244292259216309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6244616508483887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6294875144958496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6299357414245605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6299357414245605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6299757957458496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6364645957946777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.636767864227295  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.636767864227295  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6367945671081543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6413073539733887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([308, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6487388610839844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6487388610839844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6493263244628906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7558484077453613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7356534004211426  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7360773086547852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7365012168884277  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.736055850982666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21665
output nodes number: 2842
edges number: 23634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.736238956451416  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7362394332885742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04987525939941406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 14 input nodes size: 71163
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04574918746948242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04574918746948242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0796823501586914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07970380783081055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045482635498046875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04693794250488281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04693794250488281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04693794250488281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71163, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04693794250488281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([772, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1314253807067871  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1314253807067871  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13216161727905273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13805150985717773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([1087, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13890647888183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13890647888183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13994312286376953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15549278259277344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1113, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15656661987304688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15656661987304688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15762805938720703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18140506744384766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1127, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18302392959594727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18302392959594727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1840987205505371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2154526710510254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1078, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2174854278564453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2174854278564453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21851348876953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2556619644165039  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([982, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25795745849609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25795745849609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 982, 128]), torch.Size([1, 982, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2588939666748047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29996490478515625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 982, 128])
m.shape torch.Size([951, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.302670955657959  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.302670955657959  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30357789993286133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3489251136779785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([855, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3517332077026367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3517332077026367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35254859924316406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39979982376098633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40292835235595703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40292835235595703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4037141799926758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4553709030151367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([12819, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5161037445068359  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5161037445068359  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12819, 128]), torch.Size([1, 12819, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5283288955688477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4245243072509766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12819, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3462748527526855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3668818473815918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.387488842010498  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3667206764221191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21608, 256])
first layer input nodes number: 71163
first layer output nodes number: 21608
edges number: 171178
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3880209922790527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.408627986907959  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4143624305725098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4143624305725098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([385, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4378843307495117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4378843307495117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4386186599731445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4446711540222168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([385, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4450445175170898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4450445175170898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4457788467407227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4570317268371582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4575386047363281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4575386047363281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4581165313720703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4717121124267578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4722728729248047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4722728729248047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4726943969726562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4849185943603516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4856114387512207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4856114387512207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4859700202941895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4988789558410645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4995017051696777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4995017051696777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4997668266296387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.511167049407959  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118217468261719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118217468261719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512044906616211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523202896118164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5239067077636719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5239067077636719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.52410888671875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5356330871582031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5363883972167969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5363883972167969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5365772247314453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5486621856689453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5493273735046387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5493273735046387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5494780540466309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5601763725280762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5607142448425293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5607142448425293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5608248710632324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5694537162780762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5700793266296387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5700793266296387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701918601989746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5797572135925293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5804009437561035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5804009437561035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580507755279541  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590334415435791  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5909404754638672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5909404754638672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.591033935546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6002864837646484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6008024215698242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6008024215698242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.600876808166504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6087617874145508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6094169616699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6094169616699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6095027923583984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.61920166015625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.619828701019287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.619828701019287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6199069023132324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.62929105758667  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629702091217041  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.629702091217041  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6297516822814941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.636049747467041  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6365914344787598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6365914344787598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.636650562286377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.64457368850708  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6451020240783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6451020240783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6451573371887207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.652956485748291  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.653393268585205  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.653393268585205  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6534371376037598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6599297523498535  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6603097915649414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6603097915649414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6603460311889648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6659631729125977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6661882400512695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6661882400512695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6662092208862305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6696081161499023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.669990062713623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.669990062713623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6700224876403809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6755023002624512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([317, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.683103084564209  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.683103084564209  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6837077140808105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7917590141296387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 317, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7712488174438477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7716727256774902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7720966339111328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.771651268005371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21608
output nodes number: 2842
edges number: 23956
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.771833896636963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.771834373474121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04961872100830078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 15 input nodes size: 70407
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045482635498046875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045482635498046875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0790553092956543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07907676696777344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04512214660644531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046539306640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046539306640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046539306640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70407, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046539306640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([816, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12856435775756836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12856435775756836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12934255599975586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13644790649414062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([1053, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13706302642822266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13706302642822266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13806724548339844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15313053131103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([1122, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15423345565795898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15423345565795898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1553034782409668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17911481857299805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1145, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18076372146606445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18076372146606445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1818556785583496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21352243423461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([1077, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2155442237854004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2155442237854004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21657133102416992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2535529136657715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([978, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25583744049072266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25583744049072266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25677013397216797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.297823429107666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([937, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30048465728759766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30048465728759766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3013782501220703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3462204933166504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([862, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3490619659423828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3490619659423828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.349884033203125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39774513244628906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([763, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40060853958129883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40060853958129883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4013361930847168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44908905029296875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([12448, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5080819129943848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5080819129943848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12448, 128]), torch.Size([1, 12448, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5199532508850098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3628182411193848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12448, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2869963645935059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3072152137756348  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3274340629577637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3070569038391113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21201, 256])
first layer input nodes number: 70407
first layer output nodes number: 21201
edges number: 166923
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3279609680175781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.348179817199707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3532347679138184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3532347679138184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([426, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375959873199463  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375959873199463  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.376772403717041  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3833413124084473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([343, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3835945129394531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3835945129394531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3842487335205078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3958969116210938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3964176177978516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3964176177978516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3969783782958984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4131908416748047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4138216972351074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4138216972351074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.414273738861084  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4273829460144043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4281039237976074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4281039237976074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4284796714782715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4420065879821777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4427475929260254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4427475929260254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4430546760559082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4562592506408691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.456892967224121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.456892967224121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4571161270141602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4682741165161133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.469008445739746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.469008445739746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4692182540893555  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4811773300170898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4818511009216309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4818511009216309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.482022762298584  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.493009090423584  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4936637878417969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4936637878417969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4938106536865234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5042381286621094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5049896240234375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5049896240234375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5051383972167969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5167427062988281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5174527168273926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5174527168273926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5175824165344238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.52860689163208  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5291671752929688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5291671752929688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5292625427246094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5380363464355469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5386347770690918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5386347770690918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5387263298034668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5477900505065918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5484223365783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5484223365783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5485119819641113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5580143928527832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.558523178100586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.558523178100586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5585918426513672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5663509368896484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5667743682861328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5667743682861328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5668277740478516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5732364654541016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5739364624023438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5739364624023438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5740165710449219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5841903686523438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846071243286133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846071243286133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846548080444336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5910444259643555  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5914435386657715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5914435386657715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5914855003356934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5974020957946777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5977849960327148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5977849960327148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.597823143005371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603468894958496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603682518005371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603682518005371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603703498840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6069555282592773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6071882247924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6071882247924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072092056274414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6106081008911133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111974716186523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6111974716186523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112470626831055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6196279525756836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([278, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6262831687927246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6262831687927246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6268134117126465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.73753023147583  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 278, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.718681812286377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7191057205200195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.719529628753662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7190842628479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21201
output nodes number: 2842
edges number: 23085
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.719264030456543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7192645072937012  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049161434173583984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 16 input nodes size: 70962
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04512214660644531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04512214660644531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07895946502685547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07898092269897461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04538679122924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04681730270385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04681730270385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04681730270385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70962, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04681730270385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12961673736572266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12961673736572266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13040542602539062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1368246078491211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([1116, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13774919509887695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13774919509887695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13881349563598633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15477800369262695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1103, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1558237075805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1558237075805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1568756103515625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18061447143554688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1071, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18213129043579102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18213129043579102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1831526756286621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21277284622192383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1160, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2150278091430664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2150278091430664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21613407135009766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25595951080322266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
m.shape torch.Size([991, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2582416534423828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2582416534423828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2591867446899414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30094385147094727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([871, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3033785820007324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3033785820007324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30420923233032227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34591150283813477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([894, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3489065170288086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3489065170288086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3497591018676758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3999929428100586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([883, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40335607528686523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40335607528686523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40419816970825195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45855045318603516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([12490, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5176863670349121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5176863670349121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12490, 128]), torch.Size([1, 12490, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5295977592468262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3753066062927246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12490, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2988085746765137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3192229270935059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.339637279510498  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3190631866455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21406, 256])
first layer input nodes number: 70962
first layer output nodes number: 21406
edges number: 168494
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3401679992675781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3605823516845703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3665380477905273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3665380477905273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([410, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3895721435546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3895721435546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3903541564941406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3966217041015625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([386, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3969731330871582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3969731330871582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3977093696594238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409325122833252  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([252, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4096837043762207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4096837043762207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4101643562316895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.420738697052002  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.421313762664795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.421313762664795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4217181205749512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4334444999694824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([236, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4343976974487305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4343976974487305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4348478317260742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4510526657104492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([134, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4516005516052246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4516005516052246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4518561363220215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.462846279144287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4635868072509766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4635868072509766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4638328552246094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.47613525390625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4770255088806152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4770255088806152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4772753715515137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4915175437927246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492171287536621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492171287536621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4923429489135742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5033292770385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.504079818725586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.504079818725586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5042457580566406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5160274505615234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516632080078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516632080078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5167560577392578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5264263153076172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5270910263061523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5270910263061523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5272111892700195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5374250411987305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5379400253295898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5379400253295898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5380277633666992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5460996627807617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546607494354248  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546607494354248  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5466856956481934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5544276237487793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5549511909484863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5549511909484863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.555025577545166  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562910556793213  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.56345796585083  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.56345796585083  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.563530445098877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5717206001281738  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5721092224121094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5721092224121094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5721588134765625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5781097412109375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785179138183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785179138183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785655975341797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5846214294433594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5852551460266113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5852551460266113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5853238105773926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59452486038208  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594933032989502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594933032989502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5949769020080566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6011624336242676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6015243530273438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6015243530273438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6015605926513672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.606924057006836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072444915771484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072444915771484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072750091552734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6120052337646484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612410068511963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612410068511963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6124463081359863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6183171272277832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618645191192627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618645191192627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6186738014221191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6235089302062988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([304, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6311712265014648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6311712265014648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6317510604858398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7477755546569824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7285571098327637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7289810180664062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7294049263000488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.728959560394287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21406
output nodes number: 2842
edges number: 23421
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7291407585144043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7291412353515625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04946327209472656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 17 input nodes size: 69586
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04538679122924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04538679122924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0785679817199707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07858943939208984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04473066329956055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0461268424987793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0461268424987793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0461268424987793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([69586, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0461268424987793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([873, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12697982788085938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12697982788085938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12781238555908203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1347503662109375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([1070, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13535451889038086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13535451889038086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13637495040893555  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15168142318725586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([1097, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.152740478515625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.152740478515625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15378665924072266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17774152755737305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1127, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18001079559326172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18001079559326172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18108558654785156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21243953704833984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1063, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21443653106689453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21443653106689453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21545028686523438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25235605239868164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([937, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2545299530029297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2545299530029297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25542354583740234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2943735122680664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([907, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2969541549682617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2969541549682617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2978191375732422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34250402450561523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([864, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.345367431640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.345367431640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34619140625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3931694030761719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([754, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3959932327270508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3959932327270508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3967123031616211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44356822967529297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([12267, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5017023086547852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5017023086547852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12267, 128]), torch.Size([1, 12267, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5134010314941406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.344050407409668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12267, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2693748474121094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.289362907409668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3093509674072266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2892065048217773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([20959, 256])
first layer input nodes number: 69586
first layer output nodes number: 20959
edges number: 164466
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3098716735839844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.329859733581543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3348569869995117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3348569869995117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3573665618896484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3573665618896484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3581809997558594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3657593727111816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3660807609558105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3660807609558105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3668036460876465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3808913230895996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3813462257385254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3813462257385254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3818860054016113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4000134468078613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4006896018981934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4006896018981934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4011588096618652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4147658348083496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([175, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.415372371673584  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.415372371673584  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4157061576843262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.427722454071045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4284210205078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4284210205078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4287071228027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.441009521484375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4416942596435547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4416942596435547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4419288635253906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4536590576171875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4544878005981445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4544878005981445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4547224044799805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.468094825744629  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4687824249267578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4687824249267578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4689598083496094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4803123474121094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4810118675231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4810118675231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.481168270111084  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4922728538513184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4928078651428223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4928078651428223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4929184913635254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5015473365783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502230167388916  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502230167388916  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502352237701416  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512728214263916  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513354778289795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513354778289795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5134596824645996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5231108665466309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523691177368164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523691177368164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5237808227539062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5326557159423828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5332598686218262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5332598686218262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5333456993103027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5424437522888184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5428624153137207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5428624153137207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542919635772705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5493855476379395  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5500268936157227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5500268936157227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.550105094909668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5594892501831055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.559779167175293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.559779167175293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5598154067993164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564417839050293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5648932456970215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5648932456970215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5649447441101074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.571845531463623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5722427368164062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5722427368164062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5722846984863281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5782012939453125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785236358642578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785236358642578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5785560607910156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5833549499511719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5837831497192383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5837831497192383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5838232040405273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.590031623840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5904541015625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5904541015625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5904922485351562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5966720581054688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969300270080566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969300270080566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969529151916504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6008210182189941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([283, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.607609748840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.607609748840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608149528503418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7249598503112793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 283, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7055258750915527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7059497833251953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.706373691558838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7059283256530762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 20959
output nodes number: 2842
edges number: 22863
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.706106185913086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7061066627502441  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04871416091918945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 18 input nodes size: 70005
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04473066329956055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04473066329956055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07811164855957031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07813310623168945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044930458068847656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04631996154785156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04631996154785156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04631996154785156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70005, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04631996154785156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([826, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12684392929077148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12684392929077148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12763166427612305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13489341735839844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([1077, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1355266571044922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1355266571044922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13655376434326172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1519603729248047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1179, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15313339233398438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15313339233398438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1179, 128]), torch.Size([1, 1179, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15425777435302734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17899417877197266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1179, 128])
m.shape torch.Size([1105, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18067550659179688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18067550659179688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18172931671142578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21285247802734375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1089, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2149219512939453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2149219512939453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21596050262451172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2544121742248535  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1000, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25675392150878906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25675392150878906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2577075958251953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29917335510253906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([916, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3017539978027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3017539978027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3026275634765625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34720802307128906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([892, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3501739501953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3501739501953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 892, 128]), torch.Size([1, 892, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3510246276855469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40105438232421875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 892, 128])
m.shape torch.Size([840, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4042339324951172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4042339324951172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40503501892089844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4578266143798828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([12034, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5148086547851562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5148086547851562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12034, 128]), torch.Size([1, 12034, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5262851715087891  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3416023254394531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12034, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2673392295837402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2873263359069824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.307898998260498  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2877554893493652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([20958, 256])
first layer input nodes number: 70005
first layer output nodes number: 20958
edges number: 163830
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.308422565460205  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3284096717834473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3334064483642578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3334064483642578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([428, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3556571006774902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3556571006774902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.356473445892334  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3650555610656738  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([364, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3653473854064941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3653473854064941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.366041660308838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3803200721740723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3808927536010742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3808927536010742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3815011978149414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3949270248413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3955416679382324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3955416679382324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3959975242614746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.409217357635498  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([180, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4098548889160156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4098548889160156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4101982116699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4225578308105469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4232516288757324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4232516288757324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4235377311706543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.435840129852295  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4365720748901367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4365720748901367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4368200302124023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4492177963256836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4498934745788574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4498934745788574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.45009183883667  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4613986015319824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4620437622070312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4620437622070312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4622077941894531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4727058410644531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.473402500152588  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.473402500152588  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4735569953918457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4845261573791504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4851999282836914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4851999282836914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.485335350036621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4958982467651367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.496638298034668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.496638298034668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4967718124389648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5081205368041992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5087037086486816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5087037086486816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.508802890777588  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.517927646636963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5184974670410156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5184974670410156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.518585205078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5272712707519531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5277900695800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5277900695800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5278644561767578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5357494354248047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5362353324890137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5362353324890137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5363001823425293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.543628215789795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5441350936889648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5441350936889648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5441980361938477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5517511367797852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5523080825805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5523080825805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552372932434082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5606088638305664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5609416961669922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5609416961669922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5609798431396484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566091537475586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566495418548584  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.566495418548584  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5665373802185059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5724539756774902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5729379653930664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5729379653930664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5729856491088867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580042839050293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580209732055664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.580209732055664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5802268981933594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5828876495361328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5832109451293945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5832109451293945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5832395553588867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.587874412536621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588137149810791  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588137149810791  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5881600379943848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5920281410217285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5987205505371094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5987205505371094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.599252700805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7018628120422363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6826906204223633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6831145286560059  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6835384368896484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6830930709838867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 20958
output nodes number: 2842
edges number: 22589
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6832709312438965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6832714080810547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04890155792236328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 19 input nodes size: 69532
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044930458068847656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.044930458068847656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07808589935302734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07810735702514648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04470491409301758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04609251022338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04609251022338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04609251022338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([69532, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04609251022338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([823, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12630558013916016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12630558013916016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1270904541015625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13336944580078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([978, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1339097023010254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1339097023010254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1348423957824707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1488327980041504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([1110, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14995431900024414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14995431900024414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15101289749145508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1752486228942871  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1125, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1768651008605957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1768651008605957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17793798446655273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.20969057083129883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1104, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21178627014160156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21178627014160156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21283912658691406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25132179260253906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1012, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2536907196044922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2536907196044922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1012, 128]), torch.Size([1, 1012, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2546558380126953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29653358459472656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1012, 128])
m.shape torch.Size([897, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2990450859069824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2990450859069824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29990053176879883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3433842658996582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([877, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3463020324707031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3463020324707031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3471384048461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39481163024902344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([793, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.397796630859375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.397796630859375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39855289459228516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4471554756164551  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([12057, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5042695999145508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5042695999145508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12057, 128]), torch.Size([1, 12057, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5157680511474609  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3325986862182617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12057, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.258540153503418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2783536911010742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2981672286987305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2781987190246582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([20776, 256])
first layer input nodes number: 69532
first layer output nodes number: 20776
edges number: 163203
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.29868745803833  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3185009956359863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3234543800354004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3234543800354004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([413, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3459248542785645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3459248542785645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.346712589263916  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3551387786865234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3554353713989258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3554353713989258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3561201095581055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3700590133666992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.37054443359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.37054443359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3710918426513672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3838276863098145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3845000267028809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3845000267028809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3849692344665527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.398576259613037  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3993682861328125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3993682861328125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3997631072998047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4139766693115234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4147367477416992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4147367477416992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.415053367614746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4286680221557617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4292702674865723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4292702674865723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.42948579788208  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4402623176574707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4409313201904297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4409313201904297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4411239624023438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4521045684814453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4528560638427734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4528560638427734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.453042984008789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.465005874633789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4657678604125977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4657678604125977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.465937614440918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4779901504516602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4787616729736328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4787616729736328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4789161682128906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490966796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4916162490844727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4916162490844727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4917364120483398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5019502639770508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5025525093078613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5025525093078613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5026535987854004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5119538307189941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5125360488891602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5125360488891602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5126256942749023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521500587463379  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5219173431396484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5219173431396484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5219783782958984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5284481048583984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5288639068603516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5288639068603516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5289192199707031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5351696014404297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5357141494750977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5357141494750977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535780906677246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5437917709350586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544294834136963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544294834136963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.54435396194458  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551863193511963  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552363395690918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.552363395690918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5524187088012695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.559830665588379  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5602068901062012  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5602068901062012  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5602469444274902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565894603729248  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5663189888000488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5663189888000488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5663609504699707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5725712776184082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5727620124816895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5727620124816895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5727810859680176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575737476348877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5759491920471191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5759491920471191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5759682655334473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5790581703186035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5794639587402344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5794639587402344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.579498291015625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5853004455566406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([282, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59205961227417  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59205961227417  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.592597484588623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.696016788482666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 282, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6766095161437988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6770334243774414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.677457332611084  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6770119667053223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 20776
output nodes number: 2842
edges number: 22834
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6771883964538574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6771888732910156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.048666954040527344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 20 input nodes size: 70288
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04470491409301758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04470491409301758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07822084426879883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07824230194091797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04506540298461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04648160934448242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04648160934448242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04648160934448242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70288, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04648160934448242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([839, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12847280502319336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12847280502319336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1292729377746582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1365976333618164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([1130, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13727521896362305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13727521896362305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1383528709411621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15451765060424805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([1059, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15549373626708984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15549373626708984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15650367736816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1791090965270996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([1132, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18076324462890625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18076324462890625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18184280395507812  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21324920654296875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1106, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2153463363647461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2153463363647461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2164011001586914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25491809844970703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1033, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25734615325927734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25734615325927734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1033, 128]), torch.Size([1, 1033, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.258331298828125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3012361526489258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1033, 128])
m.shape torch.Size([890, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3037142753601074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3037142753601074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.304563045501709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34869813919067383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([882, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3516383171081543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3516383171081543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 882, 128]), torch.Size([1, 882, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3524794578552246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4004244804382324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 882, 128])
m.shape torch.Size([785, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40337276458740234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40337276458740234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40412139892578125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4521803855895996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([12394, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5109052658081055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5109052658081055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12394, 128]), torch.Size([1, 12394, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5227251052856445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.361933708190918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12394, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2862062454223633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.306471824645996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.326737403869629  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3063130378723145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21250, 256])
first layer input nodes number: 70288
first layer output nodes number: 21250
edges number: 166823
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.327263355255127  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3475289344787598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.352595329284668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.352595329284668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375399112701416  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.375399112701416  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3762307167053223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3831467628479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([388, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3834772109985352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3834772109985352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3842172622680664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3969430923461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([271, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3973546028137207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3973546028137207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.397871494293213  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4148564338684082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4154553413391113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4154553413391113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4158806800842285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.428215503692627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4289112091064453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4289112091064453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4292716979980469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4422492980957031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4428939819335938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4428939819335938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.443166732788086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.45489501953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4555797576904297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4555797576904297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4558124542236328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.467447280883789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4681921005249023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4681921005249023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4684057235717773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4805822372436523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4812021255493164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4812021255493164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4813623428344727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4916162490844727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492286205291748  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.492286205291748  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4924349784851074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502997875213623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5037379264831543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5037379264831543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5038847923278809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5153403282165527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5159821510314941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5159821510314941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5161004066467285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5261521339416504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5268054008483887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5268054008483887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.526914119720459  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5369162559509277  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5373735427856445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5373735427856445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5374460220336914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.544621467590332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545219898223877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.545219898223877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5453038215637207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5541996955871582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5546345710754395  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5546345710754395  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5546936988830566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5613751411437988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5620484352111816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5620484352111816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5621304512023926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.571972370147705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5724334716796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5724334716796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.572488784790039  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5795135498046875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5800704956054688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5800704956054688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5801315307617188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5883102416992188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5887799263000488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5887799263000488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588829517364502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5958218574523926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5961809158325195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5961809158325195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.596217155456543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6015806198120117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6020069122314453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6020069122314453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6020469665527344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608255386352539  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6085009574890137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6085009574890137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6085238456726074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.612231731414795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6124744415283203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6124744415283203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6124954223632812  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6160411834716797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([294, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6230950355529785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6230950355529785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6236557960510254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7382774353027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 294, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7185492515563965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.718973159790039  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7193970680236816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.71895170211792  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21250
output nodes number: 2842
edges number: 23158
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7191319465637207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.719132423400879  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049103736877441406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 21 input nodes size: 70191
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04506540298461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04506540298461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07853507995605469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07855653762817383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04501914978027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046416282653808594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046416282653808594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046416282653808594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70191, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046416282653808594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([806, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1272115707397461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1272115707397461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12798023223876953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1346888542175293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([1103, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13535642623901367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13535642623901367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13640832901000977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15218687057495117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1122, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15326595306396484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15326595306396484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15433597564697266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1784505844116211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1136, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1803264617919922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1803264617919922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1814098358154297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2128582000732422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1063, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21485090255737305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21485090255737305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2158646583557129  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2527189254760742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([951, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25493288040161133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25493288040161133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25583982467651367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29511022567749023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([922, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29773426055908203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.29773426055908203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2986135482788086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34339141845703125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([846, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3461790084838867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3461790084838867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3469858169555664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39316463470458984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([804, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3962116241455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3962116241455078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39697837829589844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44655609130859375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([12201, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5043516159057617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5043516159057617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12201, 128]), torch.Size([1, 12201, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5159873962402344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3422937393188477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12201, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2676730155944824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.287656307220459  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3076395988464355  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2874999046325684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([20954, 256])
first layer input nodes number: 70191
first layer output nodes number: 20954
edges number: 164411
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3081645965576172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3281478881835938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.333143711090088  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.333143711090088  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3557429313659668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3557429313659668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3565287590026855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.364333152770996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([381, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3646726608276367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3646726608276367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3653993606567383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3801069259643555  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38055419921875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38055419921875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3810901641845703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3938441276550293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3946313858032227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3946313858032227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395125389099121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4102602005004883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([171, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4108352661132812  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4108352661132812  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4111614227294922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.422903060913086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4236054420471191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4236054420471191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.423891544342041  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4361939430236816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.437093734741211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.437093734741211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4373893737792969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4521713256835938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4527158737182617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4527158737182617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4528875350952148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.462672233581543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4633913040161133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4633913040161133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4635686874389648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4749212265014648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4757075309753418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4757075309753418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4758810997009277  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4882044792175293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4888582229614258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4888582229614258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4889917373657227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.499405860900879  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5000314712524414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5000314712524414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5001459121704102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.509873390197754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5104036331176758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5104036331176758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.510493278503418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5187406539916992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5191669464111328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5191669464111328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5192337036132812  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5258426666259766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5263571739196777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5263571739196777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5264296531677246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5341124534606934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.534660816192627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.534660816192627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5347332954406738  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5429234504699707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5433940887451172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5433940887451172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5434532165527344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5505485534667969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5510554313659668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5510554313659668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551114559173584  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5586237907409668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5590143203735352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5590143203735352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5590581893920898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564936637878418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5655298233032227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5655298233032227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5655908584594727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5741968154907227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5746712684631348  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5746712684631348  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.574718952178955  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5817761421203613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5820064544677734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5820064544677734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5820293426513672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5855770111083984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5858087539672852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5858087539672852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.585829734802246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.589228630065918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5895872116088867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5895872116088867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5896177291870117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5947751998901367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([290, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6017284393310547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6017284393310547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6022815704345703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7009258270263672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.681382179260254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6818060874938965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.682229995727539  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6817846298217773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 20954
output nodes number: 2842
edges number: 22967
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.681962490081787  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6819629669189453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04900979995727539  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 22 input nodes size: 70714
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04501914978027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04501914978027344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07873821258544922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07875967025756836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04526853561401367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04666948318481445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04666948318481445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04666948318481445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70714, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04666948318481445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([855, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12787675857543945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12787675857543945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1286921501159668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13521528244018555  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([1051, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1362447738647461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1362447738647461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13724708557128906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1522817611694336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1108, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15340805053710938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15340805053710938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1544647216796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17772674560546875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1115, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17932510375976562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17932510375976562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1803884506225586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21210098266601562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1162, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2143397331237793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2143397331237793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1162, 128]), torch.Size([1, 1162, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21544790267944336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2553420066833496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1162, 128])
m.shape torch.Size([1030, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2577347755432129  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2577347755432129  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25871706008911133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30131959915161133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([935, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30394935607910156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30394935607910156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3048410415649414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34950923919677734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([857, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35233259201049805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35233259201049805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3531498908996582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.400754451751709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([813, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40383481979370117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40383481979370117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40461015701293945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4552040100097656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([12175, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.512871265411377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.512871265411377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12175, 128]), torch.Size([1, 12175, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.524482250213623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3490777015686035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12175, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2741589546203613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2942824363708496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.314582347869873  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2943015098571777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21101, 256])
first layer input nodes number: 70714
first layer output nodes number: 21101
edges number: 165199
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3151111602783203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3352346420288086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3402657508850098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3402657508850098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([446, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.362717628479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.362717628479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3635683059692383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3716139793395996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([340, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.371842384338379  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.371842384338379  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3724908828735352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.385819911956787  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3863697052001953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3863697052001953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3869476318359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3996620178222656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4002265930175781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4002265930175781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4006500244140625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4129295349121094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4136457443237305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4136457443237305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4140138626098633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4272661209106445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.428102970123291  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.428102970123291  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4284348487854004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4427056312561035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4434146881103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4434146881103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4436626434326172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4560604095458984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4565978050231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4565978050231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4567618370056152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.466111660003662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4669556617736816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4669556617736816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4671597480773926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4802212715148926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4809269905090332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4809269905090332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4810872077941895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4924626350402832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4930591583251953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4930591583251953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4931812286376953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5027027130126953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5034375190734863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5034375190734863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5035691261291504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5147557258605957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.51527738571167  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.51527738571167  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.515367031097412  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5236144065856934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5240139961242676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5240139961242676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5240769386291504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5303082466125488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530940055847168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.530940055847168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5310277938842773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.540328025817871  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5407919883728027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5407919883728027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5408549308776855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5479674339294434  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5484428405761719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5484428405761719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.548501968383789  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5555973052978516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556173324584961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556173324584961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5562400817871094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564718246459961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565178394317627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565178394317627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565229892730713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5721306800842285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5726051330566406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5726051330566406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5726547241210938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5796470642089844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5802078247070312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5802078247070312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5802631378173828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.588449478149414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5887813568115234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5887813568115234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5888137817382812  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5938396453857422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5942435264587402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5942435264587402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5942797660827637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6001505851745605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6003632545471191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6003632545471191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6003823280334473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6036057472229004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([271, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101078987121582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101078987121582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6106247901916504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7056374549865723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 271, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6862897872924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.686713695526123  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6871376037597656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.686692237854004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21101
output nodes number: 2842
edges number: 22781
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.68687105178833  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6868715286254883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049271583557128906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 23 input nodes size: 71150
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04526853561401367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04526853561401367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07919549942016602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07921695709228516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045476436614990234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04691457748413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04691457748413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04691457748413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71150, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04691457748413086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([867, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13011932373046875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13011932373046875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13094615936279297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13756084442138672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([1035, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.138458251953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.138458251953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13944530487060547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1542510986328125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([1138, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15538549423217773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15538549423217773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15647077560424805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18034696578979492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1116, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18197107315063477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18197107315063477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18303537368774414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2142319679260254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1066, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21624135971069336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21624135971069336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21725797653198242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2541985511779785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1041, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2566685676574707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2566685676574707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2576613426208496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30092382431030273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([905, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3034482002258301  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3034482002258301  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30431127548217773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34820556640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([862, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3510622978210449  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3510622978210449  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3518843650817871  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3987593650817871  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([839, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4019489288330078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4019489288330078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40274906158447266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45461368560791016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([12611, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5147604942321777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5147604942321777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12611, 128]), torch.Size([1, 12611, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.526787281036377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3806891441345215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12611, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3037891387939453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3242740631103516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3447589874267578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3241138458251953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21480, 256])
first layer input nodes number: 71150
first layer output nodes number: 21480
edges number: 169283
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3452911376953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3657760620117188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3716802597045898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3716802597045898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3948612213134766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3948612213134766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395660400390625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.402132511138916  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4024176597595215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4024176597595215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4030966758728027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4140348434448242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4144625663757324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4144625663757324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4149699211120605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4283533096313477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4290647506713867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4290647506713867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4295434951782227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4434270858764648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([226, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444533348083496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444533348083496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4449644088745117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4604825973510742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4611554145812988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4611554145812988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.461449146270752  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4740796089172363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4747471809387207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4747471809387207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.474977970123291  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4865174293518066  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([88, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4870786666870117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4870786666870117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4872465133666992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4968137741088867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4975347518920898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4975347518920898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4977121353149414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5090646743774414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5096969604492188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5096969604492188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5098400115966797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5199966430664062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5205492973327637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5205492973327637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5206618309020996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5294394493103027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5302486419677734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5302486419677734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5303916931152344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542551040649414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5430421829223633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5430421829223633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5431280136108398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5510244369506836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5516142845153809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5516142845153809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.551703929901123  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5605788230895996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5610389709472656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5610389709472656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.561105728149414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5681819915771484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5686407089233398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5686407089233398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5687017440795898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5755987167358398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575944423675537  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.575944423675537  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5759882926940918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5812525749206543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5817499160766602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5817499160766602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5818071365356445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5890741348266602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58955717086792  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58955717086792  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5896105766296387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5967669486999512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5972018241882324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5972018241882324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59724760055542  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6037020683288574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6040830612182617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6040830612182617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.604121208190918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.609766960144043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.61014986038208  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.61014986038208  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101861000061035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6158032417297363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.616382122039795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.616382122039795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6164336204528809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6247763633728027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6250739097595215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6250739097595215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6251006126403809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6296133995056152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.637169361114502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.637169361114502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.637770175933838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7489542961120605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7288165092468262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7292404174804688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7296643257141113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7292189598083496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21480
output nodes number: 2842
edges number: 23567
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.729400634765625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7294011116027832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04957246780395508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 24 input nodes size: 70386
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045476436614990234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045476436614990234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07903909683227539  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07906055450439453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04511213302612305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04653215408325195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04653215408325195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04653215408325195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70386, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04653215408325195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([853, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12878894805908203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12878894805908203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12960243225097656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13670873641967773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([990, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13724613189697266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13724613189697266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13819026947021484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15235233306884766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([1107, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1534738540649414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1534738540649414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15452957153320312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1784801483154297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([1138, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18012285232543945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18012285232543945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18120813369750977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21309137344360352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1069, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21509742736816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21509742736816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21611690521240234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2532219886779785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1001, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25557613372802734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25557613372802734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1001, 128]), torch.Size([1, 1001, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25653076171875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2980184555053711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1001, 128])
m.shape torch.Size([998, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3008723258972168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3008723258972168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30182409286499023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35088014602661133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([865, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35370397567749023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35370397567749023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35452890396118164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40217161178588867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4052267074584961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4052267074584961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40599727630615234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45531368255615234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([12413, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5141181945800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5141181945800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12413, 128]), torch.Size([1, 12413, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5259561538696289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3666844367980957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12413, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2906875610351562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3109455108642578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3312034606933594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3107872009277344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21242, 256])
first layer input nodes number: 70386
first layer output nodes number: 21242
edges number: 167365
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3317298889160156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3519878387451172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3570523262023926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3570523262023926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([449, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3798465728759766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3798465728759766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3807029724121094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3875598907470703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([327, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3877606391906738  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3877606391906738  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3883843421936035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3992505073547363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3997058868408203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3997058868408203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4002132415771484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4157867431640625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4165096282958984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4165096282958984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4169940948486328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4310436248779297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4317626953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4317626953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4321441650390625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4458770751953125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.446591854095459  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.446591854095459  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4468913078308105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4597678184509277  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4604592323303223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4604592323303223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4606976509094238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.472618579864502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4732608795166016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4732608795166016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.47344970703125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.484212875366211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.484853744506836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.484853744506836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.485015869140625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.495391845703125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4962143898010254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4962143898010254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4963936805725098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5091233253479004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5099220275878906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5099220275878906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5100822448730469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5225791931152344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5232605934143066  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5232605934143066  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5233864784240723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5340867042541504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5348734855651855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5348734855651855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5350031852722168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5469355583190918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5475034713745117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5475034713745117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.547593116760254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5564680099487305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5568561553955078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5568561553955078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5569133758544922  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.562978744506836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5633807182312012  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5633807182312012  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.56343412399292  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5694689750671387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5698184967041016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5698184967041016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5698623657226562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5751266479492188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5755548477172852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5755548477172852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5756044387817383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5819025039672852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5823712348937988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5823712348937988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5824227333068848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5893235206604004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58974027633667  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.58974027633667  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5897841453552246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5959696769714355  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5964527130126953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5964527130126953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5965003967285156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6035575866699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6038298606872559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6038298606872559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6038565635681152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6079955101013184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6081814765930176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6081814765930176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.608198642730713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6109795570373535  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6115942001342773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6115942001342773  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6116456985473633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6203489303588867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([289, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6272673606872559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6272673606872559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6278185844421387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7425765991210938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 289, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7228755950927734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.723299503326416  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7237234115600586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7232780456542969  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21242
output nodes number: 2842
edges number: 23132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7234578132629395  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7234582901000977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04915666580200195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 25 input nodes size: 70342
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04511213302612305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04511213302612305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07865381240844727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0786752700805664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04648637771606445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04648637771606445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04648637771606445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70342, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04648637771606445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([825, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12729549407958984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12729549407958984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.128082275390625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13485956192016602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([1033, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1354513168334961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1354513168334961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1033, 128]), torch.Size([1, 1033, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13643646240234375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1512136459350586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1033, 128])
m.shape torch.Size([1128, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15233469009399414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15233469009399414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1128, 128]), torch.Size([1, 1128, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1534104347229004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1770768165588379  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1128, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17885828018188477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17885828018188477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.17991113662719727  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21102380752563477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1095, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21310806274414062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21310806274414062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21415233612060547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2526412010192871  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1042, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2551002502441406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2551002502441406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25609397888183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2993736267089844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([936, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3020009994506836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3020009994506836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30289363861083984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34752559661865234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([839, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3502798080444336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3502798080444336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35107994079589844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39725780487060547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([813, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4003467559814453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4003467559814453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4011220932006836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45195436477661133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([12142, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5094642639160156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5094642639160156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12142, 128]), torch.Size([1, 12142, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5210437774658203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3434677124023438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12142, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.268871784210205  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2888579368591309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3088440895080566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.2887015342712402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([20957, 256])
first layer input nodes number: 70342
first layer output nodes number: 20957
edges number: 164419
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.309370517730713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3293566703796387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3343534469604492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3343534469604492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3566861152648926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3566861152648926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3574929237365723  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.365452766418457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.365743637084961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.365743637084961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3664321899414062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3806934356689453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3812146186828613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3812146186828613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.381786823272705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3943753242492676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([268, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3951845169067383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3951845169067383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.395695686340332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.411412239074707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.412041187286377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.412041187286377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4123921394348145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4250264167785645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4257912635803223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4257912635803223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4261021614074707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4394707679748535  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4401297569274902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4401297569274902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4403605461120605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4519000053405762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4525842666625977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4525842666625977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4527826309204102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4640893936157227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4646563529968262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4646563529968262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4648032188415527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4742026329040527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4749751091003418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4749751091003418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4751429557800293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4870600700378418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4876742362976074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4876742362976074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.487800121307373  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4976191520690918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([81, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.498490810394287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.498490810394287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.498645305633545  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.511777400970459  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512275218963623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512275218963623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5123629570007324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.520434856414795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5210237503051758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5210237503051758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.521113395690918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5299882888793945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5302462577819824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5302462577819824  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5302863121032715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.534532070159912  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535019874572754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.535019874572754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5350828170776367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5421953201293945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542686939239502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542686939239502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.542747974395752  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.550072193145752  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5504226684570312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5504226684570312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5504646301269531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5557937622070312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5562663078308105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5562663078308105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5563178062438965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.563218593597412  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5636353492736816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5636353492736816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5636792182922363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5698647499084473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703072547912598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703072547912598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5703511238098145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5768437385559082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577096939086914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.577096939086914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5771217346191406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5809650421142578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5812625885009766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5812625885009766  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581289291381836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5856151580810547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5859251022338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5859251022338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.585951805114746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5904645919799805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5974435806274414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5974435806274414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5979986190795898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6980223655700684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6787528991699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6791768074035645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.679600715637207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6791553497314453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 20957
output nodes number: 2842
edges number: 22679
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.679333209991455  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6793336868286133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049077510833740234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 26 input nodes size: 71480
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04509115219116211  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07917547225952148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07919692993164062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045633792877197266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0470738410949707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0470738410949707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0470738410949707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71480, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0470738410949707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([824, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13040876388549805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13040876388549805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1311945915222168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1374812126159668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([1064, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13816022872924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13816022872924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1391749382019043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15439558029174805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1136, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15551328659057617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15551328659057617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15659666061401367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18046140670776367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1122, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18205976486206055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18205976486206055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18312978744506836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2144312858581543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1129, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21658802032470703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21658802032470703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1129, 128]), torch.Size([1, 1129, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2176647186279297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2565765380859375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1129, 128])
m.shape torch.Size([975, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25882768630981445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25882768630981445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25975751876831055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3006749153137207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([962, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3034210205078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3034210205078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3043384552001953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35021018981933594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([842, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3529634475708008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3529634475708008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35376644134521484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40050172805786133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([859, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40378665924072266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40378665924072266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4046058654785156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4570350646972656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([12605, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5171723365783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5171723365783691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12605, 128]), torch.Size([1, 12605, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5301499366760254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3836455345153809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3066191673278809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3271403312683105  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3476614952087402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.326979637145996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21518, 256])
first layer input nodes number: 71480
first layer output nodes number: 21518
edges number: 169594
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.348196029663086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3687171936035156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.374727725982666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.374727725982666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.397958755493164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.397958755493164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3987483978271484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4051671028137207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([348, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4054412841796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4054412841796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4061050415039062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4161872863769531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4167523384094238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4167523384094238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4173455238342285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4318547248840332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4323735237121582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4323735237121582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4327778816223145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4445042610168457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4452824592590332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4452824592590332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.445671558380127  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.459679126739502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4602632522583008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4602632522583008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4605207443237305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.471592903137207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4723658561706543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4723658561706543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4726214408874512  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.485400676727295  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4860496520996094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4860496520996094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4862422943115234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.497222900390625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4979743957519531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4979743957519531  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4981613159179688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5101242065429688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5108575820922852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5108575820922852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.511021614074707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5226678848266602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5232734680175781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5232734680175781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523397445678711  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5330677032470703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5336980819702148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5336980819702148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5338125228881836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5435400009155273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5442328453063965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5442328453063965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5443472862243652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5548758506774902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5554242134094238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5554242134094238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5555100440979004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.56400728225708  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5644402503967285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5644402503967285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5645031929016113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5711750984191895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.571728229522705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.571728229522705  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.571800708770752  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5799908638000488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5804777145385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5804777145385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5805387496948242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5878629684448242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5884380340576172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5884380340576172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5885047912597656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5969829559326172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5974431037902832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5974431037902832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5974946022033691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6043953895568848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.604792594909668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.604792594909668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6048345565795898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6107511520385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112351417541504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112351417541504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6112828254699707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618340015411377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618781566619873  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618781566619873  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618823528289795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6253275871276855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.625638484954834  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.625638484954834  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6256670951843262  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6303019523620605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.63063383102417  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.63063383102417  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.630662441253662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6354975700378418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6428122520446777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6428122520446777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6433939933776855  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.753859519958496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7336764335632324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.734100341796875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7345242500305176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7340788841247559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21518
output nodes number: 2842
edges number: 23623
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7342610359191895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7342615127563477  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04973793029785156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 27 input nodes size: 71459
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045633792877197266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045633792877197266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07970809936523438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07972955703735352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045623779296875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04707908630371094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04707908630371094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04707908630371094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71459, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04707908630371094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1315922737121582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1315922737121582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13236665725708008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13856172561645508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([1055, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13918066024780273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13918066024780273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14018678665161133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15527868270874023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([1146, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15658092498779297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15658092498779297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1146, 128]), torch.Size([1, 1146, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15767383575439453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1817178726196289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1146, 128])
m.shape torch.Size([1092, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18325424194335938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18325424194335938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.184295654296875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.215179443359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1115, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2173171043395996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2173171043395996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21838045120239258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25713062286376953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1046, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25959157943725586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25959157943725586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2605891227722168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30371618270874023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([983, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30649852752685547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30649852752685547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3074359893798828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35598134994506836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([911, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35898780822753906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35898780822753906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35985660552978516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4102134704589844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([837, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41337108612060547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41337108612060547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4141693115234375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.46562957763671875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([12701, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5257935523986816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5257935523986816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12701, 128]), torch.Size([1, 12701, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5379061698913574  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.397902011871338  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12701, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3197484016418457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3404412269592285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3611340522766113  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3402791023254395  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21698, 256])
first layer input nodes number: 71459
first layer output nodes number: 21698
edges number: 171291
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.361668586730957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3823614120483398  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38814115524292  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.38814115524292  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4115972518920898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4115972518920898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4123830795288086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4190387725830078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4193224906921387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4193224906921387  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4199938774108887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4301819801330566  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([270, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4306249618530273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4306249618530273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4311399459838867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4436883926391602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444307804107666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.444307804107666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4447426795959473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4573540687561035  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4580497741699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4580497741699219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4584121704101562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4714584350585938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4721307754516602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4721307754516602  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4724130630493164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4845514297485352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4853391647338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4853391647338867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4856023788452148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.498763084411621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4994468688964844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4994468688964844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4996490478515625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5111732482910156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118770599365234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5118770599365234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512054443359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.523406982421875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5242314338684082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5242314338684082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5244126319885254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5372776985168457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5380120277404785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5380120277404785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.538160800933838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5497651100158691  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5503253936767578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5503253936767578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5504302978515625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.559347152709961  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5599570274353027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5599570274353027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5600581169128418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5693583488464355  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701017379760742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5701017379760742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5702142715454102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.581355094909668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5818181037902832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5818181037902832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5818867683410645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.589165210723877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5897459983825684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5897459983825684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5898222923278809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5984435081481934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.598928451538086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.598928451538086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.598989486694336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.606313705444336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066293716430664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066293716430664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6066675186157227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6115121841430664  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6119132041931152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6119132041931152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.61195707321167  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.617835521697998  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618332862854004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618332862854004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6183843612670898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.625645637512207  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.626023769378662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.626023769378662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6260619163513184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6317076683044434  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6320695877075195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6320695877075195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6321039199829102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.637425422668457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6378064155578613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6378064155578613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.637840747833252  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6434025764465332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.643754482269287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.643754482269287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.643784999847412  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.648942470550537  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.656496524810791  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.656496524810791  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.657097339630127  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7656888961791992  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7452712059020996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7456951141357422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7461190223693848  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.745673656463623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21698
output nodes number: 2842
edges number: 23860
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7458572387695312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7458577156066895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049764156341552734  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 28 input nodes size: 70609
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045623779296875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045623779296875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07929277420043945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0793142318725586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045218467712402344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04665184020996094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04665184020996094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04665184020996094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70609, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04665184020996094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12955617904663086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12955617904663086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13032770156860352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13653182983398438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([1101, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1376333236694336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1376333236694336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13868331909179688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1544332504272461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1077, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15544891357421875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15544891357421875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15647602081298828  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1793227195739746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1089, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18088626861572266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18088626861572266  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18192481994628906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21288013458251953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1122, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21503591537475586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21503591537475586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21610593795776367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2548975944519043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1014, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2572636604309082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2572636604309082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25823068618774414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30087995529174805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([855, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3032503128051758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3032503128051758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3040657043457031  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34490156173706055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([843, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34770965576171875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34770965576171875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3485136032104492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3947887420654297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([772, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39769983291625977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.39769983291625977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3984360694885254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.44606447219848633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([12676, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5062432289123535  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5062432289123535  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12676, 128]), torch.Size([1, 12676, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5183320045471191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3766350746154785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12676, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.299912452697754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3202810287475586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3406496047973633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3201217651367188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21358, 256])
first layer input nodes number: 70609
first layer output nodes number: 21358
edges number: 168729
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3411779403686523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.361546516418457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3666386604309082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3666386604309082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3896918296813965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3896918296813965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.390491008758545  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3968844413757324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3971753120422363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3971753120422363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.397860050201416  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4083027839660645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4087910652160645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4087910652160645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4093403816223145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4224553108215332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4230036735534668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4230036735534668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4234118461608887  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.435248851776123  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4361109733581543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4361109733581543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.436521053314209  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4512839317321777  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4519844055175781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4519844055175781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4522838592529297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4651603698730469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4657912254333496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4657912254333496  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4660124778747559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4770750999450684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4778103828430176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4778103828430176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.478020191192627  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4899792671203613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4907135963439941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4907135963439941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.490898609161377  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.502739429473877  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5035219192504883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5035219192504883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5036954879760742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5160188674926758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5166616439819336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5166616439819336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5167932510375977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5270586013793945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5277080535888672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5277080535888672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5278263092041016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5378780364990234  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5383687019348145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5383687019348145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5384526252746582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5461735725402832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5467910766601562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5467910766601562  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546884536743164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5561370849609375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5565953254699707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5565953254699707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5566620826721191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5637383460998535  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564197063446045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564197063446045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.564258098602295  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.571155071258545  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5716476440429688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5716476440429688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5717086791992188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5790328979492188  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5792794227600098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5792794227600098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5793099403381348  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5831856727600098  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5835542678833008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5835542678833008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5835943222045898  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5889616012573242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5895566940307617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5895566940307617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5896177291870117  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5982236862182617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.598536491394043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.598536491394043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5985689163208008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.603367805480957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6037745475769043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6037745475769043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6038126945495605  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6097254753112793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101264953613281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101264953613281  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6101627349853516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6160335540771484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6164307594299316  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6164307594299316  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6164650917053223  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.622267246246338  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([310, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6296992301940918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6296992301940918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6302905082702637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7371211051940918  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 310, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7171149253845215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.717538833618164  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7179627418518066  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.717517375946045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21358
output nodes number: 2842
edges number: 23434
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.717698097229004  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.717698574066162  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049297332763671875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 29 input nodes size: 72459
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045218467712402344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045218467712402344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07976961135864258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07979106903076172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046100616455078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04755401611328125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04755401611328125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04755401611328125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([72459, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04755401611328125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([826, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13207197189331055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13207197189331055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1328597068786621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1391615867614746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([1163, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1398768424987793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1398768424987793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1163, 128]), torch.Size([1, 1163, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14098596572875977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15800905227661133  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1163, 128])
m.shape torch.Size([1157, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15910959243774414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15910959243774414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.16021299362182617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1847095489501953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([1056, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1861720085144043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1861720085144043  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1871790885925293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2163844108581543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([1057, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2184009552001953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2184009552001953  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21940898895263672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2565903663635254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([1007, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25896739959716797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25896739959716797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25992774963378906  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3015470504760742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([993, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3043813705444336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3043813705444336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 993, 128]), torch.Size([1, 993, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.305328369140625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3532695770263672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 993, 128])
m.shape torch.Size([894, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35620641708374023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35620641708374023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3570590019226074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40720510482788086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([817, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41028499603271484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41028499603271484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.41106414794921875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4622035026550293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([12756, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.522639274597168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.522639274597168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12756, 128]), torch.Size([1, 12756, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5348043441772461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.398524284362793  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12756, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3203587532043457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.341078281402588  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.36179780960083  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3409161567687988  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21726, 256])
first layer input nodes number: 72459
first layer output nodes number: 21726
edges number: 171190
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.362339973449707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3830595016479492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3883357048034668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3883357048034668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([377, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.411677360534668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.411677360534668  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4123964309692383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4183855056762695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4187602996826172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4187602996826172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4194889068603516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4304180145263672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4308757781982422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4308757781982422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4314193725585938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4450702667236328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4456367492675781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4456367492675781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4460525512695312  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4581108093261719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4588065147399902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4588065147399902  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.459165096282959  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.472074031829834  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4728751182556152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4728751182556152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4731993675231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4871420860290527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4878883361816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4878883361816406  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4881458282470703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5010204315185547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5016837120056152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5016837120056152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.501880168914795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513078212738037  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513810634613037  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513810634613037  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.513993740081787  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.525712490081787  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5264286994934082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5264286994934082  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5265889167785645  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5379643440246582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5386033058166504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5386033058166504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5387330055236816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5488495826721191  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5494308471679688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5494308471679688  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5495376586914062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5586166381835938  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5591630935668945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5591630935668945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5592546463012695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5676774978637695  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5683722496032715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5683722496032715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5684771537780762  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5788626670837402  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5794157981872559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5794157981872559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.579495906829834  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5879874229431152  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5883779525756836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5883779525756836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5884313583374023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.594466209411621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5951261520385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5951261520385742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5952062606811523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6048192977905273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6053156852722168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6053156852722168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.605374813079834  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6128840446472168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6134023666381836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6134023666381836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.613459587097168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6211271286010742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6216368675231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6216368675231934  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.621690273284912  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6292204856872559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6296782493591309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6296782493591309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6297240257263184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6364989280700684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.63692045211792  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.63692045211792  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.636960506439209  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6431689262390137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6436352729797363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6436352729797363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6436772346496582  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.650475025177002  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6507773399353027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6507773399353027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.650804042816162  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6553168296813965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6623921394348145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6623921394348145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6629548072814941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7631478309631348  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7428288459777832  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7432527542114258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7436766624450684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7432312965393066  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2842, 40])
input nodes number: 21726
output nodes number: 2842
edges number: 23778
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7434148788452148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.743415355682373  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.05024385452270508  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 30 input nodes size: 71221
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046100616455078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.046100616455078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.08006143569946289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.08008289337158203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.045510292053222656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04696846008300781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04696846008300781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04696846008300781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([71221, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04696846008300781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([880, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1315169334411621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1315169334411621  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1323561668395996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1390700340270996  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([1022, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13962507247924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13962507247924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.14059972763061523  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15521955490112305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([1121, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15633583068847656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15633583068847656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15740489959716797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1812124252319336  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1105, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1827855110168457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1827855110168457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1838393211364746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21496248245239258  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1060, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2169628143310547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2169628143310547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2179737091064453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.254852294921875  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([1025, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2572793960571289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2572793960571289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1025, 128]), torch.Size([1, 1025, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.2582569122314453  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3011150360107422  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1025, 128])
m.shape torch.Size([931, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30373382568359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30373382568359375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30462169647216797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34917545318603516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([913, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35221433639526367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.35221433639526367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3530850410461426  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40332746505737305  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([839, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4064927101135254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4064927101135254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.40729284286499023  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.45963621139526367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([12814, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5203380584716797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5203380584716797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12814, 128]), torch.Size([1, 12814, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5325584411621094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.428701400756836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12814, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3504996299743652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.371203899383545  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3919081687927246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3710417747497559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21710, 256])
first layer input nodes number: 71221
first layer output nodes number: 21710
edges number: 171669
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3924407958984375  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4131450653076172  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4188556671142578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4188556671142578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([424, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4423542022705078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4423542022705078  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4431629180908203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4496326446533203  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([334, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4498705863952637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4498705863952637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.450507640838623  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4607529640197754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4612622261047363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4612622261047363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4618096351623535  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4746899604797363  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4752278327941895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4752278327941895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.475630283355713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4873013496398926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4879603385925293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4879603385925293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4883017539978027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5005927085876465  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([180, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.501460075378418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.501460075378418  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5018033981323242  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.516566276550293  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.517188549041748  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.517188549041748  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.51741361618042  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5286669731140137  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5294771194458008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5294771194458008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5297060012817383  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5427522659301758  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.543355941772461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.543355941772461  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5435142517089844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5536460876464844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5544323921203613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5544323921203613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5546040534973145  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5667920112609863  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.567488670349121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.567488670349121  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5676298141479492  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.578639030456543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5791683197021484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5791683197021484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5792675018310547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.587697982788086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5882859230041504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5882859230041504  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5883831977844238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.59733247756958  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5978894233703613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5978894233703613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.597975254058838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6064724922180176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072373390197754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6072373390197754  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.607344150543213  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618666172027588  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618997573852539  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.618997573852539  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6190452575683594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6244335174560547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6249980926513672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6249980926513672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6250667572021484  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6333065032958984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6339468955993652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6339468955993652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.634021282196045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6434683799743652  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6439247131347656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6439247131347656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6439762115478516  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6508769989013672  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6515240669250488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6515240669250488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6515908241271973  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.661003589630127  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6613540649414062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6613540649414062  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6613903045654297  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6667537689208984  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.666989803314209  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.666989803314209  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6670126914978027  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.670560359954834  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6709470748901367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6709470748901367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6709814071655273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6765432357788086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6767802238464355  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6767802238464355  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6768012046813965  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.680346965789795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([314, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6878814697265625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6878814697265625  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6884803771972656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7957220077514648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 314, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7752723693847656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.77569580078125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7761192321777344  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7756743431091309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2840, 40])
input nodes number: 21710
output nodes number: 2840
edges number: 23894
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7758574485778809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.775857925415039  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04965400695800781  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

pseudo mini batch 31 input nodes size: 70865
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04550981521606445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04550981521606445  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.0793008804321289  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.07932233810424805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04534006118774414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04674863815307617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04674863815307617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04674863815307617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([70865, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.04674863815307617  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([829, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12825918197631836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12825918197631836  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.12904977798461914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.1353745460510254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([1163, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13634777069091797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13634777069091797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1163, 128]), torch.Size([1, 1163, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.13745689392089844  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15409374237060547  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1163, 128])
m.shape torch.Size([1164, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15520429611206055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15520429611206055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.15631437301635742  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18073606491088867  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([1122, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18232107162475586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18232107162475586  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.18339109420776367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21461248397827148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1082, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21665716171264648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21665716171264648  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 1082, 128]), torch.Size([1, 1082, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.21768903732299805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.25585412979125977  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 1082, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.258176326751709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.258176326751709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.259122371673584  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.300412654876709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([860, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3028101921081543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3028101921081543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.30363035202026367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34476804733276367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([901, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3477950096130371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3477950096130371  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.34865427017211914  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.3991217613220215  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([819, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4022068977355957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4022068977355957  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4029879570007324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.4554100036621094  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([12275, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5135512351989746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5135512351989746  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 12275, 128]), torch.Size([1, 12275, 128])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.5252575874328613  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3568429946899414  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 12275, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.281618595123291  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3018431663513184  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3220677375793457  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.301684856414795  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([21207, 256])
first layer input nodes number: 70865
first layer output nodes number: 21207
edges number: 165846
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3225979804992676  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.342822551727295  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3478789329528809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3478789329528809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3705601692199707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3705601692199707  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3713345527648926  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.378798484802246  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3791632652282715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3791632652282715  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3799090385437012  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3939952850341797  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3945393562316895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3945393562316895  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.3951458930969238  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4137964248657227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.414381504058838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.414381504058838  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4148221015930176  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4275994300842285  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.428225040435791  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.428225040435791  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.428560733795166  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.440645694732666  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4413490295410156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4413490295410156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4416370391845703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4540214538574219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4547524452209473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4547524452209473  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.455000400543213  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4673981666564941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4681663513183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4681663513183594  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4683876037597656  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4809989929199219  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4816842079162598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4816842079162598  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4818596839904785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4930901527404785  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([53, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4935121536254883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4935121536254883  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.4936132431030273  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5007905960083008  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5014591217041016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5014591217041016  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5015888214111328  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5117053985595703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5122981071472168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5122981071472168  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.512406826019287  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5216479301452637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5221433639526367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5221433639526367  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5222272872924805  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5299482345581055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5304985046386719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5304985046386719  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5305824279785156  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5388908386230469  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5393824577331543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5393824577331543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5394530296325684  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.546933650970459  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.547482967376709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.547482967376709  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5475554466247559  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5557456016540527  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5563139915466309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5563139915466309  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.556384563446045  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5648531913757324  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565406322479248  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.565406322479248  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5654711723327637  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.573707103729248  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.574204444885254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.574204444885254  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5742597579956055  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5816717147827148  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5819902420043945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5819902420043945  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5820245742797852  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5868654251098633  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.587453842163086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.587453842163086  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5875110626220703  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5959796905517578  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.596479892730713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.596479892730713  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.5965275764465332  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6039185523986816  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6042265892028809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6042265892028809  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.604255199432373  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6088900566101074  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6094293594360352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6094293594360352  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6094751358032227  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6172113418579102  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6238923072814941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6238923072814941  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.6244244575500488  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.739701271057129  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7200822830200195  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.720506191253662  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes
Using backend: pytorch

----------------------------------------after rst
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7209300994873047  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.720484733581543  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

torch.Size([2843, 40])
input nodes number: 21207
output nodes number: 2843
edges number: 23059
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.7206649780273438  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 1.720665454864502  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049365997314453125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049365997314453125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.2479248046875 GB
    Memory Allocated: 0.049365997314453125  GigaBytes
Max Memory Allocated: 1.8111820220947266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01867176592350006 |0.0017503947019577026 |0.11768964678049088 |9.050220251083374e-05 |0.07179291546344757 |0.00480341911315918 |
----------------------------------------------------------pseudo_mini_loss sum 3.090313196182251
Total (block generation + training)time/epoch 24.19368863105774
Training time/epoch 6.839331150054932
Training time without block to device /epoch 6.783318519592285
Training time without total dataloading part /epoch 6.071141481399536
load block tensor time/epoch 0.597496509552002
block to device time/epoch 0.056012630462646484
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2941968
Number of first layer input nodes during this epoch:  2261552
Number of first layer output nodes during this epoch:  680416
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
